<!DOCTYPE html>
<html>
<head>
    <title>Test Supabase Connection</title>
</head>
<body>
    <h1>Supabase Connection Test</h1>
    <button onclick="testConnection()">Test Connection</button>
    <button onclick="testOrderInsert()">Test Order Insert</button>
    <div id="results"></div>

    <script>
        const SUPABASE_URL = 'https://ftexuxkdfahbqjddidaf.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ0ZXh1eGtkZmFoYnFqZGRpZGFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4OTg0MjMsImV4cCI6MjA3NTQ3NDQyM30.j_HfG_5FLay9EymJkJAkWRx0P0yScHXPZckIQ3apbEY';

        async function testConnection() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing connection...</p>';
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/orders?select=count&limit=1`, {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    results.innerHTML = '<p style="color: green;">✅ Connection successful!</p>';
                } else {
                    const error = await response.text();
                    results.innerHTML = `<p style="color: red;">❌ Connection failed: ${response.status} - ${error}</p>`;
                }
            } catch (error) {
                results.innerHTML = `<p style="color: red;">❌ Connection error: ${error.message}</p>`;
            }
        }

        async function testOrderInsert() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing order insert...</p>';
            
            const testOrder = {
                order_id: `TEST-${Date.now()}`,
                customer_name: 'Test Customer',
                customer_phone: '9999999999',
                delivery_address: 'Test Address',
                items: JSON.stringify([{product_id: 1, product_name: 'Test Product', price: 100, quantity: 1}]),
                total_amount: 100,
                status: 'confirmed',
                payment_status: 'paid',
                payment_id: 'test_payment',
                created_at: new Date().toISOString()
            };
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/orders`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=representation'
                    },
                    body: JSON.stringify(testOrder)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    results.innerHTML = `<p style="color: green;">✅ Order insert successful: ${JSON.stringify(result)}</p>`;
                } else {
                    const error = await response.text();
                    results.innerHTML = `<p style="color: red;">❌ Order insert failed: ${response.status} - ${error}</p>`;
                }
            } catch (error) {
                results.innerHTML = `<p style="color: red;">❌ Insert error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>