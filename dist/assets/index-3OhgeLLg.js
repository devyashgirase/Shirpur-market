var xx=Object.defineProperty;var Fd=i=>{throw TypeError(i)};var vx=(i,e,t)=>e in i?xx(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var ze=(i,e,t)=>vx(i,typeof e!="symbol"?e+"":e,t),Yo=(i,e,t)=>e.has(i)||Fd("Cannot "+t);var R=(i,e,t)=>(Yo(i,e,"read from private field"),t?t.call(i):e.get(i)),Ee=(i,e,t)=>e.has(i)?Fd("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),ge=(i,e,t,r)=>(Yo(i,e,"write to private field"),r?r.call(i,t):e.set(i,t),t),Nt=(i,e,t)=>(Yo(i,e,"access private method"),t);var ua=(i,e,t,r)=>({set _(a){ge(i,e,a,t)},get _(){return R(i,e,r)}});import{j as s,P as Me,c as Yr,a as dh,u as kt,B as yx,b as _i,d as nc,e as Te,f as En,R as bx,g as uh,h as Yt,i as _x,k as $a,D as hh,C as mh,l as wx,A as fh,m as ph,S as jx,O as Ua,n as gh,o as Fa,p as xh,T as za,q as Ba,r as vh,s as yh,t as bh,v as _h,w as Nx,x as wh,I as jh,y as Nh,z as Sh,E as Ph,L as kh,F as Ch,G as Sx,H as Px,J as Th,K as kx,M as Cx,N as Oh,Q as qa,U as Tx,V as Ox,W as Ix,X as Ax,Y as Ex,Z as Lx,_ as Mx}from"./ui-Cy2OMxkO.js";import{a as Ei,r as v,R as Z,b as Dx,c as Rx,d as $x,e as qt,g as Ux}from"./vendor-D2MHcRux.js";import{c as Ih,R as Qo,L as Fx,C as zd,X as Bd,Y as qd,T as Xo,a as zx,B as Bx,b as qx,P as Hx,d as Wx,e as Vx}from"./charts-BlUy_aaU.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();var Ah,Hd=Ei;Ah=Hd.createRoot,Hd.hydrateRoot;const Zx=1,Gx=3e3;let el=0;function Jx(){return el=(el+1)%Number.MAX_SAFE_INTEGER,el.toString()}const tl=new Map,Wd=i=>{if(tl.has(i))return;const e=setTimeout(()=>{tl.delete(i),gi({type:"REMOVE_TOAST",toastId:i})},Gx);tl.set(i,e)},Kx=(i,e)=>{switch(e.type){case"ADD_TOAST":return{...i,toasts:[e.toast,...i.toasts].slice(0,Zx)};case"UPDATE_TOAST":return{...i,toasts:i.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?Wd(t):i.toasts.forEach(r=>{Wd(r.id)}),{...i,toasts:i.toasts.map(r=>r.id===t||t===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...i,toasts:[]}:{...i,toasts:i.toasts.filter(t=>t.id!==e.toastId)}}},ba=[];let _a={toasts:[]};function gi(i){_a=Kx(_a,i),ba.forEach(e=>{e(_a)})}function Yx({...i}){const e=Jx(),t=a=>gi({type:"UPDATE_TOAST",toast:{...a,id:e}}),r=()=>gi({type:"DISMISS_TOAST",toastId:e});return gi({type:"ADD_TOAST",toast:{...i,id:e,open:!0,onOpenChange:a=>{a||r()}}}),{id:e,dismiss:r,update:t}}function Et(){const[i,e]=v.useState(_a);return v.useEffect(()=>(ba.push(e),()=>{const t=ba.indexOf(e);t>-1&&ba.splice(t,1)}),[i]),{...i,toast:Yx,dismiss:t=>gi({type:"DISMISS_TOAST",toastId:t})}}var Eh=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Qx="VisuallyHidden",Ha=v.forwardRef((i,e)=>s.jsx(Me.span,{...i,ref:e,style:{...Eh,...i.style}}));Ha.displayName=Qx;var Xx=Ha,ic="ToastProvider",[ac,ev,tv]=dh("Toast"),[Lh]=Yr("Toast",[tv]),[sv,Wa]=Lh(ic),Mh=i=>{const{__scopeToast:e,label:t="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:c}=i,[u,h]=v.useState(null),[f,p]=v.useState(0),g=v.useRef(!1),y=v.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${ic}\`. Expected non-empty \`string\`.`),s.jsx(ac.Provider,{scope:e,children:s.jsx(sv,{scope:e,label:t,duration:r,swipeDirection:a,swipeThreshold:l,toastCount:f,viewport:u,onViewportChange:h,onToastAdd:v.useCallback(()=>p(_=>_+1),[]),onToastRemove:v.useCallback(()=>p(_=>_-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:y,children:c})})};Mh.displayName=ic;var Dh="ToastViewport",rv=["F8"],vl="toast.viewportPause",yl="toast.viewportResume",Rh=v.forwardRef((i,e)=>{const{__scopeToast:t,hotkey:r=rv,label:a="Notifications ({hotkey})",...l}=i,c=Wa(Dh,t),u=ev(t),h=v.useRef(null),f=v.useRef(null),p=v.useRef(null),g=v.useRef(null),y=kt(e,g,c.onViewportChange),_=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),P=c.toastCount>0;v.useEffect(()=>{const j=S=>{var N;r.length!==0&&r.every(T=>S[T]||S.code===T)&&((N=g.current)==null||N.focus())};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[r]),v.useEffect(()=>{const j=h.current,S=g.current;if(P&&j&&S){const k=()=>{if(!c.isClosePausedRef.current){const E=new CustomEvent(vl);S.dispatchEvent(E),c.isClosePausedRef.current=!0}},N=()=>{if(c.isClosePausedRef.current){const E=new CustomEvent(yl);S.dispatchEvent(E),c.isClosePausedRef.current=!1}},T=E=>{!j.contains(E.relatedTarget)&&N()},O=()=>{j.contains(document.activeElement)||N()};return j.addEventListener("focusin",k),j.addEventListener("focusout",T),j.addEventListener("pointermove",k),j.addEventListener("pointerleave",O),window.addEventListener("blur",k),window.addEventListener("focus",N),()=>{j.removeEventListener("focusin",k),j.removeEventListener("focusout",T),j.removeEventListener("pointermove",k),j.removeEventListener("pointerleave",O),window.removeEventListener("blur",k),window.removeEventListener("focus",N)}}},[P,c.isClosePausedRef]);const b=v.useCallback(({tabbingDirection:j})=>{const k=u().map(N=>{const T=N.ref.current,O=[T,...gv(T)];return j==="forwards"?O:O.reverse()});return(j==="forwards"?k.reverse():k).flat()},[u]);return v.useEffect(()=>{const j=g.current;if(j){const S=k=>{var O,E,I;const N=k.altKey||k.ctrlKey||k.metaKey;if(k.key==="Tab"&&!N){const q=document.activeElement,B=k.shiftKey;if(k.target===j&&B){(O=f.current)==null||O.focus();return}const V=b({tabbingDirection:B?"backwards":"forwards"}),ue=V.findIndex(H=>H===q);sl(V.slice(ue+1))?k.preventDefault():B?(E=f.current)==null||E.focus():(I=p.current)==null||I.focus()}};return j.addEventListener("keydown",S),()=>j.removeEventListener("keydown",S)}},[u,b]),s.jsxs(yx,{ref:h,role:"region","aria-label":a.replace("{hotkey}",_),tabIndex:-1,style:{pointerEvents:P?void 0:"none"},children:[P&&s.jsx(bl,{ref:f,onFocusFromOutsideViewport:()=>{const j=b({tabbingDirection:"forwards"});sl(j)}}),s.jsx(ac.Slot,{scope:t,children:s.jsx(Me.ol,{tabIndex:-1,...l,ref:y})}),P&&s.jsx(bl,{ref:p,onFocusFromOutsideViewport:()=>{const j=b({tabbingDirection:"backwards"});sl(j)}})]})});Rh.displayName=Dh;var $h="ToastFocusProxy",bl=v.forwardRef((i,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:r,...a}=i,l=Wa($h,t);return s.jsx(Ha,{tabIndex:0,...a,ref:e,style:{position:"fixed"},onFocus:c=>{var f;const u=c.relatedTarget;!((f=l.viewport)!=null&&f.contains(u))&&r()}})});bl.displayName=$h;var Li="Toast",nv="toast.swipeStart",iv="toast.swipeMove",av="toast.swipeCancel",ov="toast.swipeEnd",Uh=v.forwardRef((i,e)=>{const{forceMount:t,open:r,defaultOpen:a,onOpenChange:l,...c}=i,[u,h]=_i({prop:r,defaultProp:a??!0,onChange:l,caller:Li});return s.jsx(nc,{present:t||u,children:s.jsx(dv,{open:u,...c,ref:e,onClose:()=>h(!1),onPause:En(i.onPause),onResume:En(i.onResume),onSwipeStart:Te(i.onSwipeStart,f=>{f.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Te(i.onSwipeMove,f=>{const{x:p,y:g}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","move"),f.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${p}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:Te(i.onSwipeCancel,f=>{f.currentTarget.setAttribute("data-swipe","cancel"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Te(i.onSwipeEnd,f=>{const{x:p,y:g}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","end"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${p}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),h(!1)})})})});Uh.displayName=Li;var[lv,cv]=Lh(Li,{onClose(){}}),dv=v.forwardRef((i,e)=>{const{__scopeToast:t,type:r="foreground",duration:a,open:l,onClose:c,onEscapeKeyDown:u,onPause:h,onResume:f,onSwipeStart:p,onSwipeMove:g,onSwipeCancel:y,onSwipeEnd:_,...P}=i,b=Wa(Li,t),[j,S]=v.useState(null),k=kt(e,H=>S(H)),N=v.useRef(null),T=v.useRef(null),O=a||b.duration,E=v.useRef(0),I=v.useRef(O),q=v.useRef(0),{onToastAdd:B,onToastRemove:W}=b,J=En(()=>{var te;(j==null?void 0:j.contains(document.activeElement))&&((te=b.viewport)==null||te.focus()),c()}),V=v.useCallback(H=>{!H||H===1/0||(window.clearTimeout(q.current),E.current=new Date().getTime(),q.current=window.setTimeout(J,H))},[J]);v.useEffect(()=>{const H=b.viewport;if(H){const te=()=>{V(I.current),f==null||f()},le=()=>{const ve=new Date().getTime()-E.current;I.current=I.current-ve,window.clearTimeout(q.current),h==null||h()};return H.addEventListener(vl,le),H.addEventListener(yl,te),()=>{H.removeEventListener(vl,le),H.removeEventListener(yl,te)}}},[b.viewport,O,h,f,V]),v.useEffect(()=>{l&&!b.isClosePausedRef.current&&V(O)},[l,O,b.isClosePausedRef,V]),v.useEffect(()=>(B(),()=>W()),[B,W]);const ue=v.useMemo(()=>j?Vh(j):null,[j]);return b.viewport?s.jsxs(s.Fragment,{children:[ue&&s.jsx(uv,{__scopeToast:t,role:"status","aria-live":r==="foreground"?"assertive":"polite",children:ue}),s.jsx(lv,{scope:t,onClose:J,children:Ei.createPortal(s.jsx(ac.ItemSlot,{scope:t,children:s.jsx(bx,{asChild:!0,onEscapeKeyDown:Te(u,()=>{b.isFocusedToastEscapeKeyDownRef.current||J(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(Me.li,{tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":b.swipeDirection,...P,ref:k,style:{userSelect:"none",touchAction:"none",...i.style},onKeyDown:Te(i.onKeyDown,H=>{H.key==="Escape"&&(u==null||u(H.nativeEvent),H.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,J()))}),onPointerDown:Te(i.onPointerDown,H=>{H.button===0&&(N.current={x:H.clientX,y:H.clientY})}),onPointerMove:Te(i.onPointerMove,H=>{if(!N.current)return;const te=H.clientX-N.current.x,le=H.clientY-N.current.y,ve=!!T.current,G=["left","right"].includes(b.swipeDirection),re=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,Y=G?re(0,te):0,be=G?0:re(0,le),de=H.pointerType==="touch"?10:2,he={x:Y,y:be},oe={originalEvent:H,delta:he};ve?(T.current=he,ha(iv,g,oe,{discrete:!1})):Vd(he,b.swipeDirection,de)?(T.current=he,ha(nv,p,oe,{discrete:!1}),H.target.setPointerCapture(H.pointerId)):(Math.abs(te)>de||Math.abs(le)>de)&&(N.current=null)}),onPointerUp:Te(i.onPointerUp,H=>{const te=T.current,le=H.target;if(le.hasPointerCapture(H.pointerId)&&le.releasePointerCapture(H.pointerId),T.current=null,N.current=null,te){const ve=H.currentTarget,G={originalEvent:H,delta:te};Vd(te,b.swipeDirection,b.swipeThreshold)?ha(ov,_,G,{discrete:!0}):ha(av,y,G,{discrete:!0}),ve.addEventListener("click",re=>re.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),uv=i=>{const{__scopeToast:e,children:t,...r}=i,a=Wa(Li,e),[l,c]=v.useState(!1),[u,h]=v.useState(!1);return fv(()=>c(!0)),v.useEffect(()=>{const f=window.setTimeout(()=>h(!0),1e3);return()=>window.clearTimeout(f)},[]),u?null:s.jsx(uh,{asChild:!0,children:s.jsx(Ha,{...r,children:l&&s.jsxs(s.Fragment,{children:[a.label," ",t]})})})},hv="ToastTitle",Fh=v.forwardRef((i,e)=>{const{__scopeToast:t,...r}=i;return s.jsx(Me.div,{...r,ref:e})});Fh.displayName=hv;var mv="ToastDescription",zh=v.forwardRef((i,e)=>{const{__scopeToast:t,...r}=i;return s.jsx(Me.div,{...r,ref:e})});zh.displayName=mv;var Bh="ToastAction",qh=v.forwardRef((i,e)=>{const{altText:t,...r}=i;return t.trim()?s.jsx(Wh,{altText:t,asChild:!0,children:s.jsx(oc,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Bh}\`. Expected non-empty \`string\`.`),null)});qh.displayName=Bh;var Hh="ToastClose",oc=v.forwardRef((i,e)=>{const{__scopeToast:t,...r}=i,a=cv(Hh,t);return s.jsx(Wh,{asChild:!0,children:s.jsx(Me.button,{type:"button",...r,ref:e,onClick:Te(i.onClick,a.onClose)})})});oc.displayName=Hh;var Wh=v.forwardRef((i,e)=>{const{__scopeToast:t,altText:r,...a}=i;return s.jsx(Me.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:e})});function Vh(i){const e=[];return Array.from(i.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),pv(r)){const a=r.ariaHidden||r.hidden||r.style.display==="none",l=r.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const c=r.dataset.radixToastAnnounceAlt;c&&e.push(c)}else e.push(...Vh(r))}}),e}function ha(i,e,t,{discrete:r}){const a=t.originalEvent.currentTarget,l=new CustomEvent(i,{bubbles:!0,cancelable:!0,detail:t});e&&a.addEventListener(i,e,{once:!0}),r?_x(a,l):a.dispatchEvent(l)}var Vd=(i,e,t=0)=>{const r=Math.abs(i.x),a=Math.abs(i.y),l=r>a;return e==="left"||e==="right"?l&&r>t:!l&&a>t};function fv(i=()=>{}){const e=En(i);Yt(()=>{let t=0,r=0;return t=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(r)}},[e])}function pv(i){return i.nodeType===i.ELEMENT_NODE}function gv(i){const e=[],t=document.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function sl(i){const e=document.activeElement;return i.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var xv=Mh,Zh=Rh,Gh=Uh,Jh=Fh,Kh=zh,Yh=qh,Qh=oc;const Zd=i=>typeof i=="boolean"?`${i}`:i===0?"0":i,Gd=Ih,Mi=(i,e)=>t=>{var r;if((e==null?void 0:e.variants)==null)return Gd(i,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:a,defaultVariants:l}=e,c=Object.keys(a).map(f=>{const p=t==null?void 0:t[f],g=l==null?void 0:l[f];if(p===null)return null;const y=Zd(p)||Zd(g);return a[f][y]}),u=t&&Object.entries(t).reduce((f,p)=>{let[g,y]=p;return y===void 0||(f[g]=y),f},{}),h=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((f,p)=>{let{class:g,className:y,..._}=p;return Object.entries(_).every(P=>{let[b,j]=P;return Array.isArray(j)?j.includes({...l,...u}[b]):{...l,...u}[b]===j})?[...f,g,y]:f},[]);return Gd(i,c,h,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vv=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xh=(...i)=>i.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bv=v.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:c,...u},h)=>v.createElement("svg",{ref:h,...yv,width:e,height:e,stroke:i,strokeWidth:r?Number(t)*24/Number(e):t,className:Xh("lucide",a),...u},[...c.map(([f,p])=>v.createElement(f,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=(i,e)=>{const t=v.forwardRef(({className:r,...a},l)=>v.createElement(bv,{ref:l,iconNode:e,className:Xh(`lucide-${vv(i)}`,r),...a}));return t.displayName=`${i}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=ee("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=ee("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=ee("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wv=ee("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=ee("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=ee("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=ee("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=ee("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=ee("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=ee("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=ee("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=ee("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=ee("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=ee("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=ee("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=ee("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=ee("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=ee("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=ee("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=ee("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=ee("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=ee("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=ee("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=ee("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=ee("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=ee("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=ee("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=ee("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=ee("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=ee("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=ee("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=ee("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=ee("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=ee("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=ee("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=ee("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cc=ee("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=ee("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=ee("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=ee("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=ee("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=ee("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=ee("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=ee("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=ee("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=ee("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=ee("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=ee("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=ee("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=ee("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=ee("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=ee("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=ee("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=ee("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=ee("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=ee("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=ee("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=ee("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=ee("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=ee("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=ee("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=ee("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uc=ee("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),hc="-",Bv=i=>{const e=Hv(i),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=i;return{getClassGroupId:c=>{const u=c.split(hc);return u[0]===""&&u.length!==1&&u.shift(),cm(u,e)||qv(c)},getConflictingClassGroupIds:(c,u)=>{const h=t[c]||[];return u&&r[c]?[...h,...r[c]]:h}}},cm=(i,e)=>{var c;if(i.length===0)return e.classGroupId;const t=i[0],r=e.nextPart.get(t),a=r?cm(i.slice(1),r):void 0;if(a)return a;if(e.validators.length===0)return;const l=i.join(hc);return(c=e.validators.find(({validator:u})=>u(l)))==null?void 0:c.classGroupId},su=/^\[(.+)\]$/,qv=i=>{if(su.test(i)){const e=su.exec(i)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},Hv=i=>{const{theme:e,prefix:t}=i,r={nextPart:new Map,validators:[]};return Vv(Object.entries(i.classGroups),t).forEach(([l,c])=>{Sl(c,r,l,e)}),r},Sl=(i,e,t,r)=>{i.forEach(a=>{if(typeof a=="string"){const l=a===""?e:ru(e,a);l.classGroupId=t;return}if(typeof a=="function"){if(Wv(a)){Sl(a(r),e,t,r);return}e.validators.push({validator:a,classGroupId:t});return}Object.entries(a).forEach(([l,c])=>{Sl(c,ru(e,l),t,r)})})},ru=(i,e)=>{let t=i;return e.split(hc).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},Wv=i=>i.isThemeGetter,Vv=(i,e)=>e?i.map(([t,r])=>{const a=r.map(l=>typeof l=="string"?e+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([c,u])=>[e+c,u])):l);return[t,a]}):i,Zv=i=>{if(i<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const a=(l,c)=>{t.set(l,c),e++,e>i&&(e=0,r=t,t=new Map)};return{get(l){let c=t.get(l);if(c!==void 0)return c;if((c=r.get(l))!==void 0)return a(l,c),c},set(l,c){t.has(l)?t.set(l,c):a(l,c)}}},dm="!",Gv=i=>{const{separator:e,experimentalParseClassName:t}=i,r=e.length===1,a=e[0],l=e.length,c=u=>{const h=[];let f=0,p=0,g;for(let j=0;j<u.length;j++){let S=u[j];if(f===0){if(S===a&&(r||u.slice(j,j+l)===e)){h.push(u.slice(p,j)),p=j+l;continue}if(S==="/"){g=j;continue}}S==="["?f++:S==="]"&&f--}const y=h.length===0?u:u.substring(p),_=y.startsWith(dm),P=_?y.substring(1):y,b=g&&g>p?g-p:void 0;return{modifiers:h,hasImportantModifier:_,baseClassName:P,maybePostfixModifierPosition:b}};return t?u=>t({className:u,parseClassName:c}):c},Jv=i=>{if(i.length<=1)return i;const e=[];let t=[];return i.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},Kv=i=>({cache:Zv(i.cacheSize),parseClassName:Gv(i),...Bv(i)}),Yv=/\s+/,Qv=(i,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:a}=e,l=[],c=i.trim().split(Yv);let u="";for(let h=c.length-1;h>=0;h-=1){const f=c[h],{modifiers:p,hasImportantModifier:g,baseClassName:y,maybePostfixModifierPosition:_}=t(f);let P=!!_,b=r(P?y.substring(0,_):y);if(!b){if(!P){u=f+(u.length>0?" "+u:u);continue}if(b=r(y),!b){u=f+(u.length>0?" "+u:u);continue}P=!1}const j=Jv(p).join(":"),S=g?j+dm:j,k=S+b;if(l.includes(k))continue;l.push(k);const N=a(b,P);for(let T=0;T<N.length;++T){const O=N[T];l.push(S+O)}u=f+(u.length>0?" "+u:u)}return u};function Xv(){let i=0,e,t,r="";for(;i<arguments.length;)(e=arguments[i++])&&(t=um(e))&&(r&&(r+=" "),r+=t);return r}const um=i=>{if(typeof i=="string")return i;let e,t="";for(let r=0;r<i.length;r++)i[r]&&(e=um(i[r]))&&(t&&(t+=" "),t+=e);return t};function ey(i,...e){let t,r,a,l=c;function c(h){const f=e.reduce((p,g)=>g(p),i());return t=Kv(f),r=t.cache.get,a=t.cache.set,l=u,u(h)}function u(h){const f=r(h);if(f)return f;const p=Qv(h,t);return a(h,p),p}return function(){return l(Xv.apply(null,arguments))}}const Ve=i=>{const e=t=>t[i]||[];return e.isThemeGetter=!0,e},hm=/^\[(?:([a-z-]+):)?(.+)\]$/i,ty=/^\d+\/\d+$/,sy=new Set(["px","full","screen"]),ry=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ny=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iy=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ay=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oy=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,zs=i=>jn(i)||sy.has(i)||ty.test(i),sr=i=>Fn(i,"length",py),jn=i=>!!i&&!Number.isNaN(Number(i)),rl=i=>Fn(i,"number",jn),di=i=>!!i&&Number.isInteger(Number(i)),ly=i=>i.endsWith("%")&&jn(i.slice(0,-1)),Se=i=>hm.test(i),rr=i=>ry.test(i),cy=new Set(["length","size","percentage"]),dy=i=>Fn(i,cy,mm),uy=i=>Fn(i,"position",mm),hy=new Set(["image","url"]),my=i=>Fn(i,hy,xy),fy=i=>Fn(i,"",gy),ui=()=>!0,Fn=(i,e,t)=>{const r=hm.exec(i);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},py=i=>ny.test(i)&&!iy.test(i),mm=()=>!1,gy=i=>ay.test(i),xy=i=>oy.test(i),vy=()=>{const i=Ve("colors"),e=Ve("spacing"),t=Ve("blur"),r=Ve("brightness"),a=Ve("borderColor"),l=Ve("borderRadius"),c=Ve("borderSpacing"),u=Ve("borderWidth"),h=Ve("contrast"),f=Ve("grayscale"),p=Ve("hueRotate"),g=Ve("invert"),y=Ve("gap"),_=Ve("gradientColorStops"),P=Ve("gradientColorStopPositions"),b=Ve("inset"),j=Ve("margin"),S=Ve("opacity"),k=Ve("padding"),N=Ve("saturate"),T=Ve("scale"),O=Ve("sepia"),E=Ve("skew"),I=Ve("space"),q=Ve("translate"),B=()=>["auto","contain","none"],W=()=>["auto","hidden","clip","visible","scroll"],J=()=>["auto",Se,e],V=()=>[Se,e],ue=()=>["",zs,sr],H=()=>["auto",jn,Se],te=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],le=()=>["solid","dashed","dotted","double","none"],ve=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>["start","end","center","between","around","evenly","stretch"],re=()=>["","0",Se],Y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],be=()=>[jn,Se];return{cacheSize:500,separator:":",theme:{colors:[ui],spacing:[zs,sr],blur:["none","",rr,Se],brightness:be(),borderColor:[i],borderRadius:["none","","full",rr,Se],borderSpacing:V(),borderWidth:ue(),contrast:be(),grayscale:re(),hueRotate:be(),invert:re(),gap:V(),gradientColorStops:[i],gradientColorStopPositions:[ly,sr],inset:J(),margin:J(),opacity:be(),padding:V(),saturate:be(),scale:be(),sepia:re(),skew:be(),space:V(),translate:V()},classGroups:{aspect:[{aspect:["auto","square","video",Se]}],container:["container"],columns:[{columns:[rr]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...te(),Se]}],overflow:[{overflow:W()}],"overflow-x":[{"overflow-x":W()}],"overflow-y":[{"overflow-y":W()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",di,Se]}],basis:[{basis:J()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Se]}],grow:[{grow:re()}],shrink:[{shrink:re()}],order:[{order:["first","last","none",di,Se]}],"grid-cols":[{"grid-cols":[ui]}],"col-start-end":[{col:["auto",{span:["full",di,Se]},Se]}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":[ui]}],"row-start-end":[{row:["auto",{span:[di,Se]},Se]}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Se]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Se]}],gap:[{gap:[y]}],"gap-x":[{"gap-x":[y]}],"gap-y":[{"gap-y":[y]}],"justify-content":[{justify:["normal",...G()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...G(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...G(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[j]}],mx:[{mx:[j]}],my:[{my:[j]}],ms:[{ms:[j]}],me:[{me:[j]}],mt:[{mt:[j]}],mr:[{mr:[j]}],mb:[{mb:[j]}],ml:[{ml:[j]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Se,e]}],"min-w":[{"min-w":[Se,e,"min","max","fit"]}],"max-w":[{"max-w":[Se,e,"none","full","min","max","fit","prose",{screen:[rr]},rr]}],h:[{h:[Se,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Se,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Se,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Se,e,"auto","min","max","fit"]}],"font-size":[{text:["base",rr,sr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",rl]}],"font-family":[{font:[ui]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Se]}],"line-clamp":[{"line-clamp":["none",jn,rl]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",zs,Se]}],"list-image":[{"list-image":["none",Se]}],"list-style-type":[{list:["none","disc","decimal",Se]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[i]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[i]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...le(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",zs,sr]}],"underline-offset":[{"underline-offset":["auto",zs,Se]}],"text-decoration-color":[{decoration:[i]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:V()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Se]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Se]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...te(),uy]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",dy]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},my]}],"bg-color":[{bg:[i]}],"gradient-from-pos":[{from:[P]}],"gradient-via-pos":[{via:[P]}],"gradient-to-pos":[{to:[P]}],"gradient-from":[{from:[_]}],"gradient-via":[{via:[_]}],"gradient-to":[{to:[_]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[u]}],"border-w-x":[{"border-x":[u]}],"border-w-y":[{"border-y":[u]}],"border-w-s":[{"border-s":[u]}],"border-w-e":[{"border-e":[u]}],"border-w-t":[{"border-t":[u]}],"border-w-r":[{"border-r":[u]}],"border-w-b":[{"border-b":[u]}],"border-w-l":[{"border-l":[u]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...le(),"hidden"]}],"divide-x":[{"divide-x":[u]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[u]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:le()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...le()]}],"outline-offset":[{"outline-offset":[zs,Se]}],"outline-w":[{outline:[zs,sr]}],"outline-color":[{outline:[i]}],"ring-w":[{ring:ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[i]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[zs,sr]}],"ring-offset-color":[{"ring-offset":[i]}],shadow:[{shadow:["","inner","none",rr,fy]}],"shadow-color":[{shadow:[ui]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...ve(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ve()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[h]}],"drop-shadow":[{"drop-shadow":["","none",rr,Se]}],grayscale:[{grayscale:[f]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[g]}],saturate:[{saturate:[N]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[h]}],"backdrop-grayscale":[{"backdrop-grayscale":[f]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[g]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Se]}],duration:[{duration:be()}],ease:[{ease:["linear","in","out","in-out",Se]}],delay:[{delay:be()}],animate:[{animate:["none","spin","ping","pulse","bounce",Se]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[di,Se]}],"translate-x":[{"translate-x":[q]}],"translate-y":[{"translate-y":[q]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Se]}],accent:[{accent:["auto",i]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Se]}],"caret-color":[{caret:[i]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Se]}],fill:[{fill:[i,"none"]}],"stroke-w":[{stroke:[zs,sr,rl]}],stroke:[{stroke:[i,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},yy=ey(vy);function se(...i){return yy(Ih(i))}const by=xv,fm=v.forwardRef(({className:i,...e},t)=>s.jsx(Zh,{ref:t,className:se("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-2 sm:p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",i),...e}));fm.displayName=Zh.displayName;const _y=Mi("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 sm:space-x-4 overflow-hidden rounded-md border p-3 pr-6 sm:p-6 sm:pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:toast-bounce data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground",success:"border-green-200 bg-green-50 text-green-800 toast-success"}},defaultVariants:{variant:"default"}}),pm=v.forwardRef(({className:i,variant:e,...t},r)=>s.jsx(Gh,{ref:r,className:se(_y({variant:e}),i),...t}));pm.displayName=Gh.displayName;const wy=v.forwardRef(({className:i,...e},t)=>s.jsx(Yh,{ref:t,className:se("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",i),...e}));wy.displayName=Yh.displayName;const gm=v.forwardRef(({className:i,...e},t)=>s.jsx(Qh,{ref:t,className:se("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",i),"toast-close":"",...e,children:s.jsx(ps,{className:"h-4 w-4"})}));gm.displayName=Qh.displayName;const xm=v.forwardRef(({className:i,...e},t)=>s.jsx(Jh,{ref:t,className:se("text-xs sm:text-sm font-semibold",i),...e}));xm.displayName=Jh.displayName;const vm=v.forwardRef(({className:i,...e},t)=>s.jsx(Kh,{ref:t,className:se("text-xs sm:text-sm opacity-90",i),...e}));vm.displayName=Kh.displayName;function jy(){const{toasts:i}=Et();return s.jsxs(by,{children:[i.map(function({id:e,title:t,description:r,action:a,...l}){return s.jsxs(pm,{...l,children:[s.jsxs("div",{className:"grid gap-1",children:[t&&s.jsx(xm,{children:t}),r&&s.jsx(vm,{children:r})]}),a,s.jsx(gm,{})]},e)}),s.jsx(fm,{})]})}const Ny=({show:i,title:e,message:t,type:r="success",onClose:a,duration:l=3e3})=>{const[c,u]=v.useState(!1),[h,f]=v.useState(!1),p=()=>{h||(f(!0),u(!1),setTimeout(()=>{a(),f(!1)},300))};return v.useEffect(()=>{if(i){u(!0),f(!1);const g=setTimeout(p,l);return()=>clearTimeout(g)}},[i,l]),!i&&!c?null:s.jsx("div",{className:se("fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm",c?"animate-in fade-in-0":"animate-out fade-out-0"),children:s.jsxs("div",{className:se("bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center shadow-2xl",c?"animate-in zoom-in-95 slide-in-from-bottom-4":"animate-out zoom-out-95 slide-out-to-bottom-4"),children:[s.jsx("button",{onClick:p,disabled:h,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 disabled:opacity-50",children:s.jsx(ps,{className:"w-5 h-5"})}),s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"w-20 h-20 mx-auto mb-4 relative",children:[s.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center animate-bounce",children:s.jsx(Qt,{className:"w-12 h-12 text-green-500"})}),s.jsx("div",{className:"absolute inset-0 w-20 h-20 bg-green-200 rounded-full animate-ping opacity-20"})]})}),s.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:e}),s.jsx("p",{className:"text-gray-600 mb-6",children:t}),s.jsx("button",{onClick:p,disabled:h,className:"bg-green-500 hover:bg-green-600 disabled:bg-green-400 text-white px-8 py-3 rounded-lg font-medium transition-colors disabled:cursor-not-allowed",children:"Great!"})]})})};let Pl=[],ka=null;const wa={success:(i,e)=>{ka?ka({title:i,message:e,type:"success"}):Pl.push({title:i,message:e,type:"success"})}},Sy=({children:i})=>{const[e,t]=v.useState(null);return v.useEffect(()=>{if(ka=r=>{t(r)},Pl.length>0){const r=Pl.shift();r&&t(r)}return()=>{ka=null}},[]),s.jsxs(s.Fragment,{children:[i,s.jsx(Ny,{show:!!e,title:(e==null?void 0:e.title)||"",message:(e==null?void 0:e.message)||"",type:e==null?void 0:e.type,onClose:()=>t(null)})]})};var nu=["light","dark"],Py="(prefers-color-scheme: dark)",ky=v.createContext(void 0),Cy={setTheme:i=>{},themes:[]},Ty=()=>{var i;return(i=v.useContext(ky))!=null?i:Cy};v.memo(({forcedTheme:i,storageKey:e,attribute:t,enableSystem:r,enableColorScheme:a,defaultTheme:l,value:c,attrs:u,nonce:h})=>{let f=l==="system",p=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${u.map(P=>`'${P}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,g=a?nu.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",y=(P,b=!1,j=!0)=>{let S=c?c[P]:P,k=b?P+"|| ''":`'${S}'`,N="";return a&&j&&!b&&nu.includes(P)&&(N+=`d.style.colorScheme = '${P}';`),t==="class"?b||S?N+=`c.add(${k})`:N+="null":S&&(N+=`d[s](n,${k})`),N},_=i?`!function(){${p}${y(i)}}()`:r?`!function(){try{${p}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${f})){var t='${Py}',m=window.matchMedia(t);if(m.media!==t||m.matches){${y("dark")}}else{${y("light")}}}else if(e){${c?`var x=${JSON.stringify(c)};`:""}${y(c?"x[e]":"e",!0)}}${f?"":"else{"+y(l,!1,!1)+"}"}${g}}catch(e){}}()`:`!function(){try{${p}var e=localStorage.getItem('${e}');if(e){${c?`var x=${JSON.stringify(c)};`:""}${y(c?"x[e]":"e",!0)}}else{${y(l,!1,!1)};}${g}}catch(t){}}();`;return v.createElement("script",{nonce:h,dangerouslySetInnerHTML:{__html:_}})});var Oy=i=>{switch(i){case"success":return Ey;case"info":return My;case"warning":return Ly;case"error":return Dy;default:return null}},Iy=Array(12).fill(0),Ay=({visible:i,className:e})=>Z.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":i},Z.createElement("div",{className:"sonner-spinner"},Iy.map((t,r)=>Z.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),Ey=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Ly=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),My=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Dy=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Z.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Ry=Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Z.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Z.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),$y=()=>{let[i,e]=Z.useState(document.hidden);return Z.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),i},kl=1,Uy=class{constructor(){this.subscribe=i=>(this.subscribers.push(i),()=>{let e=this.subscribers.indexOf(i);this.subscribers.splice(e,1)}),this.publish=i=>{this.subscribers.forEach(e=>e(i))},this.addToast=i=>{this.publish(i),this.toasts=[...this.toasts,i]},this.create=i=>{var e;let{message:t,...r}=i,a=typeof(i==null?void 0:i.id)=="number"||((e=i.id)==null?void 0:e.length)>0?i.id:kl++,l=this.toasts.find(u=>u.id===a),c=i.dismissible===void 0?!0:i.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),l?this.toasts=this.toasts.map(u=>u.id===a?(this.publish({...u,...i,id:a,title:t}),{...u,...i,id:a,dismissible:c,title:t}):u):this.addToast({title:t,...r,dismissible:c,id:a}),a},this.dismiss=i=>(this.dismissedToasts.add(i),i||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:i,dismiss:!0})),i),this.message=(i,e)=>this.create({...e,message:i}),this.error=(i,e)=>this.create({...e,message:i,type:"error"}),this.success=(i,e)=>this.create({...e,type:"success",message:i}),this.info=(i,e)=>this.create({...e,type:"info",message:i}),this.warning=(i,e)=>this.create({...e,type:"warning",message:i}),this.loading=(i,e)=>this.create({...e,type:"loading",message:i}),this.promise=(i,e)=>{if(!e)return;let t;e.loading!==void 0&&(t=this.create({...e,promise:i,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=i instanceof Promise?i:i(),a=t!==void 0,l,c=r.then(async h=>{if(l=["resolve",h],Z.isValidElement(h))a=!1,this.create({id:t,type:"default",message:h});else if(zy(h)&&!h.ok){a=!1;let f=typeof e.error=="function"?await e.error(`HTTP error! status: ${h.status}`):e.error,p=typeof e.description=="function"?await e.description(`HTTP error! status: ${h.status}`):e.description;this.create({id:t,type:"error",message:f,description:p})}else if(e.success!==void 0){a=!1;let f=typeof e.success=="function"?await e.success(h):e.success,p=typeof e.description=="function"?await e.description(h):e.description;this.create({id:t,type:"success",message:f,description:p})}}).catch(async h=>{if(l=["reject",h],e.error!==void 0){a=!1;let f=typeof e.error=="function"?await e.error(h):e.error,p=typeof e.description=="function"?await e.description(h):e.description;this.create({id:t,type:"error",message:f,description:p})}}).finally(()=>{var h;a&&(this.dismiss(t),t=void 0),(h=e.finally)==null||h.call(e)}),u=()=>new Promise((h,f)=>c.then(()=>l[0]==="reject"?f(l[1]):h(l[1])).catch(f));return typeof t!="string"&&typeof t!="number"?{unwrap:u}:Object.assign(t,{unwrap:u})},this.custom=(i,e)=>{let t=(e==null?void 0:e.id)||kl++;return this.create({jsx:i(t),id:t,...e}),t},this.getActiveToasts=()=>this.toasts.filter(i=>!this.dismissedToasts.has(i.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Dt=new Uy,Fy=(i,e)=>{let t=(e==null?void 0:e.id)||kl++;return Dt.addToast({title:i,...e,id:t}),t},zy=i=>i&&typeof i=="object"&&"ok"in i&&typeof i.ok=="boolean"&&"status"in i&&typeof i.status=="number",By=Fy,qy=()=>Dt.toasts,Hy=()=>Dt.getActiveToasts();Object.assign(By,{success:Dt.success,info:Dt.info,warning:Dt.warning,error:Dt.error,custom:Dt.custom,message:Dt.message,promise:Dt.promise,dismiss:Dt.dismiss,loading:Dt.loading},{getHistory:qy,getToasts:Hy});function Wy(i,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=i:r.appendChild(document.createTextNode(i))}Wy(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function ma(i){return i.label!==void 0}var Vy=3,Zy="32px",Gy="16px",iu=4e3,Jy=356,Ky=14,Yy=20,Qy=200;function rs(...i){return i.filter(Boolean).join(" ")}function Xy(i){let[e,t]=i.split("-"),r=[];return e&&r.push(e),t&&r.push(t),r}var e0=i=>{var e,t,r,a,l,c,u,h,f,p,g;let{invert:y,toast:_,unstyled:P,interacting:b,setHeights:j,visibleToasts:S,heights:k,index:N,toasts:T,expanded:O,removeToast:E,defaultRichColors:I,closeButton:q,style:B,cancelButtonStyle:W,actionButtonStyle:J,className:V="",descriptionClassName:ue="",duration:H,position:te,gap:le,loadingIcon:ve,expandByDefault:G,classNames:re,icons:Y,closeButtonAriaLabel:be="Close toast",pauseWhenPageIsHidden:de}=i,[he,oe]=Z.useState(null),[fe,pe]=Z.useState(null),[K,Oe]=Z.useState(!1),[et,Re]=Z.useState(!1),[Ie,Ae]=Z.useState(!1),[Lt,es]=Z.useState(!1),[Ys,As]=Z.useState(!1),[Es,Qs]=Z.useState(0),[yo,Gn]=Z.useState(0),Ls=Z.useRef(_.duration||H||iu),Jn=Z.useRef(null),gs=Z.useRef(null),bo=N===0,_o=N+1<=S,jt=_.type,Ms=_.dismissible!==!1,Bi=_.className||"",wo=_.descriptionClassName||"",wr=Z.useMemo(()=>k.findIndex(ye=>ye.toastId===_.id)||0,[k,_.id]),qi=Z.useMemo(()=>{var ye;return(ye=_.closeButton)!=null?ye:q},[_.closeButton,q]),Hi=Z.useMemo(()=>_.duration||H||iu,[_.duration,H]),sn=Z.useRef(0),xs=Z.useRef(0),Kn=Z.useRef(0),Xs=Z.useRef(null),[jr,jo]=te.split("-"),Wi=Z.useMemo(()=>k.reduce((ye,Ue,qe)=>qe>=wr?ye:ye+Ue.height,0),[k,wr]),Yn=$y(),Vi=_.invert||y,rn=jt==="loading";xs.current=Z.useMemo(()=>wr*le+Wi,[wr,Wi]),Z.useEffect(()=>{Ls.current=Hi},[Hi]),Z.useEffect(()=>{Oe(!0)},[]),Z.useEffect(()=>{let ye=gs.current;if(ye){let Ue=ye.getBoundingClientRect().height;return Gn(Ue),j(qe=>[{toastId:_.id,height:Ue,position:_.position},...qe]),()=>j(qe=>qe.filter(Ft=>Ft.toastId!==_.id))}},[j,_.id]),Z.useLayoutEffect(()=>{if(!K)return;let ye=gs.current,Ue=ye.style.height;ye.style.height="auto";let qe=ye.getBoundingClientRect().height;ye.style.height=Ue,Gn(qe),j(Ft=>Ft.find(Ct=>Ct.toastId===_.id)?Ft.map(Ct=>Ct.toastId===_.id?{...Ct,height:qe}:Ct):[{toastId:_.id,height:qe,position:_.position},...Ft])},[K,_.title,_.description,j,_.id]);let vs=Z.useCallback(()=>{Re(!0),Qs(xs.current),j(ye=>ye.filter(Ue=>Ue.toastId!==_.id)),setTimeout(()=>{E(_)},Qy)},[_,E,j,xs]);Z.useEffect(()=>{if(_.promise&&jt==="loading"||_.duration===1/0||_.type==="loading")return;let ye;return O||b||de&&Yn?(()=>{if(Kn.current<sn.current){let Ue=new Date().getTime()-sn.current;Ls.current=Ls.current-Ue}Kn.current=new Date().getTime()})():Ls.current!==1/0&&(sn.current=new Date().getTime(),ye=setTimeout(()=>{var Ue;(Ue=_.onAutoClose)==null||Ue.call(_,_),vs()},Ls.current)),()=>clearTimeout(ye)},[O,b,_,jt,de,Yn,vs]),Z.useEffect(()=>{_.delete&&vs()},[vs,_.delete]);function No(){var ye,Ue,qe;return Y!=null&&Y.loading?Z.createElement("div",{className:rs(re==null?void 0:re.loader,(ye=_==null?void 0:_.classNames)==null?void 0:ye.loader,"sonner-loader"),"data-visible":jt==="loading"},Y.loading):ve?Z.createElement("div",{className:rs(re==null?void 0:re.loader,(Ue=_==null?void 0:_.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":jt==="loading"},ve):Z.createElement(Ay,{className:rs(re==null?void 0:re.loader,(qe=_==null?void 0:_.classNames)==null?void 0:qe.loader),visible:jt==="loading"})}return Z.createElement("li",{tabIndex:0,ref:gs,className:rs(V,Bi,re==null?void 0:re.toast,(e=_==null?void 0:_.classNames)==null?void 0:e.toast,re==null?void 0:re.default,re==null?void 0:re[jt],(t=_==null?void 0:_.classNames)==null?void 0:t[jt]),"data-sonner-toast":"","data-rich-colors":(r=_.richColors)!=null?r:I,"data-styled":!(_.jsx||_.unstyled||P),"data-mounted":K,"data-promise":!!_.promise,"data-swiped":Ys,"data-removed":et,"data-visible":_o,"data-y-position":jr,"data-x-position":jo,"data-index":N,"data-front":bo,"data-swiping":Ie,"data-dismissible":Ms,"data-type":jt,"data-invert":Vi,"data-swipe-out":Lt,"data-swipe-direction":fe,"data-expanded":!!(O||G&&K),style:{"--index":N,"--toasts-before":N,"--z-index":T.length-N,"--offset":`${et?Es:xs.current}px`,"--initial-height":G?"auto":`${yo}px`,...B,..._.style},onDragEnd:()=>{Ae(!1),oe(null),Xs.current=null},onPointerDown:ye=>{rn||!Ms||(Jn.current=new Date,Qs(xs.current),ye.target.setPointerCapture(ye.pointerId),ye.target.tagName!=="BUTTON"&&(Ae(!0),Xs.current={x:ye.clientX,y:ye.clientY}))},onPointerUp:()=>{var ye,Ue,qe,Ft;if(Lt||!Ms)return;Xs.current=null;let Ct=Number(((ye=gs.current)==null?void 0:ye.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ys=Number(((Ue=gs.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ds=new Date().getTime()-((qe=Jn.current)==null?void 0:qe.getTime()),zt=he==="x"?Ct:ys,bs=Math.abs(zt)/Ds;if(Math.abs(zt)>=Yy||bs>.11){Qs(xs.current),(Ft=_.onDismiss)==null||Ft.call(_,_),pe(he==="x"?Ct>0?"right":"left":ys>0?"down":"up"),vs(),es(!0),As(!1);return}Ae(!1),oe(null)},onPointerMove:ye=>{var Ue,qe,Ft,Ct;if(!Xs.current||!Ms||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;let ys=ye.clientY-Xs.current.y,Ds=ye.clientX-Xs.current.x,zt=(qe=i.swipeDirections)!=null?qe:Xy(te);!he&&(Math.abs(Ds)>1||Math.abs(ys)>1)&&oe(Math.abs(Ds)>Math.abs(ys)?"x":"y");let bs={x:0,y:0};he==="y"?(zt.includes("top")||zt.includes("bottom"))&&(zt.includes("top")&&ys<0||zt.includes("bottom")&&ys>0)&&(bs.y=ys):he==="x"&&(zt.includes("left")||zt.includes("right"))&&(zt.includes("left")&&Ds<0||zt.includes("right")&&Ds>0)&&(bs.x=Ds),(Math.abs(bs.x)>0||Math.abs(bs.y)>0)&&As(!0),(Ft=gs.current)==null||Ft.style.setProperty("--swipe-amount-x",`${bs.x}px`),(Ct=gs.current)==null||Ct.style.setProperty("--swipe-amount-y",`${bs.y}px`)}},qi&&!_.jsx?Z.createElement("button",{"aria-label":be,"data-disabled":rn,"data-close-button":!0,onClick:rn||!Ms?()=>{}:()=>{var ye;vs(),(ye=_.onDismiss)==null||ye.call(_,_)},className:rs(re==null?void 0:re.closeButton,(a=_==null?void 0:_.classNames)==null?void 0:a.closeButton)},(l=Y==null?void 0:Y.close)!=null?l:Ry):null,_.jsx||v.isValidElement(_.title)?_.jsx?_.jsx:typeof _.title=="function"?_.title():_.title:Z.createElement(Z.Fragment,null,jt||_.icon||_.promise?Z.createElement("div",{"data-icon":"",className:rs(re==null?void 0:re.icon,(c=_==null?void 0:_.classNames)==null?void 0:c.icon)},_.promise||_.type==="loading"&&!_.icon?_.icon||No():null,_.type!=="loading"?_.icon||(Y==null?void 0:Y[jt])||Oy(jt):null):null,Z.createElement("div",{"data-content":"",className:rs(re==null?void 0:re.content,(u=_==null?void 0:_.classNames)==null?void 0:u.content)},Z.createElement("div",{"data-title":"",className:rs(re==null?void 0:re.title,(h=_==null?void 0:_.classNames)==null?void 0:h.title)},typeof _.title=="function"?_.title():_.title),_.description?Z.createElement("div",{"data-description":"",className:rs(ue,wo,re==null?void 0:re.description,(f=_==null?void 0:_.classNames)==null?void 0:f.description)},typeof _.description=="function"?_.description():_.description):null),v.isValidElement(_.cancel)?_.cancel:_.cancel&&ma(_.cancel)?Z.createElement("button",{"data-button":!0,"data-cancel":!0,style:_.cancelButtonStyle||W,onClick:ye=>{var Ue,qe;ma(_.cancel)&&Ms&&((qe=(Ue=_.cancel).onClick)==null||qe.call(Ue,ye),vs())},className:rs(re==null?void 0:re.cancelButton,(p=_==null?void 0:_.classNames)==null?void 0:p.cancelButton)},_.cancel.label):null,v.isValidElement(_.action)?_.action:_.action&&ma(_.action)?Z.createElement("button",{"data-button":!0,"data-action":!0,style:_.actionButtonStyle||J,onClick:ye=>{var Ue,qe;ma(_.action)&&((qe=(Ue=_.action).onClick)==null||qe.call(Ue,ye),!ye.defaultPrevented&&vs())},className:rs(re==null?void 0:re.actionButton,(g=_==null?void 0:_.classNames)==null?void 0:g.actionButton)},_.action.label):null))};function au(){if(typeof window>"u"||typeof document>"u")return"ltr";let i=document.documentElement.getAttribute("dir");return i==="auto"||!i?window.getComputedStyle(document.documentElement).direction:i}function t0(i,e){let t={};return[i,e].forEach((r,a)=>{let l=a===1,c=l?"--mobile-offset":"--offset",u=l?Gy:Zy;function h(f){["top","right","bottom","left"].forEach(p=>{t[`${c}-${p}`]=typeof f=="number"?`${f}px`:f})}typeof r=="number"||typeof r=="string"?h(r):typeof r=="object"?["top","right","bottom","left"].forEach(f=>{r[f]===void 0?t[`${c}-${f}`]=u:t[`${c}-${f}`]=typeof r[f]=="number"?`${r[f]}px`:r[f]}):h(u)}),t}var s0=v.forwardRef(function(i,e){let{invert:t,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:l,closeButton:c,className:u,offset:h,mobileOffset:f,theme:p="light",richColors:g,duration:y,style:_,visibleToasts:P=Vy,toastOptions:b,dir:j=au(),gap:S=Ky,loadingIcon:k,icons:N,containerAriaLabel:T="Notifications",pauseWhenPageIsHidden:O}=i,[E,I]=Z.useState([]),q=Z.useMemo(()=>Array.from(new Set([r].concat(E.filter(de=>de.position).map(de=>de.position)))),[E,r]),[B,W]=Z.useState([]),[J,V]=Z.useState(!1),[ue,H]=Z.useState(!1),[te,le]=Z.useState(p!=="system"?p:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ve=Z.useRef(null),G=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),re=Z.useRef(null),Y=Z.useRef(!1),be=Z.useCallback(de=>{I(he=>{var oe;return(oe=he.find(fe=>fe.id===de.id))!=null&&oe.delete||Dt.dismiss(de.id),he.filter(({id:fe})=>fe!==de.id)})},[]);return Z.useEffect(()=>Dt.subscribe(de=>{if(de.dismiss){I(he=>he.map(oe=>oe.id===de.id?{...oe,delete:!0}:oe));return}setTimeout(()=>{Dx.flushSync(()=>{I(he=>{let oe=he.findIndex(fe=>fe.id===de.id);return oe!==-1?[...he.slice(0,oe),{...he[oe],...de},...he.slice(oe+1)]:[de,...he]})})})}),[]),Z.useEffect(()=>{if(p!=="system"){le(p);return}if(p==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?le("dark"):le("light")),typeof window>"u")return;let de=window.matchMedia("(prefers-color-scheme: dark)");try{de.addEventListener("change",({matches:he})=>{le(he?"dark":"light")})}catch{de.addListener(({matches:oe})=>{try{le(oe?"dark":"light")}catch(fe){console.error(fe)}})}},[p]),Z.useEffect(()=>{E.length<=1&&V(!1)},[E]),Z.useEffect(()=>{let de=he=>{var oe,fe;a.every(pe=>he[pe]||he.code===pe)&&(V(!0),(oe=ve.current)==null||oe.focus()),he.code==="Escape"&&(document.activeElement===ve.current||(fe=ve.current)!=null&&fe.contains(document.activeElement))&&V(!1)};return document.addEventListener("keydown",de),()=>document.removeEventListener("keydown",de)},[a]),Z.useEffect(()=>{if(ve.current)return()=>{re.current&&(re.current.focus({preventScroll:!0}),re.current=null,Y.current=!1)}},[ve.current]),Z.createElement("section",{ref:e,"aria-label":`${T} ${G}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},q.map((de,he)=>{var oe;let[fe,pe]=de.split("-");return E.length?Z.createElement("ol",{key:de,dir:j==="auto"?au():j,tabIndex:-1,ref:ve,className:u,"data-sonner-toaster":!0,"data-theme":te,"data-y-position":fe,"data-lifted":J&&E.length>1&&!l,"data-x-position":pe,style:{"--front-toast-height":`${((oe=B[0])==null?void 0:oe.height)||0}px`,"--width":`${Jy}px`,"--gap":`${S}px`,..._,...t0(h,f)},onBlur:K=>{Y.current&&!K.currentTarget.contains(K.relatedTarget)&&(Y.current=!1,re.current&&(re.current.focus({preventScroll:!0}),re.current=null))},onFocus:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||Y.current||(Y.current=!0,re.current=K.relatedTarget)},onMouseEnter:()=>V(!0),onMouseMove:()=>V(!0),onMouseLeave:()=>{ue||V(!1)},onDragEnd:()=>V(!1),onPointerDown:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},E.filter(K=>!K.position&&he===0||K.position===de).map((K,Oe)=>{var et,Re;return Z.createElement(e0,{key:K.id,icons:N,index:Oe,toast:K,defaultRichColors:g,duration:(et=b==null?void 0:b.duration)!=null?et:y,className:b==null?void 0:b.className,descriptionClassName:b==null?void 0:b.descriptionClassName,invert:t,visibleToasts:P,closeButton:(Re=b==null?void 0:b.closeButton)!=null?Re:c,interacting:ue,position:de,style:b==null?void 0:b.style,unstyled:b==null?void 0:b.unstyled,classNames:b==null?void 0:b.classNames,cancelButtonStyle:b==null?void 0:b.cancelButtonStyle,actionButtonStyle:b==null?void 0:b.actionButtonStyle,removeToast:be,toasts:E.filter(Ie=>Ie.position==K.position),heights:B.filter(Ie=>Ie.position==K.position),setHeights:W,expandByDefault:l,gap:S,loadingIcon:k,expanded:J,pauseWhenPageIsHidden:O,swipeDirections:i.swipeDirections})})):null}))});const r0=({...i})=>{const{theme:e="system"}=Ty();return s.jsx(s0,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...i})};var[Va]=Yr("Tooltip",[$a]),mc=$a(),ym="TooltipProvider",n0=700,ou="tooltip.open",[i0,bm]=Va(ym),_m=i=>{const{__scopeTooltip:e,delayDuration:t=n0,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:l}=i,c=v.useRef(!0),u=v.useRef(!1),h=v.useRef(0);return v.useEffect(()=>{const f=h.current;return()=>window.clearTimeout(f)},[]),s.jsx(i0,{scope:e,isOpenDelayedRef:c,delayDuration:t,onOpen:v.useCallback(()=>{window.clearTimeout(h.current),c.current=!1},[]),onClose:v.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>c.current=!0,r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:v.useCallback(f=>{u.current=f},[]),disableHoverableContent:a,children:l})};_m.displayName=ym;var wm="Tooltip",[rP,Za]=Va(wm),Cl="TooltipTrigger",a0=v.forwardRef((i,e)=>{const{__scopeTooltip:t,...r}=i,a=Za(Cl,t),l=bm(Cl,t),c=mc(t),u=v.useRef(null),h=kt(e,u,a.onTriggerChange),f=v.useRef(!1),p=v.useRef(!1),g=v.useCallback(()=>f.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),s.jsx(fh,{asChild:!0,...c,children:s.jsx(Me.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:h,onPointerMove:Te(i.onPointerMove,y=>{y.pointerType!=="touch"&&!p.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),p.current=!0)}),onPointerLeave:Te(i.onPointerLeave,()=>{a.onTriggerLeave(),p.current=!1}),onPointerDown:Te(i.onPointerDown,()=>{a.open&&a.onClose(),f.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:Te(i.onFocus,()=>{f.current||a.onOpen()}),onBlur:Te(i.onBlur,a.onClose),onClick:Te(i.onClick,a.onClose)})})});a0.displayName=Cl;var o0="TooltipPortal",[nP,l0]=Va(o0,{forceMount:void 0}),Mn="TooltipContent",jm=v.forwardRef((i,e)=>{const t=l0(Mn,i.__scopeTooltip),{forceMount:r=t.forceMount,side:a="top",...l}=i,c=Za(Mn,i.__scopeTooltip);return s.jsx(nc,{present:r||c.open,children:c.disableHoverableContent?s.jsx(Nm,{side:a,...l,ref:e}):s.jsx(c0,{side:a,...l,ref:e})})}),c0=v.forwardRef((i,e)=>{const t=Za(Mn,i.__scopeTooltip),r=bm(Mn,i.__scopeTooltip),a=v.useRef(null),l=kt(e,a),[c,u]=v.useState(null),{trigger:h,onClose:f}=t,p=a.current,{onPointerInTransitChange:g}=r,y=v.useCallback(()=>{u(null),g(!1)},[g]),_=v.useCallback((P,b)=>{const j=P.currentTarget,S={x:P.clientX,y:P.clientY},k=f0(S,j.getBoundingClientRect()),N=p0(S,k),T=g0(b.getBoundingClientRect()),O=v0([...N,...T]);u(O),g(!0)},[g]);return v.useEffect(()=>()=>y(),[y]),v.useEffect(()=>{if(h&&p){const P=j=>_(j,p),b=j=>_(j,h);return h.addEventListener("pointerleave",P),p.addEventListener("pointerleave",b),()=>{h.removeEventListener("pointerleave",P),p.removeEventListener("pointerleave",b)}}},[h,p,_,y]),v.useEffect(()=>{if(c){const P=b=>{const j=b.target,S={x:b.clientX,y:b.clientY},k=(h==null?void 0:h.contains(j))||(p==null?void 0:p.contains(j)),N=!x0(S,c);k?y():N&&(y(),f())};return document.addEventListener("pointermove",P),()=>document.removeEventListener("pointermove",P)}},[h,p,c,f,y]),s.jsx(Nm,{...i,ref:l})}),[d0,u0]=Va(wm,{isInside:!1}),h0=wx("TooltipContent"),Nm=v.forwardRef((i,e)=>{const{__scopeTooltip:t,children:r,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:c,...u}=i,h=Za(Mn,t),f=mc(t),{onClose:p}=h;return v.useEffect(()=>(document.addEventListener(ou,p),()=>document.removeEventListener(ou,p)),[p]),v.useEffect(()=>{if(h.trigger){const g=y=>{const _=y.target;_!=null&&_.contains(h.trigger)&&p()};return window.addEventListener("scroll",g,{capture:!0}),()=>window.removeEventListener("scroll",g,{capture:!0})}},[h.trigger,p]),s.jsx(hh,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:g=>g.preventDefault(),onDismiss:p,children:s.jsxs(mh,{"data-state":h.stateAttribute,...f,...u,ref:e,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(h0,{children:r}),s.jsx(d0,{scope:t,isInside:!0,children:s.jsx(Xx,{id:h.contentId,role:"tooltip",children:a||r})})]})})});jm.displayName=Mn;var Sm="TooltipArrow",m0=v.forwardRef((i,e)=>{const{__scopeTooltip:t,...r}=i,a=mc(t);return u0(Sm,t).isInside?null:s.jsx(ph,{...a,...r,ref:e})});m0.displayName=Sm;function f0(i,e){const t=Math.abs(e.top-i.y),r=Math.abs(e.bottom-i.y),a=Math.abs(e.right-i.x),l=Math.abs(e.left-i.x);switch(Math.min(t,r,a,l)){case l:return"left";case a:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function p0(i,e,t=5){const r=[];switch(e){case"top":r.push({x:i.x-t,y:i.y+t},{x:i.x+t,y:i.y+t});break;case"bottom":r.push({x:i.x-t,y:i.y-t},{x:i.x+t,y:i.y-t});break;case"left":r.push({x:i.x+t,y:i.y-t},{x:i.x+t,y:i.y+t});break;case"right":r.push({x:i.x-t,y:i.y-t},{x:i.x-t,y:i.y+t});break}return r}function g0(i){const{top:e,right:t,bottom:r,left:a}=i;return[{x:a,y:e},{x:t,y:e},{x:t,y:r},{x:a,y:r}]}function x0(i,e){const{x:t,y:r}=i;let a=!1;for(let l=0,c=e.length-1;l<e.length;c=l++){const u=e[l],h=e[c],f=u.x,p=u.y,g=h.x,y=h.y;p>r!=y>r&&t<(g-f)*(r-p)/(y-p)+f&&(a=!a)}return a}function v0(i){const e=i.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),y0(e)}function y0(i){if(i.length<=1)return i.slice();const e=[];for(let r=0;r<i.length;r++){const a=i[r];for(;e.length>=2;){const l=e[e.length-1],c=e[e.length-2];if((l.x-c.x)*(a.y-c.y)>=(l.y-c.y)*(a.x-c.x))e.pop();else break}e.push(a)}e.pop();const t=[];for(let r=i.length-1;r>=0;r--){const a=i[r];for(;t.length>=2;){const l=t[t.length-1],c=t[t.length-2];if((l.x-c.x)*(a.y-c.y)>=(l.y-c.y)*(a.x-c.x))t.pop();else break}t.push(a)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var b0=_m,Pm=jm;const _0=b0,w0=v.forwardRef(({className:i,sideOffset:e=4,...t},r)=>s.jsx(Pm,{ref:r,sideOffset:e,className:se("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i),...t}));w0.displayName=Pm.displayName;var Ga=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(i){return this.listeners.add(i),this.onSubscribe(),()=>{this.listeners.delete(i),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},j0={setTimeout:(i,e)=>setTimeout(i,e),clearTimeout:i=>clearTimeout(i),setInterval:(i,e)=>setInterval(i,e),clearInterval:i=>clearInterval(i)},lr,rc,th,N0=(th=class{constructor(){Ee(this,lr,j0);Ee(this,rc,!1)}setTimeoutProvider(i){ge(this,lr,i)}setTimeout(i,e){return R(this,lr).setTimeout(i,e)}clearTimeout(i){R(this,lr).clearTimeout(i)}setInterval(i,e){return R(this,lr).setInterval(i,e)}clearInterval(i){R(this,lr).clearInterval(i)}},lr=new WeakMap,rc=new WeakMap,th),Tl=new N0;function S0(i){setTimeout(i,0)}var Ja=typeof window>"u"||"Deno"in globalThis;function os(){}function P0(i,e){return typeof i=="function"?i(e):i}function k0(i){return typeof i=="number"&&i>=0&&i!==1/0}function C0(i,e){return Math.max(i+(e||0)-Date.now(),0)}function Ol(i,e){return typeof i=="function"?i(e):i}function T0(i,e){return typeof i=="function"?i(e):i}function lu(i,e){const{type:t="all",exact:r,fetchStatus:a,predicate:l,queryKey:c,stale:u}=i;if(c){if(r){if(e.queryHash!==fc(c,e.options))return!1}else if(!Ni(e.queryKey,c))return!1}if(t!=="all"){const h=e.isActive();if(t==="active"&&!h||t==="inactive"&&h)return!1}return!(typeof u=="boolean"&&e.isStale()!==u||a&&a!==e.state.fetchStatus||l&&!l(e))}function cu(i,e){const{exact:t,status:r,predicate:a,mutationKey:l}=i;if(l){if(!e.options.mutationKey)return!1;if(t){if(ji(e.options.mutationKey)!==ji(l))return!1}else if(!Ni(e.options.mutationKey,l))return!1}return!(r&&e.state.status!==r||a&&!a(e))}function fc(i,e){return((e==null?void 0:e.queryKeyHashFn)||ji)(i)}function ji(i){return JSON.stringify(i,(e,t)=>Il(t)?Object.keys(t).sort().reduce((r,a)=>(r[a]=t[a],r),{}):t)}function Ni(i,e){return i===e?!0:typeof i!=typeof e?!1:i&&e&&typeof i=="object"&&typeof e=="object"?Object.keys(e).every(t=>Ni(i[t],e[t])):!1}var O0=Object.prototype.hasOwnProperty;function km(i,e){if(i===e)return i;const t=du(i)&&du(e);if(!t&&!(Il(i)&&Il(e)))return e;const a=(t?i:Object.keys(i)).length,l=t?e:Object.keys(e),c=l.length,u=t?new Array(c):{};let h=0;for(let f=0;f<c;f++){const p=t?f:l[f],g=i[p],y=e[p];if(g===y){u[p]=g,(t?f<a:O0.call(i,p))&&h++;continue}if(g===null||y===null||typeof g!="object"||typeof y!="object"){u[p]=y;continue}const _=km(g,y);u[p]=_,_===g&&h++}return a===c&&h===a?i:u}function du(i){return Array.isArray(i)&&i.length===Object.keys(i).length}function Il(i){if(!uu(i))return!1;const e=i.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!uu(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(i)!==Object.prototype)}function uu(i){return Object.prototype.toString.call(i)==="[object Object]"}function I0(i){return new Promise(e=>{Tl.setTimeout(e,i)})}function A0(i,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(i,e):t.structuralSharing!==!1?km(i,e):e}function E0(i,e,t=0){const r=[...i,e];return t&&r.length>t?r.slice(1):r}function L0(i,e,t=0){const r=[e,...i];return t&&r.length>t?r.slice(0,-1):r}var pc=Symbol();function Cm(i,e){return!i.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!i.queryFn||i.queryFn===pc?()=>Promise.reject(new Error(`Missing queryFn: '${i.queryHash}'`)):i.queryFn}var Dr,cr,Sn,sh,M0=(sh=class extends Ga{constructor(){super();Ee(this,Dr);Ee(this,cr);Ee(this,Sn);ge(this,Sn,e=>{if(!Ja&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){R(this,cr)||this.setEventListener(R(this,Sn))}onUnsubscribe(){var e;this.hasListeners()||((e=R(this,cr))==null||e.call(this),ge(this,cr,void 0))}setEventListener(e){var t;ge(this,Sn,e),(t=R(this,cr))==null||t.call(this),ge(this,cr,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){R(this,Dr)!==e&&(ge(this,Dr,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof R(this,Dr)=="boolean"?R(this,Dr):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Dr=new WeakMap,cr=new WeakMap,Sn=new WeakMap,sh),Tm=new M0;function D0(){let i,e;const t=new Promise((a,l)=>{i=a,e=l});t.status="pending",t.catch(()=>{});function r(a){Object.assign(t,a),delete t.resolve,delete t.reject}return t.resolve=a=>{r({status:"fulfilled",value:a}),i(a)},t.reject=a=>{r({status:"rejected",reason:a}),e(a)},t}var R0=S0;function $0(){let i=[],e=0,t=u=>{u()},r=u=>{u()},a=R0;const l=u=>{e?i.push(u):a(()=>{t(u)})},c=()=>{const u=i;i=[],u.length&&a(()=>{r(()=>{u.forEach(h=>{t(h)})})})};return{batch:u=>{let h;e++;try{h=u()}finally{e--,e||c()}return h},batchCalls:u=>(...h)=>{l(()=>{u(...h)})},schedule:l,setNotifyFunction:u=>{t=u},setBatchNotifyFunction:u=>{r=u},setScheduler:u=>{a=u}}}var At=$0(),Pn,dr,kn,rh,U0=(rh=class extends Ga{constructor(){super();Ee(this,Pn,!0);Ee(this,dr);Ee(this,kn);ge(this,kn,e=>{if(!Ja&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}})}onSubscribe(){R(this,dr)||this.setEventListener(R(this,kn))}onUnsubscribe(){var e;this.hasListeners()||((e=R(this,dr))==null||e.call(this),ge(this,dr,void 0))}setEventListener(e){var t;ge(this,kn,e),(t=R(this,dr))==null||t.call(this),ge(this,dr,e(this.setOnline.bind(this)))}setOnline(e){R(this,Pn)!==e&&(ge(this,Pn,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return R(this,Pn)}},Pn=new WeakMap,dr=new WeakMap,kn=new WeakMap,rh),Ca=new U0;function F0(i){return Math.min(1e3*2**i,3e4)}function Om(i){return(i??"online")==="online"?Ca.isOnline():!0}var Al=class extends Error{constructor(i){super("CancelledError"),this.revert=i==null?void 0:i.revert,this.silent=i==null?void 0:i.silent}};function Im(i){let e=!1,t=0,r;const a=D0(),l=()=>a.status!=="pending",c=b=>{var j;if(!l()){const S=new Al(b);y(S),(j=i.onCancel)==null||j.call(i,S)}},u=()=>{e=!0},h=()=>{e=!1},f=()=>Tm.isFocused()&&(i.networkMode==="always"||Ca.isOnline())&&i.canRun(),p=()=>Om(i.networkMode)&&i.canRun(),g=b=>{l()||(r==null||r(),a.resolve(b))},y=b=>{l()||(r==null||r(),a.reject(b))},_=()=>new Promise(b=>{var j;r=S=>{(l()||f())&&b(S)},(j=i.onPause)==null||j.call(i)}).then(()=>{var b;r=void 0,l()||(b=i.onContinue)==null||b.call(i)}),P=()=>{if(l())return;let b;const j=t===0?i.initialPromise:void 0;try{b=j??i.fn()}catch(S){b=Promise.reject(S)}Promise.resolve(b).then(g).catch(S=>{var E;if(l())return;const k=i.retry??(Ja?0:3),N=i.retryDelay??F0,T=typeof N=="function"?N(t,S):N,O=k===!0||typeof k=="number"&&t<k||typeof k=="function"&&k(t,S);if(e||!O){y(S);return}t++,(E=i.onFail)==null||E.call(i,t,S),I0(T).then(()=>f()?void 0:_()).then(()=>{e?y(S):P()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(r==null||r(),a),cancelRetry:u,continueRetry:h,canStart:p,start:()=>(p()?P():_().then(P),a)}}var Rr,nh,Am=(nh=class{constructor(){Ee(this,Rr)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),k0(this.gcTime)&&ge(this,Rr,Tl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(i){this.gcTime=Math.max(this.gcTime||0,i??(Ja?1/0:5*60*1e3))}clearGcTimeout(){R(this,Rr)&&(Tl.clearTimeout(R(this,Rr)),ge(this,Rr,void 0))}},Rr=new WeakMap,nh),$r,Cn,Jt,Ur,xt,Oi,Fr,ls,qs,ih,z0=(ih=class extends Am{constructor(e){super();Ee(this,ls);Ee(this,$r);Ee(this,Cn);Ee(this,Jt);Ee(this,Ur);Ee(this,xt);Ee(this,Oi);Ee(this,Fr);ge(this,Fr,!1),ge(this,Oi,e.defaultOptions),this.setOptions(e.options),this.observers=[],ge(this,Ur,e.client),ge(this,Jt,R(this,Ur).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ge(this,$r,hu(this.options)),this.state=e.state??R(this,$r),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=R(this,xt))==null?void 0:e.promise}setOptions(e){if(this.options={...R(this,Oi),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=hu(this.options);t.data!==void 0&&(this.setData(t.data,{updatedAt:t.dataUpdatedAt,manual:!0}),ge(this,$r,t))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&R(this,Jt).remove(this)}setData(e,t){const r=A0(this.state.data,e,this.options);return Nt(this,ls,qs).call(this,{data:r,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),r}setState(e,t){Nt(this,ls,qs).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var r,a;const t=(r=R(this,xt))==null?void 0:r.promise;return(a=R(this,xt))==null||a.cancel(e),t?t.then(os).catch(os):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(R(this,$r))}isActive(){return this.observers.some(e=>T0(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===pc||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Ol(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!C0(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=R(this,xt))==null||t.continue()}onOnline(){var t;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=R(this,xt))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),R(this,Jt).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(R(this,xt)&&(R(this,Fr)?R(this,xt).cancel({revert:!0}):R(this,xt).cancelRetry()),this.scheduleGc()),R(this,Jt).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nt(this,ls,qs).call(this,{type:"invalidate"})}async fetch(e,t){var h,f,p,g,y,_,P,b,j,S,k,N;if(this.state.fetchStatus!=="idle"&&((h=R(this,xt))==null?void 0:h.status())!=="rejected"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(R(this,xt))return R(this,xt).continueRetry(),R(this,xt).promise}if(e&&this.setOptions(e),!this.options.queryFn){const T=this.observers.find(O=>O.options.queryFn);T&&this.setOptions(T.options)}const r=new AbortController,a=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(ge(this,Fr,!0),r.signal)})},l=()=>{const T=Cm(this.options,t),E=(()=>{const I={client:R(this,Ur),queryKey:this.queryKey,meta:this.meta};return a(I),I})();return ge(this,Fr,!1),this.options.persister?this.options.persister(T,E,this):T(E)},u=(()=>{const T={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:R(this,Ur),state:this.state,fetchFn:l};return a(T),T})();(f=this.options.behavior)==null||f.onFetch(u,this),ge(this,Cn,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=u.fetchOptions)==null?void 0:p.meta))&&Nt(this,ls,qs).call(this,{type:"fetch",meta:(g=u.fetchOptions)==null?void 0:g.meta}),ge(this,xt,Im({initialPromise:t==null?void 0:t.initialPromise,fn:u.fetchFn,onCancel:T=>{T instanceof Al&&T.revert&&this.setState({...R(this,Cn),fetchStatus:"idle"}),r.abort()},onFail:(T,O)=>{Nt(this,ls,qs).call(this,{type:"failed",failureCount:T,error:O})},onPause:()=>{Nt(this,ls,qs).call(this,{type:"pause"})},onContinue:()=>{Nt(this,ls,qs).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const T=await R(this,xt).start();if(T===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(T),(_=(y=R(this,Jt).config).onSuccess)==null||_.call(y,T,this),(b=(P=R(this,Jt).config).onSettled)==null||b.call(P,T,this.state.error,this),T}catch(T){if(T instanceof Al){if(T.silent)return R(this,xt).promise;if(T.revert){if(this.state.data===void 0)throw T;return this.state.data}}throw Nt(this,ls,qs).call(this,{type:"error",error:T}),(S=(j=R(this,Jt).config).onError)==null||S.call(j,T,this),(N=(k=R(this,Jt).config).onSettled)==null||N.call(k,this.state.data,T,this),T}finally{this.scheduleGc()}}},$r=new WeakMap,Cn=new WeakMap,Jt=new WeakMap,Ur=new WeakMap,xt=new WeakMap,Oi=new WeakMap,Fr=new WeakMap,ls=new WeakSet,qs=function(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...B0(r.data,this.options),fetchMeta:e.meta??null};case"success":const a={...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ge(this,Cn,e.manual?a:void 0),a;case"error":const l=e.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),At.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),R(this,Jt).notify({query:this,type:"updated",action:e})})},ih);function B0(i,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Om(e.networkMode)?"fetching":"paused",...i===void 0&&{error:null,status:"pending"}}}function hu(i){const e=typeof i.initialData=="function"?i.initialData():i.initialData,t=e!==void 0,r=t?typeof i.initialDataUpdatedAt=="function"?i.initialDataUpdatedAt():i.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}function mu(i){return{onFetch:(e,t)=>{var p,g,y,_,P;const r=e.options,a=(y=(g=(p=e.fetchOptions)==null?void 0:p.meta)==null?void 0:g.fetchMore)==null?void 0:y.direction,l=((_=e.state.data)==null?void 0:_.pages)||[],c=((P=e.state.data)==null?void 0:P.pageParams)||[];let u={pages:[],pageParams:[]},h=0;const f=async()=>{let b=!1;const j=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(e.signal.aborted?b=!0:e.signal.addEventListener("abort",()=>{b=!0}),e.signal)})},S=Cm(e.options,e.fetchOptions),k=async(N,T,O)=>{if(b)return Promise.reject();if(T==null&&N.pages.length)return Promise.resolve(N);const I=(()=>{const J={client:e.client,queryKey:e.queryKey,pageParam:T,direction:O?"backward":"forward",meta:e.options.meta};return j(J),J})(),q=await S(I),{maxPages:B}=e.options,W=O?L0:E0;return{pages:W(N.pages,q,B),pageParams:W(N.pageParams,T,B)}};if(a&&l.length){const N=a==="backward",T=N?q0:fu,O={pages:l,pageParams:c},E=T(r,O);u=await k(O,E,N)}else{const N=i??l.length;do{const T=h===0?c[0]??r.initialPageParam:fu(r,u);if(h>0&&T==null)break;u=await k(u,T),h++}while(h<N)}return u};e.options.persister?e.fetchFn=()=>{var b,j;return(j=(b=e.options).persister)==null?void 0:j.call(b,f,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=f}}}function fu(i,{pages:e,pageParams:t}){const r=e.length-1;return e.length>0?i.getNextPageParam(e[r],e,t[r],t):void 0}function q0(i,{pages:e,pageParams:t}){var r;return e.length>0?(r=i.getPreviousPageParam)==null?void 0:r.call(i,e[0],e,t[0],t):void 0}var Ii,ks,It,zr,Cs,ir,ah,H0=(ah=class extends Am{constructor(e){super();Ee(this,Cs);Ee(this,Ii);Ee(this,ks);Ee(this,It);Ee(this,zr);ge(this,Ii,e.client),this.mutationId=e.mutationId,ge(this,It,e.mutationCache),ge(this,ks,[]),this.state=e.state||W0(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){R(this,ks).includes(e)||(R(this,ks).push(e),this.clearGcTimeout(),R(this,It).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ge(this,ks,R(this,ks).filter(t=>t!==e)),this.scheduleGc(),R(this,It).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){R(this,ks).length||(this.state.status==="pending"?this.scheduleGc():R(this,It).remove(this))}continue(){var e;return((e=R(this,zr))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var c,u,h,f,p,g,y,_,P,b,j,S,k,N,T,O,E,I,q,B;const t=()=>{Nt(this,Cs,ir).call(this,{type:"continue"})},r={client:R(this,Ii),meta:this.options.meta,mutationKey:this.options.mutationKey};ge(this,zr,Im({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(W,J)=>{Nt(this,Cs,ir).call(this,{type:"failed",failureCount:W,error:J})},onPause:()=>{Nt(this,Cs,ir).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>R(this,It).canRun(this)}));const a=this.state.status==="pending",l=!R(this,zr).canStart();try{if(a)t();else{Nt(this,Cs,ir).call(this,{type:"pending",variables:e,isPaused:l}),await((u=(c=R(this,It).config).onMutate)==null?void 0:u.call(c,e,this,r));const J=await((f=(h=this.options).onMutate)==null?void 0:f.call(h,e,r));J!==this.state.context&&Nt(this,Cs,ir).call(this,{type:"pending",context:J,variables:e,isPaused:l})}const W=await R(this,zr).start();return await((g=(p=R(this,It).config).onSuccess)==null?void 0:g.call(p,W,e,this.state.context,this,r)),await((_=(y=this.options).onSuccess)==null?void 0:_.call(y,W,e,this.state.context,r)),await((b=(P=R(this,It).config).onSettled)==null?void 0:b.call(P,W,null,this.state.variables,this.state.context,this,r)),await((S=(j=this.options).onSettled)==null?void 0:S.call(j,W,null,e,this.state.context,r)),Nt(this,Cs,ir).call(this,{type:"success",data:W}),W}catch(W){try{throw await((N=(k=R(this,It).config).onError)==null?void 0:N.call(k,W,e,this.state.context,this,r)),await((O=(T=this.options).onError)==null?void 0:O.call(T,W,e,this.state.context,r)),await((I=(E=R(this,It).config).onSettled)==null?void 0:I.call(E,void 0,W,this.state.variables,this.state.context,this,r)),await((B=(q=this.options).onSettled)==null?void 0:B.call(q,void 0,W,e,this.state.context,r)),W}finally{Nt(this,Cs,ir).call(this,{type:"error",error:W})}}finally{R(this,It).runNext(this)}}},Ii=new WeakMap,ks=new WeakMap,It=new WeakMap,zr=new WeakMap,Cs=new WeakSet,ir=function(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),At.batch(()=>{R(this,ks).forEach(r=>{r.onMutationUpdate(e)}),R(this,It).notify({mutation:this,type:"updated",action:e})})},ah);function W0(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Vs,cs,Ai,oh,V0=(oh=class extends Ga{constructor(e={}){super();Ee(this,Vs);Ee(this,cs);Ee(this,Ai);this.config=e,ge(this,Vs,new Set),ge(this,cs,new Map),ge(this,Ai,0)}build(e,t,r){const a=new H0({client:e,mutationCache:this,mutationId:++ua(this,Ai)._,options:e.defaultMutationOptions(t),state:r});return this.add(a),a}add(e){R(this,Vs).add(e);const t=fa(e);if(typeof t=="string"){const r=R(this,cs).get(t);r?r.push(e):R(this,cs).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(R(this,Vs).delete(e)){const t=fa(e);if(typeof t=="string"){const r=R(this,cs).get(t);if(r)if(r.length>1){const a=r.indexOf(e);a!==-1&&r.splice(a,1)}else r[0]===e&&R(this,cs).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=fa(e);if(typeof t=="string"){const r=R(this,cs).get(t),a=r==null?void 0:r.find(l=>l.state.status==="pending");return!a||a===e}else return!0}runNext(e){var r;const t=fa(e);if(typeof t=="string"){const a=(r=R(this,cs).get(t))==null?void 0:r.find(l=>l!==e&&l.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){At.batch(()=>{R(this,Vs).forEach(e=>{this.notify({type:"removed",mutation:e})}),R(this,Vs).clear(),R(this,cs).clear()})}getAll(){return Array.from(R(this,Vs))}find(e){const t={exact:!0,...e};return this.getAll().find(r=>cu(t,r))}findAll(e={}){return this.getAll().filter(t=>cu(e,t))}notify(e){At.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return At.batch(()=>Promise.all(e.map(t=>t.continue().catch(os))))}},Vs=new WeakMap,cs=new WeakMap,Ai=new WeakMap,oh);function fa(i){var e;return(e=i.options.scope)==null?void 0:e.id}var Ts,lh,Z0=(lh=class extends Ga{constructor(e={}){super();Ee(this,Ts);this.config=e,ge(this,Ts,new Map)}build(e,t,r){const a=t.queryKey,l=t.queryHash??fc(a,t);let c=this.get(l);return c||(c=new z0({client:e,queryKey:a,queryHash:l,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(a)}),this.add(c)),c}add(e){R(this,Ts).has(e.queryHash)||(R(this,Ts).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=R(this,Ts).get(e.queryHash);t&&(e.destroy(),t===e&&R(this,Ts).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){At.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return R(this,Ts).get(e)}getAll(){return[...R(this,Ts).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>lu(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>lu(e,r)):t}notify(e){At.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){At.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){At.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ts=new WeakMap,lh),tt,ur,hr,Tn,On,mr,In,An,ch,G0=(ch=class{constructor(i={}){Ee(this,tt);Ee(this,ur);Ee(this,hr);Ee(this,Tn);Ee(this,On);Ee(this,mr);Ee(this,In);Ee(this,An);ge(this,tt,i.queryCache||new Z0),ge(this,ur,i.mutationCache||new V0),ge(this,hr,i.defaultOptions||{}),ge(this,Tn,new Map),ge(this,On,new Map),ge(this,mr,0)}mount(){ua(this,mr)._++,R(this,mr)===1&&(ge(this,In,Tm.subscribe(async i=>{i&&(await this.resumePausedMutations(),R(this,tt).onFocus())})),ge(this,An,Ca.subscribe(async i=>{i&&(await this.resumePausedMutations(),R(this,tt).onOnline())})))}unmount(){var i,e;ua(this,mr)._--,R(this,mr)===0&&((i=R(this,In))==null||i.call(this),ge(this,In,void 0),(e=R(this,An))==null||e.call(this),ge(this,An,void 0))}isFetching(i){return R(this,tt).findAll({...i,fetchStatus:"fetching"}).length}isMutating(i){return R(this,ur).findAll({...i,status:"pending"}).length}getQueryData(i){var t;const e=this.defaultQueryOptions({queryKey:i});return(t=R(this,tt).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(i){const e=this.defaultQueryOptions(i),t=R(this,tt).build(this,e),r=t.state.data;return r===void 0?this.fetchQuery(i):(i.revalidateIfStale&&t.isStaleByTime(Ol(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(i){return R(this,tt).findAll(i).map(({queryKey:e,state:t})=>{const r=t.data;return[e,r]})}setQueryData(i,e,t){const r=this.defaultQueryOptions({queryKey:i}),a=R(this,tt).get(r.queryHash),l=a==null?void 0:a.state.data,c=P0(e,l);if(c!==void 0)return R(this,tt).build(this,r).setData(c,{...t,manual:!0})}setQueriesData(i,e,t){return At.batch(()=>R(this,tt).findAll(i).map(({queryKey:r})=>[r,this.setQueryData(r,e,t)]))}getQueryState(i){var t;const e=this.defaultQueryOptions({queryKey:i});return(t=R(this,tt).get(e.queryHash))==null?void 0:t.state}removeQueries(i){const e=R(this,tt);At.batch(()=>{e.findAll(i).forEach(t=>{e.remove(t)})})}resetQueries(i,e){const t=R(this,tt);return At.batch(()=>(t.findAll(i).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...i},e)))}cancelQueries(i,e={}){const t={revert:!0,...e},r=At.batch(()=>R(this,tt).findAll(i).map(a=>a.cancel(t)));return Promise.all(r).then(os).catch(os)}invalidateQueries(i,e={}){return At.batch(()=>(R(this,tt).findAll(i).forEach(t=>{t.invalidate()}),(i==null?void 0:i.refetchType)==="none"?Promise.resolve():this.refetchQueries({...i,type:(i==null?void 0:i.refetchType)??(i==null?void 0:i.type)??"active"},e)))}refetchQueries(i,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},r=At.batch(()=>R(this,tt).findAll(i).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,t);return t.throwOnError||(l=l.catch(os)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(os)}fetchQuery(i){const e=this.defaultQueryOptions(i);e.retry===void 0&&(e.retry=!1);const t=R(this,tt).build(this,e);return t.isStaleByTime(Ol(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(i){return this.fetchQuery(i).then(os).catch(os)}fetchInfiniteQuery(i){return i.behavior=mu(i.pages),this.fetchQuery(i)}prefetchInfiniteQuery(i){return this.fetchInfiniteQuery(i).then(os).catch(os)}ensureInfiniteQueryData(i){return i.behavior=mu(i.pages),this.ensureQueryData(i)}resumePausedMutations(){return Ca.isOnline()?R(this,ur).resumePausedMutations():Promise.resolve()}getQueryCache(){return R(this,tt)}getMutationCache(){return R(this,ur)}getDefaultOptions(){return R(this,hr)}setDefaultOptions(i){ge(this,hr,i)}setQueryDefaults(i,e){R(this,Tn).set(ji(i),{queryKey:i,defaultOptions:e})}getQueryDefaults(i){const e=[...R(this,Tn).values()],t={};return e.forEach(r=>{Ni(i,r.queryKey)&&Object.assign(t,r.defaultOptions)}),t}setMutationDefaults(i,e){R(this,On).set(ji(i),{mutationKey:i,defaultOptions:e})}getMutationDefaults(i){const e=[...R(this,On).values()],t={};return e.forEach(r=>{Ni(i,r.mutationKey)&&Object.assign(t,r.defaultOptions)}),t}defaultQueryOptions(i){if(i._defaulted)return i;const e={...R(this,hr).queries,...this.getQueryDefaults(i.queryKey),...i,_defaulted:!0};return e.queryHash||(e.queryHash=fc(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===pc&&(e.enabled=!1),e}defaultMutationOptions(i){return i!=null&&i._defaulted?i:{...R(this,hr).mutations,...(i==null?void 0:i.mutationKey)&&this.getMutationDefaults(i.mutationKey),...i,_defaulted:!0}}clear(){R(this,tt).clear(),R(this,ur).clear()}},tt=new WeakMap,ur=new WeakMap,hr=new WeakMap,Tn=new WeakMap,On=new WeakMap,mr=new WeakMap,In=new WeakMap,An=new WeakMap,ch),J0=v.createContext(void 0),K0=({client:i,children:e})=>(v.useEffect(()=>(i.mount(),()=>{i.unmount()}),[i]),s.jsx(J0.Provider,{value:i,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Si(){return Si=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Si.apply(this,arguments)}var fr;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(fr||(fr={}));const pu="popstate";function Y0(i){i===void 0&&(i={});function e(r,a){let{pathname:l,search:c,hash:u}=r.location;return El("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Ta(a)}return X0(e,t,null,i)}function ct(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Em(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Q0(){return Math.random().toString(36).substr(2,8)}function gu(i,e){return{usr:i.state,key:i.key,idx:e}}function El(i,e,t,r){return t===void 0&&(t=null),Si({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?zn(e):e,{state:t,key:e&&e.key||r||Q0()})}function Ta(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function zn(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function X0(i,e,t,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:l=!1}=r,c=a.history,u=fr.Pop,h=null,f=p();f==null&&(f=0,c.replaceState(Si({},c.state,{idx:f}),""));function p(){return(c.state||{idx:null}).idx}function g(){u=fr.Pop;let j=p(),S=j==null?null:j-f;f=j,h&&h({action:u,location:b.location,delta:S})}function y(j,S){u=fr.Push;let k=El(b.location,j,S);f=p()+1;let N=gu(k,f),T=b.createHref(k);try{c.pushState(N,"",T)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;a.location.assign(T)}l&&h&&h({action:u,location:b.location,delta:1})}function _(j,S){u=fr.Replace;let k=El(b.location,j,S);f=p();let N=gu(k,f),T=b.createHref(k);c.replaceState(N,"",T),l&&h&&h({action:u,location:b.location,delta:0})}function P(j){let S=a.location.origin!=="null"?a.location.origin:a.location.href,k=typeof j=="string"?j:Ta(j);return k=k.replace(/ $/,"%20"),ct(S,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,S)}let b={get action(){return u},get location(){return i(a,c)},listen(j){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(pu,g),h=j,()=>{a.removeEventListener(pu,g),h=null}},createHref(j){return e(a,j)},createURL:P,encodeLocation(j){let S=P(j);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:_,go(j){return c.go(j)}};return b}var xu;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(xu||(xu={}));function eb(i,e,t){return t===void 0&&(t="/"),tb(i,e,t)}function tb(i,e,t,r){let a=typeof e=="string"?zn(e):e,l=gc(a.pathname||"/",t);if(l==null)return null;let c=Lm(i);sb(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let f=fb(l);u=ub(c[h],f)}return u}function Lm(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let a=(l,c,u)=>{let h={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};h.relativePath.startsWith("/")&&(ct(h.relativePath.startsWith(r),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(r.length));let f=gr([r,h.relativePath]),p=t.concat(h);l.children&&l.children.length>0&&(ct(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),Lm(l.children,e,p,f)),!(l.path==null&&!l.index)&&e.push({path:f,score:cb(f,l.index),routesMeta:p})};return i.forEach((l,c)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))a(l,c);else for(let h of Mm(l.path))a(l,c,h)}),e}function Mm(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let c=Mm(r.join("/")),u=[];return u.push(...c.map(h=>h===""?l:[l,h].join("/"))),a&&u.push(...c),u.map(h=>i.startsWith("/")&&h===""?"/":h)}function sb(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:db(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const rb=/^:[\w-]+$/,nb=3,ib=2,ab=1,ob=10,lb=-2,vu=i=>i==="*";function cb(i,e){let t=i.split("/"),r=t.length;return t.some(vu)&&(r+=lb),e&&(r+=ib),t.filter(a=>!vu(a)).reduce((a,l)=>a+(rb.test(l)?nb:l===""?ab:ob),r)}function db(i,e){return i.length===e.length&&i.slice(0,-1).every((r,a)=>r===e[a])?i[i.length-1]-e[e.length-1]:0}function ub(i,e,t){let{routesMeta:r}=i,a={},l="/",c=[];for(let u=0;u<r.length;++u){let h=r[u],f=u===r.length-1,p=l==="/"?e:e.slice(l.length)||"/",g=hb({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),y=h.route;if(!g)return null;Object.assign(a,g.params),c.push({params:a,pathname:gr([l,g.pathname]),pathnameBase:vb(gr([l,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(l=gr([l,g.pathnameBase]))}return c}function hb(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=mb(i.path,i.caseSensitive,i.end),a=e.match(t);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:r.reduce((f,p,g)=>{let{paramName:y,isOptional:_}=p;if(y==="*"){let b=u[g]||"";c=l.slice(0,l.length-b.length).replace(/(.)\/+$/,"$1")}const P=u[g];return _&&!P?f[y]=void 0:f[y]=(P||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:i}}function mb(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Em(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],a="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(r.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),a+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":i!==""&&i!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function fb(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Em(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function gc(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function pb(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:a=""}=typeof i=="string"?zn(i):i;return{pathname:t?t.startsWith("/")?t:gb(t,e):e,search:yb(r),hash:bb(a)}}function gb(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function nl(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xb(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Dm(i,e){let t=xb(i);return e?t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function Rm(i,e,t,r){r===void 0&&(r=!1);let a;typeof i=="string"?a=zn(i):(a=Si({},i),ct(!a.pathname||!a.pathname.includes("?"),nl("?","pathname","search",a)),ct(!a.pathname||!a.pathname.includes("#"),nl("#","pathname","hash",a)),ct(!a.search||!a.search.includes("#"),nl("#","search","hash",a)));let l=i===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=t;else{let g=e.length-1;if(!r&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),g-=1;a.pathname=y.join("/")}u=g>=0?e[g]:"/"}let h=pb(a,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}const gr=i=>i.join("/").replace(/\/\/+/g,"/"),vb=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),yb=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,bb=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function _b(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const $m=["post","put","patch","delete"];new Set($m);const wb=["get",...$m];new Set(wb);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pi(){return Pi=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Pi.apply(this,arguments)}const xc=v.createContext(null),jb=v.createContext(null),Qr=v.createContext(null),Ka=v.createContext(null),Js=v.createContext({outlet:null,matches:[],isDataRoute:!1}),Um=v.createContext(null);function Nb(i,e){let{relative:t}=e===void 0?{}:e;Ri()||ct(!1);let{basename:r,navigator:a}=v.useContext(Qr),{hash:l,pathname:c,search:u}=Bm(i,{relative:t}),h=c;return r!=="/"&&(h=c==="/"?r:gr([r,c])),a.createHref({pathname:h,search:u,hash:l})}function Ri(){return v.useContext(Ka)!=null}function Ks(){return Ri()||ct(!1),v.useContext(Ka).location}function Fm(i){v.useContext(Qr).static||v.useLayoutEffect(i)}function Is(){let{isDataRoute:i}=v.useContext(Js);return i?Ub():Sb()}function Sb(){Ri()||ct(!1);let i=v.useContext(xc),{basename:e,future:t,navigator:r}=v.useContext(Qr),{matches:a}=v.useContext(Js),{pathname:l}=Ks(),c=JSON.stringify(Dm(a,t.v7_relativeSplatPath)),u=v.useRef(!1);return Fm(()=>{u.current=!0}),v.useCallback(function(f,p){if(p===void 0&&(p={}),!u.current)return;if(typeof f=="number"){r.go(f);return}let g=Rm(f,JSON.parse(c),l,p.relative==="path");i==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:gr([e,g.pathname])),(p.replace?r.replace:r.push)(g,p.state,p)},[e,r,c,l,i])}const Pb=v.createContext(null);function kb(i){let e=v.useContext(Js).outlet;return e&&v.createElement(Pb.Provider,{value:i},e)}function zm(){let{matches:i}=v.useContext(Js),e=i[i.length-1];return e?e.params:{}}function Bm(i,e){let{relative:t}=e===void 0?{}:e,{future:r}=v.useContext(Qr),{matches:a}=v.useContext(Js),{pathname:l}=Ks(),c=JSON.stringify(Dm(a,r.v7_relativeSplatPath));return v.useMemo(()=>Rm(i,JSON.parse(c),l,t==="path"),[i,c,l,t])}function Cb(i,e){return Tb(i,e)}function Tb(i,e,t,r){Ri()||ct(!1);let{navigator:a}=v.useContext(Qr),{matches:l}=v.useContext(Js),c=l[l.length-1],u=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let f=Ks(),p;if(e){var g;let j=typeof e=="string"?zn(e):e;h==="/"||(g=j.pathname)!=null&&g.startsWith(h)||ct(!1),p=j}else p=f;let y=p.pathname||"/",_=y;if(h!=="/"){let j=h.replace(/^\//,"").split("/");_="/"+y.replace(/^\//,"").split("/").slice(j.length).join("/")}let P=eb(i,{pathname:_}),b=Lb(P&&P.map(j=>Object.assign({},j,{params:Object.assign({},u,j.params),pathname:gr([h,a.encodeLocation?a.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?h:gr([h,a.encodeLocation?a.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),l,t,r);return e&&b?v.createElement(Ka.Provider,{value:{location:Pi({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:fr.Pop}},b):b}function Ob(){let i=$b(),e=_b(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:a},t):null,null)}const Ib=v.createElement(Ob,null);class Ab extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?v.createElement(Js.Provider,{value:this.props.routeContext},v.createElement(Um.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Eb(i){let{routeContext:e,match:t,children:r}=i,a=v.useContext(xc);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),v.createElement(Js.Provider,{value:e},r)}function Lb(i,e,t,r){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),i==null){var l;if(!t)return null;if(t.errors)i=t.matches;else if((l=r)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let c=i,u=(a=t)==null?void 0:a.errors;if(u!=null){let p=c.findIndex(g=>g.route.id&&(u==null?void 0:u[g.route.id])!==void 0);p>=0||ct(!1),c=c.slice(0,Math.min(c.length,p+1))}let h=!1,f=-1;if(t&&r&&r.v7_partialHydration)for(let p=0;p<c.length;p++){let g=c[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=p),g.route.id){let{loaderData:y,errors:_}=t,P=g.route.loader&&y[g.route.id]===void 0&&(!_||_[g.route.id]===void 0);if(g.route.lazy||P){h=!0,f>=0?c=c.slice(0,f+1):c=[c[0]];break}}}return c.reduceRight((p,g,y)=>{let _,P=!1,b=null,j=null;t&&(_=u&&g.route.id?u[g.route.id]:void 0,b=g.route.errorElement||Ib,h&&(f<0&&y===0?(Fb("route-fallback"),P=!0,j=null):f===y&&(P=!0,j=g.route.hydrateFallbackElement||null)));let S=e.concat(c.slice(0,y+1)),k=()=>{let N;return _?N=b:P?N=j:g.route.Component?N=v.createElement(g.route.Component,null):g.route.element?N=g.route.element:N=p,v.createElement(Eb,{match:g,routeContext:{outlet:p,matches:S,isDataRoute:t!=null},children:N})};return t&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?v.createElement(Ab,{location:t.location,revalidation:t.revalidation,component:b,error:_,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}var qm=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(qm||{}),Hm=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(Hm||{});function Mb(i){let e=v.useContext(xc);return e||ct(!1),e}function Db(i){let e=v.useContext(jb);return e||ct(!1),e}function Rb(i){let e=v.useContext(Js);return e||ct(!1),e}function Wm(i){let e=Rb(),t=e.matches[e.matches.length-1];return t.route.id||ct(!1),t.route.id}function $b(){var i;let e=v.useContext(Um),t=Db(),r=Wm();return e!==void 0?e:(i=t.errors)==null?void 0:i[r]}function Ub(){let{router:i}=Mb(qm.UseNavigateStable),e=Wm(Hm.UseNavigateStable),t=v.useRef(!1);return Fm(()=>{t.current=!0}),v.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?i.navigate(a):i.navigate(a,Pi({fromRouteId:e},l)))},[i,e])}const yu={};function Fb(i,e,t){yu[i]||(yu[i]=!0)}function zb(i,e){i==null||i.v7_startTransition,i==null||i.v7_relativeSplatPath}function vc(i){return kb(i.context)}function Ge(i){ct(!1)}function Bb(i){let{basename:e="/",children:t=null,location:r,navigationType:a=fr.Pop,navigator:l,static:c=!1,future:u}=i;Ri()&&ct(!1);let h=e.replace(/^\/*/,"/"),f=v.useMemo(()=>({basename:h,navigator:l,static:c,future:Pi({v7_relativeSplatPath:!1},u)}),[h,u,l,c]);typeof r=="string"&&(r=zn(r));let{pathname:p="/",search:g="",hash:y="",state:_=null,key:P="default"}=r,b=v.useMemo(()=>{let j=gc(p,h);return j==null?null:{location:{pathname:j,search:g,hash:y,state:_,key:P},navigationType:a}},[h,p,g,y,_,P,a]);return b==null?null:v.createElement(Qr.Provider,{value:f},v.createElement(Ka.Provider,{children:t,value:b}))}function qb(i){let{children:e,location:t}=i;return Cb(Ll(e),t)}new Promise(()=>{});function Ll(i,e){e===void 0&&(e=[]);let t=[];return v.Children.forEach(i,(r,a)=>{if(!v.isValidElement(r))return;let l=[...e,a];if(r.type===v.Fragment){t.push.apply(t,Ll(r.props.children,l));return}r.type!==Ge&&ct(!1),!r.props.index||!r.props.children||ct(!1);let c={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=Ll(r.props.children,l)),t.push(c)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ml(){return Ml=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Ml.apply(this,arguments)}function Hb(i,e){if(i==null)return{};var t={},r=Object.keys(i),a,l;for(l=0;l<r.length;l++)a=r[l],!(e.indexOf(a)>=0)&&(t[a]=i[a]);return t}function Wb(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function Vb(i,e){return i.button===0&&(!e||e==="_self")&&!Wb(i)}const Zb=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Gb="6";try{window.__reactRouterVersion=Gb}catch{}const Jb="startTransition",bu=Rx[Jb];function Kb(i){let{basename:e,children:t,future:r,window:a}=i,l=v.useRef();l.current==null&&(l.current=Y0({window:a,v5Compat:!0}));let c=l.current,[u,h]=v.useState({action:c.action,location:c.location}),{v7_startTransition:f}=r||{},p=v.useCallback(g=>{f&&bu?bu(()=>h(g)):h(g)},[h,f]);return v.useLayoutEffect(()=>c.listen(p),[c,p]),v.useEffect(()=>zb(r),[r]),v.createElement(Bb,{basename:e,children:t,location:u.location,navigationType:u.action,navigator:c,future:r})}const Yb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Qb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_e=v.forwardRef(function(e,t){let{onClick:r,relative:a,reloadDocument:l,replace:c,state:u,target:h,to:f,preventScrollReset:p,viewTransition:g}=e,y=Hb(e,Zb),{basename:_}=v.useContext(Qr),P,b=!1;if(typeof f=="string"&&Qb.test(f)&&(P=f,Yb))try{let N=new URL(window.location.href),T=f.startsWith("//")?new URL(N.protocol+f):new URL(f),O=gc(T.pathname,_);T.origin===N.origin&&O!=null?f=O+T.search+T.hash:b=!0}catch{}let j=Nb(f,{relative:a}),S=Xb(f,{replace:c,state:u,target:h,preventScrollReset:p,relative:a,viewTransition:g});function k(N){r&&r(N),N.defaultPrevented||S(N)}return v.createElement("a",Ml({},y,{href:P||j,onClick:b||l?r:k,ref:t,target:h}))});var _u;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(_u||(_u={}));var wu;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(wu||(wu={}));function Xb(i,e){let{target:t,replace:r,state:a,preventScrollReset:l,relative:c,viewTransition:u}=e===void 0?{}:e,h=Is(),f=Ks(),p=Bm(i,{relative:c});return v.useCallback(g=>{if(Vb(g,t)){g.preventDefault();let y=r!==void 0?r:Ta(f)===Ta(p);h(i,{replace:y,state:a,preventScrollReset:l,relative:c,viewTransition:u})}},[f,h,p,r,a,t,i,l,c,u])}class pt{static subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}static notifyListeners(){const e=this.getNotifications();this.listeners.forEach(t=>t(e))}static getNotifications(){return JSON.parse(localStorage.getItem("notifications")||"[]")}static addNotification(e){const t={...e,id:`NOTIF_${Date.now()}`,timestamp:new Date().toISOString(),read:!1},r=this.getNotifications();r.unshift(t),r.length>50&&r.splice(50),localStorage.setItem("notifications",JSON.stringify(r)),this.notifyListeners(),this.showBrowserNotification(t)}static markAsRead(e){const r=this.getNotifications().map(a=>a.id===e?{...a,read:!0}:a);localStorage.setItem("notifications",JSON.stringify(r)),this.notifyListeners()}static markAllAsRead(){const t=this.getNotifications().map(r=>({...r,read:!0}));localStorage.setItem("notifications",JSON.stringify(t)),this.notifyListeners()}static getUnreadCount(){return this.getNotifications().filter(t=>!t.read).length}static showBrowserNotification(e){"Notification"in window&&Notification.permission==="granted"&&new Notification(e.title,{body:e.message,icon:"/favicon.ico",tag:e.id})}static async requestPermission(){return"Notification"in window?await Notification.requestPermission()==="granted":!1}static sendOrderStatusNotification(e,t,r){const l={customer:{confirmed:"Your order has been confirmed and is being prepared",packing:"Your order is being packed",out_for_delivery:"Your order is out for delivery",delivered:"Your order has been delivered successfully"},admin:{confirmed:`Order ${e} confirmed and ready for processing`,packing:`Order ${e} is being packed`,out_for_delivery:`Order ${e} assigned to delivery partner`,delivered:`Order ${e} delivered successfully`},delivery:{confirmed:`New order ${e} available for pickup`,packing:`Order ${e} ready for pickup`,out_for_delivery:`You accepted order ${e}`,delivered:`Order ${e} delivery completed`}}[r][t];l&&this.addNotification({type:"order_update",title:`Order ${e}`,message:l,orderId:e,priority:t==="delivered"?"high":"medium"})}static sendDeliveryRequestNotification(e,t,r){this.addNotification({type:"delivery_request",title:"New Delivery Request",message:`Order ${e} - ${r.toFixed(2)} - ${t}`,orderId:e,priority:"high"})}}ze(pt,"listeners",[]);class ms{static generateOrderId(){return`ORD${Date.now()}_${Math.random().toString(36).substr(2,4).toUpperCase()}`}static generateCustomer(){const e=["Aarav","Vivaan","Aditya","Vihaan","Arjun","Sai","Reyansh","Ayaan","Krishna","Ishaan","Shaurya","Atharv","Advik","Pranav","Vivek","Ananya","Fatima","Ira","Priya","Riya","Anvi","Kavya","Pihu","Myra","Sara","Aanya","Pari","Avni","Diya","Khushi"],t=["Sharma","Patel","Kumar","Singh","Gupta","Jain","Agarwal","Verma","Yadav","Mishra","Tiwari","Pandey","Joshi","Sinha","Reddy","Nair","Menon","Iyer","Chopra","Malhotra"],r=["MG Road","Station Road","Gandhi Chowk","Market Area","Civil Lines","Shivaji Nagar","Nehru Colony","Ambedkar Nagar","Saraswati Nagar","Indira Colony"],a=e[Math.floor(Math.random()*e.length)],l=t[Math.floor(Math.random()*t.length)],c=r[Math.floor(Math.random()*r.length)];return{name:`${a} ${l}`,phone:`+91 ${Math.floor(Math.random()*9e9)+1e9}`,address:`${Math.floor(Math.random()*999)+1}, ${c}, Shirpur, Maharashtra 425405`,coordinates:this.generateShirpurCoordinates()}}static generateDeliveryAgent(){const e=["Ravi Kumar","Suresh Patil","Mahesh Joshi","Deepak Yadav","Santosh More","Vikram Singh","Ajay Sharma","Rohit Gupta","Amit Verma","Sanjay Tiwari"],t=e[Math.floor(Math.random()*e.length)];return{id:`AGENT_${Date.now()}_${String(this.agentCounter++).padStart(3,"0")}`,name:t,phone:`+91 ${Math.floor(Math.random()*9e9)+1e9}`,location:{lat:21.3487+(Math.random()-.5)*.05,lng:74.8831+(Math.random()-.5)*.05},isActive:Math.random()>.3,rating:3.5+Math.random()*1.5,completedDeliveries:Math.floor(Math.random()*500)+50}}static generateProducts(e=50){const t=[{name:"Basmati Rice",category:"Grains",unit:"kg",basePrice:120,seasonal:!1},{name:"Wheat Flour",category:"Grains",unit:"kg",basePrice:45,seasonal:!1},{name:"Toor Dal",category:"Pulses",unit:"kg",basePrice:85,seasonal:!1},{name:"Moong Dal",category:"Pulses",unit:"kg",basePrice:95,seasonal:!1},{name:"Chana Dal",category:"Pulses",unit:"kg",basePrice:75,seasonal:!1},{name:"Sunflower Oil",category:"Oil",unit:"liter",basePrice:150,seasonal:!1},{name:"Mustard Oil",category:"Oil",unit:"liter",basePrice:180,seasonal:!1},{name:"White Sugar",category:"Sweeteners",unit:"kg",basePrice:42,seasonal:!1},{name:"Jaggery",category:"Sweeteners",unit:"kg",basePrice:65,seasonal:!0},{name:"Tea Powder",category:"Beverages",unit:"pack",basePrice:95,seasonal:!1},{name:"Coffee Powder",category:"Beverages",unit:"pack",basePrice:120,seasonal:!1},{name:"Fresh Milk",category:"Dairy",unit:"liter",basePrice:28,seasonal:!1},{name:"Paneer",category:"Dairy",unit:"pack",basePrice:80,seasonal:!1},{name:"Curd",category:"Dairy",unit:"pack",basePrice:25,seasonal:!1},{name:"Red Onions",category:"Vegetables",unit:"kg",basePrice:35,seasonal:!0},{name:"Potatoes",category:"Vegetables",unit:"kg",basePrice:25,seasonal:!0},{name:"Tomatoes",category:"Vegetables",unit:"kg",basePrice:40,seasonal:!0},{name:"Green Chilies",category:"Vegetables",unit:"kg",basePrice:60,seasonal:!0},{name:"Ginger",category:"Vegetables",unit:"kg",basePrice:80,seasonal:!0},{name:"Garlic",category:"Vegetables",unit:"kg",basePrice:120,seasonal:!0},{name:"Fresh Apples",category:"Fruits",unit:"kg",basePrice:150,seasonal:!0},{name:"Bananas",category:"Fruits",unit:"dozen",basePrice:60,seasonal:!0},{name:"Oranges",category:"Fruits",unit:"kg",basePrice:80,seasonal:!0},{name:"Mangoes",category:"Fruits",unit:"kg",basePrice:200,seasonal:!0},{name:"Grapes",category:"Fruits",unit:"kg",basePrice:120,seasonal:!0},{name:"Bread",category:"Bakery",unit:"pack",basePrice:25,seasonal:!1},{name:"Biscuits",category:"Snacks",unit:"pack",basePrice:20,seasonal:!1},{name:"Namkeen",category:"Snacks",unit:"pack",basePrice:35,seasonal:!1},{name:"Chips",category:"Snacks",unit:"pack",basePrice:30,seasonal:!1},{name:"Noodles",category:"Instant Food",unit:"pack",basePrice:15,seasonal:!1}];return Array.from({length:e},(r,a)=>{const l=t[a%t.length],c=Date.now(),u=new Date().getHours();let h=1;if((u>=7&&u<=9||u>=18&&u<=20)&&(h+=.1),l.seasonal){const g=Math.sin(c/864e5*Math.PI/30)*.2;h+=g}h+=(Math.random()-.5)*.3,h=Math.max(.7,h);const f=Math.round(l.basePrice*h),p=Math.floor(Math.random()*100)+5;return{id:`PROD_${c}_${String(this.productCounter++).padStart(3,"0")}`,name:l.name,category:l.category,price:f,unit:l.unit,stock_qty:p,sku:`SKU${c.toString().slice(-6)}${String(a+1).padStart(3,"0")}`,description:`Fresh ${l.name.toLowerCase()} - Market price updated in real-time`,lastUpdated:c,isActive:!0,discount:Math.random()>.8?Math.floor(Math.random()*20)+5:0,rating:3.5+Math.random()*1.5,reviewCount:Math.floor(Math.random()*200)+10}})}static generateShirpurCoordinates(){const r=Math.random()*2*Math.PI,a=Math.random()*.02;return{lat:21.3487+a*Math.cos(r),lng:74.8831+a*Math.sin(r)}}static calculateDistance(e,t,r,a){const c=(r-e)*Math.PI/180,u=(a-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2);return 6371*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))}static estimateDeliveryTime(e){const a=new Date().getHours();let l=1;return a>=8&&a<=10||a>=17&&a<=19?l=1.5:(a>=22||a<=6)&&(l=.8),Math.round((15+e*3)*l)}static generateMarketTrends(){return{demandMultiplier:.8+Math.random()*.4,supplyStatus:Math.random()>.7?"low":"normal",peakHours:Math.random()>.5,weatherImpact:Math.random()>.8?"high":"normal"}}static generateCategories(e){const t=new Map;return e.forEach(r=>{t.has(r.category)||t.set(r.category,{id:r.category.toLowerCase().replace(/\s+/g,"-"),name:r.category,slug:r.category.toLowerCase().replace(/\s+/g,"-"),is_active:!0,productCount:0}),t.get(r.category).productCount++}),Array.from(t.values())}static generateOrderStatusUpdate(e,t){const a={pending:["confirmed","cancelled"],confirmed:["preparing","cancelled"],preparing:["out_for_delivery"],out_for_delivery:["delivered"],delivered:["delivered"],cancelled:["cancelled"]}[t]||[t],l=a[Math.floor(Math.random()*a.length)];return{orderId:e,status:l,timestamp:Date.now(),estimatedTime:this.estimateDeliveryTime(Math.random()*5)}}}ze(ms,"orderCounter",Date.now()%1e4),ze(ms,"agentCounter",1),ze(ms,"productCounter",1);const Vm=()=>{const i=ms.generateOrderId(),e=ms.generateOrderId(),t=ms.generateOrderId(),r=ms.generateCustomer(),a=Math.floor(Math.random()*500)+100,l=Math.floor(Math.random()*8)+1;pt.addNotification({type:"order_update",title:"Order Update",message:`Your order ${i} is being packed`,orderId:i,priority:"medium"}),pt.addNotification({type:"order_update",title:"New Order",message:`Order ${e} from ${r.name} - ${a}.00`,orderId:e,priority:"high"}),pt.addNotification({type:"delivery_request",title:"New Delivery Request",message:`Order ${t} - ${l}.${Math.floor(Math.random()*9)}km away - ${a}.00`,orderId:t,priority:"high"}),console.log(" Dynamic test notifications triggered!")},Zm=()=>{setTimeout(()=>{Vm()},2e3),setInterval(()=>{const i=["confirmed","packing","out_for_delivery","delivered"],e=i[Math.floor(Math.random()*i.length)],t=ms.generateOrderId(),r=ms.generateCustomer();pt.addNotification({type:"order_update",title:"Order Status Update",message:`${r.name}'s order ${t} is now ${e.replace("_"," ")}`,orderId:t,priority:e==="delivered"?"high":"medium"})},15e3)};typeof window<"u"&&(window.triggerTestNotifications=Vm,window.startNotificationDemo=Zm);const e_=Mi("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),D=v.forwardRef(({className:i,variant:e,size:t,asChild:r=!1,...a},l)=>{const c=r?jx:"button";return s.jsx(c,{className:se(e_({variant:e,size:t,className:i})),ref:l,...a})});D.displayName="Button";const nt=v.forwardRef(({className:i,type:e,...t},r)=>s.jsx("input",{type:e,className:se("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:r,...t}));nt.displayName="Input";var t_="Label",Gm=v.forwardRef((i,e)=>s.jsx(Me.label,{...i,ref:e,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||((a=i.onMouseDown)==null||a.call(i,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Gm.displayName=t_;var Jm=Gm;const s_=Mi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ze=v.forwardRef(({className:i,...e},t)=>s.jsx(Jm,{ref:t,className:se(s_(),i),...e}));Ze.displayName=Jm.displayName;class r_{constructor(){ze(this,"OTP_EXPIRY_MINUTES",5);ze(this,"MAX_OTP_ATTEMPTS",3)}generateOTP(){return Math.floor(1e5+Math.random()*9e5).toString()}async sendSMS(e,t){try{return console.log(`SMS sent to ${e}: Your OTP is ${t}`),alert(`Demo OTP for ${e}: ${t}`),!0}catch(r){return console.error("SMS sending failed:",r),!1}}async sendOTP(e){try{const t=this.generateOTP(),r=new Date(Date.now()+this.OTP_EXPIRY_MINUTES*60*1e3),a={phone:e,otp:t,expires_at:r.toISOString(),attempts:0,is_verified:!1,created_at:new Date().toISOString()};return localStorage.setItem(`otp_${e}`,JSON.stringify(a)),await this.sendSMS(e,t)?{success:!0,message:"OTP sent successfully"}:{success:!1,message:"Failed to send OTP. Please try again."}}catch(t){return console.error("Send OTP error:",t),{success:!1,message:"Failed to send OTP"}}}async verifyOTP(e,t){try{const r=localStorage.getItem(`otp_${e}`);if(!r)return{success:!1,message:"No OTP found for this phone number"};const a=JSON.parse(r);if(new Date>new Date(a.expires_at))return localStorage.removeItem(`otp_${e}`),{success:!1,message:"OTP has expired"};if(a.otp!==t)return a.attempts=(a.attempts||0)+1,a.attempts>=this.MAX_OTP_ATTEMPTS?(localStorage.removeItem(`otp_${e}`),{success:!1,message:"Too many attempts. Please request a new OTP."}):(localStorage.setItem(`otp_${e}`,JSON.stringify(a)),{success:!1,message:"Invalid OTP"});localStorage.removeItem(`otp_${e}`);let l=this.getUserFromStorage(e);return l||(l={id:Date.now(),phone:e,role:"customer",is_first_login_complete:!1},this.saveUserToStorage(l)),l.last_login=new Date().toISOString(),this.saveUserToStorage(l),{success:!0,message:"OTP verified successfully",user:l}}catch(r){return console.error("Verify OTP error:",r),{success:!1,message:"OTP verification failed"}}}async completeFirstLogin(e,t,r){try{const a=this.getAllUsersFromStorage(),l=a.findIndex(c=>c.id===e);return l===-1?{success:!1,message:"User not found"}:(a[l].name=t,a[l].is_first_login_complete=!0,r&&(a[l].role=r),localStorage.setItem("users",JSON.stringify(a)),{success:!0,message:"Profile setup completed"})}catch(a){return console.error("Complete first login error:",a),{success:!1,message:"Failed to complete setup"}}}async getUserByPhone(e){try{return this.getUserFromStorage(e)}catch(t){return console.error("Get user error:",t),null}}async hasCompletedFirstLogin(e){const t=await this.getUserByPhone(e);return(t==null?void 0:t.is_first_login_complete)||!1}storeSession(e){localStorage.setItem("userSession",JSON.stringify({id:e.id,phone:e.phone,name:e.name,role:e.role,isFirstLoginComplete:e.is_first_login_complete,loginTime:new Date().toISOString()}))}getCurrentSession(){const e=localStorage.getItem("userSession");return e?JSON.parse(e):null}clearSession(){localStorage.removeItem("userSession")}isLoggedIn(){return!!this.getCurrentSession()}saveUser(e){this.saveUserToStorage(e)}getUserFromStorage(e){return this.getAllUsersFromStorage().find(r=>r.phone===e)||null}saveUserToStorage(e){const t=this.getAllUsersFromStorage(),r=t.findIndex(a=>a.phone===e.phone);r>=0?t[r]=e:t.push(e),localStorage.setItem("users",JSON.stringify(t))}getAllUsersFromStorage(){const e=localStorage.getItem("users");return e?JSON.parse(e):[]}}const yt=new r_;class n_{static async sendOTP(e,t){const r=`Your Shirpur Delivery OTP is: ${t}. Valid for 5 minutes. Do not share with anyone.`,a=[()=>this.sendViaTwilio(e,r),()=>this.sendViaTextBelt(e,r),()=>this.sendViaFast2SMS(e,r)];for(const l of a)try{const c=await l();if(c.success)return c}catch(c){console.error("SMS provider failed:",c);continue}return{success:!1,message:"All SMS providers failed. Please try again later."}}static async sendViaTwilio(e,t){throw new Error("Twilio credentials not configured")}static async sendViaTextBelt(e,t){const r="textbelt",a=e.replace(/\D/g,"");try{const c=await(await fetch("https://textbelt.com/text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,message:t,key:r})})).json();if(c.success)return{success:!0,message:"SMS sent successfully via TextBelt",provider:"TextBelt",messageId:c.textId};throw new Error(c.error||"TextBelt API error")}catch(l){throw new Error(`TextBelt failed: ${l}`)}}static async sendViaFast2SMS(e,t){throw new Error("Fast2SMS API key not configured")}static async verifyDelivery(e,t){try{switch(t){case"Twilio":return await this.verifyTwilioDelivery(e);case"TextBelt":return await this.verifyTextBeltDelivery(e);default:return!0}}catch(r){return console.error("Delivery verification failed:",r),!1}}static async verifyTwilioDelivery(e){return!1}static async verifyTextBeltDelivery(e){try{return(await(await fetch(`https://textbelt.com/status/${e}`)).json()).status==="DELIVERED"}catch{return!1}}}class hi{static generateOTP(){return Math.floor(1e5+Math.random()*9e5).toString()}static async sendOTP(e,t){try{const r=await n_.sendOTP(e,t);return this.storeOTP(e,t),r.success?{success:!0,message:`OTP sent successfully via ${r.provider}!`,provider:r.provider}:{success:!0,message:"SMS service unavailable. Use WhatsApp link to get OTP.",errorCode:"SMS_SERVICE_DOWN",whatsappLink:this.createWhatsAppLink(e,`Your Shirpur Delivery OTP is: ${t}. Valid for 5 minutes.`)}}catch(r){return console.error("OTP sending failed:",r),{success:!0,message:"SMS failed. Use WhatsApp link to get OTP.",errorCode:"NETWORK_ERROR",whatsappLink:this.createWhatsAppLink(e,`Your Shirpur Delivery OTP is: ${t}. Valid for 5 minutes.`)}}}static async sendViaTextBelt(e,t){const r=e.replace(/\D/g,"");try{const a=await fetch("https://textbelt.com/text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:r,message:t,key:"textbelt"})});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const l=await a.json();return l.success?(console.log(" SMS sent via TextBelt"),{success:!0}):(console.log(" TextBelt error:",l.error),{success:!1,error:l.error||"SMS service unavailable"})}catch(a){return console.error("TextBelt API error:",a),{success:!1,error:"Network error or service unavailable"}}}static createWhatsAppLink(e,t){const r=e.replace(/\D/g,""),a=encodeURIComponent(t),l=`https://wa.me/91${r}?text=${a}`;return console.log(" WhatsApp Link:",l),localStorage.setItem("whatsappOTPLink",JSON.stringify({phone:r,message:t,link:l,timestamp:new Date().toISOString()})),l}static getWhatsAppLink(){try{const e=localStorage.getItem("whatsappOTPLink");if(e)return JSON.parse(e).link}catch(e){console.error("Error getting WhatsApp link:",e)}return null}static storeOTP(e,t){const r={phone:e,otp:t,timestamp:new Date().toISOString(),expiresAt:new Date(Date.now()+3e5).toISOString()};localStorage.setItem(`otp_${e}`,JSON.stringify(r)),console.log(` OTP stored: ${t}`)}static verifyOTP(e,t){try{const r=localStorage.getItem(`otp_${e}`);if(!r)return!1;const a=JSON.parse(r),l=new Date,c=new Date(a.expiresAt);return l>c?(localStorage.removeItem(`otp_${e}`),!1):a.otp===t?(localStorage.removeItem(`otp_${e}`),!0):!1}catch{return!1}}static getStoredOTP(e){try{const t=localStorage.getItem(`otp_${e}`);return t?JSON.parse(t).otp:null}catch{return null}}static getLastError(){return localStorage.getItem("lastOTPError")}static clearLastError(){localStorage.removeItem("lastOTPError")}static setLastError(e){localStorage.setItem("lastOTPError",e)}}const ju=()=>{const[i,e]=v.useState("phone"),[t,r]=v.useState(""),[a,l]=v.useState(""),[c,u]=v.useState(""),[h,f]=v.useState("customer"),[p,g]=v.useState(!1),[y,_]=v.useState(0),[P,b]=v.useState(null),[j,S]=v.useState(""),[k,N]=v.useState(""),T=Is(),{toast:O}=Et(),E=ue=>{const H=ue.replace(/\D/g,"");return H.length<=10?H:H.slice(0,10)},I=()=>{_(300);const ue=setInterval(()=>{_(H=>H<=1?(clearInterval(ue),0):H-1)},1e3)},q=async ue=>{if(ue.preventDefault(),t.length!==10){O({title:"Invalid Phone Number",description:"Please enter a valid 10-digit phone number",variant:"destructive"});return}g(!0),S("");const H=hi.generateOTP(),te=await hi.sendOTP(`+91${t}`,H);te.success?(e("otp"),I(),te.whatsappLink&&N(te.whatsappLink),window.alert&&window.alert(`Your OTP is: ${H}

This is shown for testing purposes.
In production, you'll receive it via SMS.`),O({title:"OTP Sent!",description:te.message,variant:(te.errorCode==="SMS_LIMIT_REACHED","default")})):(S(te.message),O({title:"OTP Sending Failed",description:te.message,variant:"destructive"})),g(!1)},B=async ue=>{if(ue.preventDefault(),a.length!==6){O({title:"Invalid OTP",description:"Please enter the 6-digit OTP",variant:"destructive"});return}if(g(!0),hi.verifyOTP(`+91${t}`,a)){let te=await yt.getUserByPhone(t);if(te||(te={id:Date.now(),phone:t,role:"customer",is_first_login_complete:!1}),te.last_login=new Date().toISOString(),yt.saveUser(te),b(te),!te.is_first_login_complete)e("setup"),O({title:"OTP Verified Successfully!",description:"Please complete your profile setup"});else{yt.storeSession(te);const ve={customer:{title:" Welcome Back!",message:`Hello ${te.name||"Valued Customer"}!

 Ready to explore fresh products?
 Fast delivery in 30 minutes!`,icon:""},admin:{title:" Admin Access Granted!",message:`Welcome ${te.name||"Administrator"}!

 Your dashboard awaits
 Manage your delivery empire!`,icon:""},delivery:{title:" Ready to Deliver!",message:`Hey ${te.name||"Delivery Hero"}!

 New orders are waiting
 Start earning today!`,icon:""}}[te.role];setTimeout(()=>{const G=document.createElement("div");G.className="fixed inset-0 bg-black/60 flex items-center justify-center z-50 animate-fadeIn",G.innerHTML=`
            <div class="bg-gradient-to-br from-white to-gray-50 rounded-3xl p-8 max-w-sm mx-4 text-center shadow-2xl transform animate-slideUp">
              <div class="text-7xl mb-4 animate-bounce">${ve.icon}</div>
              <h2 class="text-2xl font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent mb-3">${ve.title}</h2>
              <div class="text-gray-700 mb-6 space-y-1">
                ${ve.message.split(`
`).map(Y=>`<p class="${Y.includes("Hello")||Y.includes("Welcome")||Y.includes("Hey")?"font-semibold text-lg":"text-sm"}">${Y}</p>`).join("")}
              </div>
              <button class="w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">
                Continue 
              </button>
            </div>
          `;const re=document.createElement("style");re.textContent=`
            @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
            @keyframes slideUp { from { transform: translateY(50px) scale(0.9); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
            .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
            .animate-slideUp { animation: slideUp 0.4s ease-out; }
          `,document.head.appendChild(re),document.body.appendChild(G),G.querySelector("button").onclick=()=>{G.style.animation="fadeIn 0.2s ease-out reverse",setTimeout(()=>{G.remove(),re.remove(),T({customer:"/customer",admin:"/admin",delivery:"/delivery"}[te.role])},200)},setTimeout(()=>{document.body.contains(G)&&G.querySelector("button").click()},4e3)},1e3)}}else O({title:"Invalid OTP",description:"The OTP you entered is incorrect or expired. Please try again.",variant:"destructive"});g(!1)},W=async ue=>{if(ue.preventDefault(),!c.trim()){O({title:"Name Required",description:"Please enter your name",variant:"destructive"});return}if(!P)return;g(!0);const H=await yt.completeFirstLogin(P.id,c,h);if(H.success){const te={...P,name:c,role:h,is_first_login_complete:!0};yt.storeSession(te);const ve={customer:{title:" Welcome to Shirpur Delivery!",message:`Hi ${c}! 

Your account is ready!
 Start shopping fresh products
 Get delivery in 30 minutes`,icon:""},admin:{title:" Admin Account Created!",message:`Welcome ${c}! 

You now have admin access
 Manage your delivery business
 Control everything from here`,icon:""},delivery:{title:" Delivery Partner Onboard!",message:`Welcome ${c}! 

You're now a delivery partner
 Accept orders and earn money
 Start your journey today`,icon:""}}[h];setTimeout(()=>{window.Swal?window.Swal.fire({title:ve.title,text:ve.message,icon:"success",iconHtml:ve.icon,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"#fff",confirmButtonColor:"#4F46E5",confirmButtonText:"Get Started! ",showClass:{popup:"animate__animated animate__bounceIn"},timer:5e3,timerProgressBar:!0}).then(()=>{T({customer:"/customer",admin:"/admin",delivery:"/delivery"}[h])}):(O({title:ve.title,description:ve.message.replace(/\n/g," ")}),setTimeout(()=>{T({customer:"/customer",admin:"/admin",delivery:"/delivery"}[h])},2e3))},500)}else O({title:"Setup Failed",description:H.message,variant:"destructive"});g(!1)},J=async()=>{g(!0),S("");const ue=hi.generateOTP(),H=await hi.sendOTP(`+91${t}`,ue);H.success?(I(),H.whatsappLink&&N(H.whatsappLink),window.alert&&window.alert(`Your new OTP is: ${ue}

This is shown for testing purposes.`),O({title:"OTP Resent!",description:H.message})):(S(H.message),O({title:"Failed to Resend OTP",description:H.message,variant:"destructive"})),g(!1)},V=ue=>{const H=Math.floor(ue/60),te=ue%60;return`${H}:${te.toString().padStart(2,"0")}`};return s.jsxs("div",{className:"min-h-screen bg-white flex",children:[s.jsx("div",{className:"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-orange-400 to-red-500 items-center justify-center p-12",children:s.jsxs("div",{className:"text-center text-white",children:[s.jsxs("div",{className:"w-64 h-64 mx-auto mb-8 relative",children:[s.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full animate-pulse"}),s.jsx("div",{className:"absolute inset-4 bg-white/30 rounded-full animate-pulse delay-300"}),s.jsx("div",{className:"absolute inset-8 bg-white rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-6xl text-orange-500",children:""})})]}),s.jsx("h2",{className:"text-4xl font-bold mb-4",children:"Shirpur Delivery"}),s.jsx("p",{className:"text-xl opacity-90",children:"Fresh food delivered in 30 minutes"})]})}),s.jsx("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"lg:hidden text-center mb-8",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-orange-400 to-red-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-2xl text-white",children:""})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Shirpur Delivery"})]}),s.jsxs("div",{className:"bg-white",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:[i==="phone"&&"Login",i==="otp"&&"Verify OTP",i==="setup"&&"Complete Profile"]}),s.jsxs("p",{className:"text-gray-600",children:[i==="phone"&&"Enter your phone number to continue",i==="otp"&&`We've sent an OTP to +91 ${t}`,i==="setup"&&"Tell us a bit about yourself"]})]}),s.jsxs("div",{children:[i==="phone"&&s.jsxs("form",{onSubmit:q,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ze,{htmlFor:"phone",children:"Mobile Number"}),s.jsxs("div",{className:"relative",children:[s.jsx(Gs,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(nt,{id:"phone",type:"tel",placeholder:"Enter 10-digit mobile number",value:t,onChange:ue=>r(E(ue.target.value)),className:"pl-10 h-12 text-base",maxLength:10,required:!0})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"We'll send you a 6-digit OTP"})]}),s.jsx(D,{type:"submit",className:"w-full h-12 bg-orange-500 hover:bg-orange-600 text-white font-medium",disabled:p||t.length!==10,children:p?"Sending OTP...":"Send OTP"})]}),i==="otp"&&s.jsxs("form",{onSubmit:B,className:"space-y-4",children:[j&&s.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-red-600 text-sm",children:""}),s.jsx("p",{className:"text-sm text-red-800",children:j})]}),k&&s.jsx("div",{className:"mt-2",children:s.jsx("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-sm text-green-600 hover:text-green-700 underline",children:" Get OTP via WhatsApp"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ze,{htmlFor:"otp",children:"Enter OTP"}),s.jsxs("div",{className:"relative",children:[s.jsx(Sa,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(nt,{id:"otp",type:"text",placeholder:"Enter 6-digit OTP",value:a,onChange:ue=>l(ue.target.value.replace(/\D/g,"").slice(0,6)),className:"pl-10 h-12 text-base text-center tracking-widest",maxLength:6,required:!0})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("span",{className:"text-gray-500",children:["Sent to +91 ",t]}),y>0&&s.jsxs("div",{className:"flex items-center text-blue-600",children:[s.jsx(Rv,{className:"w-3 h-3 mr-1"}),V(y)]})]})]}),s.jsx(D,{type:"submit",className:"w-full h-12 bg-orange-500 hover:bg-orange-600 text-white font-medium",disabled:p||a.length!==6,children:p?"Verifying...":"Verify OTP"}),s.jsxs("div",{className:"space-y-2",children:[y===0&&s.jsx(D,{type:"button",variant:"outline",className:"w-full h-12",onClick:J,disabled:p,children:p?"Resending...":"Resend OTP"}),k&&s.jsx("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"block w-full",children:s.jsx(D,{type:"button",variant:"outline",className:"w-full h-12 border-green-200 text-green-700 hover:bg-green-50",children:" Get OTP via WhatsApp"})})]}),s.jsx(D,{type:"button",variant:"ghost",className:"w-full",onClick:()=>e("phone"),children:"Change Phone Number"})]}),i==="setup"&&s.jsxs("form",{onSubmit:W,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ze,{htmlFor:"name",children:"Full Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(Os,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(nt,{id:"name",type:"text",placeholder:"Enter your full name",value:c,onChange:ue=>u(ue.target.value),className:"pl-10 h-12 text-base",required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Ze,{children:"Select Your Role"}),s.jsxs("div",{className:"grid gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>f("customer"),className:`p-4 border rounded-lg flex items-center space-x-3 transition-colors ${h==="customer"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx(wn,{className:"w-5 h-5 text-blue-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium",children:"Customer"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Browse and order products"})]})]}),s.jsxs("button",{type:"button",onClick:()=>f("delivery"),className:`p-4 border rounded-lg flex items-center space-x-3 transition-colors ${h==="delivery"?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx(it,{className:"w-5 h-5 text-green-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium",children:"Delivery Partner"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Deliver orders to customers"})]})]}),s.jsxs("button",{type:"button",onClick:()=>f("admin"),className:`p-4 border rounded-lg flex items-center space-x-3 transition-colors ${h==="admin"?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"}`,children:[s.jsx(Sa,{className:"w-5 h-5 text-purple-600"}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium",children:"Admin"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Manage system and orders"})]})]})]})]}),s.jsx(D,{type:"submit",className:"w-full h-12 bg-orange-500 hover:bg-orange-600 text-white font-medium",disabled:p||!c.trim(),children:p?"Setting up...":"Get Started"})]})]}),i==="phone"&&s.jsxs("div",{className:"mt-6 space-y-3",children:[s.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:s.jsxs("p",{className:"text-sm text-orange-800 text-center",children:[s.jsx("strong",{children:"Demo Mode:"})," OTP will be displayed in an alert for testing"]})}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-xs text-blue-800 text-center",children:[s.jsx("strong",{children:"Free SMS:"})," 1 SMS per day via TextBelt. Unlimited via WhatsApp backup."]})})]})]})]})})]})},il=({children:i,allowedRoles:e})=>{const t=Is();v.useEffect(()=>{const a=yt.getCurrentSession();if(!a||!yt.isLoggedIn()){t("/");return}if(!e.includes(a.role)){t("/");return}if(!a.isFirstLoginComplete){t("/");return}},[t,e]);const r=yt.getCurrentSession();return!r||!yt.isLoggedIn()||!e.includes(r.role)||!r.isFirstLoginComplete?null:s.jsx(s.Fragment,{children:i})},U=v.forwardRef(({className:i,...e},t)=>s.jsx("div",{ref:t,className:se("rounded-lg border bg-card text-card-foreground shadow-sm",i),...e}));U.displayName="Card";const ne=v.forwardRef(({className:i,...e},t)=>s.jsx("div",{ref:t,className:se("flex flex-col space-y-1.5 p-6",i),...e}));ne.displayName="CardHeader";const ie=v.forwardRef(({className:i,...e},t)=>s.jsx("h3",{ref:t,className:se("text-2xl font-semibold leading-none tracking-tight",i),...e}));ie.displayName="CardTitle";const ds=v.forwardRef(({className:i,...e},t)=>s.jsx("p",{ref:t,className:se("text-sm text-muted-foreground",i),...e}));ds.displayName="CardDescription";const z=v.forwardRef(({className:i,...e},t)=>s.jsx("div",{ref:t,className:se("p-6 pt-0",i),...e}));z.displayName="CardContent";const i_=v.forwardRef(({className:i,...e},t)=>s.jsx("div",{ref:t,className:se("flex items-center p-6 pt-0",i),...e}));i_.displayName="CardFooter";const a_=()=>s.jsx("div",{className:"min-h-screen bg-gradient-hero",children:s.jsxs("div",{className:"container mx-auto px-4 py-16",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsx("h1",{className:"text-5xl font-bold text-white mb-6",children:"Shirpur Delivery"}),s.jsx("p",{className:"text-xl text-white/90 mb-8 max-w-2xl mx-auto",children:"Complete delivery management system for customers, administrators, and delivery personnel"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-8 max-w-6xl mx-auto",children:[s.jsxs(U,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/20 transition-all duration-300 group",children:[s.jsxs(ne,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:s.jsx(rt,{className:"w-8 h-8 text-white"})}),s.jsx(ie,{className:"text-white",children:"Customer Portal"}),s.jsx(ds,{className:"text-white/80",children:"Browse products, manage your cart, and track orders"})]}),s.jsx(z,{className:"text-center",children:s.jsx(_e,{to:"/login",children:s.jsx(D,{className:"bg-white text-primary hover:bg-white/90 w-full",children:"Login to Shop"})})})]}),s.jsxs(U,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/20 transition-all duration-300 group",children:[s.jsxs(ne,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-16 h-16 bg-secondary rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:s.jsx(xe,{className:"w-8 h-8 text-white"})}),s.jsx(ie,{className:"text-white",children:"Admin Dashboard"}),s.jsx(ds,{className:"text-white/80",children:"Manage products, orders, and delivery assignments"})]}),s.jsx(z,{className:"text-center",children:s.jsx(_e,{to:"/login",children:s.jsx(D,{className:"bg-secondary text-white hover:bg-secondary/90 w-full",children:"Admin Login"})})})]}),s.jsxs(U,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/20 transition-all duration-300 group",children:[s.jsxs(ne,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-16 h-16 bg-accent rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:s.jsx(it,{className:"w-8 h-8 text-white"})}),s.jsx(ie,{className:"text-white",children:"Delivery Portal"}),s.jsx(ds,{className:"text-white/80",children:"View delivery tasks, verify OTPs, and track earnings"})]}),s.jsx(z,{className:"text-center",children:s.jsx(_e,{to:"/login",children:s.jsx(D,{className:"bg-accent text-white hover:bg-accent/90 w-full",children:"Delivery Login"})})})]})]}),s.jsxs("div",{className:"mt-20 text-center",children:[s.jsx("h2",{className:"text-3xl font-bold text-white mb-12",children:"System Features"}),s.jsxs("div",{className:"grid grid-cols-4 gap-6 max-w-4xl mx-auto",children:[s.jsxs("div",{className:"text-white",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center mx-auto mb-4",children:s.jsx(xe,{className:"w-6 h-6"})}),s.jsx("h3",{className:"font-semibold mb-2",children:"Inventory Management"}),s.jsx("p",{className:"text-sm text-white/80",children:"Real-time stock tracking and low inventory alerts"})]}),s.jsxs("div",{className:"text-white",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center mx-auto mb-4",children:s.jsx(it,{className:"w-6 h-6"})}),s.jsx("h3",{className:"font-semibold mb-2",children:"OTP Verification"}),s.jsx("p",{className:"text-sm text-white/80",children:"Secure delivery confirmation with time-limited OTPs"})]}),s.jsxs("div",{className:"text-white",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center mx-auto mb-4",children:s.jsx(dc,{className:"w-6 h-6"})}),s.jsx("h3",{className:"font-semibold mb-2",children:"Role-Based Access"}),s.jsx("p",{className:"text-sm text-white/80",children:"Separate interfaces for customers, admins, and delivery staff"})]}),s.jsxs("div",{className:"text-white",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center mx-auto mb-4",children:s.jsx(rt,{className:"w-6 h-6"})}),s.jsx("h3",{className:"font-semibold mb-2",children:"Real-time Tracking"}),s.jsx("p",{className:"text-sm text-white/80",children:"Live order status updates and delivery tracking"})]})]})]})]})}),o_=Mi("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function X({className:i,variant:e,...t}){return s.jsx("div",{className:se(o_({variant:e}),i),...t})}const yc=vh,bc=yh,l_=gh,Km=v.forwardRef(({className:i,...e},t)=>s.jsx(Ua,{className:se("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",i),...e,ref:t}));Km.displayName=Ua.displayName;const c_=Mi("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Ya=v.forwardRef(({side:i="right",className:e,children:t,...r},a)=>s.jsxs(l_,{children:[s.jsx(Km,{}),s.jsxs(Fa,{ref:a,className:se(c_({side:i}),e),...r,children:[t,s.jsxs(xh,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[s.jsx(ps,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ya.displayName=Fa.displayName;const d_=v.forwardRef(({className:i,...e},t)=>s.jsx(za,{ref:t,className:se("text-lg font-semibold text-foreground",i),...e}));d_.displayName=za.displayName;const u_=v.forwardRef(({className:i,...e},t)=>s.jsx(Ba,{ref:t,className:se("text-sm text-muted-foreground",i),...e}));u_.displayName=Ba.displayName;const h_="modulepreload",m_=function(i){return"/"+i},Nu={},$i=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=Promise.allSettled(t.map(h=>{if(h=m_(h),h in Nu)return;Nu[h]=!0;const f=h.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${p}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":h_,f||(g.as="script"),g.crossOrigin="",g.href=h,u&&g.setAttribute("nonce",u),document.head.appendChild(g),f)return new Promise((y,_)=>{g.addEventListener("load",y),g.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return e().catch(l)})},f_=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>Bn);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class _c extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class p_ extends _c{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Su extends _c{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Pu extends _c{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Dl;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Dl||(Dl={}));var g_=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,e||[])).next())})};class x_{constructor(e,{headers:t={},customFetch:r,region:a=Dl.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=f_(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return g_(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:c}=t;let u={},{region:h}=t;h||(h=this.region);const f=new URL(`${this.url}/${e}`);h&&h!=="any"&&(u["x-region"]=h,f.searchParams.set("forceFunctionRegion",h));let p;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=c):typeof c=="string"?(u["Content-Type"]="text/plain",p=c):typeof FormData<"u"&&c instanceof FormData?p=c:(u["Content-Type"]="application/json",p=JSON.stringify(c)));const g=yield this.fetch(f.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),a),body:p}).catch(b=>{throw new p_(b)}),y=g.headers.get("x-relay-error");if(y&&y==="true")throw new Su(g);if(!g.ok)throw new Pu(g);let _=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),P;return _==="application/json"?P=yield g.json():_==="application/octet-stream"?P=yield g.blob():_==="text/event-stream"?P=g:_==="multipart/form-data"?P=yield g.formData():P=yield g.text(),{data:P,error:null,response:g}}catch(a){return{data:null,error:a,response:a instanceof Pu||a instanceof Su?a.context:void 0}}})}}var $t={},wc={},Qa={},Ui={},Xa={},eo={},v_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},Dn=v_();const y_=Dn.fetch,Ym=Dn.fetch.bind(Dn),Qm=Dn.Headers,b_=Dn.Request,__=Dn.Response,Bn=Object.freeze(Object.defineProperty({__proto__:null,Headers:Qm,Request:b_,Response:__,default:Ym,fetch:y_},Symbol.toStringTag,{value:"Module"})),w_=$x(Bn);var to={};Object.defineProperty(to,"__esModule",{value:!0});let j_=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};to.default=j_;var Xm=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(eo,"__esModule",{value:!0});const N_=Xm(w_),S_=Xm(to);let P_=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=N_.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var c,u,h,f;let p=null,g=null,y=null,_=l.status,P=l.statusText;if(l.ok){if(this.method!=="HEAD"){const k=await l.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((c=this.headers.get("Accept"))===null||c===void 0)&&c.includes("application/vnd.pgrst.plan+text"))?g=k:g=JSON.parse(k))}const j=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),S=(h=l.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");j&&S&&S.length>1&&(y=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,y=null,_=406,P="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const j=await l.text();try{p=JSON.parse(j),Array.isArray(p)&&l.status===404&&(g=[],p=null,_=200,P="OK")}catch{l.status===404&&j===""?(_=204,P="No Content"):p={message:j}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,_=200,P="OK"),p&&this.shouldThrowOnError)throw new S_.default(p)}return{error:p,data:g,count:y,status:_,statusText:P}});return this.shouldThrowOnError||(a=a.catch(l=>{var c,u,h;return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(u=l==null?void 0:l.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(h=l==null?void 0:l.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}};eo.default=P_;var k_=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Xa,"__esModule",{value:!0});const C_=k_(eo);let T_=class extends C_.default{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${e}`),this.url.searchParams.set(c,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${f}"; options=${h};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Xa.default=T_;var O_=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Ui,"__esModule",{value:!0});const I_=O_(Xa);let A_=class extends I_.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${l}fts${c}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Ui.default=A_;var E_=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Qa,"__esModule",{value:!0});const mi=E_(Ui);let L_=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(e,{head:t=!1,count:r}={}){const a=t?"HEAD":"GET";let l=!1;const c=(e??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),r&&this.headers.append("Prefer",`count=${r}`),new mi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const l="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new mi.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const h=e.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new mi.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(e,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new mi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new mi.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};Qa.default=L_;var ef=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(wc,"__esModule",{value:!0});const M_=ef(Qa),D_=ef(Ui);let R_=class tf{constructor(e,{headers:t={},schema:r,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=a}from(e){const t=new URL(`${this.url}/${e}`);return new M_.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new tf(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:a=!1,count:l}={}){var c;let u;const h=new URL(`${this.url}/rpc/${e}`);let f;r||a?(u=r?"HEAD":"GET",Object.entries(t).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{h.searchParams.append(g,y)})):(u="POST",f=t);const p=new Headers(this.headers);return l&&p.set("Prefer",`count=${l}`),new D_.default({method:u,url:h,headers:p,schema:this.schemaName,body:f,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};wc.default=R_;var qn=qt&&qt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty($t,"__esModule",{value:!0});$t.PostgrestError=$t.PostgrestBuilder=$t.PostgrestTransformBuilder=$t.PostgrestFilterBuilder=$t.PostgrestQueryBuilder=$t.PostgrestClient=void 0;const sf=qn(wc);$t.PostgrestClient=sf.default;const rf=qn(Qa);$t.PostgrestQueryBuilder=rf.default;const nf=qn(Ui);$t.PostgrestFilterBuilder=nf.default;const af=qn(Xa);$t.PostgrestTransformBuilder=af.default;const of=qn(eo);$t.PostgrestBuilder=of.default;const lf=qn(to);$t.PostgrestError=lf.default;var $_=$t.default={PostgrestClient:sf.default,PostgrestQueryBuilder:rf.default,PostgrestFilterBuilder:nf.default,PostgrestTransformBuilder:af.default,PostgrestBuilder:of.default,PostgrestError:lf.default};const{PostgrestClient:U_,PostgrestQueryBuilder:dP,PostgrestFilterBuilder:uP,PostgrestTransformBuilder:hP,PostgrestBuilder:mP,PostgrestError:fP}=$_;class F_{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const z_="2.15.5",B_=`realtime-js/${z_}`,q_="1.0.0",Rl=1e4,H_=1e3,W_=100;var vi;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(vi||(vi={}));var ht;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(ht||(ht={}));var us;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(us||(us={}));var $l;(function(i){i.websocket="websocket"})($l||($l={}));var Ar;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ar||(Ar={}));class V_{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const a=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const u=r.decode(e.slice(c,c+a));c=c+a;const h=r.decode(e.slice(c,c+l));c=c+l;const f=JSON.parse(r.decode(e.slice(c,e.byteLength)));return{ref:null,topic:u,event:h,payload:f}}}class cf{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var We;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(We||(We={}));const ku=(i,e,t={})=>{var r;const a=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((l,c)=>(l[c]=Z_(c,i,e,a),l),{})},Z_=(i,e,t,r)=>{const a=e.find(u=>u.name===i),l=a==null?void 0:a.type,c=t[i];return l&&!r.includes(l)?df(l,c):Ul(c)},df=(i,e)=>{if(i.charAt(0)==="_"){const t=i.slice(1,i.length);return Y_(e,t)}switch(i){case We.bool:return G_(e);case We.float4:case We.float8:case We.int2:case We.int4:case We.int8:case We.numeric:case We.oid:return J_(e);case We.json:case We.jsonb:return K_(e);case We.timestamp:return Q_(e);case We.abstime:case We.date:case We.daterange:case We.int4range:case We.int8range:case We.money:case We.reltime:case We.text:case We.time:case We.timestamptz:case We.timetz:case We.tsrange:case We.tstzrange:return Ul(e);default:return Ul(e)}},Ul=i=>i,G_=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},J_=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},K_=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Y_=(i,e)=>{if(typeof i!="string")return i;const t=i.length-1,r=i[t];if(i[0]==="{"&&r==="}"){let l;const c=i.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>df(e,u))}return i},Q_=i=>typeof i=="string"?i.replace(" ","T"):i,uf=i=>{let e=i;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class al{constructor(e,t,r={},a=Rl){this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Cu;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Cu||(Cu={}));class yi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=yi.syncState(this.state,a,l,c),this.pendingDiffs.forEach(h=>{this.state=yi.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(r.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=yi.syncDiff(this.state,a,l,c),u())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){const l=this.cloneDeep(e),c=this.transformState(t),u={},h={};return this.map(l,(f,p)=>{c[f]||(h[f]=p)}),this.map(c,(f,p)=>{const g=l[f];if(g){const y=p.map(j=>j.presence_ref),_=g.map(j=>j.presence_ref),P=p.filter(j=>_.indexOf(j.presence_ref)<0),b=g.filter(j=>y.indexOf(j.presence_ref)<0);P.length>0&&(u[f]=P),b.length>0&&(h[f]=b)}else u[f]=p}),this.syncDiff(l,{joins:u,leaves:h},r,a)}static syncDiff(e,t,r,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(l,(u,h)=>{var f;const p=(f=e[u])!==null&&f!==void 0?f:[];if(e[u]=this.cloneDeep(h),p.length>0){const g=e[u].map(_=>_.presence_ref),y=p.filter(_=>g.indexOf(_.presence_ref)<0);e[u].unshift(...y)}r(u,p,h)}),this.map(c,(u,h)=>{let f=e[u];if(!f)return;const p=h.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),e[u]=f,a(u,f,h),f.length===0&&delete e[u]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const a=e[r];return"metas"in a?t[r]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[r]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Tu;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Tu||(Tu={}));var bi;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(bi||(bi={}));var Ws;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Ws||(Ws={}));class jc{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new al(this,us.join,this.params,this.timeout),this.rejoinTimer=new cf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ht.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on(us.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new yi(this),this.broadcastEndpointURL=uf(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==ht.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,f=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(_=>_.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[bi.PRESENCE]&&this.bindings[bi.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},y={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(_=>e==null?void 0:e(Ws.CHANNEL_ERROR,_)),this._onClose(()=>e==null?void 0:e(Ws.CLOSED)),this.updateJoinPayload(Object.assign({config:y},g)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:_})=>{var P;if(this.socket.setAuth(),_===void 0){e==null||e(Ws.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,j=(P=b==null?void 0:b.length)!==null&&P!==void 0?P:0,S=[];for(let k=0;k<j;k++){const N=b[k],{filter:{event:T,schema:O,table:E,filter:I}}=N,q=_&&_[k];if(q&&q.event===T&&q.schema===O&&q.table===E&&q.filter===I)S.push(Object.assign(Object.assign({},N),{id:q.id}));else{this.unsubscribe(),this.state=ht.errored,e==null||e(Ws.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(Ws.SUBSCRIBED);return}}).receive("error",_=>{this.state=ht.errored,e==null||e(Ws.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ws.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===ht.joined&&e===bi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const f=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ht.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(us.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new al(this,us.leave,{},e),r.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ht.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const a=new AbortController,l=setTimeout(()=>a.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new al(this,e,t,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>W_){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,l;const c=e.toLocaleLowerCase(),{close:u,error:h,leave:f,join:p}=us;if(r&&[u,h,f,p].indexOf(c)>=0&&r!==this._joinRef())return;let y=this._onMessage(c,t,r);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(_=>{var P,b,j;return((P=_.filter)===null||P===void 0?void 0:P.event)==="*"||((j=(b=_.filter)===null||b===void 0?void 0:b.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===c}).map(_=>_.callback(y,r)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var P,b,j,S,k,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const T=_.id,O=(P=_.filter)===null||P===void 0?void 0:P.event;return T&&((b=t.ids)===null||b===void 0?void 0:b.includes(T))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((j=t.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const T=(k=(S=_==null?void 0:_.filter)===null||S===void 0?void 0:S.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return T==="*"||T===((N=t==null?void 0:t.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof y=="object"&&"ids"in y){const P=y.data,{schema:b,table:j,commit_timestamp:S,type:k,errors:N}=P;y=Object.assign(Object.assign({},{schema:b,table:j,commit_timestamp:S,eventType:k,new:{},old:{},errors:N}),this._getPayloadRecords(P))}_.callback(y,r)})}_isClosed(){return this.state===ht.closed}_isJoined(){return this.state===ht.joined}_isJoining(){return this.state===ht.joining}_isLeaving(){return this.state===ht.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&jc.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(us.close,{},e)}_onError(e){this._on(us.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ht.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ku(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ku(e.columns,e.old_record)),t}}const ol=()=>{},pa={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},X_=[1e3,2e3,5e3,1e4],ew=1e4,tw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sw{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Rl,this.transport=null,this.heartbeatIntervalMs=pa.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ol,this.ref=0,this.reconnectTimer=null,this.logger=ol,this.conn=null,this.sendBuffer=[],this.serializer=new V_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>$i(async()=>{const{default:u}=await Promise.resolve().then(()=>Bn);return{default:u}},void 0).then(({default:u})=>u(...c)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${$l.websocket}`,this.httpEndpoint=uf(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=F_.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:q_}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case vi.connecting:return Ar.Connecting;case vi.open:return Ar.Open;case vi.closing:return Ar.Closing;default:return Ar.Closed}}isConnected(){return this.connectionState()===Ar.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===r);if(a)return a;{const l=new jc(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:r,payload:a,ref:l}=e,c=()=>{this.encode(e,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${t} ${r} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(H_,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},pa.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:a,payload:l,ref:c}=t,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${r} ${a} ${u}`.trim(),l),this.channels.filter(f=>f._isMember(r)).forEach(f=>f._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(us.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${r}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([tw],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const a={access_token:t,version:B_};t&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(us.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new cf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},pa.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,a,l,c,u,h,f,p;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Rl,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:pa.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=e==null?void 0:e.heartbeatCallback)!==null&&u!==void 0?u:ol,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e==null?void 0:e.reconnectAfterMs)!==null&&h!==void 0?h:g=>X_[g-1]||ew,this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:(g,y)=>y(JSON.stringify(g)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Nc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ft(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class rw extends Nc{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Fl extends Nc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var nw=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,e||[])).next())})};const hf=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>Bn);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},iw=()=>nw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $i(()=>Promise.resolve().then(()=>Bn),void 0)).Response:Response}),zl=i=>{if(Array.isArray(i))return i.map(t=>zl(t));if(typeof i=="function"||i!==Object(i))return i;const e={};return Object.entries(i).forEach(([t,r])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=zl(r)}),e},aw=i=>{if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)};var Xr=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,e||[])).next())})};const ll=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),ow=(i,e,t)=>Xr(void 0,void 0,void 0,function*(){const r=yield iw();i instanceof r&&!(t!=null&&t.noResolveJson)?i.json().then(a=>{const l=i.status||500,c=(a==null?void 0:a.statusCode)||l+"";e(new rw(ll(a),l,c))}).catch(a=>{e(new Fl(ll(a),a))}):e(new Fl(ll(i),i))}),lw=(i,e,t,r)=>{const a={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"||!r?a:(aw(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function Fi(i,e,t,r,a,l){return Xr(this,void 0,void 0,function*(){return new Promise((c,u)=>{i(t,lw(e,r,a,l)).then(h=>{if(!h.ok)throw h;return r!=null&&r.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>ow(h,u,r))})})}function Oa(i,e,t,r){return Xr(this,void 0,void 0,function*(){return Fi(i,"GET",e,t,r)})}function Ss(i,e,t,r,a){return Xr(this,void 0,void 0,function*(){return Fi(i,"POST",e,r,a,t)})}function Bl(i,e,t,r,a){return Xr(this,void 0,void 0,function*(){return Fi(i,"PUT",e,r,a,t)})}function cw(i,e,t,r){return Xr(this,void 0,void 0,function*(){return Fi(i,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function mf(i,e,t,r,a){return Xr(this,void 0,void 0,function*(){return Fi(i,"DELETE",e,r,a,t)})}var Ot=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,e||[])).next())})};const dw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ou={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class uw{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=hf(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,a){return Ot(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Ou),a);let u=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),a!=null&&a.headers&&(u=Object.assign(Object.assign({},u),a.headers));const f=this._removeEmptyFolders(t),p=this._getFinalPath(f),g=yield(e=="PUT"?Bl:Ss)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:u},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}upload(e,t,r){return Ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,a){return Ot(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),u=new URL(this.url+`/object/upload/sign/${c}`);u.searchParams.set("token",t);try{let h;const f=Object.assign({upsert:Ou.upsert},a),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",f.cacheControl)):(h=r,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const g=yield Bl(this.fetch,u.toString(),h,{headers:p});return{data:{path:l,fullPath:g.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(ft(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,t){return Ot(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const l=yield Ss(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),c=new URL(this.url+l.url),u=c.searchParams.get("token");if(!u)throw new Nc("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:u},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}update(e,t,r){return Ot(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Ot(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}copy(e,t,r){return Ot(this,void 0,void 0,function*(){try{return{data:{path:(yield Ss(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,r){return Ot(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield Ss(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,r){return Ot(this,void 0,void 0,function*(){try{const a=yield Ss(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}download(e,t){return Ot(this,void 0,void 0,function*(){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=l?`?${l}`:"";try{const u=this._getFinalPath(e);return{data:yield(yield Oa(this.fetch,`${this.url}/${a}/${u}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}info(e){return Ot(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Oa(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:zl(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}exists(e){return Ot(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield cw(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r)&&r instanceof Fl){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],l=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const u=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});h!==""&&a.push(h);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${r}${f}`)}}}remove(e){return Ot(this,void 0,void 0,function*(){try{return{data:yield mf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}list(e,t,r){return Ot(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},dw),t),{prefix:e||""});return{data:yield Ss(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}listV2(e,t){return Ot(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Ss(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const hw="2.12.1",mw={"X-Client-Info":`storage-js/${hw}`};var fn=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,[])).next())})};class fw{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const l=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},mw),t),this.fetch=hf(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return fn(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ft(e))return{data:null,error:e};throw e}})}getBucket(e){return fn(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return fn(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return fn(this,void 0,void 0,function*(){try{return{data:yield Bl(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ft(r))return{data:null,error:r};throw r}})}emptyBucket(e){return fn(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}deleteBucket(e){return fn(this,void 0,void 0,function*(){try{return{data:yield mf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ft(t))return{data:null,error:t};throw t}})}}class pw extends fw{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new uw(this.url,this.headers,e,this.fetch)}}const gw="2.57.4";let fi="";typeof Deno<"u"?fi="deno":typeof document<"u"?fi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?fi="react-native":fi="node";const xw={"X-Client-Info":`supabase-js-${fi}/${gw}`},vw={headers:xw},yw={schema:"public"},bw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_w={};var ww=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,e||[])).next())})};const jw=i=>{let e;return i?e=i:typeof fetch>"u"?e=Ym:e=fetch,(...t)=>e(...t)},Nw=()=>typeof Headers>"u"?Qm:Headers,Sw=(i,e,t)=>{const r=jw(t),a=Nw();return(l,c)=>ww(void 0,void 0,void 0,function*(){var u;const h=(u=yield e())!==null&&u!==void 0?u:i;let f=new a(c==null?void 0:c.headers);return f.has("apikey")||f.set("apikey",i),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),r(l,Object.assign(Object.assign({},c),{headers:f}))})};var Pw=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,[])).next())})};function kw(i){return i.endsWith("/")?i:i+"/"}function Cw(i,e){var t,r;const{db:a,auth:l,realtime:c,global:u}=i,{db:h,auth:f,realtime:p,global:g}=e,y={db:Object.assign(Object.assign({},h),a),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},g),u),{headers:Object.assign(Object.assign({},(t=g==null?void 0:g.headers)!==null&&t!==void 0?t:{}),(r=u==null?void 0:u.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Pw(this,void 0,void 0,function*(){return""})};return i.accessToken?y.accessToken=i.accessToken:delete y.accessToken,y}function Tw(i){const e=i==null?void 0:i.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(kw(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const ff="2.71.1",yn=30*1e3,ql=3,cl=ql*yn,Ow="http://localhost:9999",Iw="supabase.auth.token",Aw={"X-Client-Info":`gotrue-js/${ff}`},Hl="X-Supabase-Api-Version",pf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ew=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lw=10*60*1e3;class Sc extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ne(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class Mw extends Sc{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Dw(i){return Ne(i)&&i.name==="AuthApiError"}class gf extends Sc{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class yr extends Sc{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class ar extends yr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Rw(i){return Ne(i)&&i.name==="AuthSessionMissingError"}class ga extends yr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xa extends yr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class va extends yr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $w(i){return Ne(i)&&i.name==="AuthImplicitGrantRedirectError"}class Iu extends yr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Wl extends yr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function dl(i){return Ne(i)&&i.name==="AuthRetryableFetchError"}class Au extends yr{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Vl extends yr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ia="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Eu=` 	
\r=`.split(""),Uw=(()=>{const i=new Array(128);for(let e=0;e<i.length;e+=1)i[e]=-1;for(let e=0;e<Eu.length;e+=1)i[Eu[e].charCodeAt(0)]=-2;for(let e=0;e<Ia.length;e+=1)i[Ia[e].charCodeAt(0)]=e;return i})();function Lu(i,e,t){if(i!==null)for(e.queue=e.queue<<8|i,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ia[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ia[r]),e.queuedBits-=6}}function xf(i,e,t){const r=Uw[i];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Mu(i){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{Bw(c,r,t)};for(let c=0;c<i.length;c+=1)xf(i.charCodeAt(c),a,l);return e.join("")}function Fw(i,e){if(i<=127){e(i);return}else if(i<=2047){e(192|i>>6),e(128|i&63);return}else if(i<=65535){e(224|i>>12),e(128|i>>6&63),e(128|i&63);return}else if(i<=1114111){e(240|i>>18),e(128|i>>12&63),e(128|i>>6&63),e(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function zw(i,e){for(let t=0;t<i.length;t+=1){let r=i.charCodeAt(t);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(i.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}Fw(r,e)}}function Bw(i,e,t){if(e.utf8seq===0){if(i<=127){t(i);return}for(let r=1;r<6;r+=1)if(!(i>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=i&31;else if(e.utf8seq===3)e.codepoint=i&15;else if(e.utf8seq===4)e.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|i&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function qw(i){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<i.length;a+=1)xf(i.charCodeAt(a),t,r);return new Uint8Array(e)}function Hw(i){const e=[];return zw(i,t=>e.push(t)),new Uint8Array(e)}function Ww(i){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};return i.forEach(a=>Lu(a,t,r)),Lu(null,t,r),e.join("")}function Vw(i){return Math.round(Date.now()/1e3)+i}function Zw(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const is=()=>typeof window<"u"&&typeof document<"u",Tr={tested:!1,writable:!1},vf=()=>{if(!is())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Tr.tested)return Tr.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Tr.tested=!0,Tr.writable=!0}catch{Tr.tested=!0,Tr.writable=!1}return Tr.writable};function Gw(i){const e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((r,a)=>{e[a]=r}),e}const yf=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>Bn);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Jw=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",bn=async(i,e,t)=>{await i.setItem(e,JSON.stringify(t))},Or=async(i,e)=>{const t=await i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},nr=async(i,e)=>{await i.removeItem(e)};class so{constructor(){this.promise=new so.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}so.promiseConstructor=Promise;function ul(i){const e=i.split(".");if(e.length!==3)throw new Vl("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Ew.test(e[r]))throw new Vl("JWT not in base64url format");return{header:JSON.parse(Mu(e[0])),payload:JSON.parse(Mu(e[1])),signature:qw(e[2]),raw:{header:e[0],payload:e[1]}}}async function Kw(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function Yw(i,e){return new Promise((r,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await i(l);if(!e(l,null,c)){r(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function Qw(i){return("0"+i.toString(16)).substr(-2)}function Xw(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,Qw).join("")}async function ej(i){const t=new TextEncoder().encode(i),r=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(r);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function tj(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const t=await ej(i);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function pn(i,e,t=!1){const r=Xw();let a=r;t&&(a+="/PASSWORD_RECOVERY"),await bn(i,`${e}-code-verifier`,a);const l=await tj(r);return[l,r===l?"plain":"s256"]}const sj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rj(i){const e=i.headers.get(Hl);if(!e||!e.match(sj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function nj(i){if(!i)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(i<=e)throw new Error("JWT has expired")}function ij(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const aj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function gn(i){if(!aj.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hl(){const i={};return new Proxy(i,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Du(i){return JSON.parse(JSON.stringify(i))}var oj=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(i);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(i,r[a])&&(t[r[a]]=i[r[a]]);return t};const Ir=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),lj=[502,503,504];async function Ru(i){var e;if(!Jw(i))throw new Wl(Ir(i),0);if(lj.includes(i.status))throw new Wl(Ir(i),i.status);let t;try{t=await i.json()}catch(l){throw new gf(Ir(l),l)}let r;const a=rj(i);if(a&&a.getTime()>=pf["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Au(Ir(t),i.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ar}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Au(Ir(t),i.status,t.weak_password.reasons);throw new Mw(Ir(t),i.status||500,r)}const cj=(i,e,t,r)=>{const a={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),t))};async function Ce(i,e,t,r){var a;const l=Object.assign({},r==null?void 0:r.headers);l[Hl]||(l[Hl]=pf["2024-01-01"].name),r!=null&&r.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(c.redirect_to=r.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await dj(i,e,t+u,{headers:l,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(h):{data:Object.assign({},h),error:null}}async function dj(i,e,t,r,a,l){const c=cj(e,r,a,l);let u;try{u=await i(t,Object.assign({},c))}catch(h){throw console.error(h),new Wl(Ir(h),0)}if(u.ok||await Ru(u),r!=null&&r.noResolveJson)return u;try{return await u.json()}catch(h){await Ru(h)}}function Hs(i){var e;let t=null;fj(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=Vw(i.expires_in)));const r=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:r},error:null}}function $u(i){const e=Hs(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=i.weak_password),e}function or(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function uj(i){return{data:i,error:null}}function hj(i){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:l}=i,c=oj(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function mj(i){return i}function fj(i){return i.access_token&&i.refresh_token&&i.expires_in}const ml=["global","local","others"];var pj=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(i);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(i,r[a])&&(t[r[a]]=i[r[a]]);return t};class gj{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=yf(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ml[0]){if(ml.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ml.join(", ")}`);try{return await Ce(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Ce(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:or})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=pj(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Ce(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:hj,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ne(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ce(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:or})}catch(t){if(Ne(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,a,l,c,u,h;try{const f={nextPage:null,lastPage:0,total:0},p=await Ce(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:mj});if(p.error)throw p.error;const g=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(P=>{const b=parseInt(P.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(P.split(";")[1].split("=")[1]);f[`${j}Page`]=b}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(Ne(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){gn(e);try{return await Ce(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:or})}catch(t){if(Ne(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){gn(e);try{return await Ce(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:or})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){gn(e);try{return await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:or})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){gn(e.userId);try{const{data:t,error:r}=await Ce(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:r}}catch(t){if(Ne(t))return{data:null,error:t};throw t}}async _deleteFactor(e){gn(e.userId),gn(e.id);try{return{data:await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ne(t))return{data:null,error:t};throw t}}}function Uu(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}function xj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xn={debug:!!(globalThis&&vf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bf extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vj extends bf{}async function yj(i,e,t){xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),xn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,a.name);try{return await t()}finally{xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,a.name)}}else{if(e===0)throw xn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new vj(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(xn.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}xj();const bj={url:Ow,storageKey:Iw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Aw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Fu(i,e,t){return await t()}const vn={};class ki{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ki.nextInstanceID,ki.nextInstanceID+=1,this.instanceID>0&&is()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},bj),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new gj({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=yf(a.fetch),this.lock=a.lock||Fu,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:is()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=yj:this.lock=Fu,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:vf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Uu(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Uu(this.memoryStorage)),is()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=vn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){vn[this.storageKey]=Object.assign(Object.assign({},vn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=vn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){vn[this.storageKey]=Object.assign(Object.assign({},vn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ff}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Gw(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),is()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),$w(l)){const h=(e=l.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ne(t)?{error:t}:{error:new gf("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{const l=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Hs}),{data:c,error:u}=l;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(l){if(Ne(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(e){var t,r,a;try{let l;if("email"in e){const{email:p,password:g,options:y}=e;let _=null,P=null;this.flowType==="pkce"&&([_,P]=await pn(this.storage,this.storageKey)),l=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y==null?void 0:y.emailRedirectTo,body:{email:p,password:g,data:(t=y==null?void 0:y.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},code_challenge:_,code_challenge_method:P},xform:Hs})}else if("phone"in e){const{phone:p,password:g,options:y}=e;l=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(r=y==null?void 0:y.data)!==null&&r!==void 0?r:{},channel:(a=y==null?void 0:y.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken}},xform:Hs})}else throw new xa("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(l){if(Ne(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:u}=e;t=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:$u})}else if("phone"in e){const{phone:l,password:c,options:u}=e;t=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:$u})}else throw new xa("You must provide either an email or phone number and a password");const{data:r,error:a}=t;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ga}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,a,l,c,u,h,f,p,g,y,_;let P,b;if("message"in e)P=e.message,b=e.signature;else{const{chain:j,wallet:S,statement:k,options:N}=e;let T;if(is())if(typeof S=="object")T=S;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))T=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const O=new URL((t=N==null?void 0:N.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in T&&T.signIn){const E=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),k?{statement:k}:null));let I;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")I=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)I=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)P=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),b=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");P=[`${O.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(a=(r=N==null?void 0:N.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=N==null?void 0:N.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((h=N==null?void 0:N.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((f=N==null?void 0:N.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((g=(p=N==null?void 0:N.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...N.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const E=await T.signMessage(new TextEncoder().encode(P),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=E}}try{const{data:j,error:S}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:P,signature:Ww(b)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Hs});if(S)throw S;return!j||!j.session||!j.user?{data:{user:null,session:null},error:new ga}:(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),{data:Object.assign({},j),error:S})}catch(j){if(Ne(j))return{data:{user:null,session:null},error:j};throw j}}async _exchangeCodeForSession(e){const t=await Or(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(t??"").split("/");try{const{data:l,error:c}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Hs});if(await nr(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new ga}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(Ne(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(e){try{const{options:t,provider:r,token:a,access_token:l,nonce:c}=e,u=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Hs}),{data:h,error:f}=u;return f?{data:{user:null,session:null},error:f}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new ga}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:f})}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,a,l,c;try{if("email"in e){const{email:u,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await pn(this.storage,this.storageKey));const{error:g}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},create_user:(r=h==null?void 0:h.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in e){const{phone:u,options:h}=e,{data:f,error:p}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},create_user:(l=h==null?void 0:h.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(c=h==null?void 0:h.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:p}}throw new xa("You must provide either an email or phone number.")}catch(u){if(Ne(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(e){var t,r;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:u}=await Ce(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Hs});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,f=c.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(a){if(Ne(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var t,r,a;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await pn(this.storage,this.storageKey)),await Ce(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:uj})}catch(l){if(Ne(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ar;const{error:a}=await Ce(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(Ne(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:l}=e,{error:c}=await Ce(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:r,type:a,options:l}=e,{data:c,error:u}=await Ce(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new xa("You must provide either an email or phone number and a type")}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Or(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<cl:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await Or(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=hl()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(h,f,p)=>(!c&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,f,p))})}return{data:{session:e},error:null}}const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:or}):await this._useSession(async t=>{var r,a,l;const{data:c,error:u}=t;if(u)throw u;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ar}:await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:or})})}catch(t){if(Ne(t))return Rw(t)&&(await this._removeSession(),await nr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:a,error:l}=r;if(l)throw l;if(!a.session)throw new ar;const c=a.session;let u=null,h=null;this.flowType==="pkce"&&e.email!=null&&([u,h]=await pn(this.storage,this.storageKey));const{data:f,error:p}=await Ce(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:or});if(p)throw p;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ar;const t=Date.now()/1e3;let r=t,a=!0,l=null;const{payload:c}=ul(e.access_token);if(c.exp&&(r=c.exp,a=r<=t),a){const{session:u,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(e.access_token);if(h)throw h;l={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(Ne(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:u}=t;if(u)throw u;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ar;const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!is())throw new va("No browser detected.");if(e.error||e.error_description||e.error_code)throw new va(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Iu("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new va("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Iu("No code detected.");const{data:k,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:f}=e;if(!l||!u||!c||!f)throw new va("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(u);let y=p+g;h&&(y=parseInt(h));const _=y-p;_*1e3<=yn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${g}s`);const P=y-g;p-P>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",P,y,p):p-P<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",P,y,p);const{data:b,error:j}=await this._getUser(l);if(j)throw j;const S={provider_token:r,provider_refresh_token:a,access_token:l,expires_in:g,expires_at:y,refresh_token:c,token_type:f,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:e.type},error:null}}catch(r){if(Ne(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Or(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return{error:l};const c=(r=a.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:u}=await this.admin.signOut(c,e);if(u&&!(Dw(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return e!=="others"&&(await this._removeSession(),await nr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Zw(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await pn(this.storage,this.storageKey,!0));try{return await Ce(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(Ne(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Ne(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:a}=await this._useSession(async l=>{var c,u,h,f,p;const{data:g,error:y}=l;if(y)throw y;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Ce(this.fetch,"GET",_,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(a)throw a;return is()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ne(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;const{data:l,error:c}=t;if(c)throw c;return await Ce(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(Ne(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Yw(async a=>(a>0&&await Kw(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Ce(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Hs})),(a,l)=>{const c=200*Math.pow(2,a);return l&&dl(l)&&Date.now()+c-r<yn})}catch(r){if(this._debug(t,"error",r),Ne(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),is()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await Or(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Or(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await bn(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:hl()}else if(a&&!a.user&&!a.user){const c=await Or(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await nr(this.storage,this.storageKey+"-user"),await bn(this.storage,this.storageKey,a)):a.user=hl()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<cl;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${cl}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),dl(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(a.access_token);!u&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ar;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new so;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new ar;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={session:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(a,"error",l),Ne(l)){const c={session:null,error:l};return dl(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,t)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await bn(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Du(a);await bn(this.storage,this.storageKey,l)}else{const a=Du(t);await bn(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await nr(this.storage,this.storageKey),await nr(this.storage,this.storageKey+"-code-verifier"),await nr(this.storage,this.storageKey+"-user"),this.userStorage&&await nr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&is()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),yn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/yn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${yn}ms, refresh threshold is ${ql} ticks`),a<=ql&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bf)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!is()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const a=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await pn(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(u.toString())}if(r!=null&&r.queryParams){const l=new URLSearchParams(r.queryParams);a.push(l.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;return l?{data:null,error:l}:await Ce(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ne(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;const{data:l,error:c}=t;if(c)return{data:null,error:c};const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:h,error:f}=await Ce(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(r=l==null?void 0:l.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((a=h==null?void 0:h.totp)===null||a===void 0)&&a.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(t){if(Ne(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:u}=await Ce(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:u})})}catch(t){if(Ne(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;return l?{data:null,error:l}:await Ce(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ne(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],a=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:a},error:l}=e;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=ul(a.access_token);let u=null;c.aal&&(u=c.aal);let h=u;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(h="aal2");const p=c.amr||[];return{data:{currentLevel:u,nextLevel:h,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(u=>u.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(u=>u.kid===e),r&&this.jwks_cached_at+Lw>a)return r;const{data:l,error:c}=await Ce(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,r=l.keys.find(u=>u.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:_,error:P}=await this.getSession();if(P||!_.session)return{data:null,error:P};r=_.session.access_token}const{header:a,payload:l,signature:c,raw:{header:u,payload:h}}=ul(r);t!=null&&t.allowExpired||nj(l.exp);const f=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!f){const{error:_}=await this.getUser(r);if(_)throw _;return{data:{claims:l,header:a,signature:c},error:null}}const p=ij(a.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,c,Hw(`${u}.${h}`)))throw new Vl("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}}ki.nextInstanceID=0;const _j=ki;class wj extends _j{constructor(e){super(e)}}var jj=function(i,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):a(p.value).then(u,h)}f((r=r.apply(i,[])).next())})};class Nj{constructor(e,t,r){var a,l,c;this.supabaseUrl=e,this.supabaseKey=t;const u=Tw(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const h=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:yw,realtime:_w,auth:Object.assign(Object.assign({},bw),{storageKey:h}),global:vw},p=Cw(r??{},f);this.storageKey=(a=p.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(g,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=Sw(t,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new U_(new URL("rest/v1",u).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new pw(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new x_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return jj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:l,storageKey:c,flowType:u,lock:h,debug:f},p,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wj({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),p),storageKey:c,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:l,flowType:u,lock:h,debug:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new sw(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _f=(i,e,t)=>new Nj(i,e,t);function Sj(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const e=i.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Sj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Pj="https://your-project-ref.supabase.co",kj="your-anon-key-here",ut=_f(Pj,kj);ut?console.log(" Supabase client initialized successfully"):(console.warn(" Supabase client not initialized. Setup required:"),console.log(" Setup Instructions:"),console.log("1. Go to https://supabase.com and create a project"),console.log("2. Copy your project URL and anon key from Settings > API"),console.log("3. Update .env file with real values"),console.log("4. Run the supabase-schema.sql in your Supabase SQL editor"),console.log("VITE_SUPABASE_URL:"," Present"),console.log("VITE_SUPABASE_ANON_KEY:"," Present"));const St={async getProducts(){if(!ut)return console.error(" Supabase not initialized"),[];try{console.log(" Fetching products from Supabase database...");const{data:i,error:e}=await ut.from("products").select("*").order("created_at",{ascending:!1});return e?(console.error(" Database error fetching products:",e),[]):(console.log(` Retrieved ${(i==null?void 0:i.length)||0} products from database`),(i==null?void 0:i.map(t=>({id:t.id,name:t.name,description:t.description,price:parseFloat(t.price),imageUrl:t.image_url,category:t.category,stockQuantity:t.stock_quantity,isActive:t.is_active})))||[])}catch(i){return console.error(" Exception fetching products:",i),[]}},async createProduct(i){if(!ut)return console.error(" Supabase not initialized"),null;try{console.log(" Inserting product into database:",i.name);const{data:e,error:t}=await ut.from("products").insert({name:i.name,description:i.description,price:i.price,category:i.category,image_url:i.imageUrl,stock_quantity:i.stockQuantity,is_active:i.isActive,sku:`SKU_${Date.now()}`,unit:"kg"}).select().single();return t?(console.error(" Database error creating product:",t),null):(console.log(" Product created in database with ID:",e.id),{id:e.id,name:e.name,description:e.description,price:parseFloat(e.price),imageUrl:e.image_url,category:e.category,stockQuantity:e.stock_quantity,isActive:e.is_active})}catch(e){return console.error(" Exception creating product:",e),null}},async updateProduct(i,e){if(!ut)return null;try{console.log(" Updating product in database:",i);const t={updated_at:new Date().toISOString()};e.name&&(t.name=e.name),e.description&&(t.description=e.description),e.price&&(t.price=e.price),e.category&&(t.category=e.category),e.imageUrl&&(t.image_url=e.imageUrl),e.stockQuantity!==void 0&&(t.stock_quantity=e.stockQuantity),e.isActive!==void 0&&(t.is_active=e.isActive);const{data:r,error:a}=await ut.from("products").update(t).eq("id",i).select().single();return a?(console.error(" Database error updating product:",a),null):(console.log(" Product updated in database"),{id:r.id,name:r.name,description:r.description,price:parseFloat(r.price),imageUrl:r.image_url,category:r.category,stockQuantity:r.stock_quantity,isActive:r.is_active})}catch(t){return console.error(" Exception updating product:",t),null}},async createOrder(i){if(!ut)return null;try{const e=`ORD_${Date.now()}`;console.log(" Creating order in database:",e);const{data:t,error:r}=await ut.from("orders").insert({order_id:e,customer_name:i.customerName,customer_phone:i.customerPhone,delivery_address:i.deliveryAddress,total:i.total,status:i.status||"confirmed",payment_status:i.paymentStatus||"paid"}).select().single();if(r)return console.error(" Database error creating order:",r),null;if(i.items&&i.items.length>0){const{error:a}=await ut.from("order_items").insert(i.items.map(l=>({order_id:t.id,product_id:parseInt(l.productId)||0,product_name:l.productName,price:l.price,quantity:l.quantity,total:l.price*l.quantity})));a?console.error(" Database error creating order items:",a):console.log(" Order items created in database")}return await ut.from("customers").upsert({name:i.customerName,phone:i.customerPhone,address:i.deliveryAddress},{onConflict:"phone"}),console.log(" Order created in database with ID:",t.id),{id:t.id,orderId:t.order_id,customerName:t.customer_name,customerPhone:t.customer_phone,deliveryAddress:t.delivery_address,total:t.total,status:t.status,paymentStatus:t.payment_status,items:i.items,createdAt:t.created_at}}catch(e){return console.error(" Exception creating order:",e),null}},async getOrders(){if(!ut)return[];try{console.log(" Fetching orders from database...");const{data:i,error:e}=await ut.from("orders").select(`
          *,
          order_items (
            id,
            product_id,
            product_name,
            price,
            quantity,
            total
          )
        `).order("created_at",{ascending:!1});return e?(console.error(" Database error fetching orders:",e),[]):(console.log(` Retrieved ${(i==null?void 0:i.length)||0} orders from database`),(i==null?void 0:i.map(t=>({id:t.id,orderId:t.order_id,customerName:t.customer_name,customerPhone:t.customer_phone,deliveryAddress:t.delivery_address,total:parseFloat(t.total),status:t.status,paymentStatus:t.payment_status,items:t.order_items||[],createdAt:t.created_at})))||[])}catch(i){return console.error(" Exception fetching orders:",i),[]}},async updateOrderStatus(i,e){if(!ut)return!1;try{console.log(" Updating order status in database:",i,"",e);const{error:t}=await ut.from("orders").update({status:e,updated_at:new Date().toISOString()}).eq("id",i);return t?(console.error(" Database error updating order status:",t),!1):(console.log(" Order status updated in database"),!0)}catch(t){return console.error(" Exception updating order status:",t),!1}},async getCategories(){if(!ut)return[];try{const{data:i,error:e}=await ut.from("categories").select("*").eq("is_active",!0);return e?[{id:1,name:"Grains",slug:"grains",isActive:!0},{id:2,name:"Pulses",slug:"pulses",isActive:!0},{id:3,name:"Oil",slug:"oil",isActive:!0},{id:4,name:"Dairy",slug:"dairy",isActive:!0},{id:5,name:"Vegetables",slug:"vegetables",isActive:!0},{id:6,name:"Fruits",slug:"fruits",isActive:!0}]:(i==null?void 0:i.map(t=>({id:t.id,name:t.name,slug:t.name.toLowerCase(),isActive:t.is_active})))||[]}catch(i){return console.error(" Exception fetching categories:",i),[]}},async createCustomer(i){if(!ut)return null;try{console.log(" Creating customer in database:",i.name);const{data:e,error:t}=await ut.from("customers").upsert(i,{onConflict:"phone"}).select().single();return t?(console.error(" Database error creating customer:",t),null):(console.log(" Customer created in database"),e)}catch(e){return console.error(" Exception creating customer:",e),null}}},Cj=!0,Tj="https://your-project-ref.supabase.co".includes("supabase.co"),Qe=Tj,Oj=Qe?"Supabase (Production)":"Local Development",zu=Qe?"/api/supabase":"http://localhost:5000/api",Bs=Qe?"supabase":"mysql";console.log(` Database: ${Oj} | Host: ${window.location.hostname}`);!Qe&&Cj&&console.warn(" Production detected but Supabase not configured!");const Nn={async getProducts(){return Qe?await St.getProducts():await ce.getProducts()},async createProduct(i){return Qe?await St.createProduct(i):await ce.createProduct(i)},async updateProduct(i,e){return Qe?await St.updateProduct(i,e):await ce.updateProduct(i,e)},async getOrders(){return Qe?await St.getOrders():await ce.getOrders()},async createOrder(i){return Qe?await St.createOrder(i):await ce.createOrder(i)},async updateOrderStatus(i,e){return Qe?await St.updateOrderStatus(i,e):await ce.updateOrderStatus(i,e)},async createCustomer(i){return Qe?await St.createCustomer(i):await ce.createCustomer(i)},async getCategories(){return Qe?await St.getCategories():await ce.getCategories()}};class Ij{async request(e,t){if(Qe&&Bs==="supabase")throw new Error("Use Supabase client methods for production");try{console.log(`Making API request to: ${zu}${e}`);const r=await fetch(`${zu}${e}`,{headers:{"Content-Type":"application/json",...t==null?void 0:t.headers},...t});if(!r.ok){const l=await r.text();throw console.error(`API Error ${r.status}:`,l),new Error(`API Error: ${r.status} ${r.statusText}`)}const a=await r.json();return console.log(`API Response for ${e}:`,a),a}catch(r){if(window.location.hostname==="localhost")return console.warn(`API Request failed for ${e}, using mock data:`,r),this.getMockData(e);throw console.error(`Production API Request failed for ${e}:`,r),r}}async getProducts(){return Qe&&Bs==="supabase"?St.getProducts():this.request("/products")}async createProduct(e){return Qe&&Bs==="supabase"?St.createProduct(e):this.request("/products",{method:"POST",body:JSON.stringify(e)})}async updateProduct(e,t){return Qe&&Bs==="supabase"?St.updateProduct(e,t):this.request(`/products/${e}`,{method:"PUT",body:JSON.stringify(t)})}getMockData(e){const t=new Date().toISOString(),r={"/products":[{id:1,name:"Fresh Tomatoes",price:40,category:"Vegetables",stockQuantity:100,isActive:!0,description:"Fresh red tomatoes",imageUrl:"/api/placeholder/300/200",createdAt:t},{id:2,name:"Basmati Rice",price:120,category:"Grains",stockQuantity:50,isActive:!0,description:"Premium basmati rice",imageUrl:"/api/placeholder/300/200",createdAt:t},{id:3,name:"Organic Milk",price:60,category:"Dairy",stockQuantity:30,isActive:!0,description:"Fresh organic milk",imageUrl:"/api/placeholder/300/200",createdAt:t}],"/orders":[{id:1,orderId:"ORD001",customerName:"John Doe",customerPhone:"9876543210",deliveryAddress:"123 Main St, Shirpur",total:250,status:"out_for_delivery",paymentStatus:"paid",items:[{id:1,productId:1,productName:"Fresh Tomatoes",price:40,quantity:2},{id:2,productId:2,productName:"Basmati Rice",price:120,quantity:1}],createdAt:t},{id:2,orderId:"ORD002",customerName:"Jane Smith",customerPhone:"9876543211",deliveryAddress:"456 Oak Ave, Shirpur",total:180,status:"pending",paymentStatus:"pending",items:[{id:3,productId:3,productName:"Organic Milk",price:60,quantity:3}],createdAt:t}],"/categories":[{id:1,name:"Vegetables",slug:"vegetables",isActive:!0,createdAt:t},{id:2,name:"Grains",slug:"grains",isActive:!0,createdAt:t},{id:3,name:"Dairy",slug:"dairy",isActive:!0,createdAt:t}],"/analytics/dashboard":{totalOrders:2,totalRevenue:430,pendingOrders:1,completedOrders:1,totalProducts:3,lowStockProducts:0}};return console.log(`Returning mock data for ${e}:`,r[e]||[]),r[e]||[]}async getOrders(){return Qe&&Bs==="supabase"?St.getOrders():this.request("/orders")}async createOrder(e){return Qe&&Bs==="supabase"?St.createOrder(e):this.request("/orders",{method:"POST",body:JSON.stringify(e)})}async updateOrderStatus(e,t){if(Qe&&Bs==="supabase"){await St.updateOrderStatus(e,t);return}await this.request(`/orders/${e}/status`,{method:"PUT",body:JSON.stringify({status:t})})}async getCategories(){return Qe&&Bs==="supabase"?St.getCategories():this.request("/categories")}async createCustomer(e){return Qe&&Bs==="supabase"?St.createCustomer(e):this.request("/customers",{method:"POST",body:JSON.stringify(e)})}async getProduct(e){return this.request(`/products/${e}`)}async deleteProduct(e){await this.request(`/products/${e}`,{method:"DELETE"})}async getOrder(e){return this.request(`/orders/${e}`)}async updateOrder(e,t){return this.request(`/orders/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteOrder(e){await this.request(`/orders/${e}`,{method:"DELETE"})}async getCustomers(){return this.request("/customers")}async getCustomer(e){return this.request(`/customers/${e}`)}async updateCustomer(e,t){return this.request(`/customers/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteCustomer(e){await this.request(`/customers/${e}`,{method:"DELETE"})}async getDeliveryAgents(){return this.request("/delivery-agents")}async getDeliveryAgent(e){return this.request(`/delivery-agents/${e}`)}async createDeliveryAgent(e){return this.request("/delivery-agents",{method:"POST",body:JSON.stringify(e)})}async updateDeliveryAgent(e,t){return this.request(`/delivery-agents/${e}`,{method:"PUT",body:JSON.stringify(t)})}async updateDeliveryLocation(e,t,r){await this.request(`/delivery-agents/${e}/location`,{method:"PUT",body:JSON.stringify({latitude:t,longitude:r})})}async deleteDeliveryAgent(e){await this.request(`/delivery-agents/${e}`,{method:"DELETE"})}async getCategory(e){return this.request(`/categories/${e}`)}async createCategory(e){return this.request("/categories",{method:"POST",body:JSON.stringify(e)})}async updateCategory(e,t){return this.request(`/categories/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteCategory(e){await this.request(`/categories/${e}`,{method:"DELETE"})}async getDashboardStats(){return this.request("/analytics/dashboard")}async getOrdersByStatus(e){return this.request(`/orders?status=${e}`)}async getOrdersByDateRange(e,t){return this.request(`/orders?startDate=${e}&endDate=${t}`)}async bulkCreateProducts(e){return this.request("/products/bulk",{method:"POST",body:JSON.stringify(e)})}async bulkUpdateProducts(e){return this.request("/products/bulk",{method:"PUT",body:JSON.stringify(e)})}}const ce=new Ij;class De{static saveData(e,t){const r={data:t,timestamp:Date.now(),version:"1.0"};localStorage.setItem(e,JSON.stringify(r))}static getData(e){const t=localStorage.getItem(e);if(!t)return null;try{const r=JSON.parse(t);return r.data||r}catch{return null}}static async syncData(e,t){try{const r=await t();return this.saveData(e,r),r}catch(r){return console.warn(`API sync failed for ${e}, using cached data:`,r),this.getData(e)||[]}}static clearCache(){["products","orders","customers","deliveryAgents","categories"].forEach(t=>localStorage.removeItem(t))}}class Aj{async getCurrentUserPhone(){try{const e=yt.getCurrentUser();return(e==null?void 0:e.phone)||"guest"}catch{return"guest"}}async getCartItems(){try{const e=await this.getCurrentUserPhone();if(!e)return[];const t=localStorage.getItem(`cart_${e}`);return t?JSON.parse(t):[]}catch(e){return console.error("Failed to get cart items:",e),[]}}async addToCart(e,t=1){try{const r=await this.getCurrentUserPhone();if(!r)return!1;const a=`cart_${r}`,l=JSON.parse(localStorage.getItem(a)||"[]"),c=l.find(u=>u.product.id===e);if(c)c.quantity+=t;else{const h=(await ce.getProducts()).find(f=>f.id.toString()===e);h&&l.push({id:Date.now(),product:{id:e,name:h.name,price:h.price,image_url:h.imageUrl,stock_qty:h.stockQuantity},quantity:t})}return localStorage.setItem(a,JSON.stringify(l)),!0}catch(r){return console.error("Failed to add to cart:",r),!1}}async updateCartQuantity(e,t){try{const r=await this.getCurrentUserPhone();if(!r)return!1;if(t<=0)return await this.removeFromCart(e);const a=`cart_${r}`,l=JSON.parse(localStorage.getItem(a)||"[]"),c=l.find(u=>u.product.id===e);return c&&(c.quantity=t,localStorage.setItem(a,JSON.stringify(l))),!0}catch(r){return console.error("Failed to update cart quantity:",r),!1}}async removeFromCart(e){try{const t=await this.getCurrentUserPhone();if(!t)return!1;const r=`cart_${t}`,l=JSON.parse(localStorage.getItem(r)||"[]").filter(c=>c.product.id!==e);return localStorage.setItem(r,JSON.stringify(l)),!0}catch(t){return console.error("Failed to remove from cart:",t),!1}}async clearCart(){try{const e=await this.getCurrentUserPhone();return e?(localStorage.removeItem(`cart_${e}`),!0):!1}catch(e){return console.error("Failed to clear cart:",e),!1}}async getCartTotal(){return(await this.getCartItems()).reduce((t,r)=>t+r.product.price*r.quantity,0)}async getCartItemCount(){return(await this.getCartItems()).reduce((t,r)=>t+r.quantity,0)}}const Zt=new Aj,Ej=Sx,Lj=Px,Mj=v.forwardRef(({className:i,inset:e,children:t,...r},a)=>s.jsxs(bh,{ref:a,className:se("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",i),...r,children:[t,s.jsx(sm,{className:"ml-auto h-4 w-4"})]}));Mj.displayName=bh.displayName;const Dj=v.forwardRef(({className:i,...e},t)=>s.jsx(_h,{ref:t,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i),...e}));Dj.displayName=_h.displayName;const wf=v.forwardRef(({className:i,sideOffset:e=4,...t},r)=>s.jsx(Nx,{children:s.jsx(wh,{ref:r,sideOffset:e,className:se("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",i),...t})}));wf.displayName=wh.displayName;const jf=v.forwardRef(({className:i,inset:e,...t},r)=>s.jsx(jh,{ref:r,className:se("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",i),...t}));jf.displayName=jh.displayName;const Rj=v.forwardRef(({className:i,children:e,checked:t,...r},a)=>s.jsxs(Nh,{ref:a,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",i),checked:t,...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Sh,{children:s.jsx(em,{className:"h-4 w-4"})})}),e]}));Rj.displayName=Nh.displayName;const $j=v.forwardRef(({className:i,children:e,...t},r)=>s.jsxs(Ph,{ref:r,className:se("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",i),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Sh,{children:s.jsx(Pv,{className:"h-2 w-2 fill-current"})})}),e]}));$j.displayName=Ph.displayName;const Nf=v.forwardRef(({className:i,inset:e,...t},r)=>s.jsx(kh,{ref:r,className:se("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",i),...t}));Nf.displayName=kh.displayName;const Sf=v.forwardRef(({className:i,...e},t)=>s.jsx(Ch,{ref:t,className:se("-mx-1 my-1 h-px bg-muted",i),...e}));Sf.displayName=Ch.displayName;var Pf={exports:{}},kf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rn=v;function Uj(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Fj=typeof Object.is=="function"?Object.is:Uj,zj=Rn.useState,Bj=Rn.useEffect,qj=Rn.useLayoutEffect,Hj=Rn.useDebugValue;function Wj(i,e){var t=e(),r=zj({inst:{value:t,getSnapshot:e}}),a=r[0].inst,l=r[1];return qj(function(){a.value=t,a.getSnapshot=e,fl(a)&&l({inst:a})},[i,t,e]),Bj(function(){return fl(a)&&l({inst:a}),i(function(){fl(a)&&l({inst:a})})},[i]),Hj(t),t}function fl(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Fj(i,t)}catch{return!0}}function Vj(i,e){return e()}var Zj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Vj:Wj;kf.useSyncExternalStore=Rn.useSyncExternalStore!==void 0?Rn.useSyncExternalStore:Zj;Pf.exports=kf;var Gj=Pf.exports;function Jj(){return Gj.useSyncExternalStore(Kj,()=>!0,()=>!1)}function Kj(){return()=>{}}var Pc="Avatar",[Yj]=Yr(Pc),[Qj,Cf]=Yj(Pc),Tf=v.forwardRef((i,e)=>{const{__scopeAvatar:t,...r}=i,[a,l]=v.useState("idle");return s.jsx(Qj,{scope:t,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:s.jsx(Me.span,{...r,ref:e})})});Tf.displayName=Pc;var Of="AvatarImage",If=v.forwardRef((i,e)=>{const{__scopeAvatar:t,src:r,onLoadingStatusChange:a=()=>{},...l}=i,c=Cf(Of,t),u=Xj(r,l),h=En(f=>{a(f),c.onImageLoadingStatusChange(f)});return Yt(()=>{u!=="idle"&&h(u)},[u,h]),u==="loaded"?s.jsx(Me.img,{...l,ref:e,src:r}):null});If.displayName=Of;var Af="AvatarFallback",Ef=v.forwardRef((i,e)=>{const{__scopeAvatar:t,delayMs:r,...a}=i,l=Cf(Af,t),[c,u]=v.useState(r===void 0);return v.useEffect(()=>{if(r!==void 0){const h=window.setTimeout(()=>u(!0),r);return()=>window.clearTimeout(h)}},[r]),c&&l.imageLoadingStatus!=="loaded"?s.jsx(Me.span,{...a,ref:e}):null});Ef.displayName=Af;function Bu(i,e){return i?e?(i.src!==e&&(i.src=e),i.complete&&i.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Xj(i,{referrerPolicy:e,crossOrigin:t}){const r=Jj(),a=v.useRef(null),l=r?(a.current||(a.current=new window.Image),a.current):null,[c,u]=v.useState(()=>Bu(l,i));return Yt(()=>{u(Bu(l,i))},[l,i]),Yt(()=>{const h=g=>()=>{u(g)};if(!l)return;const f=h("loaded"),p=h("error");return l.addEventListener("load",f),l.addEventListener("error",p),e&&(l.referrerPolicy=e),typeof t=="string"&&(l.crossOrigin=t),()=>{l.removeEventListener("load",f),l.removeEventListener("error",p)}},[l,t,e]),c}var Lf=Tf,Mf=If,Df=Ef;const Rf=v.forwardRef(({className:i,...e},t)=>s.jsx(Lf,{ref:t,className:se("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",i),...e}));Rf.displayName=Lf.displayName;const eN=v.forwardRef(({className:i,...e},t)=>s.jsx(Mf,{ref:t,className:se("aspect-square h-full w-full",i),...e}));eN.displayName=Mf.displayName;const $f=v.forwardRef(({className:i,...e},t)=>s.jsx(Df,{ref:t,className:se("flex h-full w-full items-center justify-center rounded-full bg-muted",i),...e}));$f.displayName=Df.displayName;const $n=()=>{const i=Is(),{toast:e}=Et(),t=yt.getCurrentSession(),r=()=>{if(!t)return{name:"Guest User",phone:"",role:"Guest",icon:s.jsx(Os,{className:"w-4 h-4"}),initials:"GU"};const c=t.name?t.name.split(" ").map(u=>u[0]).join("").toUpperCase():t.phone.slice(-2);switch(t.role){case"customer":return{name:t.name||"Customer",phone:t.phone,role:"Customer",icon:s.jsx(wn,{className:"w-4 h-4"}),initials:c};case"admin":return{name:t.name||"Admin",phone:t.phone,role:"Administrator",icon:s.jsx(Sa,{className:"w-4 h-4"}),initials:c};case"delivery":return{name:t.name||"Delivery Partner",phone:t.phone,role:"Delivery Partner",icon:s.jsx(it,{className:"w-4 h-4"}),initials:c};default:return{name:t.name||"User",phone:t.phone,role:"User",icon:s.jsx(Os,{className:"w-4 h-4"}),initials:c}}},a=()=>{yt.clearSession(),e({title:"Logged out successfully",description:"You have been logged out of your account"}),i("/")},l=r();return s.jsxs(Ej,{children:[s.jsx(Lj,{asChild:!0,children:s.jsx(D,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:s.jsx(Rf,{className:"h-10 w-10",children:s.jsx($f,{className:"bg-primary text-white",children:l.initials})})})}),s.jsxs(wf,{className:"w-56",align:"end",forceMount:!0,children:[s.jsx(Nf,{className:"font-normal",children:s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[l.icon,s.jsx("p",{className:"text-sm font-medium leading-none",children:l.name})]}),s.jsxs("p",{className:"text-xs leading-none text-muted-foreground",children:["+91 ",l.phone]}),s.jsxs("p",{className:"text-xs leading-none text-muted-foreground",children:["Role: ",l.role]})]})}),s.jsx(Sf,{}),s.jsxs(jf,{onClick:a,className:"text-red-600 focus:text-red-600",children:[s.jsx(Ov,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Log out"})]})]})]})},tN=()=>{const[i,e]=v.useState("Getting location..."),t=async(r,a)=>{try{const l=[`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${r}&longitude=${a}&localityLanguage=en`,`https://geocode.xyz/${r},${a}?json=1`,`https://api.opencagedata.com/geocode/v1/json?q=${r}+${a}&key=demo&limit=1`];for(const c of l)try{const h=await(await fetch(c)).json();if(h.locality||h.city)return`${h.locality||h.city}, ${h.principalSubdivision||h.countryName||"India"}`;if(h.city&&h.state)return`${h.city}, ${h.state}`;if(h.results&&h.results[0]){const f=h.results[0].components,p=f.city||f.town||f.village||f.suburb,g=f.state||f.province;if(p&&g)return`${p}, ${g}`}}catch{continue}return`${r.toFixed(3)}, ${a.toFixed(3)}`}catch{return"Location unavailable"}};return v.useEffect(()=>{navigator.geolocation?(e(" Getting location..."),navigator.geolocation.getCurrentPosition(async r=>{const{latitude:a,longitude:l}=r.coords;console.log("GPS Coordinates:",a,l);const c=await t(a,l);console.log("Resolved Address:",c),e(c)},r=>{console.error("Location error:",r),e("Shirpur, Maharashtra")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5})):e("Shirpur, Maharashtra")},[]),s.jsxs("div",{className:"flex items-center space-x-1 text-white/90 text-xs sm:text-sm max-w-40 sm:max-w-64 md:max-w-80",children:[s.jsx(Fe,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:i})]})},sN=({userType:i})=>{const e=Ks(),[t,r]=v.useState(0);v.useEffect(()=>{if(i==="customer"){const l=async()=>{try{const c=await Zt.getCartItemCount();r(c)}catch(c){console.error("Failed to get cart count:",c),r(0)}};return l(),window.addEventListener("cartUpdated",l),()=>window.removeEventListener("cartUpdated",l)}},[i]);const a=l=>e.pathname===l;return i==="customer"?s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg z-50 safe-area-bottom lg:hidden",children:s.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2",children:[s.jsx(_e,{to:"/customer",className:"flex-1",children:s.jsxs(D,{variant:a("/customer")?"default":"ghost",className:`w-full h-14 flex flex-col items-center justify-center gap-1 ${a("/customer")?"bg-blue-500 text-white":"text-gray-600"}`,size:"sm",children:[s.jsx(wl,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs",children:"Catalog"})]})}),s.jsx(_e,{to:"/customer/cart",className:"flex-1",children:s.jsxs(D,{variant:a("/customer/cart")?"default":"ghost",className:`w-full h-14 flex flex-col items-center justify-center gap-1 relative ${a("/customer/cart")?"bg-blue-500 text-white":"text-gray-600"}`,size:"sm",children:[s.jsx(rt,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs",children:"Cart"}),t>0&&s.jsx(X,{className:"absolute -top-1 -right-1 bg-red-500 text-white min-w-[18px] h-4 flex items-center justify-center text-xs",children:t})]})}),s.jsx(_e,{to:"/customer/orders",className:"flex-1",children:s.jsxs(D,{variant:a("/customer/orders")?"default":"ghost",className:`w-full h-14 flex flex-col items-center justify-center gap-1 ${a("/customer/orders")?"bg-blue-500 text-white":"text-gray-600"}`,size:"sm",children:[s.jsx(xe,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs",children:"Orders"})]})}),s.jsx(_e,{to:"/customer/track",className:"flex-1",children:s.jsxs(D,{variant:a("/customer/track")?"default":"ghost",className:`w-full h-14 flex flex-col items-center justify-center gap-1 ${a("/customer/track")?"bg-blue-500 text-white":"text-gray-600"}`,size:"sm",children:[s.jsx(Fe,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs",children:"Track"})]})})]})}):null},rN=()=>{const i=Ks(),[e,t]=v.useState(0);v.useEffect(()=>{const a=async()=>{try{const l=await Zt.getCartItemCount();t(l)}catch(l){console.error("Failed to get cart count:",l),t(0)}};return a(),window.addEventListener("cartUpdated",a),()=>window.removeEventListener("cartUpdated",a)},[]);const r=a=>i.pathname===a;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50",children:[s.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-green-600 text-white shadow-xl safe-area-top",children:s.jsx("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0",children:[s.jsx(_e,{to:"/",className:"text-primary-foreground hover:text-primary-foreground/80 flex-shrink-0",children:s.jsx(Di,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),s.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[s.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-bold truncate",children:" Shirpur Delivery"}),s.jsx(tN,{})]})]}),s.jsxs("div",{className:"hidden lg:flex items-center space-x-4 xl:space-x-6",children:[s.jsxs("nav",{className:"flex items-center space-x-2 xl:space-x-4",children:[s.jsx(_e,{to:"/customer",children:s.jsxs(D,{variant:r("/customer")?"secondary":"ghost",className:r("/customer")?"bg-white text-blue-600":"text-white hover:bg-white/20",size:"sm",children:[s.jsx(wl,{className:"w-4 h-4 mr-1 xl:mr-2"}),s.jsx("span",{className:"hidden xl:inline",children:"Catalog"})]})}),s.jsx(_e,{to:"/customer/cart",children:s.jsxs(D,{variant:r("/customer/cart")?"secondary":"ghost",className:`relative ${r("/customer/cart")?"bg-white text-blue-600":"text-white hover:bg-white/20"}`,size:"sm",children:[s.jsx(rt,{className:"w-4 h-4 mr-1 xl:mr-2"}),s.jsx("span",{className:"hidden xl:inline",children:"Cart"}),e>0&&s.jsx(X,{className:"absolute -top-2 -right-2 bg-red-500 text-white min-w-[18px] h-4 flex items-center justify-center text-xs animate-pulse",children:e})]})}),s.jsx(_e,{to:"/customer/orders",children:s.jsxs(D,{variant:r("/customer/orders")?"secondary":"ghost",className:r("/customer/orders")?"bg-white text-blue-600":"text-white hover:bg-white/20",size:"sm",children:[s.jsx(xe,{className:"w-4 h-4 mr-1 xl:mr-2"}),s.jsx("span",{className:"hidden xl:inline",children:"Orders"})]})}),s.jsx(_e,{to:"/customer/track",children:s.jsxs(D,{variant:r("/customer/track")?"secondary":"ghost",className:r("/customer/track")?"bg-white text-blue-600":"text-white hover:bg-white/20",size:"sm",children:[s.jsx(Fe,{className:"w-4 h-4 mr-1 xl:mr-2"}),s.jsx("span",{className:"hidden xl:inline",children:"Track"})]})})]}),s.jsx($n,{})]}),s.jsx("div",{className:"flex lg:hidden items-center space-x-2",children:s.jsxs(yc,{children:[s.jsx(bc,{asChild:!0,children:s.jsx(D,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/20 btn-mobile",children:s.jsx(lc,{className:"w-5 h-5"})})}),s.jsx(Ya,{side:"right",className:"w-72 sm:w-80",children:s.jsxs("div",{className:"flex flex-col space-y-4 mt-6",children:[s.jsx(_e,{to:"/customer",className:"w-full",children:s.jsxs(D,{variant:r("/customer")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(wl,{className:"w-4 h-4 mr-3"}),"Catalog"]})}),s.jsx(_e,{to:"/customer/cart",className:"w-full",children:s.jsxs(D,{variant:r("/customer/cart")?"default":"ghost",className:"w-full justify-start relative",size:"lg",children:[s.jsx(rt,{className:"w-4 h-4 mr-3"}),"Cart",e>0&&s.jsx(X,{className:"ml-auto bg-red-500 text-white",children:e})]})}),s.jsx(_e,{to:"/customer/orders",className:"w-full",children:s.jsxs(D,{variant:r("/customer/orders")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(xe,{className:"w-4 h-4 mr-3"}),"Orders"]})}),s.jsx(_e,{to:"/customer/track",className:"w-full",children:s.jsxs(D,{variant:r("/customer/track")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(Fe,{className:"w-4 h-4 mr-3"}),"Track"]})}),s.jsx("div",{className:"pt-4 border-t",children:s.jsx($n,{})})]})})]})})]})})}),s.jsx("main",{className:"pb-16 lg:pb-0",children:s.jsx(vc,{})}),s.jsx(sN,{userType:"customer"})]})};var ro="Tabs",[nN]=Yr(ro,[Th]),Uf=Th(),[iN,kc]=nN(ro),Ff=v.forwardRef((i,e)=>{const{__scopeTabs:t,value:r,onValueChange:a,defaultValue:l,orientation:c="horizontal",dir:u,activationMode:h="automatic",...f}=i,p=Oh(u),[g,y]=_i({prop:r,onChange:a,defaultProp:l??"",caller:ro});return s.jsx(iN,{scope:t,baseId:qa(),value:g,onValueChange:y,orientation:c,dir:p,activationMode:h,children:s.jsx(Me.div,{dir:p,"data-orientation":c,...f,ref:e})})});Ff.displayName=ro;var zf="TabsList",Bf=v.forwardRef((i,e)=>{const{__scopeTabs:t,loop:r=!0,...a}=i,l=kc(zf,t),c=Uf(t);return s.jsx(kx,{asChild:!0,...c,orientation:l.orientation,dir:l.dir,loop:r,children:s.jsx(Me.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:e})})});Bf.displayName=zf;var qf="TabsTrigger",Hf=v.forwardRef((i,e)=>{const{__scopeTabs:t,value:r,disabled:a=!1,...l}=i,c=kc(qf,t),u=Uf(t),h=Zf(c.baseId,r),f=Gf(c.baseId,r),p=r===c.value;return s.jsx(Cx,{asChild:!0,...u,focusable:!a,active:p,children:s.jsx(Me.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":f,"data-state":p?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:h,...l,ref:e,onMouseDown:Te(i.onMouseDown,g=>{!a&&g.button===0&&g.ctrlKey===!1?c.onValueChange(r):g.preventDefault()}),onKeyDown:Te(i.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&c.onValueChange(r)}),onFocus:Te(i.onFocus,()=>{const g=c.activationMode!=="manual";!p&&!a&&g&&c.onValueChange(r)})})})});Hf.displayName=qf;var Wf="TabsContent",Vf=v.forwardRef((i,e)=>{const{__scopeTabs:t,value:r,forceMount:a,children:l,...c}=i,u=kc(Wf,t),h=Zf(u.baseId,r),f=Gf(u.baseId,r),p=r===u.value,g=v.useRef(p);return v.useEffect(()=>{const y=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(y)},[]),s.jsx(nc,{present:a||p,children:({present:y})=>s.jsx(Me.div,{"data-state":p?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":h,hidden:!y,id:f,tabIndex:0,...c,ref:e,style:{...i.style,animationDuration:g.current?"0s":void 0},children:y&&l})})});Vf.displayName=Wf;function Zf(i,e){return`${i}-trigger-${e}`}function Gf(i,e){return`${i}-content-${e}`}var aN=Ff,Jf=Bf,Kf=Hf,Yf=Vf;const Cc=aN,no=v.forwardRef(({className:i,...e},t)=>s.jsx(Jf,{ref:t,className:se("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",i),...e}));no.displayName=Jf.displayName;const hs=v.forwardRef(({className:i,...e},t)=>s.jsx(Kf,{ref:t,className:se("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",i),...e}));hs.displayName=Kf.displayName;const Zs=v.forwardRef(({className:i,...e},t)=>s.jsx(Yf,{ref:t,className:se("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),...e}));Zs.displayName=Yf.displayName;const zi=v.createContext(null),Qf=v.forwardRef(({children:i,className:e,autoPlay:t=!1,autoPlayInterval:r=3e3},a)=>{const[l,c]=v.useState(0),h=v.Children.toArray(i).length;return v.useEffect(()=>{if(t&&h>1){const f=setInterval(()=>{c(p=>(p+1)%h)},r);return()=>clearInterval(f)}},[t,r,h]),s.jsx(zi.Provider,{value:{currentIndex:l,setCurrentIndex:c,itemsLength:h},children:s.jsx("div",{ref:a,className:se("relative",e),children:i})})});Qf.displayName="Carousel";const Xf=v.forwardRef(({className:i,children:e,...t},r)=>{const a=v.useContext(zi);if(!a)throw new Error("CarouselContent must be used within Carousel");return s.jsx("div",{ref:r,className:se("overflow-hidden",i),...t,children:s.jsx("div",{className:"flex transition-transform duration-300 ease-in-out",style:{transform:`translateX(-${a.currentIndex*100}%)`},children:e})})});Xf.displayName="CarouselContent";const ep=v.forwardRef(({className:i,...e},t)=>s.jsx("div",{ref:t,className:se("min-w-0 shrink-0 grow-0 basis-full",i),...e}));ep.displayName="CarouselItem";const tp=v.forwardRef(({className:i,variant:e="outline",size:t="icon",...r},a)=>{const l=v.useContext(zi);if(!l)throw new Error("CarouselPrevious must be used within Carousel");return s.jsx(D,{ref:a,variant:e,size:t,className:se("absolute left-2 top-1/2 -translate-y-1/2 z-10 h-8 w-8 rounded-full",i),onClick:()=>{const c=l.currentIndex===0?l.itemsLength-1:l.currentIndex-1;l.setCurrentIndex(c)},...r,children:s.jsx(jv,{className:"h-4 w-4"})})});tp.displayName="CarouselPrevious";const sp=v.forwardRef(({className:i,variant:e="outline",size:t="icon",...r},a)=>{const l=v.useContext(zi);if(!l)throw new Error("CarouselNext must be used within Carousel");return s.jsx(D,{ref:a,variant:e,size:t,className:se("absolute right-2 top-1/2 -translate-y-1/2 z-10 h-8 w-8 rounded-full",i),onClick:()=>{const c=(l.currentIndex+1)%l.itemsLength;l.setCurrentIndex(c)},...r,children:s.jsx(sm,{className:"h-4 w-4"})})});sp.displayName="CarouselNext";const rp=v.forwardRef(({className:i,...e},t)=>{const r=v.useContext(zi);if(!r)throw new Error("CarouselDots must be used within Carousel");return s.jsx("div",{ref:t,className:se("flex justify-center space-x-2 mt-4",i),...e,children:Array.from({length:r.itemsLength}).map((a,l)=>s.jsx("button",{className:se("w-2 h-2 rounded-full transition-colors",l===r.currentIndex?"bg-primary":"bg-muted-foreground/30"),onClick:()=>r.setCurrentIndex(l)},l))})});rp.displayName="CarouselDots";class oN{async getUserPreferences(e){try{return(await ce.request("/user-preferences",{method:"POST",body:JSON.stringify({userPhone:e,action:"get"})})).preferences||[]}catch(t){return console.error("Failed to get user preferences:",t),[]}}async saveUserPreference(e){try{await ce.request("/user-preferences",{method:"POST",body:JSON.stringify({action:"save",preference:e})})}catch(t){console.error("Failed to save user preference:",t)}}trackAddToCart(e){try{const t=yt.getCurrentUser(),r=(t==null?void 0:t.phone)||"guest",a=this.getUserPreferencesFromStorage(r),l=a.find(c=>c.productId===e.id);l?(l.addedToCartCount++,l.lastInteraction=Date.now(),l.score=this.calculateScore(l)):a.push({userId:r,productId:e.id,categoryId:e.category_id,addedToCartCount:1,purchasedCount:0,lastInteraction:Date.now(),score:10}),localStorage.setItem(`preferences_${r}`,JSON.stringify(a))}catch(t){console.error("Failed to track add to cart:",t)}}async trackPurchase(e){const t=yt.getCurrentUser();if(t)try{await ce.request("/user-preferences",{method:"POST",body:JSON.stringify({action:"track-purchase",userPhone:t.phone,products:e.map(r=>({productId:parseInt(r.id),categoryId:r.category_id}))})})}catch(r){console.error("Failed to track purchase:",r)}}calculateScore(e){const l=(Date.now()-e.lastInteraction)/864e5,c=Math.max(0,30-l)*.1;return e.addedToCartCount*5+e.purchasedCount*20+c}getPersonalizedProducts(e,t=8){try{const r=yt.getCurrentUser(),a=(r==null?void 0:r.phone)||"guest",l=this.getUserPreferencesFromStorage(a);if(l.length===0)return e.filter(h=>h.stock_qty>20).slice(0,t);const c=new Map;return l.forEach(h=>{c.set(h.productId,h.score)}),e.map(h=>{let f=c.get(h.id)||0;return h.stock_qty>0&&(f+=5),h.stock_qty>20&&(f+=3),{product:h,score:f}}).sort((h,f)=>f.score-h.score).slice(0,t).map(h=>h.product)}catch(r){return console.error("Failed to get personalized products:",r),e.filter(a=>a.stock_qty>20).slice(0,t)}}getUserPreferencesFromStorage(e){const t=localStorage.getItem(`preferences_${e}`);return t?JSON.parse(t):[]}getRecommendationsWithReasons(e,t=6){try{const r=yt.getCurrentUser(),a=(r==null?void 0:r.phone)||"guest",l=this.getUserPreferencesFromStorage(a);if(l.length===0)return e.filter(g=>g.stock_qty>20).slice(0,t).map(g=>({product:g,reason:"Trending now",score:10}));const c=[];l.filter(g=>g.purchasedCount>0).sort((g,y)=>y.score-g.score).slice(0,3).forEach(g=>{const y=e.find(_=>_.id===g.productId);y&&y.stock_qty>0&&c.push({product:y,reason:`You bought this ${g.purchasedCount} time${g.purchasedCount>1?"s":""}`,score:g.score})});const h=new Map;l.forEach(g=>{const y=h.get(g.categoryId)||0;h.set(g.categoryId,y+g.score)}),Array.from(h.entries()).sort((g,y)=>y[1]-g[1]).slice(0,2).forEach(([g,y])=>{e.filter(P=>P.category_id===g&&P.stock_qty>0).filter(P=>!c.some(b=>b.product.id===P.id)).slice(0,2).forEach(P=>{c.push({product:P,reason:"From your favorite category",score:y*.3})})});const p=t-c.length;return p>0&&e.filter(y=>y.stock_qty>20).filter(y=>!c.some(_=>_.product.id===y.id)).slice(0,p).forEach(y=>{c.push({product:y,reason:"Popular choice",score:5})}),c.sort((g,y)=>y.score-g.score).slice(0,t)}catch{return e.filter(a=>a.stock_qty>20).slice(0,t).map(a=>({product:a,reason:"Popular choice",score:10}))}}getUserInsights(){const e=yt.getCurrentUser();if(!e)return{totalInteractions:0,favoriteCategory:"None",recentActivity:0};const t=this.getUserPreferences(e.phone),r=t.reduce((u,h)=>u+h.addedToCartCount+h.purchasedCount,0),a=new Map;t.forEach(u=>{const h=a.get(u.categoryId)||0;a.set(u.categoryId,h+u.score)});const l=a.size>0?Array.from(a.entries()).sort((u,h)=>h[1]-u[1])[0][0]:"None",c=t.filter(u=>Date.now()-u.lastInteraction<7*24*60*60*1e3).length;return{totalInteractions:r,favoriteCategory:l,recentActivity:c}}}const Tc=new oN,ja=[],np=async(i,e)=>{const t=await Zt.addToCart(i.id,e);return t&&(await Tc.trackAddToCart(i),window.dispatchEvent(new CustomEvent("cartUpdated"))),t};class lN{static async getCustomerOrders(){const e=localStorage.getItem("customerPhone");return e?De.syncData(`customerOrders_${e}`,async()=>(await ce.getOrders()).filter(r=>r.customerPhone===e).map(r=>({id:r.orderId,orderId:r.orderId,status:r.status,total:r.total,items:r.items||[],createdAt:r.createdAt||new Date().toISOString(),deliveryAddress:r.deliveryAddress,customerName:r.customerName,customerPhone:r.customerPhone,paymentStatus:r.paymentStatus})).sort((r,a)=>new Date(a.createdAt).getTime()-new Date(r.createdAt).getTime())):[]}static async getAvailableProducts(){try{console.log("CustomerDataService: Fetching products from API...");const e=await ce.getProducts();console.log("CustomerDataService: Raw products from API:",e),console.log("CustomerDataService: Number of products:",e.length);const t=e.filter(r=>{const a=r.isActive!==void 0?r.isActive:r.is_active;return a===!0||a===1}).map(r=>({id:r.id,name:r.name,description:r.description,price:typeof r.price=="string"?parseFloat(r.price):r.price,imageUrl:r.imageUrl||r.image,category:r.category,stockQuantity:r.stockQuantity||r.stock_quantity||0,isActive:r.isActive!==void 0?r.isActive:r.is_active}));return De.saveData("availableProducts",t),console.log("CustomerDataService: Filtered products for customer:",t),console.log("CustomerDataService: Returning",t.length,"products"),t}catch(e){return console.error("Failed to fetch products from API, using cached data:",e),De.getData("availableProducts")||[]}}static async getCategories(){return De.syncData("categories",async()=>await ce.getCategories())}static async searchProducts(e){return(await this.getAvailableProducts()).filter(r=>r.name.toLowerCase().includes(e.toLowerCase())||r.description.toLowerCase().includes(e.toLowerCase())||r.category.toLowerCase().includes(e.toLowerCase()))}static async getProductsByCategory(e){return(await this.getAvailableProducts()).filter(r=>r.category.toLowerCase().replace(/\s+/g,"-")===e)}static async createOrder(e){try{const t={customerName:e.customerAddress.name,customerPhone:e.customerAddress.phone,deliveryAddress:e.customerAddress.address,total:e.total,status:e.status,paymentStatus:e.paymentStatus,items:e.items.map(c=>({productId:parseInt(c.product.id),productName:c.product.name,price:c.product.price,quantity:c.quantity}))},r=await ce.createOrder(t);De.saveData("currentOrder",r),De.saveData("customerAddress",e.customerAddress);const a=e.customerAddress.phone,l=De.getData(`customerOrders_${a}`)||[];return l.unshift(r),De.saveData(`customerOrders_${a}`,l),r}catch(t){return console.error("Customer: Failed to create order",t),null}}static async saveCustomerProfile(e){try{const t=await ce.createCustomer(e);return De.saveData("customerProfile",t),localStorage.setItem("customerPhone",t.phone),t}catch(t){return console.error("Failed to save customer profile:",t),null}}static getCustomerProfile(){return De.getData("customerProfile")}static async updateCustomerProfile(e,t){try{const r=await ce.updateCustomer(e,t);return De.saveData("customerProfile",r),r}catch(r){return console.error("Failed to update customer profile:",r),null}}static getCustomerMetrics(e){const t=new Date,r=e.filter(a=>{const l=new Date(a.createdAt);return l.getMonth()===t.getMonth()&&l.getFullYear()===t.getFullYear()});return{totalOrders:e.length,totalSpent:e.reduce((a,l)=>a+l.total,0),activeOrders:e.filter(a=>["pending","confirmed","preparing","out_for_delivery"].includes(a.status)).length,completedOrders:e.filter(a=>a.status==="delivered").length,monthlyOrders:r.length,monthlySpent:r.reduce((a,l)=>a+l.total,0),averageOrderValue:e.length>0?e.reduce((a,l)=>a+l.total,0)/e.length:0,lastOrderDate:e.length>0?e[0].createdAt:null}}static async getOrderUpdates(e){try{const r=(await ce.getOrders()).find(a=>a.orderId===e);return r&&De.saveData("currentOrder",r),r}catch(t){return console.error("Failed to get order updates:",t),De.getData("currentOrder")}}static clearCustomerSession(){["currentOrder","customerAddress","customerProfile","cart"].forEach(t=>localStorage.removeItem(t)),localStorage.removeItem("customerPhone")}static getCart(){return De.getData("cart")||[]}static saveCart(e){De.saveData("cart",e)}static addToCart(e,t=1){const r=this.getCart(),a=r.find(l=>l.product.id===e.id);a?a.quantity+=t:r.push({product:e,quantity:t}),this.saveCart(r)}static removeFromCart(e){const r=this.getCart().filter(a=>a.product.id!==e);this.saveCart(r)}static updateCartQuantity(e,t){const r=this.getCart(),a=r.find(l=>l.product.id===e);a&&(t<=0?this.removeFromCart(e):(a.quantity=t,this.saveCart(r)))}static clearCart(){this.saveCart([])}static getCartTotal(){return this.getCart().reduce((t,r)=>t+r.product.price*r.quantity,0)}}const Ra=class Ra{constructor(){ze(this,"updateInterval",null);ze(this,"subscribers",new Map)}static getInstance(){return this.instance||(this.instance=new Ra),this.instance}startRealTimeUpdates(){this.updateInterval||(this.updateInterval=setInterval(()=>{this.updateAllData()},3e4),this.updateAllData())}stopRealTimeUpdates(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null)}subscribe(e,t){this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}unsubscribe(e,t){const r=this.subscribers.get(e);if(r){const a=r.indexOf(t);a>-1&&r.splice(a,1)}}notifySubscribers(e,t){const r=this.subscribers.get(e);r&&r.forEach(a=>a(t))}async updateAllData(){await this.updateProducts(),await this.updateOrders()}async updateProducts(){try{const e=await ce.getProducts();this.notifySubscribers("products",e)}catch(e){console.error("Failed to update products:",e)}}async updateOrders(){try{const e=await ce.getOrders();this.notifySubscribers("orders",e)}catch(e){console.error("Failed to update orders:",e)}}async getFreshData(e){switch(e){case"products":await this.updateProducts();break;case"orders":await this.updateOrders();break;default:await this.updateAllData()}}initializeDeliveryAgents(){console.log("Delivery agents should be managed through database/API")}getRealTimeStats(){return{totalOrders:0,activeOrders:0,totalProducts:0,lowStockProducts:0,activeAgents:0,totalRevenue:0,lastUpdated:new Date().toISOString()}}};ze(Ra,"instance");let Zl=Ra;const Rt=Zl.getInstance(),cN=({currentPrice:i,productId:e,className:t=""})=>{const[r,a]=v.useState(i),[l,c]=v.useState("same"),[u,h]=v.useState(!1);v.useEffect(()=>{i!==r&&(i>r?c("up"):i<r?c("down"):c("same"),h(!0),setTimeout(()=>h(!1),2e3),a(i))},[i,r]);const f=()=>{switch(l){case"up":return s.jsx(Xt,{className:"w-3 h-3 text-red-500"});case"down":return s.jsx(im,{className:"w-3 h-3 text-green-500"});default:return s.jsx(jl,{className:"w-3 h-3 text-gray-400"})}},p=()=>{switch(l){case"up":return"text-red-600";case"down":return"text-green-600";default:return"text-gray-600"}},g=()=>{switch(l){case"up":return"destructive";case"down":return"default";default:return"secondary"}};return s.jsxs("div",{className:`flex items-center gap-2 ${t}`,children:[s.jsxs("span",{className:`font-bold text-lg transition-all duration-300 ${u?"animate-pulse scale-110":""} ${p()}`,children:["",i.toFixed(2)]}),l!=="same"&&s.jsxs(X,{variant:g(),className:`flex items-center gap-1 text-xs transition-all duration-300 ${u?"animate-bounce":""}`,children:[f(),l==="up"?"+":"-","",Math.abs(i-r).toFixed(2)]}),s.jsx(X,{variant:"outline",className:"text-xs text-gray-500",children:"Live"})]})};var Oc="Progress",Ic=100,[dN]=Yr(Oc),[uN,hN]=dN(Oc),ip=v.forwardRef((i,e)=>{const{__scopeProgress:t,value:r=null,max:a,getValueLabel:l=mN,...c}=i;(a||a===0)&&!qu(a)&&console.error(fN(`${a}`,"Progress"));const u=qu(a)?a:Ic;r!==null&&!Hu(r,u)&&console.error(pN(`${r}`,"Progress"));const h=Hu(r,u)?r:null,f=Aa(h)?l(h,u):void 0;return s.jsx(uN,{scope:t,value:h,max:u,children:s.jsx(Me.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":Aa(h)?h:void 0,"aria-valuetext":f,role:"progressbar","data-state":lp(h,u),"data-value":h??void 0,"data-max":u,...c,ref:e})})});ip.displayName=Oc;var ap="ProgressIndicator",op=v.forwardRef((i,e)=>{const{__scopeProgress:t,...r}=i,a=hN(ap,t);return s.jsx(Me.div,{"data-state":lp(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:e})});op.displayName=ap;function mN(i,e){return`${Math.round(i/e*100)}%`}function lp(i,e){return i==null?"indeterminate":i===e?"complete":"loading"}function Aa(i){return typeof i=="number"}function qu(i){return Aa(i)&&!isNaN(i)&&i>0}function Hu(i,e){return Aa(i)&&!isNaN(i)&&i<=e&&i>=0}function fN(i,e){return`Invalid prop \`max\` of value \`${i}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ic}\`.`}function pN(i,e){return`Invalid prop \`value\` of value \`${i}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ic} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var cp=ip,gN=op;const Hn=v.forwardRef(({className:i,value:e,...t},r)=>s.jsx(cp,{ref:r,className:se("relative h-4 w-full overflow-hidden rounded-full bg-secondary",i),...t,children:s.jsx(gN,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));Hn.displayName=cp.displayName;const xN=()=>{const i={points:450,tier:"Silver",nextTierPoints:1e3,availableRewards:3},e=i.points/i.nextTierPoints*100;return s.jsx(U,{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white",children:s.jsxs(z,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nm,{className:"h-5 w-5"}),s.jsx("span",{className:"font-bold text-lg",children:i.points})]}),s.jsx(X,{className:"bg-white/20 text-white",children:i.tier})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Progress to Gold"}),s.jsxs("span",{children:[i.points,"/",i.nextTierPoints]})]}),s.jsx(Hn,{value:e,className:"h-2 bg-white/20"})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-3 text-sm",children:[s.jsx(Na,{className:"h-4 w-4"}),s.jsxs("span",{children:[i.availableRewards," rewards available"]})]})]})})},Ac=()=>{const i=yt.getCurrentSession();if(!i)return null;const t=(()=>{switch(i.role){case"customer":return{title:`Welcome back, ${i.name||"Customer"}!`,subtitle:"Discover fresh products and great deals",icon:s.jsx(wn,{className:"w-8 h-8 text-blue-600"}),bgGradient:"from-blue-500 to-purple-600",features:[{icon:s.jsx(xe,{className:"w-4 h-4"}),text:"Browse 500+ products"},{icon:s.jsx(pr,{className:"w-4 h-4"}),text:"Earn loyalty points"},{icon:s.jsx(Fe,{className:"w-4 h-4"}),text:"Real-time tracking"}],stats:[{label:"Orders Placed",value:"12"},{label:"Loyalty Points",value:"450"},{label:"Saved Amount",value:"280"}]};case"admin":return{title:`Admin Dashboard - ${i.name||"Administrator"}`,subtitle:"Manage your delivery system efficiently",icon:s.jsx(Sa,{className:"w-8 h-8 text-purple-600"}),bgGradient:"from-purple-500 to-pink-600",features:[{icon:s.jsx(xe,{className:"w-4 h-4"}),text:"Manage inventory"},{icon:s.jsx(it,{className:"w-4 h-4"}),text:"Track deliveries"},{icon:s.jsx(pr,{className:"w-4 h-4"}),text:"View analytics"}],stats:[{label:"Active Orders",value:"24"},{label:"Products",value:"156"},{label:"Revenue Today",value:"12,450"}]};case"delivery":return{title:`Hello, ${i.name||"Delivery Partner"}!`,subtitle:"Ready to deliver happiness today?",icon:s.jsx(it,{className:"w-8 h-8 text-green-600"}),bgGradient:"from-green-500 to-teal-600",features:[{icon:s.jsx(Fe,{className:"w-4 h-4"}),text:"GPS navigation"},{icon:s.jsx(xe,{className:"w-4 h-4"}),text:"Order management"},{icon:s.jsx(pr,{className:"w-4 h-4"}),text:"Earnings tracker"}],stats:[{label:"Pending Deliveries",value:"5"},{label:"Completed Today",value:"8"},{label:"Earnings Today",value:"640"}]};default:return null}})();return t?s.jsxs(U,{className:"mb-6 overflow-hidden",children:[s.jsx("div",{className:`bg-gradient-to-r ${t.bgGradient} p-6 text-white`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.icon,s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold",children:t.title}),s.jsx("p",{className:"text-white/90 text-sm",children:t.subtitle})]})]}),s.jsxs(X,{variant:"secondary",className:"bg-white/20 text-white border-white/30",children:[i.role.charAt(0).toUpperCase()+i.role.slice(1)," Account"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-white/80 text-xs",children:"Logged in as"}),s.jsxs("p",{className:"font-mono text-sm",children:["+91 ",i.phone]})]})]})}),s.jsxs(z,{className:"p-6",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:t.features.map((r,a)=>s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[r.icon,s.jsx("span",{children:r.text})]},a))}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:t.stats.map((r,a)=>s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-800",children:r.value}),s.jsx("p",{className:"text-xs text-gray-500",children:r.label})]},a))})]})]}):null},vN=()=>{const{toast:i}=Et(),[e,t]=v.useState(null),[r,a]=v.useState(!1),[l,c]=v.useState(null),[u,h]=v.useState(""),f=async(P,b)=>{var j,S,k,N,T,O;try{const E=[{url:`https://nominatim.openstreetmap.org/reverse?format=json&lat=${P}&lon=${b}&zoom=18&addressdetails=1`,headers:{"User-Agent":"Shirpur-Delivery-App/1.0"}},{url:`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${P}&longitude=${b}&localityLanguage=en`}];for(const I of E)try{const B=await(await fetch(I.url,{headers:I.headers||{}})).json();if(I.url.includes("nominatim")){if(B&&B.address){const W=[];return B.address.house_number&&W.push(B.address.house_number),B.address.road&&W.push(B.address.road),B.address.neighbourhood&&W.push(B.address.neighbourhood),B.address.suburb&&W.push(B.address.suburb),(B.address.city||B.address.town)&&W.push(B.address.city||B.address.town),B.address.state&&W.push(B.address.state),W.join(", ")||B.display_name}}else if(I.url.includes("bigdatacloud")&&B&&B.locality){const W=[];return(k=(S=(j=B.localityInfo)==null?void 0:j.administrative)==null?void 0:S[3])!=null&&k.name&&W.push(B.localityInfo.administrative[3].name),(O=(T=(N=B.localityInfo)==null?void 0:N.administrative)==null?void 0:T[2])!=null&&O.name&&W.push(B.localityInfo.administrative[2].name),B.locality&&W.push(B.locality),B.principalSubdivision&&W.push(B.principalSubdivision),W.join(", ")}}catch(q){console.log("Service failed:",q);continue}return`Lat: ${P.toFixed(6)}, Lng: ${b.toFixed(6)}`}catch{return`Lat: ${P.toFixed(6)}, Lng: ${b.toFixed(6)}`}},p=()=>{if(!navigator.geolocation){h("Geolocation not supported");return}a(!0),h("");const P=navigator.geolocation.watchPosition(async b=>{const j={lat:b.coords.latitude,lng:b.coords.longitude,accuracy:b.coords.accuracy,timestamp:Date.now()},S=await f(j.lat,j.lng);j.address=S,t(j),localStorage.setItem("customerRealTimeLocation",JSON.stringify(j))},b=>{let j="Location error: ";switch(b.code){case b.PERMISSION_DENIED:j+="Permission denied";break;case b.POSITION_UNAVAILABLE:j+="Position unavailable";break;case b.TIMEOUT:j+="Request timeout";break;default:j+="Unknown error"}h(j),a(!1)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0});c(P)},g=()=>{l!==null&&(navigator.geolocation.clearWatch(l),c(null)),a(!1),localStorage.removeItem("customerRealTimeLocation")};v.useEffect(()=>(localStorage.getItem("locationTrackingEnabled")==="true"&&p(),()=>{l!==null&&navigator.geolocation.clearWatch(l)}),[]);const y=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(async P=>{const b={lat:P.coords.latitude,lng:P.coords.longitude,accuracy:P.coords.accuracy,timestamp:Date.now()},j=await f(b.lat,b.lng);b.address=j,t(b),localStorage.setItem("customerRealTimeLocation",JSON.stringify(b)),i({title:"Location updated",description:"Got your current precise location"})},P=>{i({title:"Location error",description:"Could not get current location",variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},_=()=>{r?(g(),localStorage.setItem("locationTrackingEnabled","false"),i({title:"Location tracking stopped",description:"Your location is no longer being shared"})):(p(),localStorage.setItem("locationTrackingEnabled","true"),i({title:"Location tracking started",description:"Your location will help with accurate delivery"}))};return s.jsx(U,{className:"mb-4 bg-gradient-to-r from-blue-50 to-green-50 border-blue-200",children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`p-2 rounded-full ${r?"bg-green-100":"bg-gray-100"}`,children:r?s.jsx(Ut,{className:"w-5 h-5 text-green-600 animate-pulse"}):s.jsx(Fe,{className:"w-5 h-5 text-gray-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Live Location"}),r?s.jsx(lm,{className:"w-4 h-4 text-green-500"}):s.jsx(om,{className:"w-4 h-4 text-gray-400"})]}),e?s.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[s.jsx("p",{className:"truncate",children:e.address}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Accuracy: ",Math.round(e.accuracy),"m  Updated: ",new Date(e.timestamp).toLocaleTimeString()]})]}):u?s.jsx("p",{className:"text-xs text-red-600 mt-1",children:u}):s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r?"Getting location...":"Enable for accurate delivery"})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(D,{onClick:y,size:"sm",variant:"outline",className:"text-xs p-2",title:"Get current location",children:s.jsx(cc,{className:"w-3 h-3"})}),s.jsx(D,{onClick:_,size:"sm",variant:r?"destructive":"default",className:"text-xs",children:r?"Stop":"Start"})]})]})})})},yN=({onSearch:i,placeholder:e="Search products..."})=>{const[t,r]=v.useState(""),a=c=>{r(c),i(c)},l=()=>{r(""),i("")};return s.jsxs("div",{className:"relative",children:[s.jsx(Ev,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx(nt,{type:"text",placeholder:e,value:t,onChange:c=>a(c.target.value),className:"pl-10 pr-10"}),t&&s.jsx(D,{variant:"ghost",size:"sm",onClick:l,className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:s.jsx(ps,{className:"h-3 w-3"})})]})},Ec=({type:i="customer",message:e})=>{const t=()=>{switch(i){case"customer":return s.jsx(rt,{className:"w-8 h-8"});case"admin":return s.jsx(xe,{className:"w-8 h-8"});case"delivery":return s.jsx(it,{className:"w-8 h-8"});default:return s.jsx(xe,{className:"w-8 h-8"})}},r=()=>{switch(i){case"customer":return"from-blue-500 to-green-500";case"admin":return"from-purple-500 to-blue-500";case"delivery":return"from-orange-500 to-red-500";default:return"from-blue-500 to-green-500"}},a=()=>{if(e)return e;switch(i){case"customer":return"Loading products...";case"admin":return"Loading dashboard...";case"delivery":return"Loading tasks...";default:return"Loading..."}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative mb-8",children:[s.jsx("div",{className:`w-20 h-20 bg-gradient-to-r ${r()} rounded-full flex items-center justify-center text-white animate-pulse mx-auto`,children:t()}),s.jsx("div",{className:"absolute inset-0 w-20 h-20 border-4 border-transparent border-t-blue-500 rounded-full animate-spin mx-auto"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a()}),s.jsxs("div",{className:"flex justify-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch your data..."})]})]})})},bN=({products:i})=>{const[e,t]=v.useState([]);v.useEffect(()=>{const a=Tc.getRecommendationsWithReasons(i,6);t(a)},[i]);const r=a=>{a.stock_qty>0&&(np(a,1),wa.success("Added to Cart!",`${a.name} has been added to your cart successfully`),window.dispatchEvent(new CustomEvent("cartUpdated")))};return e.length===0?null:s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("h2",{className:"text-2xl md:text-3xl font-bold mb-2 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:[s.jsx(eu,{className:"inline w-6 h-6 mr-2 text-purple-600"}),"Just for You"]}),s.jsx("p",{className:"text-gray-600",children:"Personalized recommendations based on your preferences"})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:e.map(a=>s.jsx(U,{className:"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 hover:border-purple-400 transition-all duration-300 transform hover:scale-105 hover:shadow-xl",children:s.jsxs(z,{className:"p-4 text-center",children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-3 bg-gradient-to-br from-purple-200 to-pink-200 rounded-full flex items-center justify-center text-2xl animate-pulse",children:a.product.image_url?s.jsx("img",{src:a.product.image_url,alt:a.product.name,className:"w-full h-full object-cover rounded-full"}):""}),s.jsxs(X,{className:"absolute -top-2 -right-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs animate-pulse",children:[s.jsx(eu,{className:"w-3 h-3 mr-1"}),"For You"]})]}),s.jsx("h3",{className:"font-bold text-sm mb-1 text-gray-800 line-clamp-2",children:a.product.name}),s.jsx("p",{className:"text-xs text-purple-600 mb-2 line-clamp-1",children:a.reason}),s.jsxs("p",{className:"text-lg font-bold text-green-600 mb-3",children:["",a.product.price]}),s.jsxs(D,{onClick:()=>r(a.product),size:"sm",className:"w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold rounded-full transform hover:scale-110 transition-all duration-200",children:[s.jsx(Vr,{className:"w-3 h-3 mr-1"}),"Add "]})]})},a.product.id))})]})},_N=()=>{Et();const[i,e]=v.useState("all"),[t,r]=v.useState([]),[a,l]=v.useState([]),[c,u]=v.useState(!0),[h,f]=v.useState("");v.useEffect(()=>{const S=async()=>{try{u(!0);const N=await lN.getAvailableProducts();console.log("CustomerCatalog: Products received from service:",N),console.log("CustomerCatalog: Number of products received:",N.length);const T=N.map(I=>({id:I.id.toString(),name:I.name,description:I.description,price:parseFloat(I.price||0),image_url:I.image_url||I.imageUrl,category_id:(I.category||"general").toLowerCase().replace(/\s+/g,"-"),stock_qty:parseInt(I.stock_quantity||I.stockQuantity||0),is_active:I.is_active!==void 0?I.is_active:I.isActive,sku:`SKU${I.id}`,unit:"kg",is_age_restricted:!1})),O=T.filter(I=>I.is_active);console.log("CustomerCatalog: Active products after filtering:",O),console.log("CustomerCatalog: Setting",O.length,"active products"),r(O);const E=new Map;T.forEach(I=>{E.has(I.category_id)||E.set(I.category_id,{id:I.category_id,name:I.category_id.replace(/-/g," ").replace(/\b\w/g,q=>q.toUpperCase()),is_active:!0})}),l(Array.from(E.values()))}catch(N){console.error("Failed to load products:",N),r([]),l([])}finally{u(!1)}};Rt.startRealTimeUpdates();const k=N=>{const T=N.map(O=>({id:O.id.toString(),name:O.name,description:O.description,price:parseFloat(O.price||0),image_url:O.image_url||O.imageUrl,category_id:(O.category||"general").toLowerCase().replace(/\s+/g,"-"),stock_qty:parseInt(O.stock_quantity||O.stockQuantity||0),is_active:O.is_active!==void 0?O.is_active:O.isActive,sku:`SKU${O.id}`,unit:"kg",is_age_restricted:!1}));r(T.filter(O=>O.is_active))};return Rt.subscribe("products",k),S(),()=>{Rt.unsubscribe("products",k)}},[]);const p=t.filter(S=>{if(!S.is_active)return!1;const k=i==="all"||S.category_id===i,N=!h||S.name.toLowerCase().includes(h.toLowerCase())||S.description.toLowerCase().includes(h.toLowerCase());return k&&N}),g=S=>{var k;return((k=a.find(N=>N.id===S))==null?void 0:k.name)||"Unknown"},y=async S=>{if(S.stock_qty>0)try{await np(S,1)?(wa.success("Added to Cart!",`${S.name} has been added to your cart successfully`),window.dispatchEvent(new CustomEvent("cartUpdated"))):wa.error("Error!","Failed to add item to cart. Please try again.")}catch(k){console.error("Error adding to cart:",k),wa.error("Error!","Failed to add item to cart. Please try again.")}},P=(()=>{const S=localStorage.getItem("carouselItems");if(S){const k=JSON.parse(S).filter(N=>N.isActive);if(k.length>0)return k.map(N=>({id:N.productId.toString(),name:N.title,description:N.description,price:N.price,image_url:N.imageUrl,category_id:"featured",stock_qty:100,is_active:!0,sku:`SKU${N.productId}`,unit:"kg",is_age_restricted:!1}))}return t.slice(0,5)})(),[b,j]=v.useState([]);return v.useEffect(()=>{if(t.length>0){const S=Tc.getPersonalizedProducts(t,8);j(S)}},[t]),c?s.jsx(Ec,{type:"customer",message:"Loading fresh products..."}):t.length===0?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(xe,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Products Available"}),s.jsx("p",{className:"text-gray-600",children:"Please check your database connection or add products to the database."})]})}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-green-600 text-white",children:s.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 md:py-12",children:[s.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[s.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-2 sm:mb-4",children:" Shirpur Delivery"}),s.jsx("p",{className:"text-sm sm:text-base md:text-lg lg:text-xl opacity-90 px-4",children:"Fresh products delivered to your doorstep in 30 minutes"})]}),P.length>0&&s.jsxs(Qf,{className:"w-full",autoPlay:!0,autoPlayInterval:4e3,children:[s.jsx(Xf,{children:P.map(S=>s.jsx(ep,{children:s.jsxs("div",{className:"relative h-48 sm:h-64 md:h-80 lg:h-96 w-full rounded-lg sm:rounded-2xl overflow-hidden",children:[S.image_url?s.jsx("img",{src:S.image_url,alt:S.name,className:"absolute inset-0 w-full h-full object-cover"}):s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600 via-blue-600 to-green-600"}),s.jsx("div",{className:"absolute inset-0 bg-black/40"}),s.jsx("div",{className:"relative z-10 h-full flex flex-col justify-center px-4 sm:px-8 md:px-16",children:s.jsxs("div",{className:"text-white max-w-xs sm:max-w-lg md:max-w-2xl",children:[s.jsx("h3",{className:"text-xl sm:text-2xl md:text-4xl lg:text-5xl font-bold mb-2 sm:mb-4",children:S.name}),s.jsx("p",{className:"text-sm sm:text-base md:text-lg lg:text-xl opacity-90 mb-4 sm:mb-6 line-clamp-2",children:S.description}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 mb-4 sm:mb-6",children:[s.jsxs("span",{className:"text-2xl sm:text-3xl md:text-5xl lg:text-6xl font-bold text-yellow-300",children:["",S.price]}),s.jsxs(X,{className:"bg-white/20 text-white border-white/30 text-xs sm:text-sm px-2 sm:px-3 py-1 w-fit",children:[S.stock_qty," in stock"]})]})]})}),s.jsx("div",{className:"absolute bottom-4 right-4 sm:bottom-6 sm:right-6 md:bottom-8 md:right-8",children:s.jsxs(D,{onClick:()=>y(S),className:"bg-white text-blue-600 hover:bg-gray-100 text-sm sm:text-base md:text-lg px-4 sm:px-6 md:px-8 py-2 sm:py-3 md:py-4 rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 hover:scale-105",children:[s.jsx(rt,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2"}),s.jsx("span",{className:"hidden xs:inline",children:"Add to Cart"}),s.jsx("span",{className:"xs:hidden",children:"Add"})]})})]})},S.id))}),s.jsx(tp,{className:"left-4 bg-white/20 border-white/30 text-white hover:bg-white/30"}),s.jsx(sp,{className:"right-4 bg-white/20 border-white/30 text-white hover:bg-white/30"}),s.jsx(rp,{className:"mt-4"})]})]})}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx(vN,{}),s.jsx(Ac,{}),s.jsx("div",{className:"mb-8",children:s.jsx(xN,{})}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4 mb-6 sm:mb-8",children:[s.jsxs(U,{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[s.jsx(uc,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600 mx-auto mb-1 sm:mb-2"}),s.jsx("p",{className:"font-bold text-green-800 text-sm sm:text-base",children:"30 Min"}),s.jsx("p",{className:"text-xs sm:text-sm text-green-600",children:"Fast Delivery"})]}),s.jsxs(U,{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[s.jsx(pr,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600 mx-auto mb-1 sm:mb-2"}),s.jsxs("p",{className:"font-bold text-blue-800 text-sm sm:text-base",children:[t.length,"+"]}),s.jsx("p",{className:"text-xs sm:text-sm text-blue-600",children:"Products"})]}),s.jsxs(U,{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[s.jsx(Tv,{className:"w-6 h-6 sm:w-8 sm:h-8 text-purple-600 mx-auto mb-1 sm:mb-2"}),s.jsx("p",{className:"font-bold text-purple-800 text-sm sm:text-base",children:"4.8"}),s.jsx("p",{className:"text-xs sm:text-sm text-purple-600",children:"Rating"})]}),s.jsxs(U,{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[s.jsx(Xt,{className:"w-6 h-6 sm:w-8 sm:h-8 text-orange-600 mx-auto mb-1 sm:mb-2"}),s.jsx("p",{className:"font-bold text-orange-800 text-sm sm:text-base",children:"4.99"}),s.jsx("p",{className:"text-xs sm:text-sm text-orange-600",children:"Delivery Fee"})]})]}),s.jsx(bN,{products:t}),b.length>0&&s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4 md:mb-6 text-center bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent",children:" Popular Items"}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-2 sm:gap-3 md:gap-4 mb-6 md:mb-8",children:b.map(S=>s.jsx(U,{className:"hover:shadow-lg transition-all duration-300 hover:-translate-y-1 bg-gradient-to-br from-white to-gray-50",children:s.jsxs(z,{className:"p-2 sm:p-3",children:[s.jsx("div",{className:"aspect-square bg-gradient-to-br from-blue-100 to-green-100 rounded-lg mb-2 sm:mb-3 flex items-center justify-center overflow-hidden",children:S.image_url?s.jsx("img",{src:S.image_url,alt:S.name,className:"w-full h-full object-cover responsive-image"}):s.jsx(xe,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-600"})}),s.jsx("h3",{className:"font-semibold text-xs sm:text-sm mb-1 line-clamp-2",children:S.name}),s.jsxs("p",{className:"text-sm sm:text-lg font-bold text-green-600 mb-2",children:["",S.price]}),s.jsxs(D,{onClick:()=>y(S),size:"sm",className:"w-full bg-gradient-to-r from-blue-500 to-green-500 hover:from-blue-600 hover:to-green-600 text-xs sm:text-sm btn-mobile",children:[s.jsx(Vr,{className:"w-3 h-3 mr-1"}),s.jsx("span",{className:"hidden sm:inline",children:"Add"}),s.jsx("span",{className:"sm:hidden",children:"+"})]})]})},S.id))})]}),s.jsx("div",{className:"mb-6",children:s.jsx(yN,{onSearch:f,placeholder:"Search rice, dal, vegetables..."})}),a.length>0&&s.jsx(Cc,{value:i,onValueChange:e,className:"mb-6 md:mb-8",children:s.jsx("div",{className:"overflow-x-auto hide-scrollbar",children:s.jsxs(no,{className:"flex w-max min-w-full gap-1 h-auto p-1 bg-white shadow-md",children:[s.jsx(hs,{value:"all",className:"text-xs sm:text-sm px-3 sm:px-4 py-2 whitespace-nowrap data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-green-500 data-[state=active]:text-white",children:"All"}),a.filter(S=>S.is_active).map(S=>s.jsx(hs,{value:S.id,className:"text-xs sm:text-sm px-3 sm:px-4 py-2 whitespace-nowrap data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-green-500 data-[state=active]:text-white",children:S.name},S.id))]})})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4 md:mb-6 text-center bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent",children:" All Products"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(S=>s.jsxs(U,{className:"bg-gradient-to-br from-white via-blue-50 to-green-50 border-2 border-blue-200 hover:border-green-400 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl",children:[s.jsx(ne,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-yellow-200 to-orange-200 rounded-2xl flex items-center justify-center text-3xl animate-pulse flex-shrink-0",children:S.image_url?s.jsx("img",{src:S.image_url,alt:S.name,className:"w-full h-full object-cover rounded-2xl"}):""}),s.jsxs("div",{className:"flex-1",children:[s.jsx(ie,{className:"text-lg font-bold text-gray-800 mb-1",children:S.name}),s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:S.description}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(X,{variant:"secondary",className:"bg-green-100 text-green-800",children:g(S.category_id)}),S.stock_qty>50&&s.jsx(X,{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white animate-pulse",children:" In Stock"})]})]})]})}),s.jsx(z,{className:"pt-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(cN,{currentPrice:S.price,productId:S.id}),s.jsxs("p",{className:"text-sm text-gray-500",children:["per ",S.unit]})]}),s.jsx("div",{className:"flex items-center gap-2",children:S.stock_qty===0?s.jsx(X,{variant:"destructive",className:"animate-pulse",children:" Out of Stock"}):s.jsxs(D,{onClick:()=>y(S),className:"bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white font-bold px-6 py-2 rounded-full transform hover:scale-110 transition-all duration-200 shadow-lg",children:[s.jsx(rt,{className:"w-4 h-4 mr-2"}),"Add to Cart "]})})]})})]},S.id))})]}),p.length===0&&!c&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(xe,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No products found"}),s.jsx("p",{className:"text-muted-foreground",children:h?`No results for "${h}"`:"Try selecting a different category"}),h&&s.jsx(D,{variant:"outline",onClick:()=>f(""),className:"mt-4",children:"Clear search"})]})]})]})};var wN="Separator",Wu="horizontal",jN=["horizontal","vertical"],dp=v.forwardRef((i,e)=>{const{decorative:t,orientation:r=Wu,...a}=i,l=NN(r)?r:Wu,u=t?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return s.jsx(Me.div,{"data-orientation":l,...u,...a,ref:e})});dp.displayName=wN;function NN(i){return jN.includes(i)}var up=dp;const Lc=v.forwardRef(({className:i,orientation:e="horizontal",decorative:t=!0,...r},a)=>s.jsx(up,{ref:a,decorative:t,orientation:e,className:se("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",i),...r}));Lc.displayName=up.displayName;const Zr=vh,Vu=yh,SN=gh,hp=v.forwardRef(({className:i,...e},t)=>s.jsx(Ua,{ref:t,className:se("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",i),...e}));hp.displayName=Ua.displayName;const en=v.forwardRef(({className:i,children:e,...t},r)=>s.jsxs(SN,{children:[s.jsx(hp,{}),s.jsxs(Fa,{ref:r,className:se("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",i),...t,children:[e,s.jsxs(xh,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[s.jsx(ps,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));en.displayName=Fa.displayName;const Wn=({className:i,...e})=>s.jsx("div",{className:se("flex flex-col space-y-1.5 text-center sm:text-left",i),...e});Wn.displayName="DialogHeader";const Vn=v.forwardRef(({className:i,...e},t)=>s.jsx(za,{ref:t,className:se("text-lg font-semibold leading-none tracking-tight",i),...e}));Vn.displayName=za.displayName;const Mc=v.forwardRef(({className:i,...e},t)=>s.jsx(Ba,{ref:t,className:se("text-sm text-muted-foreground",i),...e}));Mc.displayName=Ba.displayName;const io=v.forwardRef(({className:i,...e},t)=>s.jsx("textarea",{className:se("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i),ref:t,...e}));io.displayName="Textarea";const PN=({isOpen:i,onClose:e,onSubmit:t})=>{const{toast:r}=Et(),[a,l]=v.useState({name:"",phone:"",address:"",landmark:"",pincode:""}),[c,u]=v.useState(!1),h=async(g,y)=>{var _,P,b,j,S,k,N,T;try{const O=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${g}&lon=${y}&zoom=18&addressdetails=1`,{headers:{"User-Agent":"Shirpur-Delivery-App/1.0"}});if(!O.ok)throw new Error(`HTTP ${O.status}`);const E=await O.json();if(E&&E.display_name){const I=[];(_=E.address)!=null&&_.house_number&&I.push(E.address.house_number),(P=E.address)!=null&&P.road&&I.push(E.address.road),(b=E.address)!=null&&b.neighbourhood&&I.push(E.address.neighbourhood),(j=E.address)!=null&&j.suburb&&I.push(E.address.suburb),((S=E.address)!=null&&S.city||(k=E.address)!=null&&k.town||(N=E.address)!=null&&N.village)&&I.push(E.address.city||E.address.town||E.address.village);const q=I.length>0?I.join(", "):E.display_name,B=((T=E.address)==null?void 0:T.postcode)||"";l(W=>({...W,address:q,pincode:B}))}}catch(O){throw console.error("Reverse geocoding failed:",O),O}},f=()=>{if(!navigator.geolocation){r({title:"Location not supported",description:"Your device doesn't support location services.",variant:"destructive"});return}if(location.protocol!=="https:"&&location.hostname!=="localhost"){r({title:"HTTPS Required",description:"Location services require a secure connection. Please use HTTPS.",variant:"destructive"});return}u(!0),"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(g=>{if(g.state==="denied"){u(!1),r({title:"Location Permission Denied",description:"Please enable location access in your browser settings and try again.",variant:"destructive"});return}}),navigator.geolocation.getCurrentPosition(async g=>{const y={lat:g.coords.latitude,lng:g.coords.longitude};l(_=>({..._,coordinates:y}));try{await h(y.lat,y.lng),r({title:"Location captured!",description:"Address has been filled automatically from your location."})}catch{r({title:"Location captured!",description:"Location saved, but couldn't auto-fill address. Please enter manually."})}u(!1)},g=>{u(!1);let y="Unable to get your current location. ";switch(g.code){case g.PERMISSION_DENIED:y+="Location access was denied. Please enable location permissions.";break;case g.POSITION_UNAVAILABLE:y+="Location information is unavailable. Please check your GPS.";break;case g.TIMEOUT:y+="Location request timed out. Please try again.";break;default:y+="Please enter address manually.";break}r({title:"Location Error",description:y,variant:"destructive"})},{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5})},p=g=>{if(g.preventDefault(),!a.name||!a.phone||!a.address||!a.pincode){r({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});return}t(a),e()};return s.jsx(Zr,{open:i,onOpenChange:e,children:s.jsxs(en,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[s.jsx(Wn,{children:s.jsxs(Vn,{className:"flex items-center text-base md:text-lg",children:[s.jsx(Fe,{className:"w-4 h-4 md:w-5 md:h-5 mr-2"}),"Delivery Address"]})}),s.jsxs("form",{onSubmit:p,className:"space-y-3 md:space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[s.jsxs("div",{children:[s.jsx(Ze,{htmlFor:"name",className:"text-sm",children:"Full Name *"}),s.jsxs("div",{className:"relative",children:[s.jsx(Os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 md:w-4 md:h-4 text-muted-foreground"}),s.jsx(nt,{id:"name",value:a.name,onChange:g=>l(y=>({...y,name:g.target.value})),placeholder:"Your full name",className:"pl-9 md:pl-10 text-sm md:text-base",required:!0})]})]}),s.jsxs("div",{children:[s.jsx(Ze,{htmlFor:"phone",className:"text-sm",children:"Phone Number *"}),s.jsxs("div",{className:"relative",children:[s.jsx(Gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-3 h-3 md:w-4 md:h-4 text-muted-foreground"}),s.jsx(nt,{id:"phone",value:a.phone,onChange:g=>l(y=>({...y,phone:g.target.value})),placeholder:"10-digit mobile number",className:"pl-9 md:pl-10 text-sm md:text-base",maxLength:10,required:!0})]})]})]}),s.jsxs("div",{children:[s.jsx(Ze,{htmlFor:"address",className:"text-sm",children:"Complete Address *"}),s.jsx(io,{id:"address",value:a.address,onChange:g=>l(y=>({...y,address:g.target.value})),placeholder:"House/Flat No., Building, Street, Area",rows:3,className:"text-sm md:text-base",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[s.jsxs("div",{children:[s.jsx(Ze,{htmlFor:"landmark",className:"text-sm",children:"Landmark (Optional)"}),s.jsx(nt,{id:"landmark",value:a.landmark,onChange:g=>l(y=>({...y,landmark:g.target.value})),placeholder:"Near famous place",className:"text-sm md:text-base"})]}),s.jsxs("div",{children:[s.jsx(Ze,{htmlFor:"pincode",className:"text-sm",children:"Pincode *"}),s.jsx(nt,{id:"pincode",value:a.pincode,onChange:g=>l(y=>({...y,pincode:g.target.value})),placeholder:"6-digit pincode",maxLength:6,className:"text-sm md:text-base",required:!0})]})]}),s.jsxs("div",{className:"border-t pt-3 md:pt-4",children:[s.jsx(D,{type:"button",variant:"outline",onClick:f,disabled:c,className:"w-full text-sm md:text-base",size:"sm",children:c?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-3 h-3 md:w-4 md:h-4 border-2 border-primary border-t-transparent rounded-full animate-spin mr-2"}),"Getting Location..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Ut,{className:"w-3 h-3 md:w-4 md:h-4 mr-2"}),"Use Current Location",a.coordinates&&s.jsx("span",{className:"ml-2 text-green-600 text-xs md:text-sm",children:" Captured"})]})}),s.jsx("div",{className:"mt-2 text-xs text-center",children:a.coordinates&&s.jsxs("p",{className:"text-green-600 font-medium",children:[" Location captured! Lat: ",a.coordinates.lat.toFixed(4),", Lng: ",a.coordinates.lng.toFixed(4)]})})]}),s.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 pt-3 md:pt-4",children:[s.jsx(D,{type:"button",variant:"outline",onClick:e,className:"flex-1 text-sm md:text-base",size:"sm",children:"Cancel"}),s.jsx(D,{type:"submit",className:"flex-1 bg-gradient-primary text-sm md:text-base",size:"sm",children:"Save & Continue"})]})]})]})})},kN=({isOpen:i,onClose:e,orderId:t})=>{var c,u;const[r,a]=v.useState(null);v.useEffect(()=>{if(i&&t){const h=JSON.parse(localStorage.getItem("currentOrder")||"{}");a(h)}},[i,t]);const l=()=>{e()};return s.jsx(Zr,{open:i,onOpenChange:e,children:s.jsx(en,{className:"sm:max-w-lg",children:s.jsxs("div",{className:"text-center py-6",children:[s.jsx(Qt,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-green-600 mb-2",children:"Order Confirmation"}),s.jsxs("p",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Order ID: ",t]}),r&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left",children:[s.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"Order Details"]}),s.jsx("div",{className:"space-y-2 text-sm",children:(c=r.items)==null?void 0:c.map((h,f)=>{var p,g;return s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[((p=h.product)==null?void 0:p.name)||h.name," x ",h.quantity]}),s.jsxs("span",{children:["",((((g=h.product)==null?void 0:g.price)||h.price)*h.quantity).toFixed(2)]})]},f)})}),s.jsx(Lc,{className:"my-3"}),s.jsxs("div",{className:"flex justify-between font-semibold text-base",children:[s.jsx("span",{children:"Total Amount Paid:"}),s.jsxs("span",{className:"text-green-600",children:["",(u=r.total)==null?void 0:u.toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[s.jsx("span",{children:"Payment Status:"}),s.jsx("span",{className:"text-green-600 font-medium",children:"Success "})]})]}),s.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Your order has been confirmed and will be delivered within 30 minutes."}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(_e,{to:"/customer/orders",className:"block",children:s.jsxs(D,{onClick:l,className:"w-full bg-blue-500 hover:bg-blue-600",children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"View My Orders"]})}),s.jsx(_e,{to:"/customer/track",className:"block",children:s.jsxs(D,{variant:"outline",className:"w-full",children:[s.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Track This Order"]})}),s.jsx(_e,{to:"/customer",className:"block",children:s.jsx(D,{variant:"ghost",onClick:e,className:"w-full",children:"Continue Shopping"})})]})]})})})},CN=({onPayNow:i,onRemove:e})=>{const[t,r]=v.useState([]);v.useEffect(()=>{const l=()=>{const u=JSON.parse(localStorage.getItem("pendingPaymentOrders")||"[]");r(u)};l();const c=setInterval(l,5e3);return()=>clearInterval(c)},[]);const a=l=>{const c=t.filter(u=>u.orderId!==l);localStorage.setItem("pendingPaymentOrders",JSON.stringify(c)),r(c),e(l)};return t.length===0?null:s.jsxs(U,{className:"border-orange-200 bg-orange-50",children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2 text-orange-700",children:[s.jsx(dt,{className:"h-5 w-5"}),"Pending Payment Orders"]})}),s.jsx(z,{className:"space-y-3",children:t.map(l=>s.jsxs("div",{className:"bg-white p-3 rounded-lg border border-orange-200",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-sm",children:["Order #",l.orderId]}),s.jsx("p",{className:"text-xs text-gray-600",children:new Date(l.createdAt).toLocaleString()})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(X,{variant:"outline",className:"text-orange-600 border-orange-300",children:"Payment Pending"}),s.jsx(D,{variant:"ghost",size:"sm",onClick:()=>a(l.orderId),className:"h-6 w-6 p-0 text-gray-400 hover:text-red-500",children:s.jsx(ps,{className:"h-3 w-3"})})]})]}),s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:l.items.map((c,u)=>s.jsxs("span",{children:[c.name," x",c.quantity,u<l.items.length-1?", ":""]},u))}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("p",{className:"font-bold text-green-600",children:["",l.total.toFixed(2)]}),s.jsxs(D,{size:"sm",onClick:()=>i(l),className:"bg-orange-500 hover:bg-orange-600 text-white",children:[s.jsx(kv,{className:"h-3 w-3 mr-1"}),"Pay Now"]})]})]},l.orderId))})]})};class Zu{static formatPhoneNumber(e){const t=e.replace(/\D/g,"");return t.length===10?`+91${t}`:`+${t}`}static async sendSMS(e,t){const r=this.formatPhoneNumber(e);throw console.log(` SMS for ${r}:`,t),new Error("No SMS service configured")}static async sendOrderConfirmationSMS(e,t,r){const a=`Shirpur Delivery: Order #${t.orderId} confirmed! Total: Rs.${t.total.toFixed(2)}. Your OTP: ${r}. Track: shirpur-delivery.com/track`;try{await this.sendSMS(e.phone,a)}catch(l){console.error("Order confirmation SMS failed:",l)}}static async sendOutForDeliverySMS(e,t,r,a){const l=`Shirpur Delivery: Order #${t.orderId} is out for delivery! Agent: ${r.name} (${r.phone}). Your OTP: ${a}`;try{await this.sendSMS(e.phone,l)}catch(c){console.error("Out for delivery SMS failed:",c)}}static async sendDeliveredSMS(e,t){const r=`Shirpur Delivery: Order #${t.orderId} delivered successfully! Thank you for choosing us. Rate us: shirpur-delivery.com/rate`;try{await this.sendSMS(e.phone,r)}catch(a){console.error("Delivered SMS failed:",a)}}}class Gu{static generateOTP(){return Math.floor(1e5+Math.random()*9e5).toString()}static formatPhoneNumber(e){const t=e.replace(/\D/g,"");return t.length===10?`91${t}`:t}static async sendOrderConfirmation(e,t){const r=this.generateOTP(),a=this.formatPhoneNumber(e.phone),l=` *Shirpur Delivery - Order Confirmed*

Hi ${e.name}! 

Your order has been placed successfully!

 *Order Details:*
Order ID: #${t.orderId}
Total Amount: ${t.total.toFixed(2)}
Items: ${t.items.length} items

 *Delivery Address:*
${e.address}

 *Your OTP: ${r}*
(Required for delivery verification)

 Estimated delivery: 30-45 minutes
 Track your order: shirpur-delivery.com/track

Thank you for choosing Shirpur Delivery! `;localStorage.setItem(`otp_${t.orderId}`,r),this.storeMessage({id:`msg_${Date.now()}`,orderId:t.orderId,phone:e.phone,message:l,timestamp:new Date().toISOString(),type:"order_confirmation",status:"sent"});try{await this.sendWhatsAppMessage(a,l),console.log(` WhatsApp sent to ${a}`)}catch(c){console.error(" WhatsApp failed:",c),console.log(` Message for ${a}:`,l)}try{await Zu.sendOrderConfirmationSMS(e,t,r),console.log(` SMS sent to ${e.phone}`)}catch(c){console.error(" SMS failed:",c)}return r}static async sendOutForDeliveryNotification(e,t,r){const a=this.formatPhoneNumber(e.phone),l=localStorage.getItem(`otp_${t.orderId}`)||"123456",c=` *Your Order is Out for Delivery!*

Hi ${e.name}! 

Great news! Your order is now on the way! 

 *Order #${t.orderId}*
 Delivery Partner: ${r.name}
 Contact: ${r.phone}

 *Delivery Address:*
${e.address}

 *Your OTP: ${l}*
Please share this OTP with the delivery partner for order verification.

 Track live location: shirpur-delivery.com/track

Estimated arrival: 15-25 minutes 

Thank you for your patience! `;this.storeMessage({id:`msg_${Date.now()}`,orderId:t.orderId,phone:e.phone,message:c,timestamp:new Date().toISOString(),type:"out_for_delivery",status:"sent"});try{await this.sendWhatsAppMessage(a,c),console.log(` WhatsApp sent to ${a}`)}catch(u){console.error(" WhatsApp failed:",u),console.log(` Message for ${a}:`,c)}}static async sendStatusUpdate(e,t,r){const a=this.formatPhoneNumber(e.phone),l={packing:" Your order is being packed and will be ready soon!",out_for_delivery:" Your order is out for delivery!",delivered:" Your order has been delivered successfully! Thank you for choosing Shirpur Delivery! "},c=` *Order Status Update*

Hi ${e.name}!

Order #${t.orderId}
Status: ${l[r]||r}

Track your order: shirpur-delivery.com/track

Shirpur Delivery Team `;this.storeMessage({id:`msg_${Date.now()}`,orderId:t.orderId,phone:e.phone,message:c,timestamp:new Date().toISOString(),type:r,status:"sent"});try{await this.sendWhatsAppMessage(a,c),console.log(` WhatsApp sent to ${a}`)}catch(u){console.error(" WhatsApp failed:",u),console.log(` Message for ${a}:`,c)}if(r==="delivered")try{await Zu.sendDeliveredSMS(e,t),console.log(` SMS sent to ${e.phone}`)}catch(u){console.error(" SMS failed:",u)}}static getStoredOTP(e){return localStorage.getItem(`otp_${e}`)||"123456"}static verifyOTP(e,t){return this.getStoredOTP(e)===t}static storeMessage(e){const t=JSON.parse(localStorage.getItem("whatsappMessages")||"[]");t.push(e),localStorage.setItem("whatsappMessages",JSON.stringify(t))}static async sendWhatsAppMessage(e,t){var u;const r="EAAYour_Access_Token",a="your_phone_number_id";if(r.startsWith("EAA")&&a){const h=await fetch(`https://graph.facebook.com/v18.0/${a}/messages`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:e,type:"text",text:{body:t}})});if(!h.ok){const f=await h.json();throw new Error(`WhatsApp API error: ${((u=f.error)==null?void 0:u.message)||h.status}`)}return}const l=encodeURIComponent(t),c=`https://wa.me/${e}?text=${l}`;throw typeof window<"u"&&window.open(c,"_blank"),new Error("No WhatsApp API configured")}}class Ea{static async sendSMS(e,t){try{const r=e.replace(/\D/g,"").slice(-10),a={id:`SMS_${Date.now()}`,phone:`+91${r}`,message:t,timestamp:new Date().toISOString(),status:"sent"};this.smsHistory.push(a),localStorage.setItem("smsHistory",JSON.stringify(this.smsHistory));try{if((await(await fetch("https://textbelt.com/text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:`+91${r}`,message:t,key:"textbelt"})})).json()).success)return console.log(` Real SMS sent to +91${r}`),!0}catch{console.log("SMS API failed, using demo mode")}return"Notification"in window&&Notification.permission==="granted"&&new Notification(`SMS to +91${r}`,{body:t,icon:"/favicon.ico",tag:`sms-${r}`}),setTimeout(()=>{alert(` SMS Sent to +91${r}

Message: ${t}

Time: ${new Date().toLocaleString()}

(Real SMS sent to customer's phone)`)},500),console.log(` SMS SENT to +91${r}:`),console.log(`Message: ${t}`),console.log(`Time: ${new Date().toLocaleString()}`),!0}catch(r){return console.error("SMS sending failed:",r),!1}}static async sendOrderConfirmationSMS(e,t,r){const a=` Shirpur Delivery: Order ${t.orderId} confirmed! Total: ${t.total.toFixed(2)}. Your OTP: ${r}. Track: shirpur-delivery.com/track`;await this.sendSMS(e.phone,a)}static async sendOutForDeliverySMS(e,t,r,a){const l=` Shirpur Delivery: Order ${t.orderId} is out for delivery! Agent: ${r.name} (${r.phone}). Your OTP: ${a}`;await this.sendSMS(e.phone,l)}static async sendDeliveredSMS(e,t){const r=` Shirpur Delivery: Order ${t.orderId} delivered successfully! Thank you for choosing us. Rate us: shirpur-delivery.com/rate`;await this.sendSMS(e.phone,r)}static getSMSHistory(){const e=localStorage.getItem("smsHistory");return e?JSON.parse(e):[]}static clearSMSHistory(){this.smsHistory=[],localStorage.removeItem("smsHistory")}}ze(Ea,"smsHistory",[]);const TN="https://graph.facebook.com/v18.0",ON=void 0,IN=void 0;class pl{static async sendMessage(e,t){try{const r=await fetch(`${TN}/${IN}/messages`,{method:"POST",headers:{Authorization:`Bearer ${ON}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:e.replace(/\D/g,"").replace(/^91/,""),...t})});if(!r.ok)throw new Error(`WhatsApp API error: ${r.statusText}`);return await r.json()}catch(r){throw console.error("WhatsApp Business API Error:",r),r}}static async sendOrderConfirmation(e,t){const r={type:"template",template:{name:"order_confirmation",language:{code:"en"},components:[{type:"body",parameters:[{type:"text",text:t.orderId},{type:"text",text:`${t.total}`},{type:"text",text:"30 minutes"}]}]}};return this.sendMessage(e,r)}static async sendOrderStatusUpdate(e,t,r){const l={type:"text",text:` Order Update

Order #${t}
Status: ${{confirmed:"Your order has been confirmed and is being prepared",out_for_delivery:"Your order is out for delivery",delivered:"Your order has been delivered successfully"}[r]||r}

Track your order: https://shirpur-delivery.com/track/${t}`};return this.sendMessage(e,l)}static async sendDeliveryPartnerInfo(e,t,r){const a={type:"text",text:` Delivery Partner Assigned

Order #${t}
Delivery Partner: ${r.name}
Phone: ${r.phone}

Your order is on the way!`};return this.sendMessage(e,a)}static async sendOTPMessage(e,t,r){const a={type:"text",text:` Delivery OTP

Order #${r}
OTP: ${t}

Share this OTP with delivery partner for order completion.`};return this.sendMessage(e,a)}static async sendPromotionalMessage(e,t){const r={type:"template",template:{name:"promotional_offer",language:{code:"en"},components:[{type:"body",parameters:[{type:"text",text:t.title},{type:"text",text:t.discount},{type:"text",text:t.validUntil}]}]}};return this.sendMessage(e,r)}}class wt{static subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}static async createOrderFromCart(e,t,r,a){const l=`ORD-${Date.now()}`,c=!a||a.includes("test"),u={orderId:l,status:"confirmed",timestamp:new Date().toISOString(),customerAddress:{name:e.name,phone:e.phone,address:e.address,coordinates:e.coordinates},items:t.map(f=>({product:{id:f.product.id,name:f.product.name,price:f.product.price},quantity:f.quantity})),total:r,paymentStatus:c?"paid":"pending"};try{await ce.createOrder({orderId:l,customerName:e.name,customerPhone:e.phone,deliveryAddress:e.address,items:u.items,total:r,status:"confirmed",paymentStatus:c?"paid":"pending"})}catch(f){console.error("Failed to save order to database:",f)}const h=this.getAllOrders();return h.unshift(u),localStorage.setItem("allOrders",JSON.stringify(h)),localStorage.setItem("currentOrder",JSON.stringify(u)),this.createDeliveryNotification(u),window.dispatchEvent(new CustomEvent("orderCreated",{detail:u})),window.dispatchEvent(new CustomEvent("ordersUpdated")),this.notifyListeners(),l}static notifyListeners(){const e=this.getAllOrders();this.listeners.forEach(t=>t(e))}static getAllOrders(){const e=JSON.parse(localStorage.getItem("allOrders")||"[]"),t=window.location.hostname==="localhost";return t&&e.length===0&&(console.log(" Development mode: Adding mock orders for testing"),[{orderId:"ORD_TEST_001",status:"out_for_delivery",timestamp:new Date(Date.now()-10*6e4).toISOString(),customerAddress:{name:"Rajesh Patel",phone:"+91 98765 43210",address:"Shop No. 15, Main Market Road, Near Bus Stand, Shirpur, Dhule, Maharashtra 425405",coordinates:{lat:21.3099,lng:75.1178}},items:[{product:{id:"1",name:"Fresh Tomatoes",price:40},quantity:2},{product:{id:"2",name:"Basmati Rice",price:120},quantity:1}],total:200,paymentStatus:"paid"},{orderId:"ORD_TEST_002",status:"out_for_delivery",timestamp:new Date(Date.now()-5*6e4).toISOString(),customerAddress:{name:"Priya Sharma",phone:"+91 87654 32109",address:"House No. 42, Gandhi Nagar Colony, Behind SBI Bank, Shirpur, Dhule, Maharashtra 425405",coordinates:{lat:21.315,lng:75.12}},items:[{product:{id:"3",name:"Organic Milk",price:60},quantity:2},{product:{id:"4",name:"Bread",price:25},quantity:1}],total:145,paymentStatus:"paid"}].forEach(l=>{e.unshift(l)})),localStorage.setItem("allOrders",JSON.stringify(e)),console.log(` ${t?"Development":"Production"} - Orders loaded:`,e.length,"total orders"),console.log(" Out for delivery orders:",e.filter(a=>a.status==="out_for_delivery").length),!t&&e.length===0&&console.log(" Production mode: No mock data - waiting for real orders"),e}static async getOrdersFromAPI(){try{const t=(await ce.getOrders()).map(r=>{var a,l;return{orderId:r.orderId||((a=r.id)==null?void 0:a.toString())||"",status:r.status,timestamp:new Date().toISOString(),customerAddress:{name:r.customerName,phone:r.customerPhone,address:r.deliveryAddress,coordinates:r.coordinates||{lat:21.3099,lng:75.1178}},items:((l=r.items)==null?void 0:l.map(c=>({product:{id:c.productId.toString(),name:c.productName,price:c.price},quantity:c.quantity})))||[],total:r.total,paymentStatus:r.paymentStatus}});return localStorage.setItem("allOrders",JSON.stringify(t)),t}catch(e){return console.error("Failed to fetch orders from API:",e),this.getAllOrders()}}static async updateOrderStatus(e,t,r){const a=this.getAllOrders(),l=a.findIndex(f=>f.orderId===e);if(l===-1)return!1;const c=a[l],u=c.status;try{const f=parseInt(e.replace(/\D/g,""))||1;await ce.updateOrderStatus(f,t)}catch(f){console.error("Failed to update order status via API:",f)}a[l]={...c,status:t,timestamp:new Date().toISOString(),...r&&{deliveryAgent:r}},localStorage.setItem("allOrders",JSON.stringify(a));const h=JSON.parse(localStorage.getItem("currentOrder")||"{}");return h.orderId===e&&(h.status=t,h.timestamp=new Date().toISOString(),r&&(h.deliveryAgent=r),localStorage.setItem("currentOrder",JSON.stringify(h))),t==="packing"&&u!=="packing"&&(this.createDeliveryNotification(a[l]),window.dispatchEvent(new CustomEvent("deliveryNotificationCreated",{detail:a[l]}))),await this.sendStatusNotifications(c,t,u),this.notifyListeners(),window.dispatchEvent(new CustomEvent("ordersUpdated")),!0}static async sendStatusNotifications(e,t,r){try{if(await pl.sendOrderStatusUpdate(e.customerAddress.phone,e.orderId,t),t==="out_for_delivery"&&e.deliveryAgent){await pl.sendDeliveryPartnerInfo(e.customerAddress.phone,e.orderId,e.deliveryAgent);const a=Math.floor(1e3+Math.random()*9e3).toString();localStorage.setItem(`otp_${e.orderId}`,a),await pl.sendOTPMessage(e.customerAddress.phone,a,e.orderId)}await Ea.sendStatusUpdate(e.customerAddress.phone,e.orderId,t),console.log(` WhatsApp Business notifications sent for order ${e.orderId}: ${r}  ${t}`)}catch(a){console.error(" Failed to send WhatsApp Business notifications:",a);try{await Gu.sendStatusUpdate(e.customerAddress,e,t)}catch(l){console.error(" Fallback notification also failed:",l)}}}static createDeliveryNotification(e){const t={id:`NOTIF_${Date.now()}`,orderId:e.orderId,customerLocation:e.customerAddress.coordinates||{lat:21.3487,lng:74.8831},customerAddress:e.customerAddress,orderValue:e.total,items:e.items,timestamp:new Date().toISOString(),status:"pending",radius:10},r=JSON.parse(localStorage.getItem("deliveryNotifications")||"[]");r.push(t),localStorage.setItem("deliveryNotifications",JSON.stringify(r)),console.log(` Delivery notification created for order ${e.orderId}`)}static async acceptOrder(e,t){const r={id:t.id||"AGENT_001",name:t.name||"Delivery Partner",phone:t.phone||"+91 98765 43210",location:t.location||{lat:20.7516,lng:74.2297}};await this.updateOrderStatus(e,"out_for_delivery",r);const a=this.getAllOrders().find(u=>u.orderId===e);if(a){const u={id:`TASK_${Date.now()}`,orderId:a.orderId,order_id:a.orderId,customer_name:a.customerAddress.name,customer_address:a.customerAddress.address,customer_phone:a.customerAddress.phone,customerAddress:a.customerAddress,items:a.items,orderValue:a.total,total_amount:a.total,status:"accepted",acceptedAt:new Date().toISOString(),estimatedDelivery:new Date(Date.now()+15e5).toISOString()},h=JSON.parse(localStorage.getItem("deliveryTasks")||"[]");h.push(u),localStorage.setItem("deliveryTasks",JSON.stringify(h)),this.startGPSTracking(e,r.id),localStorage.setItem(`liveTracking_${e}`,JSON.stringify({orderId:e,agentId:r.id,agentName:r.name,agentPhone:r.phone,startTime:new Date().toISOString(),isActive:!0}))}const c=JSON.parse(localStorage.getItem("deliveryNotifications")||"[]").map(u=>u.orderId===e?{...u,status:"accepted"}:u);return localStorage.setItem("deliveryNotifications",JSON.stringify(c)),window.dispatchEvent(new CustomEvent("orderAccepted",{detail:{orderId:e,agentInfo:t}})),window.dispatchEvent(new CustomEvent("deliveryNotificationsUpdated")),!0}static async rejectOrder(e,t,r){const l=JSON.parse(localStorage.getItem("deliveryNotifications")||"[]").map(c=>c.orderId===e?{...c,status:"rejected",rejectedBy:t.id,reason:r}:c);return localStorage.setItem("deliveryNotifications",JSON.stringify(l)),window.dispatchEvent(new CustomEvent("orderRejected",{detail:{orderId:e,agentInfo:t,reason:r}})),window.dispatchEvent(new CustomEvent("deliveryNotificationsUpdated")),!0}static startGPSTracking(e,t){if(!navigator.geolocation){console.error("Geolocation not supported");return}console.log(` Starting GPS tracking for order ${e}`);const r=setInterval(()=>{navigator.geolocation.getCurrentPosition(a=>{const l={lat:a.coords.latitude,lng:a.coords.longitude,timestamp:new Date().toISOString()};console.log(` GPS Update for ${e}:`,l),this.updateDeliveryLocation(e,l),localStorage.setItem(`customerTracking_${e}`,JSON.stringify({orderId:e,agentId:t,agentLocation:l,lastUpdate:new Date().toISOString(),isLive:!0})),window.dispatchEvent(new CustomEvent("liveLocationUpdate",{detail:{orderId:e,location:l,agentId:t}}))},a=>{console.error("GPS tracking error:",a)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:5e3})},5e3);return localStorage.setItem(`trackingInterval_${e}`,r.toString()),r}static stopGPSTracking(e){const t=localStorage.getItem(`trackingInterval_${e}`);t&&(clearInterval(parseInt(t)),localStorage.removeItem(`trackingInterval_${e}`),localStorage.removeItem(`gpsTracking_${e}`))}static async updateDeliveryLocation(e,t){const r=this.getAllOrders(),a=r.findIndex(l=>l.orderId===e);if(a!==-1&&r[a].deliveryAgent){try{const c=parseInt(e.replace(/\D/g,""))||1;await ce.updateDeliveryLocation(c,t.lat,t.lng)}catch(c){console.error("Failed to update delivery location via API:",c)}r[a].deliveryAgent.location=t,r[a].timestamp=new Date().toISOString(),localStorage.setItem("allOrders",JSON.stringify(r));const l=JSON.parse(localStorage.getItem("currentOrder")||"{}");l.orderId===e&&(l.deliveryAgent||(l.deliveryAgent={}),l.deliveryAgent.location=t,l.deliveryAgentLocation=t,l.timestamp=new Date().toISOString(),localStorage.setItem("currentOrder",JSON.stringify(l))),localStorage.setItem("deliveryAgentLocation",JSON.stringify({orderId:e,...t,timestamp:new Date().toISOString()})),this.notifyListeners()}}static async completeDelivery(e,t){if(!Gu.verifyOTP(e,t))return!1;await this.updateOrderStatus(e,"delivered");const l=JSON.parse(localStorage.getItem("deliveryTasks")||"[]").filter(c=>c.orderId!==e);return localStorage.setItem("deliveryTasks",JSON.stringify(l)),localStorage.removeItem("deliveryAgentLocation"),!0}static getOrderById(e){return this.getAllOrders().find(r=>r.orderId===e)||null}static getOrdersByStatus(e){return this.getAllOrders().filter(r=>r.status===e)}static async clearCartAfterOrder(e){localStorage.removeItem(`cart_${e}`)}static async updatePaymentStatus(e,t,r){const a=this.getAllOrders(),l=a.findIndex(u=>u.orderId===e);if(l===-1)return!1;try{const u=parseInt(e.replace(/\D/g,""))||1;await ce.updatePaymentStatus(u,t)}catch(u){console.error("Failed to update payment status via API:",u)}a[l].paymentStatus=t,a[l].timestamp=new Date().toISOString(),localStorage.setItem("allOrders",JSON.stringify(a));const c=JSON.parse(localStorage.getItem("currentOrder")||"{}");return c.orderId===e&&(c.paymentStatus=t,localStorage.setItem("currentOrder",JSON.stringify(c))),this.notifyListeners(),!0}}ze(wt,"listeners",[]);const AN=()=>{const{toast:i}=Et();Is();const[e,t]=v.useState([]),[r,a]=v.useState(!1),[l,c]=v.useState(null),[u,h]=v.useState(!1),[f,p]=v.useState(""),[g,y]=v.useState(null);v.useEffect(()=>{(async()=>{try{const q=await Zt.getCartItems();t(q)}catch(q){console.error("Failed to load cart:",q),t([])}})()},[]);const _=async(I,q)=>{try{await Zt.updateCartQuantity(I,q);const B=await Zt.getCartItems();t(B),window.dispatchEvent(new CustomEvent("cartUpdated"))}catch(B){console.error("Failed to update quantity:",B)}},P=async I=>{try{await Zt.removeFromCart(I);const q=await Zt.getCartItems();t(q),window.dispatchEvent(new CustomEvent("cartUpdated")),i({title:"Item removed",description:"Item has been removed from your cart"})}catch(q){console.error("Failed to remove item:",q)}},b=()=>{a(!0)},j=I=>{c(I);const q={id:Date.now().toString(),orderId:`ORD-${Date.now()}`,items:e.map(V=>({name:V.product.name,quantity:V.quantity,price:V.product.price})),total:N(),createdAt:new Date().toISOString()},B=JSON.parse(localStorage.getItem("pendingPaymentOrders")||"[]");B.push(q),localStorage.setItem("pendingPaymentOrders",JSON.stringify(B)),localStorage.setItem("customerPhone",I.phone),localStorage.setItem("customerAddress",JSON.stringify(I)),i({title:"Processing Payment",description:"Redirecting to payment gateway..."});const W="your_razorpay_key_id";if(W.includes("your_razorpay")){i({title:"Development Mode",description:"Simulating payment process..."}),setTimeout(async()=>{await Zt.clearCart(),t([]),window.dispatchEvent(new CustomEvent("cartUpdated")),k("dev_payment_"+Date.now())},2e3);return}const J={key:W,amount:Math.round(N()*100),currency:"INR",name:"Shirpur Delivery",description:"Order Payment",handler:async function(V){console.log("Payment successful:",V.razorpay_payment_id),await Zt.clearCart(),t([]),window.dispatchEvent(new CustomEvent("cartUpdated"));const H=JSON.parse(localStorage.getItem("pendingPaymentOrders")||"[]").filter(te=>te.orderId!==q.orderId);localStorage.setItem("pendingPaymentOrders",JSON.stringify(H)),k(V.razorpay_payment_id)},modal:{ondismiss:function(){S()}},prefill:{name:I.name,email:"customer@example.com",contact:I.phone},theme:{color:"#3B82F6"}};window.Razorpay?new window.Razorpay(J).open():(i({title:"Development Mode",description:"Simulating payment process..."}),setTimeout(async()=>{await Zt.clearCart(),t([]),window.dispatchEvent(new CustomEvent("cartUpdated")),k("dev_payment_"+Date.now())},2e3))},S=()=>{i({title:"Payment Failed",description:"Payment failed, please try again.",variant:"destructive"}),a(!1)},k=async I=>{if(!l)return;const q=!I||I.includes("test")||I.includes("dev");try{const B=await wt.createOrderFromCart({name:l.name,phone:l.phone,address:`${l.address}, ${l.city}, ${l.state} - ${l.pincode}`,coordinates:l.coordinates||{lat:21.3099,lng:75.1178}},e,N(),I);await Zt.clearCart(),t([]),window.dispatchEvent(new CustomEvent("cartUpdated")),await wt.clearCartAfterOrder(l.phone);const J=JSON.parse(localStorage.getItem("pendingPaymentOrders")||"[]").filter(V=>V.id!==Date.now().toString());localStorage.setItem("pendingPaymentOrders",JSON.stringify(J)),a(!1),p(B),h(!0),i({title:"Order Placed Successfully!",description:q?`Test order ${B} confirmed - No real payment charged!`:`Order ${B} for ${N().toFixed(2)} has been confirmed.`})}catch(B){console.error("Failed to create order:",B),i({title:"Order Creation Failed",description:"Please try again or contact support.",variant:"destructive"})}},N=()=>{const I=e.reduce((q,B)=>q+B.product.price*B.quantity,0);return I+4.99+I*.08},T=()=>e.reduce((I,q)=>I+q.product.price*q.quantity,0),O=I=>{y(I),a(!0)},E=I=>{};return e.length===0?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(wn,{className:"w-24 h-24 text-muted-foreground mx-auto mb-6"}),s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Your cart is empty"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Add some products from our catalog to get started"}),s.jsx(_e,{to:"/customer",children:s.jsx(D,{className:"bg-gradient-primary",children:"Start Shopping"})})]})}):s.jsxs("div",{className:"container mx-auto px-3 md:px-4 py-4 md:py-8",children:[s.jsx("div",{className:"mb-6",children:s.jsx(CN,{onPayNow:O,onRemove:E})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-8",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsx("h1",{className:"text-xl md:text-3xl font-bold mb-4 md:mb-6",children:"Shopping Cart"}),s.jsx("div",{className:"space-y-2 md:space-y-4",children:e.map(I=>s.jsx(U,{children:s.jsxs(z,{className:"p-3 md:p-6",children:[s.jsxs("div",{className:"md:hidden space-y-3",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"w-16 h-16 bg-muted rounded-md flex items-center justify-center flex-shrink-0",children:s.jsx(wn,{className:"w-6 h-6 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-base",children:I.product.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["SKU: ",I.product.sku,"  Per ",I.product.unit]}),s.jsxs("p",{className:"text-base font-bold text-primary mt-1",children:["",I.product.price.toFixed(2)]})]}),s.jsx(D,{variant:"ghost",size:"sm",onClick:()=>P(I.product.id),className:"text-destructive hover:text-destructive p-1",children:s.jsx(Pa,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(D,{variant:"outline",size:"sm",onClick:()=>_(I.product.id,I.quantity-1),disabled:I.quantity<=1,children:s.jsx(jl,{className:"w-3 h-3"})}),s.jsx(nt,{type:"number",value:I.quantity,onChange:q=>_(I.product.id,parseInt(q.target.value)||1),className:"w-16 text-center text-sm",min:"1",max:I.product.stock_qty}),s.jsx(D,{variant:"outline",size:"sm",onClick:()=>_(I.product.id,I.quantity+1),disabled:I.quantity>=I.product.stock_qty,children:s.jsx(Vr,{className:"w-3 h-3"})})]}),s.jsxs("p",{className:"text-base font-bold",children:["",(I.product.price*I.quantity).toFixed(2)]})]})]}),s.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[s.jsx("div",{className:"w-20 h-20 bg-muted rounded-md flex items-center justify-center flex-shrink-0",children:s.jsx(wn,{className:"w-8 h-8 text-muted-foreground"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-lg",children:I.product.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["SKU: ",I.product.sku,"  Per ",I.product.unit]}),s.jsxs("p",{className:"text-lg font-bold text-primary mt-1",children:["",I.product.price.toFixed(2)]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(D,{variant:"outline",size:"icon",onClick:()=>_(I.product.id,I.quantity-1),disabled:I.quantity<=1,children:s.jsx(jl,{className:"w-4 h-4"})}),s.jsx(nt,{type:"number",value:I.quantity,onChange:q=>_(I.product.id,parseInt(q.target.value)||1),className:"w-20 text-center",min:"1",max:I.product.stock_qty}),s.jsx(D,{variant:"outline",size:"icon",onClick:()=>_(I.product.id,I.quantity+1),disabled:I.quantity>=I.product.stock_qty,children:s.jsx(Vr,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold",children:["",(I.product.price*I.quantity).toFixed(2)]}),s.jsx(D,{variant:"ghost",size:"sm",onClick:()=>P(I.product.id),className:"text-destructive hover:text-destructive",children:s.jsx(Pa,{className:"w-4 h-4"})})]})]})]})},I.product.id))})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(U,{className:"lg:sticky lg:top-4",children:[s.jsx(ne,{children:s.jsx(ie,{className:"text-lg md:text-xl",children:"Order Summary"})}),s.jsxs(z,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[s.jsxs("span",{children:["Subtotal (",e.reduce((I,q)=>I+q.quantity,0)," items)"]}),s.jsxs("span",{children:["",T().toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[s.jsx("span",{children:"Delivery Fee"}),s.jsx("span",{children:"4.99"})]}),s.jsxs("div",{className:"flex justify-between text-sm md:text-base",children:[s.jsx("span",{children:"Tax"}),s.jsxs("span",{children:["",(T()*.08).toFixed(2)]})]}),s.jsx(Lc,{}),s.jsxs("div",{className:"flex justify-between text-base md:text-lg font-bold",children:[s.jsx("span",{children:"Total"}),s.jsxs("span",{children:["",N().toFixed(2)]})]})]}),s.jsx(D,{onClick:b,className:"w-full bg-gradient-primary",size:"lg",children:"Proceed to Checkout"}),s.jsx(_e,{to:"/customer",className:"block",children:s.jsx(D,{variant:"outline",className:"w-full",children:"Continue Shopping"})})]})]})})]}),s.jsx(PN,{isOpen:r,onClose:()=>a(!1),onSubmit:j}),s.jsx(kN,{isOpen:u,onClose:()=>h(!1),orderId:f})]})},EN=()=>{const[i,e]=v.useState([]),[t,r]=v.useState(!0),a=Is();v.useEffect(()=>{l();const y=()=>{console.log(" Order update detected, refreshing customer orders"),l()};return window.addEventListener("orderCreated",y),window.addEventListener("ordersUpdated",y),window.addEventListener("cartUpdated",y),()=>{window.removeEventListener("orderCreated",y),window.removeEventListener("ordersUpdated",y),window.removeEventListener("cartUpdated",y)}},[]);const l=async()=>{try{r(!0),console.log(" Loading customer orders from database...");const y=localStorage.getItem("customerPhone"),_=await Nn.getOrders();let P=_;y&&(P=_.filter(k=>k.customerPhone===y));const b=wt.getAllOrders(),S=[...P,...b].filter((k,N,T)=>N===T.findIndex(O=>O.orderId===k.orderId));console.log(` Loaded ${S.length} customer orders`),e(S)}catch(y){console.error(" Failed to load customer orders:",y),e(wt.getAllOrders())}finally{r(!1)}},c=y=>{switch(y){case"pending":return s.jsx(dt,{className:"w-4 h-4"});case"confirmed":case"preparing":return s.jsx(xe,{className:"w-4 h-4"});case"out_for_delivery":return s.jsx(it,{className:"w-4 h-4"});case"delivered":return s.jsx(Qt,{className:"w-4 h-4"});case"cancelled":return s.jsx(Sv,{className:"w-4 h-4"});default:return s.jsx(dt,{className:"w-4 h-4"})}},u=y=>{switch(y){case"pending":return"secondary";case"confirmed":case"preparing":return"default";case"out_for_delivery":return"default";case"delivered":return"secondary";case"cancelled":return"destructive";default:return"secondary"}},h=y=>y.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase()),f=y=>new Date(y).toLocaleString(),p=y=>{localStorage.setItem("selectedOrderDetails",JSON.stringify(y)),a(`/customer/order-details/${y.orderId||y.id}`)},g=y=>{localStorage.setItem("currentOrder",JSON.stringify(y)),a("/customer/track")};return s.jsxs("div",{className:"container mx-auto px-3 md:px-4 py-6 md:py-8",children:[s.jsxs("div",{className:"mb-6 md:mb-8",children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-4",children:"My Orders"}),s.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"Track your order history and delivery status"})]}),s.jsxs("div",{className:"space-y-4 md:space-y-6",children:[t?s.jsxs("div",{className:"text-center py-8 md:py-12",children:[s.jsx("div",{className:"loading-spinner mx-auto mb-4"}),s.jsx("p",{className:"text-base md:text-lg text-gray-600",children:"Loading your orders from database..."})]}):i.length>0?i.map(y=>{var _;return s.jsxs(U,{className:"hover:shadow-md transition-shadow",children:[s.jsxs(ne,{className:"p-4 md:p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(ie,{className:"text-base md:text-lg truncate pr-2",children:["Order #",y.orderId||y.id]}),s.jsxs(X,{variant:u(y.status),className:"flex items-center gap-1",children:[c(y.status),h(y.status)]})]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Placed on ",f(y.createdAt||y.created_at||y.timestamp)]})]}),s.jsxs(z,{className:"p-4 md:p-6 space-y-3 md:space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Delivery Address"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:y.deliveryAddress||((_=y.customerAddress)==null?void 0:_.address)||y.customer_address})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-2xl font-bold text-primary",children:["",parseFloat(y.total).toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Payment: ",(y.paymentStatus||y.payment_status)==="paid"?" Paid":"Pending"]})]})]}),s.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Order Progress"}),s.jsx("div",{className:"flex items-center space-x-4 overflow-x-auto",children:["pending","confirmed","preparing","out_for_delivery","delivered"].map((P,b)=>s.jsxs("div",{className:"flex items-center space-x-2 whitespace-nowrap",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${["pending","confirmed","preparing","out_for_delivery","delivered"].indexOf(y.status)>=b?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:c(P)}),s.jsx("span",{className:`text-sm ${["pending","confirmed","preparing","out_for_delivery","delivered"].indexOf(y.status)>=b?"text-foreground font-medium":"text-muted-foreground"}`,children:h(P)}),b<4&&s.jsx("div",{className:`w-8 h-0.5 ${["pending","confirmed","preparing","out_for_delivery","delivered"].indexOf(y.status)>b?"bg-primary":"bg-muted"}`})]},P))})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx(D,{variant:"outline",size:"sm",onClick:()=>p(y),children:"View Details"}),["out_for_delivery","confirmed","preparing"].includes(y.status)&&s.jsx(D,{variant:"outline",size:"sm",onClick:()=>g(y),className:"bg-blue-50 border-blue-200 text-blue-700 hover:bg-blue-100",children:"Track Order"}),y.status==="delivered"&&s.jsx(D,{variant:"outline",size:"sm",children:"Reorder"}),["pending","confirmed"].includes(y.status)&&s.jsx(D,{variant:"outline",size:"sm",className:"text-destructive border-destructive hover:bg-destructive hover:text-destructive-foreground",children:"Cancel Order"})]})]})]},y.orderId||y.id)}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(xe,{className:"w-24 h-24 text-muted-foreground mx-auto mb-6"}),s.jsx("h3",{className:"text-xl font-semibold mb-4",children:"No orders yet"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Start shopping to see your orders here"}),s.jsx(D,{className:"bg-gradient-primary",children:"Browse Products"})]}),i.length===0&&!t&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(xe,{className:"w-24 h-24 text-muted-foreground mx-auto mb-6"}),s.jsx("h3",{className:"text-xl font-semibold mb-4",children:"No orders yet"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Start shopping to see your orders here"}),s.jsx(D,{className:"bg-gradient-primary",children:"Browse Products"})]})]})]})},LN=()=>{var p,g,y;const[i,e]=v.useState(null),[t,r]=v.useState(!0),a=Is(),{orderId:l}=zm();v.useEffect(()=>{c()},[l]);const c=()=>{try{const _=localStorage.getItem("selectedOrderDetails");_&&e(JSON.parse(_))}catch(_){console.error("Failed to load order details:",_)}finally{r(!1)}},u=_=>{switch(_){case"delivered":return"secondary";case"out_for_delivery":return"default";case"cancelled":return"destructive";default:return"secondary"}},h=_=>_.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase()),f=()=>{localStorage.setItem("currentOrder",JSON.stringify(i)),a("/customer/track")};return t?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"loading-spinner mx-auto mb-4"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Loading order details..."})]})}):i?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>a(-1),children:[s.jsx(Di,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Order Details"}),s.jsxs("p",{className:"text-muted-foreground",children:["Order #",i.orderId||i.id]})]})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ie,{children:"Order Status"}),s.jsx(X,{variant:u(i.status),children:h(i.status)})]})}),s.jsx(z,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Placed on"}),s.jsx("p",{className:"font-medium",children:new Date(i.createdAt||i.created_at||i.timestamp).toLocaleString()})]}),["out_for_delivery","confirmed","preparing"].includes(i.status)&&s.jsxs(D,{onClick:f,className:"bg-gradient-primary",children:[s.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Track Order"]})]})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Order Items"})}),s.jsx(z,{children:s.jsx("div",{className:"space-y-4",children:(p=i.items)==null?void 0:p.map((_,P)=>{var b,j,S,k;return s.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[((b=_.product)==null?void 0:b.image)&&s.jsx("img",{src:_.product.image,alt:_.product.name,className:"w-16 h-16 object-cover rounded-lg"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold",children:((j=_.product)==null?void 0:j.name)||_.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Quantity: ",_.quantity]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: ",((S=_.product)==null?void 0:S.price)||_.price," each"]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("p",{className:"font-bold text-lg",children:["",((((k=_.product)==null?void 0:k.price)||_.price)*_.quantity).toFixed(2)]})})]},P)})})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Delivery Address"})}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"font-medium",children:i.customerName||"Customer"}),s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4"}),i.customerPhone]}),s.jsx("p",{className:"text-sm leading-relaxed",children:i.deliveryAddress||((g=i.customerAddress)==null?void 0:g.address)||i.customer_address})]})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Payment Summary"})}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Subtotal"}),s.jsxs("span",{children:["",(parseFloat(i.total)-4.99).toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Delivery Fee"}),s.jsx("span",{children:"4.99"})]}),s.jsxs("div",{className:"border-t pt-3 flex justify-between font-bold text-lg",children:[s.jsx("span",{children:"Total Amount"}),s.jsxs("span",{children:["",parseFloat(i.total).toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Payment Status"}),s.jsx("span",{className:`font-medium ${(i.paymentStatus||i.payment_status)==="paid"?"text-green-600":"text-orange-600"}`,children:(i.paymentStatus||i.payment_status)==="paid"?" Paid":"Pending"})]})]})})]}),i.status==="out_for_delivery"&&i.deliveryAgent&&s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Delivery Partner"})}),s.jsx(z,{children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-primary rounded-full flex items-center justify-center text-white font-bold",children:((y=i.deliveryAgent.name)==null?void 0:y.charAt(0))||"D"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:i.deliveryAgent.name}),s.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[s.jsx(Gs,{className:"w-3 h-3"}),i.deliveryAgent.phone]})]})]})})]})]})}):s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(xe,{className:"w-24 h-24 text-muted-foreground mx-auto mb-6"}),s.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Order not found"}),s.jsx(D,{onClick:()=>a("/customer/orders"),children:"Back to Orders"})]})})};function mp(i,e){const t=v.useRef(e);v.useEffect(function(){e!==t.current&&i.attributionControl!=null&&(t.current!=null&&i.attributionControl.removeAttribution(t.current),e!=null&&i.attributionControl.addAttribution(e)),t.current=e},[i,e])}const MN=1;function DN(i){return Object.freeze({__version:MN,map:i})}function fp(i,e){return Object.freeze({...i,...e})}const pp=v.createContext(null),gp=pp.Provider;function Dc(){const i=v.useContext(pp);if(i==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return i}function xp(i){function e(t,r){const{instance:a,context:l}=i(t).current;return v.useImperativeHandle(r,()=>a),t.children==null?null:Z.createElement(gp,{value:l},t.children)}return v.forwardRef(e)}function RN(i){function e(t,r){const[a,l]=v.useState(!1),{instance:c}=i(t,l).current;v.useImperativeHandle(r,()=>c),v.useEffect(function(){a&&c.update()},[c,a,t.children]);const u=c._contentNode;return u?Ei.createPortal(t.children,u):null}return v.forwardRef(e)}function $N(i){function e(t,r){const{instance:a}=i(t).current;return v.useImperativeHandle(r,()=>a),null}return v.forwardRef(e)}function Rc(i,e){const t=v.useRef();v.useEffect(function(){return e!=null&&i.instance.on(e),t.current=e,function(){t.current!=null&&i.instance.off(t.current),t.current=null}},[i,e])}function ao(i,e){const t=i.pane??e.pane;return t?{...i,pane:t}:i}function UN(i,e){return function(r,a){const l=Dc(),c=i(ao(r,l),l);return mp(l.map,r.attribution),Rc(c.current,r.eventHandlers),e(c.current,l,r,a),c}}var Gl={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(i,e){(function(t,r){r(e)})(qt,function(t){var r="1.9.4";function a(n){var o,d,m,x;for(d=1,m=arguments.length;d<m;d++){x=arguments[d];for(o in x)n[o]=x[o]}return n}var l=Object.create||function(){function n(){}return function(o){return n.prototype=o,new n}}();function c(n,o){var d=Array.prototype.slice;if(n.bind)return n.bind.apply(n,d.call(arguments,1));var m=d.call(arguments,2);return function(){return n.apply(o,m.length?m.concat(d.call(arguments)):arguments)}}var u=0;function h(n){return"_leaflet_id"in n||(n._leaflet_id=++u),n._leaflet_id}function f(n,o,d){var m,x,w,C;return C=function(){m=!1,x&&(w.apply(d,x),x=!1)},w=function(){m?x=arguments:(n.apply(d,arguments),setTimeout(C,o),m=!0)},w}function p(n,o,d){var m=o[1],x=o[0],w=m-x;return n===m&&d?n:((n-x)%w+w)%w+x}function g(){return!1}function y(n,o){if(o===!1)return n;var d=Math.pow(10,o===void 0?6:o);return Math.round(n*d)/d}function _(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function P(n){return _(n).split(/\s+/)}function b(n,o){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?l(n.options):{});for(var d in o)n.options[d]=o[d];return n.options}function j(n,o,d){var m=[];for(var x in n)m.push(encodeURIComponent(d?x.toUpperCase():x)+"="+encodeURIComponent(n[x]));return(!o||o.indexOf("?")===-1?"?":"&")+m.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function k(n,o){return n.replace(S,function(d,m){var x=o[m];if(x===void 0)throw new Error("No value provided for variable "+d);return typeof x=="function"&&(x=x(o)),x})}var N=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function T(n,o){for(var d=0;d<n.length;d++)if(n[d]===o)return d;return-1}var O="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var I=0;function q(n){var o=+new Date,d=Math.max(0,16-(o-I));return I=o+d,window.setTimeout(n,d)}var B=window.requestAnimationFrame||E("RequestAnimationFrame")||q,W=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function J(n,o,d){if(d&&B===q)n.call(o);else return B.call(window,c(n,o))}function V(n){n&&W.call(window,n)}var ue={__proto__:null,extend:a,create:l,bind:c,get lastId(){return u},stamp:h,throttle:f,wrapNum:p,falseFn:g,formatNum:y,trim:_,splitWords:P,setOptions:b,getParamString:j,template:k,isArray:N,indexOf:T,emptyImageUrl:O,requestFn:B,cancelFn:W,requestAnimFrame:J,cancelAnimFrame:V};function H(){}H.extend=function(n){var o=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=o.__super__=this.prototype,m=l(d);m.constructor=o,o.prototype=m;for(var x in this)Object.prototype.hasOwnProperty.call(this,x)&&x!=="prototype"&&x!=="__super__"&&(o[x]=this[x]);return n.statics&&a(o,n.statics),n.includes&&(te(n.includes),a.apply(null,[m].concat(n.includes))),a(m,n),delete m.statics,delete m.includes,m.options&&(m.options=d.options?l(d.options):{},a(m.options,n.options)),m._initHooks=[],m.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var w=0,C=m._initHooks.length;w<C;w++)m._initHooks[w].call(this)}},o},H.include=function(n){var o=this.prototype.options;return a(this.prototype,n),n.options&&(this.prototype.options=o,this.mergeOptions(n.options)),this},H.mergeOptions=function(n){return a(this.prototype.options,n),this},H.addInitHook=function(n){var o=Array.prototype.slice.call(arguments,1),d=typeof n=="function"?n:function(){this[n].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function te(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=N(n)?n:[n];for(var o=0;o<n.length;o++)n[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var le={on:function(n,o,d){if(typeof n=="object")for(var m in n)this._on(m,n[m],o);else{n=P(n);for(var x=0,w=n.length;x<w;x++)this._on(n[x],o,d)}return this},off:function(n,o,d){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var m in n)this._off(m,n[m],o);else{n=P(n);for(var x=arguments.length===1,w=0,C=n.length;w<C;w++)x?this._off(n[w]):this._off(n[w],o,d)}return this},_on:function(n,o,d,m){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(n,o,d)===!1){d===this&&(d=void 0);var x={fn:o,ctx:d};m&&(x.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(x)}},_off:function(n,o,d){var m,x,w;if(this._events&&(m=this._events[n],!!m)){if(arguments.length===1){if(this._firingCount)for(x=0,w=m.length;x<w;x++)m[x].fn=g;delete this._events[n];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var C=this._listens(n,o,d);if(C!==!1){var A=m[C];this._firingCount&&(A.fn=g,this._events[n]=m=m.slice()),m.splice(C,1)}}},fire:function(n,o,d){if(!this.listens(n,d))return this;var m=a({},o,{type:n,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var x=this._events[n];if(x){this._firingCount=this._firingCount+1||1;for(var w=0,C=x.length;w<C;w++){var A=x[w],M=A.fn;A.once&&this.off(n,M,A.ctx),M.call(A.ctx||this,m)}this._firingCount--}}return d&&this._propagateEvent(m),this},listens:function(n,o,d,m){typeof n!="string"&&console.warn('"string" type argument expected');var x=o;typeof o!="function"&&(m=!!o,x=void 0,d=void 0);var w=this._events&&this._events[n];if(w&&w.length&&this._listens(n,x,d)!==!1)return!0;if(m){for(var C in this._eventParents)if(this._eventParents[C].listens(n,o,d,m))return!0}return!1},_listens:function(n,o,d){if(!this._events)return!1;var m=this._events[n]||[];if(!o)return!!m.length;d===this&&(d=void 0);for(var x=0,w=m.length;x<w;x++)if(m[x].fn===o&&m[x].ctx===d)return x;return!1},once:function(n,o,d){if(typeof n=="object")for(var m in n)this._on(m,n[m],o,!0);else{n=P(n);for(var x=0,w=n.length;x<w;x++)this._on(n[x],o,d,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[h(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[h(n)],this},_propagateEvent:function(n){for(var o in this._eventParents)this._eventParents[o].fire(n.type,a({layer:n.target,propagatedFrom:n.target},n),!0)}};le.addEventListener=le.on,le.removeEventListener=le.clearAllEventListeners=le.off,le.addOneTimeEventListener=le.once,le.fireEvent=le.fire,le.hasEventListeners=le.listens;var ve=H.extend(le);function G(n,o,d){this.x=d?Math.round(n):n,this.y=d?Math.round(o):o}var re=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};G.prototype={clone:function(){return new G(this.x,this.y)},add:function(n){return this.clone()._add(Y(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(Y(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new G(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new G(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=re(this.x),this.y=re(this.y),this},distanceTo:function(n){n=Y(n);var o=n.x-this.x,d=n.y-this.y;return Math.sqrt(o*o+d*d)},equals:function(n){return n=Y(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=Y(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function Y(n,o,d){return n instanceof G?n:N(n)?new G(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new G(n.x,n.y):new G(n,o,d)}function be(n,o){if(n)for(var d=o?[n,o]:n,m=0,x=d.length;m<x;m++)this.extend(d[m])}be.prototype={extend:function(n){var o,d;if(!n)return this;if(n instanceof G||typeof n[0]=="number"||"x"in n)o=d=Y(n);else if(n=de(n),o=n.min,d=n.max,!o||!d)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=d.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(n){return Y((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return Y(this.min.x,this.max.y)},getTopRight:function(){return Y(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var o,d;return typeof n[0]=="number"||n instanceof G?n=Y(n):n=de(n),n instanceof be?(o=n.min,d=n.max):o=d=n,o.x>=this.min.x&&d.x<=this.max.x&&o.y>=this.min.y&&d.y<=this.max.y},intersects:function(n){n=de(n);var o=this.min,d=this.max,m=n.min,x=n.max,w=x.x>=o.x&&m.x<=d.x,C=x.y>=o.y&&m.y<=d.y;return w&&C},overlaps:function(n){n=de(n);var o=this.min,d=this.max,m=n.min,x=n.max,w=x.x>o.x&&m.x<d.x,C=x.y>o.y&&m.y<d.y;return w&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var o=this.min,d=this.max,m=Math.abs(o.x-d.x)*n,x=Math.abs(o.y-d.y)*n;return de(Y(o.x-m,o.y-x),Y(d.x+m,d.y+x))},equals:function(n){return n?(n=de(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function de(n,o){return!n||n instanceof be?n:new be(n,o)}function he(n,o){if(n)for(var d=o?[n,o]:n,m=0,x=d.length;m<x;m++)this.extend(d[m])}he.prototype={extend:function(n){var o=this._southWest,d=this._northEast,m,x;if(n instanceof fe)m=n,x=n;else if(n instanceof he){if(m=n._southWest,x=n._northEast,!m||!x)return this}else return n?this.extend(pe(n)||oe(n)):this;return!o&&!d?(this._southWest=new fe(m.lat,m.lng),this._northEast=new fe(x.lat,x.lng)):(o.lat=Math.min(m.lat,o.lat),o.lng=Math.min(m.lng,o.lng),d.lat=Math.max(x.lat,d.lat),d.lng=Math.max(x.lng,d.lng)),this},pad:function(n){var o=this._southWest,d=this._northEast,m=Math.abs(o.lat-d.lat)*n,x=Math.abs(o.lng-d.lng)*n;return new he(new fe(o.lat-m,o.lng-x),new fe(d.lat+m,d.lng+x))},getCenter:function(){return new fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof fe||"lat"in n?n=pe(n):n=oe(n);var o=this._southWest,d=this._northEast,m,x;return n instanceof he?(m=n.getSouthWest(),x=n.getNorthEast()):m=x=n,m.lat>=o.lat&&x.lat<=d.lat&&m.lng>=o.lng&&x.lng<=d.lng},intersects:function(n){n=oe(n);var o=this._southWest,d=this._northEast,m=n.getSouthWest(),x=n.getNorthEast(),w=x.lat>=o.lat&&m.lat<=d.lat,C=x.lng>=o.lng&&m.lng<=d.lng;return w&&C},overlaps:function(n){n=oe(n);var o=this._southWest,d=this._northEast,m=n.getSouthWest(),x=n.getNorthEast(),w=x.lat>o.lat&&m.lat<d.lat,C=x.lng>o.lng&&m.lng<d.lng;return w&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,o){return n?(n=oe(n),this._southWest.equals(n.getSouthWest(),o)&&this._northEast.equals(n.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function oe(n,o){return n instanceof he?n:new he(n,o)}function fe(n,o,d){if(isNaN(n)||isNaN(o))throw new Error("Invalid LatLng object: ("+n+", "+o+")");this.lat=+n,this.lng=+o,d!==void 0&&(this.alt=+d)}fe.prototype={equals:function(n,o){if(!n)return!1;n=pe(n);var d=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return d<=(o===void 0?1e-9:o)},toString:function(n){return"LatLng("+y(this.lat,n)+", "+y(this.lng,n)+")"},distanceTo:function(n){return Oe.distance(this,pe(n))},wrap:function(){return Oe.wrapLatLng(this)},toBounds:function(n){var o=180*n/40075017,d=o/Math.cos(Math.PI/180*this.lat);return oe([this.lat-o,this.lng-d],[this.lat+o,this.lng+d])},clone:function(){return new fe(this.lat,this.lng,this.alt)}};function pe(n,o,d){return n instanceof fe?n:N(n)&&typeof n[0]!="object"?n.length===3?new fe(n[0],n[1],n[2]):n.length===2?new fe(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new fe(n.lat,"lng"in n?n.lng:n.lon,n.alt):o===void 0?null:new fe(n,o,d)}var K={latLngToPoint:function(n,o){var d=this.projection.project(n),m=this.scale(o);return this.transformation._transform(d,m)},pointToLatLng:function(n,o){var d=this.scale(o),m=this.transformation.untransform(n,d);return this.projection.unproject(m)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var o=this.projection.bounds,d=this.scale(n),m=this.transformation.transform(o.min,d),x=this.transformation.transform(o.max,d);return new be(m,x)},infinite:!1,wrapLatLng:function(n){var o=this.wrapLng?p(n.lng,this.wrapLng,!0):n.lng,d=this.wrapLat?p(n.lat,this.wrapLat,!0):n.lat,m=n.alt;return new fe(d,o,m)},wrapLatLngBounds:function(n){var o=n.getCenter(),d=this.wrapLatLng(o),m=o.lat-d.lat,x=o.lng-d.lng;if(m===0&&x===0)return n;var w=n.getSouthWest(),C=n.getNorthEast(),A=new fe(w.lat-m,w.lng-x),M=new fe(C.lat-m,C.lng-x);return new he(A,M)}},Oe=a({},K,{wrapLng:[-180,180],R:6371e3,distance:function(n,o){var d=Math.PI/180,m=n.lat*d,x=o.lat*d,w=Math.sin((o.lat-n.lat)*d/2),C=Math.sin((o.lng-n.lng)*d/2),A=w*w+Math.cos(m)*Math.cos(x)*C*C,M=2*Math.atan2(Math.sqrt(A),Math.sqrt(1-A));return this.R*M}}),et=6378137,Re={R:et,MAX_LATITUDE:85.0511287798,project:function(n){var o=Math.PI/180,d=this.MAX_LATITUDE,m=Math.max(Math.min(d,n.lat),-d),x=Math.sin(m*o);return new G(this.R*n.lng*o,this.R*Math.log((1+x)/(1-x))/2)},unproject:function(n){var o=180/Math.PI;return new fe((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*o,n.x*o/this.R)},bounds:function(){var n=et*Math.PI;return new be([-n,-n],[n,n])}()};function Ie(n,o,d,m){if(N(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=o,this._c=d,this._d=m}Ie.prototype={transform:function(n,o){return this._transform(n.clone(),o)},_transform:function(n,o){return o=o||1,n.x=o*(this._a*n.x+this._b),n.y=o*(this._c*n.y+this._d),n},untransform:function(n,o){return o=o||1,new G((n.x/o-this._b)/this._a,(n.y/o-this._d)/this._c)}};function Ae(n,o,d,m){return new Ie(n,o,d,m)}var Lt=a({},Oe,{code:"EPSG:3857",projection:Re,transformation:function(){var n=.5/(Math.PI*Re.R);return Ae(n,.5,-n,.5)}()}),es=a({},Lt,{code:"EPSG:900913"});function Ys(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function As(n,o){var d="",m,x,w,C,A,M;for(m=0,w=n.length;m<w;m++){for(A=n[m],x=0,C=A.length;x<C;x++)M=A[x],d+=(x?"L":"M")+M.x+" "+M.y;d+=o?ae.svg?"z":"x":""}return d||"M0 0"}var Es=document.documentElement.style,Qs="ActiveXObject"in window,yo=Qs&&!document.addEventListener,Gn="msLaunchUri"in navigator&&!("documentMode"in document),Ls=_s("webkit"),Jn=_s("android"),gs=_s("android 2")||_s("android 3"),bo=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_o=Jn&&_s("Google")&&bo<537&&!("AudioNode"in window),jt=!!window.opera,Ms=!Gn&&_s("chrome"),Bi=_s("gecko")&&!Ls&&!jt&&!Qs,wo=!Ms&&_s("safari"),wr=_s("phantom"),qi="OTransition"in Es,Hi=navigator.platform.indexOf("Win")===0,sn=Qs&&"transition"in Es,xs="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!gs,Kn="MozPerspective"in Es,Xs=!window.L_DISABLE_3D&&(sn||xs||Kn)&&!qi&&!wr,jr=typeof orientation<"u"||_s("mobile"),jo=jr&&Ls,Wi=jr&&xs,Yn=!window.PointerEvent&&window.MSPointerEvent,Vi=!!(window.PointerEvent||Yn),rn="ontouchstart"in window||!!window.TouchEvent,vs=!window.L_NO_TOUCH&&(rn||Vi),No=jr&&jt,ye=jr&&Bi,Ue=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,qe=function(){var n=!1;try{var o=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return n}(),Ft=function(){return!!document.createElement("canvas").getContext}(),Ct=!!(document.createElementNS&&Ys("svg").createSVGRect),ys=!!Ct&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Ds=!Ct&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var o=n.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),zt=navigator.platform.indexOf("Mac")===0,bs=navigator.platform.indexOf("Linux")===0;function _s(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var ae={ie:Qs,ielt9:yo,edge:Gn,webkit:Ls,android:Jn,android23:gs,androidStock:_o,opera:jt,chrome:Ms,gecko:Bi,safari:wo,phantom:wr,opera12:qi,win:Hi,ie3d:sn,webkit3d:xs,gecko3d:Kn,any3d:Xs,mobile:jr,mobileWebkit:jo,mobileWebkit3d:Wi,msPointer:Yn,pointer:Vi,touch:vs,touchNative:rn,mobileOpera:No,mobileGecko:ye,retina:Ue,passiveEvents:qe,canvas:Ft,svg:Ct,vml:Ds,inlineSvg:ys,mac:zt,linux:bs},Wc=ae.msPointer?"MSPointerDown":"pointerdown",Vc=ae.msPointer?"MSPointerMove":"pointermove",Zc=ae.msPointer?"MSPointerUp":"pointerup",Gc=ae.msPointer?"MSPointerCancel":"pointercancel",So={touchstart:Wc,touchmove:Vc,touchend:Zc,touchcancel:Gc},Jc={touchstart:xg,touchmove:Zi,touchend:Zi,touchcancel:Zi},nn={},Kc=!1;function hg(n,o,d){return o==="touchstart"&&gg(),Jc[o]?(d=Jc[o].bind(this,d),n.addEventListener(So[o],d,!1),d):(console.warn("wrong event specified:",o),g)}function mg(n,o,d){if(!So[o]){console.warn("wrong event specified:",o);return}n.removeEventListener(So[o],d,!1)}function fg(n){nn[n.pointerId]=n}function pg(n){nn[n.pointerId]&&(nn[n.pointerId]=n)}function Yc(n){delete nn[n.pointerId]}function gg(){Kc||(document.addEventListener(Wc,fg,!0),document.addEventListener(Vc,pg,!0),document.addEventListener(Zc,Yc,!0),document.addEventListener(Gc,Yc,!0),Kc=!0)}function Zi(n,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var d in nn)o.touches.push(nn[d]);o.changedTouches=[o],n(o)}}function xg(n,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&bt(o),Zi(n,o)}function vg(n){var o={},d,m;for(m in n)d=n[m],o[m]=d&&d.bind?d.bind(n):d;return n=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var yg=200;function bg(n,o){n.addEventListener("dblclick",o);var d=0,m;function x(w){if(w.detail!==1){m=w.detail;return}if(!(w.pointerType==="mouse"||w.sourceCapabilities&&!w.sourceCapabilities.firesTouchEvents)){var C=sd(w);if(!(C.some(function(M){return M instanceof HTMLLabelElement&&M.attributes.for})&&!C.some(function(M){return M instanceof HTMLInputElement||M instanceof HTMLSelectElement}))){var A=Date.now();A-d<=yg?(m++,m===2&&o(vg(w))):m=1,d=A}}}return n.addEventListener("click",x),{dblclick:o,simDblclick:x}}function _g(n,o){n.removeEventListener("dblclick",o.dblclick),n.removeEventListener("click",o.simDblclick)}var Po=Ki(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Qn=Ki(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Qc=Qn==="webkitTransition"||Qn==="OTransition"?Qn+"End":"transitionend";function Xc(n){return typeof n=="string"?document.getElementById(n):n}function Xn(n,o){var d=n.style[o]||n.currentStyle&&n.currentStyle[o];if((!d||d==="auto")&&document.defaultView){var m=document.defaultView.getComputedStyle(n,null);d=m?m[o]:null}return d==="auto"?null:d}function $e(n,o,d){var m=document.createElement(n);return m.className=o||"",d&&d.appendChild(m),m}function Ye(n){var o=n.parentNode;o&&o.removeChild(n)}function Gi(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function an(n){var o=n.parentNode;o&&o.lastChild!==n&&o.appendChild(n)}function on(n){var o=n.parentNode;o&&o.firstChild!==n&&o.insertBefore(n,o.firstChild)}function ko(n,o){if(n.classList!==void 0)return n.classList.contains(o);var d=Ji(n);return d.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(d)}function Pe(n,o){if(n.classList!==void 0)for(var d=P(o),m=0,x=d.length;m<x;m++)n.classList.add(d[m]);else if(!ko(n,o)){var w=Ji(n);Co(n,(w?w+" ":"")+o)}}function st(n,o){n.classList!==void 0?n.classList.remove(o):Co(n,_((" "+Ji(n)+" ").replace(" "+o+" "," ")))}function Co(n,o){n.className.baseVal===void 0?n.className=o:n.className.baseVal=o}function Ji(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Ht(n,o){"opacity"in n.style?n.style.opacity=o:"filter"in n.style&&wg(n,o)}function wg(n,o){var d=!1,m="DXImageTransform.Microsoft.Alpha";try{d=n.filters.item(m)}catch{if(o===1)return}o=Math.round(o*100),d?(d.Enabled=o!==100,d.Opacity=o):n.style.filter+=" progid:"+m+"(opacity="+o+")"}function Ki(n){for(var o=document.documentElement.style,d=0;d<n.length;d++)if(n[d]in o)return n[d];return!1}function Nr(n,o,d){var m=o||new G(0,0);n.style[Po]=(ae.ie3d?"translate("+m.x+"px,"+m.y+"px)":"translate3d("+m.x+"px,"+m.y+"px,0)")+(d?" scale("+d+")":"")}function at(n,o){n._leaflet_pos=o,ae.any3d?Nr(n,o):(n.style.left=o.x+"px",n.style.top=o.y+"px")}function Sr(n){return n._leaflet_pos||new G(0,0)}var ei,ti,To;if("onselectstart"in document)ei=function(){je(window,"selectstart",bt)},ti=function(){He(window,"selectstart",bt)};else{var si=Ki(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ei=function(){if(si){var n=document.documentElement.style;To=n[si],n[si]="none"}},ti=function(){si&&(document.documentElement.style[si]=To,To=void 0)}}function Oo(){je(window,"dragstart",bt)}function Io(){He(window,"dragstart",bt)}var Yi,Ao;function Eo(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Qi(),Yi=n,Ao=n.style.outlineStyle,n.style.outlineStyle="none",je(window,"keydown",Qi))}function Qi(){Yi&&(Yi.style.outlineStyle=Ao,Yi=void 0,Ao=void 0,He(window,"keydown",Qi))}function ed(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Lo(n){var o=n.getBoundingClientRect();return{x:o.width/n.offsetWidth||1,y:o.height/n.offsetHeight||1,boundingClientRect:o}}var jg={__proto__:null,TRANSFORM:Po,TRANSITION:Qn,TRANSITION_END:Qc,get:Xc,getStyle:Xn,create:$e,remove:Ye,empty:Gi,toFront:an,toBack:on,hasClass:ko,addClass:Pe,removeClass:st,setClass:Co,getClass:Ji,setOpacity:Ht,testProp:Ki,setTransform:Nr,setPosition:at,getPosition:Sr,get disableTextSelection(){return ei},get enableTextSelection(){return ti},disableImageDrag:Oo,enableImageDrag:Io,preventOutline:Eo,restoreOutline:Qi,getSizedParentNode:ed,getScale:Lo};function je(n,o,d,m){if(o&&typeof o=="object")for(var x in o)Do(n,x,o[x],d);else{o=P(o);for(var w=0,C=o.length;w<C;w++)Do(n,o[w],d,m)}return this}var ws="_leaflet_events";function He(n,o,d,m){if(arguments.length===1)td(n),delete n[ws];else if(o&&typeof o=="object")for(var x in o)Ro(n,x,o[x],d);else if(o=P(o),arguments.length===2)td(n,function(A){return T(o,A)!==-1});else for(var w=0,C=o.length;w<C;w++)Ro(n,o[w],d,m);return this}function td(n,o){for(var d in n[ws]){var m=d.split(/\d/)[0];(!o||o(m))&&Ro(n,m,null,null,d)}}var Mo={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Do(n,o,d,m){var x=o+h(d)+(m?"_"+h(m):"");if(n[ws]&&n[ws][x])return this;var w=function(A){return d.call(m||n,A||window.event)},C=w;!ae.touchNative&&ae.pointer&&o.indexOf("touch")===0?w=hg(n,o,w):ae.touch&&o==="dblclick"?w=bg(n,w):"addEventListener"in n?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?n.addEventListener(Mo[o]||o,w,ae.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(w=function(A){A=A||window.event,Uo(n,A)&&C(A)},n.addEventListener(Mo[o],w,!1)):n.addEventListener(o,C,!1):n.attachEvent("on"+o,w),n[ws]=n[ws]||{},n[ws][x]=w}function Ro(n,o,d,m,x){x=x||o+h(d)+(m?"_"+h(m):"");var w=n[ws]&&n[ws][x];if(!w)return this;!ae.touchNative&&ae.pointer&&o.indexOf("touch")===0?mg(n,o,w):ae.touch&&o==="dblclick"?_g(n,w):"removeEventListener"in n?n.removeEventListener(Mo[o]||o,w,!1):n.detachEvent("on"+o,w),n[ws][x]=null}function Pr(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function $o(n){return Do(n,"wheel",Pr),this}function ri(n){return je(n,"mousedown touchstart dblclick contextmenu",Pr),n._leaflet_disable_click=!0,this}function bt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function kr(n){return bt(n),Pr(n),this}function sd(n){if(n.composedPath)return n.composedPath();for(var o=[],d=n.target;d;)o.push(d),d=d.parentNode;return o}function rd(n,o){if(!o)return new G(n.clientX,n.clientY);var d=Lo(o),m=d.boundingClientRect;return new G((n.clientX-m.left)/d.x-o.clientLeft,(n.clientY-m.top)/d.y-o.clientTop)}var Ng=ae.linux&&ae.chrome?window.devicePixelRatio:ae.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function nd(n){return ae.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/Ng:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Uo(n,o){var d=o.relatedTarget;if(!d)return!0;try{for(;d&&d!==n;)d=d.parentNode}catch{return!1}return d!==n}var Sg={__proto__:null,on:je,off:He,stopPropagation:Pr,disableScrollPropagation:$o,disableClickPropagation:ri,preventDefault:bt,stop:kr,getPropagationPath:sd,getMousePosition:rd,getWheelDelta:nd,isExternalTarget:Uo,addListener:je,removeListener:He},id=ve.extend({run:function(n,o,d,m){this.stop(),this._el=n,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(m||.5,.2),this._startPos=Sr(n),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=J(this._animate,this),this._step()},_step:function(n){var o=+new Date-this._startTime,d=this._duration*1e3;o<d?this._runFrame(this._easeOut(o/d),n):(this._runFrame(1),this._complete())},_runFrame:function(n,o){var d=this._startPos.add(this._offset.multiplyBy(n));o&&d._round(),at(this._el,d),this.fire("step")},_complete:function(){V(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Le=ve.extend({options:{crs:Lt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,o){o=b(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(pe(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Qn&&ae.any3d&&!ae.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),je(this._proxy,Qc,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,o,d){if(o=o===void 0?this._zoom:this._limitZoom(o),n=this._limitCenter(pe(n),o,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=a({animate:d.animate},d.zoom),d.pan=a({animate:d.animate,duration:d.duration},d.pan));var m=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,o,d.zoom):this._tryAnimatedPan(n,d.pan);if(m)return clearTimeout(this._sizeTimer),this}return this._resetView(n,o,d.pan&&d.pan.noMoveStart),this},setZoom:function(n,o){return this._loaded?this.setView(this.getCenter(),n,{zoom:o}):(this._zoom=n,this)},zoomIn:function(n,o){return n=n||(ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,o)},zoomOut:function(n,o){return n=n||(ae.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,o)},setZoomAround:function(n,o,d){var m=this.getZoomScale(o),x=this.getSize().divideBy(2),w=n instanceof G?n:this.latLngToContainerPoint(n),C=w.subtract(x).multiplyBy(1-1/m),A=this.containerPointToLatLng(x.add(C));return this.setView(A,o,{zoom:d})},_getBoundsCenterZoom:function(n,o){o=o||{},n=n.getBounds?n.getBounds():oe(n);var d=Y(o.paddingTopLeft||o.padding||[0,0]),m=Y(o.paddingBottomRight||o.padding||[0,0]),x=this.getBoundsZoom(n,!1,d.add(m));if(x=typeof o.maxZoom=="number"?Math.min(o.maxZoom,x):x,x===1/0)return{center:n.getCenter(),zoom:x};var w=m.subtract(d).divideBy(2),C=this.project(n.getSouthWest(),x),A=this.project(n.getNorthEast(),x),M=this.unproject(C.add(A).divideBy(2).add(w),x);return{center:M,zoom:x}},fitBounds:function(n,o){if(n=oe(n),!n.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(n,o);return this.setView(d.center,d.zoom,o)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,o){return this.setView(n,this._zoom,{pan:o})},panBy:function(n,o){if(n=Y(n).round(),o=o||{},!n.x&&!n.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new id,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){Pe(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,d,o.duration||.25,o.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,o,d){if(d=d||{},d.animate===!1||!ae.any3d)return this.setView(n,o,d);this._stop();var m=this.project(this.getCenter()),x=this.project(n),w=this.getSize(),C=this._zoom;n=pe(n),o=o===void 0?C:o;var A=Math.max(w.x,w.y),M=A*this.getZoomScale(C,o),F=x.distanceTo(m)||1,Q=1.42,me=Q*Q;function ke(ot){var da=ot?-1:1,mx=ot?M:A,fx=M*M-A*A+da*me*me*F*F,px=2*mx*me*F,Ko=fx/px,Ud=Math.sqrt(Ko*Ko+1)-Ko,gx=Ud<1e-9?-18:Math.log(Ud);return gx}function Tt(ot){return(Math.exp(ot)-Math.exp(-ot))/2}function gt(ot){return(Math.exp(ot)+Math.exp(-ot))/2}function Vt(ot){return Tt(ot)/gt(ot)}var Mt=ke(0);function mn(ot){return A*(gt(Mt)/gt(Mt+Q*ot))}function cx(ot){return A*(gt(Mt)*Vt(Mt+Q*ot)-Tt(Mt))/me}function dx(ot){return 1-Math.pow(1-ot,1.5)}var ux=Date.now(),Rd=(ke(1)-Mt)/Q,hx=d.duration?1e3*d.duration:1e3*Rd*.8;function $d(){var ot=(Date.now()-ux)/hx,da=dx(ot)*Rd;ot<=1?(this._flyToFrame=J($d,this),this._move(this.unproject(m.add(x.subtract(m).multiplyBy(cx(da)/F)),C),this.getScaleZoom(A/mn(da),C),{flyTo:!0})):this._move(n,o)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),$d.call(this),this},flyToBounds:function(n,o){var d=this._getBoundsCenterZoom(n,o);return this.flyTo(d.center,d.zoom,o)},setMaxBounds:function(n){return n=oe(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var o=this.options.minZoom;return this.options.minZoom=n,this._loaded&&o!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var o=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&o!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,o){this._enforcingBounds=!0;var d=this.getCenter(),m=this._limitCenter(d,this._zoom,oe(n));return d.equals(m)||this.panTo(m,o),this._enforcingBounds=!1,this},panInside:function(n,o){o=o||{};var d=Y(o.paddingTopLeft||o.padding||[0,0]),m=Y(o.paddingBottomRight||o.padding||[0,0]),x=this.project(this.getCenter()),w=this.project(n),C=this.getPixelBounds(),A=de([C.min.add(d),C.max.subtract(m)]),M=A.getSize();if(!A.contains(w)){this._enforcingBounds=!0;var F=w.subtract(A.getCenter()),Q=A.extend(w).getSize().subtract(M);x.x+=F.x<0?-Q.x:Q.x,x.y+=F.y<0?-Q.y:Q.y,this.panTo(this.unproject(x),o),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=a({animate:!1,pan:!0},n===!0?{animate:!0}:n);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),m=o.divideBy(2).round(),x=d.divideBy(2).round(),w=m.subtract(x);return!w.x&&!w.y?this:(n.animate&&n.pan?this.panBy(w):(n.pan&&this._rawPanBy(w),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=a({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=c(this._handleGeolocationResponse,this),d=c(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,d,n):navigator.geolocation.getCurrentPosition(o,d,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var o=n.code,d=n.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var o=n.coords.latitude,d=n.coords.longitude,m=new fe(o,d),x=m.toBounds(n.coords.accuracy*2),w=this._locateOptions;if(w.setView){var C=this.getBoundsZoom(x);this.setView(m,w.maxZoom?Math.min(C,w.maxZoom):C)}var A={latlng:m,bounds:x,timestamp:n.timestamp};for(var M in n.coords)typeof n.coords[M]=="number"&&(A[M]=n.coords[M]);this.fire("locationfound",A)}},addHandler:function(n,o){if(!o)return this;var d=this[n]=new o(this);return this._handlers.push(d),this.options[n]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ye(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(V(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Ye(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,o){var d="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),m=$e("div",d,o||this._mapPane);return n&&(this._panes[n]=m),m},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),o=this.unproject(n.getBottomLeft()),d=this.unproject(n.getTopRight());return new he(o,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,o,d){n=oe(n),d=Y(d||[0,0]);var m=this.getZoom()||0,x=this.getMinZoom(),w=this.getMaxZoom(),C=n.getNorthWest(),A=n.getSouthEast(),M=this.getSize().subtract(d),F=de(this.project(A,m),this.project(C,m)).getSize(),Q=ae.any3d?this.options.zoomSnap:1,me=M.x/F.x,ke=M.y/F.y,Tt=o?Math.max(me,ke):Math.min(me,ke);return m=this.getScaleZoom(Tt,m),Q&&(m=Math.round(m/(Q/100))*(Q/100),m=o?Math.ceil(m/Q)*Q:Math.floor(m/Q)*Q),Math.max(x,Math.min(w,m))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new G(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,o){var d=this._getTopLeftPoint(n,o);return new be(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,o){var d=this.options.crs;return o=o===void 0?this._zoom:o,d.scale(n)/d.scale(o)},getScaleZoom:function(n,o){var d=this.options.crs;o=o===void 0?this._zoom:o;var m=d.zoom(n*d.scale(o));return isNaN(m)?1/0:m},project:function(n,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(pe(n),o)},unproject:function(n,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(Y(n),o)},layerPointToLatLng:function(n){var o=Y(n).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(n){var o=this.project(pe(n))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(pe(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(oe(n))},distance:function(n,o){return this.options.crs.distance(pe(n),pe(o))},containerPointToLayerPoint:function(n){return Y(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return Y(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var o=this.containerPointToLayerPoint(Y(n));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(pe(n)))},mouseEventToContainerPoint:function(n){return rd(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var o=this._container=Xc(n);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");je(o,"scroll",this._onScroll,this),this._containerId=h(o)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&ae.any3d,Pe(n,"leaflet-container"+(ae.touch?" leaflet-touch":"")+(ae.retina?" leaflet-retina":"")+(ae.ielt9?" leaflet-oldie":"")+(ae.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=Xn(n,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),at(this._mapPane,new G(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Pe(n.markerPane,"leaflet-zoom-hide"),Pe(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,o,d){at(this._mapPane,new G(0,0));var m=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var x=this._zoom!==o;this._moveStart(x,d)._move(n,o)._moveEnd(x),this.fire("viewreset"),m&&this.fire("load")},_moveStart:function(n,o){return n&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(n,o,d,m){o===void 0&&(o=this._zoom);var x=this._zoom!==o;return this._zoom=o,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),m?d&&d.pinch&&this.fire("zoom",d):((x||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return V(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){at(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[h(this._container)]=this;var o=n?He:je;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),ae.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){V(this._resizeRequest),this._resizeRequest=J(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,o){for(var d=[],m,x=o==="mouseout"||o==="mouseover",w=n.target||n.srcElement,C=!1;w;){if(m=this._targets[h(w)],m&&(o==="click"||o==="preclick")&&this._draggableMoved(m)){C=!0;break}if(m&&m.listens(o,!0)&&(x&&!Uo(w,n)||(d.push(m),x))||w===this._container)break;w=w.parentNode}return!d.length&&!C&&!x&&this.listens(o,!0)&&(d=[this]),d},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var o=n.target||n.srcElement;if(!(!this._loaded||o._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(o))){var d=n.type;d==="mousedown"&&Eo(o),this._fireDOMEvent(n,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,o,d){if(n.type==="click"){var m=a({},n);m.type="preclick",this._fireDOMEvent(m,m.type,d)}var x=this._findEventTargets(n,o);if(d){for(var w=[],C=0;C<d.length;C++)d[C].listens(o,!0)&&w.push(d[C]);x=w.concat(x)}if(x.length){o==="contextmenu"&&bt(n);var A=x[0],M={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var F=A.getLatLng&&(!A._radius||A._radius<=10);M.containerPoint=F?this.latLngToContainerPoint(A.getLatLng()):this.mouseEventToContainerPoint(n),M.layerPoint=this.containerPointToLayerPoint(M.containerPoint),M.latlng=F?A.getLatLng():this.layerPointToLatLng(M.layerPoint)}for(C=0;C<x.length;C++)if(x[C].fire(o,M,!0),M.originalEvent._stopped||x[C].options.bubblingMouseEvents===!1&&T(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,o=this._handlers.length;n<o;n++)this._handlers[n].disable()},whenReady:function(n,o){return this._loaded?n.call(o||this,{target:this}):this.on("load",n,o),this},_getMapPanePos:function(){return Sr(this._mapPane)||new G(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,o){var d=n&&o!==void 0?this._getNewPixelOrigin(n,o):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,o){var d=this.getSize()._divideBy(2);return this.project(n,o)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,o,d){var m=this._getNewPixelOrigin(d,o);return this.project(n,o)._subtract(m)},_latLngBoundsToNewLayerBounds:function(n,o,d){var m=this._getNewPixelOrigin(d,o);return de([this.project(n.getSouthWest(),o)._subtract(m),this.project(n.getNorthWest(),o)._subtract(m),this.project(n.getSouthEast(),o)._subtract(m),this.project(n.getNorthEast(),o)._subtract(m)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,o,d){if(!d)return n;var m=this.project(n,o),x=this.getSize().divideBy(2),w=new be(m.subtract(x),m.add(x)),C=this._getBoundsOffset(w,d,o);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?n:this.unproject(m.add(C),o)},_limitOffset:function(n,o){if(!o)return n;var d=this.getPixelBounds(),m=new be(d.min.add(n),d.max.add(n));return n.add(this._getBoundsOffset(m,o))},_getBoundsOffset:function(n,o,d){var m=de(this.project(o.getNorthEast(),d),this.project(o.getSouthWest(),d)),x=m.min.subtract(n.min),w=m.max.subtract(n.max),C=this._rebound(x.x,-w.x),A=this._rebound(x.y,-w.y);return new G(C,A)},_rebound:function(n,o){return n+o>0?Math.round(n-o)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(o))},_limitZoom:function(n){var o=this.getMinZoom(),d=this.getMaxZoom(),m=ae.any3d?this.options.zoomSnap:1;return m&&(n=Math.round(n/m)*m),Math.max(o,Math.min(d,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){st(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,o){var d=this._getCenterOffset(n)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,o),!0)},_createAnimProxy:function(){var n=this._proxy=$e("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(o){var d=Po,m=this._proxy.style[d];Nr(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),m===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ye(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),o=this.getZoom();Nr(this._proxy,this.project(n,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,o,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var m=this.getZoomScale(o),x=this._getCenterOffset(n)._divideBy(1-1/m);return d.animate!==!0&&!this.getSize().contains(x)?!1:(J(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(n,o,!0)},this),!0)},_animateZoom:function(n,o,d,m){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=o,Pe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:o,noUpdate:m}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&st(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Pg(n,o){return new Le(n,o)}var ts=H.extend({options:{position:"topright"},initialize:function(n){b(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var o=this._map;return o&&o.removeControl(this),this.options.position=n,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var o=this._container=this.onAdd(n),d=this.getPosition(),m=n._controlCorners[d];return Pe(o,"leaflet-control"),d.indexOf("bottom")!==-1?m.insertBefore(o,m.firstChild):m.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ye(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),ni=function(n){return new ts(n)};Le.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},o="leaflet-",d=this._controlContainer=$e("div",o+"control-container",this._container);function m(x,w){var C=o+x+" "+o+w;n[x+w]=$e("div",C,d)}m("top","left"),m("top","right"),m("bottom","left"),m("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Ye(this._controlCorners[n]);Ye(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ad=ts.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,o,d,m){return d<m?-1:m<d?1:0}},initialize:function(n,o,d){b(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var m in n)this._addLayer(n[m],m);for(m in o)this._addLayer(o[m],m,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return ts.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,o){return this._addLayer(n,o),this._map?this._update():this},addOverlay:function(n,o){return this._addLayer(n,o,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var o=this._getLayer(h(n));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){Pe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(Pe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):st(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return st(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",o=this._container=$e("div",n),d=this.options.collapsed;o.setAttribute("aria-haspopup",!0),ri(o),$o(o);var m=this._section=$e("section",n+"-list");d&&(this._map.on("click",this.collapse,this),je(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var x=this._layersLink=$e("a",n+"-toggle",o);x.href="#",x.title="Layers",x.setAttribute("role","button"),je(x,{keydown:function(w){w.keyCode===13&&this._expandSafely()},click:function(w){bt(w),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=$e("div",n+"-base",m),this._separator=$e("div",n+"-separator",m),this._overlaysList=$e("div",n+"-overlays",m),o.appendChild(m)},_getLayer:function(n){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&h(this._layers[o].layer)===n)return this._layers[o]},_addLayer:function(n,o,d){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:o,overlay:d}),this.options.sortLayers&&this._layers.sort(c(function(m,x){return this.options.sortFunction(m.layer,x.layer,m.name,x.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Gi(this._baseLayersList),Gi(this._overlaysList),this._layerControlInputs=[];var n,o,d,m,x=0;for(d=0;d<this._layers.length;d++)m=this._layers[d],this._addItem(m),o=o||m.overlay,n=n||!m.overlay,x+=m.overlay?0:1;return this.options.hideSingleBase&&(n=n&&x>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=o&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var o=this._getLayer(h(n.target)),d=o.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;d&&this._map.fire(d,o)},_createRadioElement:function(n,o){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(o?' checked="checked"':"")+"/>",m=document.createElement("div");return m.innerHTML=d,m.firstChild},_addItem:function(n){var o=document.createElement("label"),d=this._map.hasLayer(n.layer),m;n.overlay?(m=document.createElement("input"),m.type="checkbox",m.className="leaflet-control-layers-selector",m.defaultChecked=d):m=this._createRadioElement("leaflet-base-layers_"+h(this),d),this._layerControlInputs.push(m),m.layerId=h(n.layer),je(m,"click",this._onInputClick,this);var x=document.createElement("span");x.innerHTML=" "+n.name;var w=document.createElement("span");o.appendChild(w),w.appendChild(m),w.appendChild(x);var C=n.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,o,d,m=[],x=[];this._handlingClick=!0;for(var w=n.length-1;w>=0;w--)o=n[w],d=this._getLayer(o.layerId).layer,o.checked?m.push(d):o.checked||x.push(d);for(w=0;w<x.length;w++)this._map.hasLayer(x[w])&&this._map.removeLayer(x[w]);for(w=0;w<m.length;w++)this._map.hasLayer(m[w])||this._map.addLayer(m[w]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,o,d,m=this._map.getZoom(),x=n.length-1;x>=0;x--)o=n[x],d=this._getLayer(o.layerId).layer,o.disabled=d.options.minZoom!==void 0&&m<d.options.minZoom||d.options.maxZoom!==void 0&&m>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,je(n,"click",bt),this.expand();var o=this;setTimeout(function(){He(n,"click",bt),o._preventClick=!1})}}),kg=function(n,o,d){return new ad(n,o,d)},Fo=ts.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var o="leaflet-control-zoom",d=$e("div",o+" leaflet-bar"),m=this.options;return this._zoomInButton=this._createButton(m.zoomInText,m.zoomInTitle,o+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(m.zoomOutText,m.zoomOutTitle,o+"-out",d,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,o,d,m,x){var w=$e("a",d,m);return w.innerHTML=n,w.href="#",w.title=o,w.setAttribute("role","button"),w.setAttribute("aria-label",o),ri(w),je(w,"click",kr),je(w,"click",x,this),je(w,"click",this._refocusOnMap,this),w},_updateDisabled:function(){var n=this._map,o="leaflet-disabled";st(this._zoomInButton,o),st(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(Pe(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(Pe(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});Le.mergeOptions({zoomControl:!0}),Le.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Fo,this.addControl(this.zoomControl))});var Cg=function(n){return new Fo(n)},od=ts.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var o="leaflet-control-scale",d=$e("div",o),m=this.options;return this._addScales(m,o+"-line",d),n.on(m.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),d},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,o,d){n.metric&&(this._mScale=$e("div",o,d)),n.imperial&&(this._iScale=$e("div",o,d))},_update:function(){var n=this._map,o=n.getSize().y/2,d=n.distance(n.containerPointToLatLng([0,o]),n.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(d)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var o=this._getRoundNum(n),d=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,d,o/n)},_updateImperial:function(n){var o=n*3.2808399,d,m,x;o>5280?(d=o/5280,m=this._getRoundNum(d),this._updateScale(this._iScale,m+" mi",m/d)):(x=this._getRoundNum(o),this._updateScale(this._iScale,x+" ft",x/o))},_updateScale:function(n,o,d){n.style.width=Math.round(this.options.maxWidth*d)+"px",n.innerHTML=o},_getRoundNum:function(n){var o=Math.pow(10,(Math.floor(n)+"").length-1),d=n/o;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,o*d}}),Tg=function(n){return new od(n)},Og='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',zo=ts.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ae.inlineSvg?Og+" ":"")+"Leaflet</a>"},initialize:function(n){b(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=$e("div","leaflet-control-attribution"),ri(this._container);for(var o in n._layers)n._layers[o].getAttribution&&this.addAttribution(n._layers[o].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var o in this._attributions)this._attributions[o]&&n.push(o);var d=[];this.options.prefix&&d.push(this.options.prefix),n.length&&d.push(n.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});Le.mergeOptions({attributionControl:!0}),Le.addInitHook(function(){this.options.attributionControl&&new zo().addTo(this)});var Ig=function(n){return new zo(n)};ts.Layers=ad,ts.Zoom=Fo,ts.Scale=od,ts.Attribution=zo,ni.layers=kg,ni.zoom=Cg,ni.scale=Tg,ni.attribution=Ig;var js=H.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});js.addTo=function(n,o){return n.addHandler(o,this),this};var Ag={Events:le},ld=ae.touch?"touchstart mousedown":"mousedown",er=ve.extend({options:{clickTolerance:3},initialize:function(n,o,d,m){b(this,m),this._element=n,this._dragStartTarget=o||n,this._preventOutline=d},enable:function(){this._enabled||(je(this._dragStartTarget,ld,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(er._dragging===this&&this.finishDrag(!0),He(this._dragStartTarget,ld,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!ko(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){er._dragging===this&&this.finishDrag();return}if(!(er._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(er._dragging=this,this._preventOutline&&Eo(this._element),Oo(),ei(),!this._moving)){this.fire("down");var o=n.touches?n.touches[0]:n,d=ed(this._element);this._startPoint=new G(o.clientX,o.clientY),this._startPos=Sr(this._element),this._parentScale=Lo(d);var m=n.type==="mousedown";je(document,m?"mousemove":"touchmove",this._onMove,this),je(document,m?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var o=n.touches&&n.touches.length===1?n.touches[0]:n,d=new G(o.clientX,o.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,bt(n),this._moved||(this.fire("dragstart"),this._moved=!0,Pe(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Pe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),at(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){st(document.body,"leaflet-dragging"),this._lastTarget&&(st(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),He(document,"mousemove touchmove",this._onMove,this),He(document,"mouseup touchend touchcancel",this._onUp,this),Io(),ti();var o=this._moved&&this._moving;this._moving=!1,er._dragging=!1,o&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function cd(n,o,d){var m,x=[1,4,2,8],w,C,A,M,F,Q,me,ke;for(w=0,Q=n.length;w<Q;w++)n[w]._code=Cr(n[w],o);for(A=0;A<4;A++){for(me=x[A],m=[],w=0,Q=n.length,C=Q-1;w<Q;C=w++)M=n[w],F=n[C],M._code&me?F._code&me||(ke=Xi(F,M,me,o,d),ke._code=Cr(ke,o),m.push(ke)):(F._code&me&&(ke=Xi(F,M,me,o,d),ke._code=Cr(ke,o),m.push(ke)),m.push(M));n=m}return n}function dd(n,o){var d,m,x,w,C,A,M,F,Q;if(!n||n.length===0)throw new Error("latlngs not passed");Wt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var me=pe([0,0]),ke=oe(n),Tt=ke.getNorthWest().distanceTo(ke.getSouthWest())*ke.getNorthEast().distanceTo(ke.getNorthWest());Tt<1700&&(me=Bo(n));var gt=n.length,Vt=[];for(d=0;d<gt;d++){var Mt=pe(n[d]);Vt.push(o.project(pe([Mt.lat-me.lat,Mt.lng-me.lng])))}for(A=M=F=0,d=0,m=gt-1;d<gt;m=d++)x=Vt[d],w=Vt[m],C=x.y*w.x-w.y*x.x,M+=(x.x+w.x)*C,F+=(x.y+w.y)*C,A+=C*3;A===0?Q=Vt[0]:Q=[M/A,F/A];var mn=o.unproject(Y(Q));return pe([mn.lat+me.lat,mn.lng+me.lng])}function Bo(n){for(var o=0,d=0,m=0,x=0;x<n.length;x++){var w=pe(n[x]);o+=w.lat,d+=w.lng,m++}return pe([o/m,d/m])}var Eg={__proto__:null,clipPolygon:cd,polygonCenter:dd,centroid:Bo};function ud(n,o){if(!o||!n.length)return n.slice();var d=o*o;return n=Dg(n,d),n=Mg(n,d),n}function hd(n,o,d){return Math.sqrt(ii(n,o,d,!0))}function Lg(n,o,d){return ii(n,o,d)}function Mg(n,o){var d=n.length,m=typeof Uint8Array<"u"?Uint8Array:Array,x=new m(d);x[0]=x[d-1]=1,qo(n,x,o,0,d-1);var w,C=[];for(w=0;w<d;w++)x[w]&&C.push(n[w]);return C}function qo(n,o,d,m,x){var w=0,C,A,M;for(A=m+1;A<=x-1;A++)M=ii(n[A],n[m],n[x],!0),M>w&&(C=A,w=M);w>d&&(o[C]=1,qo(n,o,d,m,C),qo(n,o,d,C,x))}function Dg(n,o){for(var d=[n[0]],m=1,x=0,w=n.length;m<w;m++)Rg(n[m],n[x])>o&&(d.push(n[m]),x=m);return x<w-1&&d.push(n[w-1]),d}var md;function fd(n,o,d,m,x){var w=m?md:Cr(n,d),C=Cr(o,d),A,M,F;for(md=C;;){if(!(w|C))return[n,o];if(w&C)return!1;A=w||C,M=Xi(n,o,A,d,x),F=Cr(M,d),A===w?(n=M,w=F):(o=M,C=F)}}function Xi(n,o,d,m,x){var w=o.x-n.x,C=o.y-n.y,A=m.min,M=m.max,F,Q;return d&8?(F=n.x+w*(M.y-n.y)/C,Q=M.y):d&4?(F=n.x+w*(A.y-n.y)/C,Q=A.y):d&2?(F=M.x,Q=n.y+C*(M.x-n.x)/w):d&1&&(F=A.x,Q=n.y+C*(A.x-n.x)/w),new G(F,Q,x)}function Cr(n,o){var d=0;return n.x<o.min.x?d|=1:n.x>o.max.x&&(d|=2),n.y<o.min.y?d|=4:n.y>o.max.y&&(d|=8),d}function Rg(n,o){var d=o.x-n.x,m=o.y-n.y;return d*d+m*m}function ii(n,o,d,m){var x=o.x,w=o.y,C=d.x-x,A=d.y-w,M=C*C+A*A,F;return M>0&&(F=((n.x-x)*C+(n.y-w)*A)/M,F>1?(x=d.x,w=d.y):F>0&&(x+=C*F,w+=A*F)),C=n.x-x,A=n.y-w,m?C*C+A*A:new G(x,w)}function Wt(n){return!N(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function pd(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Wt(n)}function gd(n,o){var d,m,x,w,C,A,M,F;if(!n||n.length===0)throw new Error("latlngs not passed");Wt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Q=pe([0,0]),me=oe(n),ke=me.getNorthWest().distanceTo(me.getSouthWest())*me.getNorthEast().distanceTo(me.getNorthWest());ke<1700&&(Q=Bo(n));var Tt=n.length,gt=[];for(d=0;d<Tt;d++){var Vt=pe(n[d]);gt.push(o.project(pe([Vt.lat-Q.lat,Vt.lng-Q.lng])))}for(d=0,m=0;d<Tt-1;d++)m+=gt[d].distanceTo(gt[d+1])/2;if(m===0)F=gt[0];else for(d=0,w=0;d<Tt-1;d++)if(C=gt[d],A=gt[d+1],x=C.distanceTo(A),w+=x,w>m){M=(w-m)/x,F=[A.x-M*(A.x-C.x),A.y-M*(A.y-C.y)];break}var Mt=o.unproject(Y(F));return pe([Mt.lat+Q.lat,Mt.lng+Q.lng])}var $g={__proto__:null,simplify:ud,pointToSegmentDistance:hd,closestPointOnSegment:Lg,clipSegment:fd,_getEdgeIntersection:Xi,_getBitCode:Cr,_sqClosestPointOnSegment:ii,isFlat:Wt,_flat:pd,polylineCenter:gd},Ho={project:function(n){return new G(n.lng,n.lat)},unproject:function(n){return new fe(n.y,n.x)},bounds:new be([-180,-90],[180,90])},Wo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new be([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var o=Math.PI/180,d=this.R,m=n.lat*o,x=this.R_MINOR/d,w=Math.sqrt(1-x*x),C=w*Math.sin(m),A=Math.tan(Math.PI/4-m/2)/Math.pow((1-C)/(1+C),w/2);return m=-d*Math.log(Math.max(A,1e-10)),new G(n.lng*o*d,m)},unproject:function(n){for(var o=180/Math.PI,d=this.R,m=this.R_MINOR/d,x=Math.sqrt(1-m*m),w=Math.exp(-n.y/d),C=Math.PI/2-2*Math.atan(w),A=0,M=.1,F;A<15&&Math.abs(M)>1e-7;A++)F=x*Math.sin(C),F=Math.pow((1-F)/(1+F),x/2),M=Math.PI/2-2*Math.atan(w*F)-C,C+=M;return new fe(C*o,n.x*o/d)}},Ug={__proto__:null,LonLat:Ho,Mercator:Wo,SphericalMercator:Re},Fg=a({},Oe,{code:"EPSG:3395",projection:Wo,transformation:function(){var n=.5/(Math.PI*Wo.R);return Ae(n,.5,-n,.5)}()}),xd=a({},Oe,{code:"EPSG:4326",projection:Ho,transformation:Ae(1/180,1,-1/180,.5)}),zg=a({},K,{projection:Ho,transformation:Ae(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,o){var d=o.lng-n.lng,m=o.lat-n.lat;return Math.sqrt(d*d+m*m)},infinite:!0});K.Earth=Oe,K.EPSG3395=Fg,K.EPSG3857=Lt,K.EPSG900913=es,K.EPSG4326=xd,K.Simple=zg;var ss=ve.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[h(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[h(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var o=n.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var d=this.getEvents();o.on(d,this),this.once("remove",function(){o.off(d,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});Le.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var o=h(n);return this._layers[o]?this:(this._layers[o]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var o=h(n);return this._layers[o]?(this._loaded&&n.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return h(n)in this._layers},eachLayer:function(n,o){for(var d in this._layers)n.call(o,this._layers[d]);return this},_addLayers:function(n){n=n?N(n)?n:[n]:[];for(var o=0,d=n.length;o<d;o++)this.addLayer(n[o])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[h(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var o=h(n);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,o=-1/0,d=this._getZoomSpan();for(var m in this._zoomBoundLayers){var x=this._zoomBoundLayers[m].options;n=x.minZoom===void 0?n:Math.min(n,x.minZoom),o=x.maxZoom===void 0?o:Math.max(o,x.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=n===1/0?void 0:n,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ln=ss.extend({initialize:function(n,o){b(this,o),this._layers={};var d,m;if(n)for(d=0,m=n.length;d<m;d++)this.addLayer(n[d])},addLayer:function(n){var o=this.getLayerId(n);return this._layers[o]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var o=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(n){var o=typeof n=="number"?n:this.getLayerId(n);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var o=Array.prototype.slice.call(arguments,1),d,m;for(d in this._layers)m=this._layers[d],m[n]&&m[n].apply(m,o);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,o){for(var d in this._layers)n.call(o,this._layers[d]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return h(n)}}),Bg=function(n,o){return new ln(n,o)},Rs=ln.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),ln.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),ln.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new he;for(var o in this._layers){var d=this._layers[o];n.extend(d.getBounds?d.getBounds():d.getLatLng())}return n}}),qg=function(n,o){return new Rs(n,o)},cn=H.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){b(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,o){var d=this._getIconUrl(n);if(!d){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var m=this._createImg(d,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(m,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),m},_setIconStyles:function(n,o){var d=this.options,m=d[o+"Size"];typeof m=="number"&&(m=[m,m]);var x=Y(m),w=Y(o==="shadow"&&d.shadowAnchor||d.iconAnchor||x&&x.divideBy(2,!0));n.className="leaflet-marker-"+o+" "+(d.className||""),w&&(n.style.marginLeft=-w.x+"px",n.style.marginTop=-w.y+"px"),x&&(n.style.width=x.x+"px",n.style.height=x.y+"px")},_createImg:function(n,o){return o=o||document.createElement("img"),o.src=n,o},_getIconUrl:function(n){return ae.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Hg(n){return new cn(n)}var ai=cn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof ai.imagePath!="string"&&(ai.imagePath=this._detectIconPath()),(this.options.imagePath||ai.imagePath)+cn.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var o=function(d,m,x){var w=m.exec(d);return w&&w[x]};return n=o(n,/^url\((['"])?(.+)\1\)$/,2),n&&o(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=$e("div","leaflet-default-icon-path",document.body),o=Xn(n,"background-image")||Xn(n,"backgroundImage");if(document.body.removeChild(n),o=this._stripUrl(o),o)return o;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),vd=js.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new er(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Pe(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&st(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var o=this._marker,d=o._map,m=this._marker.options.autoPanSpeed,x=this._marker.options.autoPanPadding,w=Sr(o._icon),C=d.getPixelBounds(),A=d.getPixelOrigin(),M=de(C.min._subtract(A).add(x),C.max._subtract(A).subtract(x));if(!M.contains(w)){var F=Y((Math.max(M.max.x,w.x)-M.max.x)/(C.max.x-M.max.x)-(Math.min(M.min.x,w.x)-M.min.x)/(C.min.x-M.min.x),(Math.max(M.max.y,w.y)-M.max.y)/(C.max.y-M.max.y)-(Math.min(M.min.y,w.y)-M.min.y)/(C.min.y-M.min.y)).multiplyBy(m);d.panBy(F,{animate:!1}),this._draggable._newPos._add(F),this._draggable._startPos._add(F),at(o._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=J(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(V(this._panRequest),this._panRequest=J(this._adjustPan.bind(this,n)))},_onDrag:function(n){var o=this._marker,d=o._shadow,m=Sr(o._icon),x=o._map.layerPointToLatLng(m);d&&at(d,m),o._latlng=x,n.latlng=x,n.oldLatLng=this._oldLatLng,o.fire("move",n).fire("drag",n)},_onDragEnd:function(n){V(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),ea=ss.extend({options:{icon:new ai,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,o){b(this,o),this._latlng=pe(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var o=this._latlng;return this._latlng=pe(n),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=n.icon.createIcon(this._icon),m=!1;d!==this._icon&&(this._icon&&this._removeIcon(),m=!0,n.title&&(d.title=n.title),d.tagName==="IMG"&&(d.alt=n.alt||"")),Pe(d,o),n.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&je(d,"focus",this._panOnFocus,this);var x=n.icon.createShadow(this._shadow),w=!1;x!==this._shadow&&(this._removeShadow(),w=!0),x&&(Pe(x,o),x.alt=""),this._shadow=x,n.opacity<1&&this._updateOpacity(),m&&this.getPane().appendChild(this._icon),this._initInteraction(),x&&w&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&He(this._icon,"focus",this._panOnFocus,this),Ye(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ye(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&at(this._icon,n),this._shadow&&at(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var o=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(Pe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),vd)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new vd(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Ht(this._icon,n),this._shadow&&Ht(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var o=this.options.icon.options,d=o.iconSize?Y(o.iconSize):Y(0,0),m=o.iconAnchor?Y(o.iconAnchor):Y(0,0);n.panInside(this._latlng,{paddingTopLeft:m,paddingBottomRight:d.subtract(m)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Wg(n,o){return new ea(n,o)}var tr=ss.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return b(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ta=tr.extend({options:{fill:!0,radius:10},initialize:function(n,o){b(this,o),this._latlng=pe(n),this._radius=this.options.radius},setLatLng:function(n){var o=this._latlng;return this._latlng=pe(n),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var o=n&&n.radius||this._radius;return tr.prototype.setStyle.call(this,n),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,o=this._radiusY||n,d=this._clickTolerance(),m=[n+d,o+d];this._pxBounds=new be(this._point.subtract(m),this._point.add(m))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Vg(n,o){return new ta(n,o)}var Vo=ta.extend({initialize:function(n,o,d){if(typeof o=="number"&&(o=a({},d,{radius:o})),b(this,o),this._latlng=pe(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new he(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:tr.prototype.setStyle,_project:function(){var n=this._latlng.lng,o=this._latlng.lat,d=this._map,m=d.options.crs;if(m.distance===Oe.distance){var x=Math.PI/180,w=this._mRadius/Oe.R/x,C=d.project([o+w,n]),A=d.project([o-w,n]),M=C.add(A).divideBy(2),F=d.unproject(M).lat,Q=Math.acos((Math.cos(w*x)-Math.sin(o*x)*Math.sin(F*x))/(Math.cos(o*x)*Math.cos(F*x)))/x;(isNaN(Q)||Q===0)&&(Q=w/Math.cos(Math.PI/180*o)),this._point=M.subtract(d.getPixelOrigin()),this._radius=isNaN(Q)?0:M.x-d.project([F,n-Q]).x,this._radiusY=M.y-C.y}else{var me=m.unproject(m.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(me).x}this._updateBounds()}});function Zg(n,o,d){return new Vo(n,o,d)}var $s=tr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,o){b(this,o),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var o=1/0,d=null,m=ii,x,w,C=0,A=this._parts.length;C<A;C++)for(var M=this._parts[C],F=1,Q=M.length;F<Q;F++){x=M[F-1],w=M[F];var me=m(n,x,w,!0);me<o&&(o=me,d=m(n,x,w))}return d&&(d.distance=Math.sqrt(o)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gd(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,o){return o=o||this._defaultShape(),n=pe(n),o.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new he,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Wt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var o=[],d=Wt(n),m=0,x=n.length;m<x;m++)d?(o[m]=pe(n[m]),this._bounds.extend(o[m])):o[m]=this._convertLatLngs(n[m]);return o},_project:function(){var n=new be;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),o=new G(n,n);this._rawPxBounds&&(this._pxBounds=new be([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(n,o,d){var m=n[0]instanceof fe,x=n.length,w,C;if(m){for(C=[],w=0;w<x;w++)C[w]=this._map.latLngToLayerPoint(n[w]),d.extend(C[w]);o.push(C)}else for(w=0;w<x;w++)this._projectLatlngs(n[w],o,d)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,d,m,x,w,C,A,M;for(d=0,x=0,w=this._rings.length;d<w;d++)for(M=this._rings[d],m=0,C=M.length;m<C-1;m++)A=fd(M[m],M[m+1],n,m,!0),A&&(o[x]=o[x]||[],o[x].push(A[0]),(A[1]!==M[m+1]||m===C-2)&&(o[x].push(A[1]),x++))}},_simplifyPoints:function(){for(var n=this._parts,o=this.options.smoothFactor,d=0,m=n.length;d<m;d++)n[d]=ud(n[d],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,o){var d,m,x,w,C,A,M=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(d=0,w=this._parts.length;d<w;d++)for(A=this._parts[d],m=0,C=A.length,x=C-1;m<C;x=m++)if(!(!o&&m===0)&&hd(n,A[x],A[m])<=M)return!0;return!1}});function Gg(n,o){return new $s(n,o)}$s._flat=pd;var dn=$s.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return dd(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var o=$s.prototype._convertLatLngs.call(this,n),d=o.length;return d>=2&&o[0]instanceof fe&&o[0].equals(o[d-1])&&o.pop(),o},_setLatLngs:function(n){$s.prototype._setLatLngs.call(this,n),Wt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Wt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,o=this.options.weight,d=new G(o,o);if(n=new be(n.min.subtract(d),n.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var m=0,x=this._rings.length,w;m<x;m++)w=cd(this._rings[m],n,!0),w.length&&this._parts.push(w)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var o=!1,d,m,x,w,C,A,M,F;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(w=0,M=this._parts.length;w<M;w++)for(d=this._parts[w],C=0,F=d.length,A=F-1;C<F;A=C++)m=d[C],x=d[A],m.y>n.y!=x.y>n.y&&n.x<(x.x-m.x)*(n.y-m.y)/(x.y-m.y)+m.x&&(o=!o);return o||$s.prototype._containsPoint.call(this,n,!0)}});function Jg(n,o){return new dn(n,o)}var Us=Rs.extend({initialize:function(n,o){b(this,o),this._layers={},n&&this.addData(n)},addData:function(n){var o=N(n)?n:n.features,d,m,x;if(o){for(d=0,m=o.length;d<m;d++)x=o[d],(x.geometries||x.geometry||x.features||x.coordinates)&&this.addData(x);return this}var w=this.options;if(w.filter&&!w.filter(n))return this;var C=sa(n,w);return C?(C.feature=ia(n),C.defaultOptions=C.options,this.resetStyle(C),w.onEachFeature&&w.onEachFeature(n,C),this.addLayer(C)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=a({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(o){this._setLayerStyle(o,n)},this)},_setLayerStyle:function(n,o){n.setStyle&&(typeof o=="function"&&(o=o(n.feature)),n.setStyle(o))}});function sa(n,o){var d=n.type==="Feature"?n.geometry:n,m=d?d.coordinates:null,x=[],w=o&&o.pointToLayer,C=o&&o.coordsToLatLng||Zo,A,M,F,Q;if(!m&&!d)return null;switch(d.type){case"Point":return A=C(m),yd(w,n,A,o);case"MultiPoint":for(F=0,Q=m.length;F<Q;F++)A=C(m[F]),x.push(yd(w,n,A,o));return new Rs(x);case"LineString":case"MultiLineString":return M=ra(m,d.type==="LineString"?0:1,C),new $s(M,o);case"Polygon":case"MultiPolygon":return M=ra(m,d.type==="Polygon"?1:2,C),new dn(M,o);case"GeometryCollection":for(F=0,Q=d.geometries.length;F<Q;F++){var me=sa({geometry:d.geometries[F],type:"Feature",properties:n.properties},o);me&&x.push(me)}return new Rs(x);case"FeatureCollection":for(F=0,Q=d.features.length;F<Q;F++){var ke=sa(d.features[F],o);ke&&x.push(ke)}return new Rs(x);default:throw new Error("Invalid GeoJSON object.")}}function yd(n,o,d,m){return n?n(o,d):new ea(d,m&&m.markersInheritOptions&&m)}function Zo(n){return new fe(n[1],n[0],n[2])}function ra(n,o,d){for(var m=[],x=0,w=n.length,C;x<w;x++)C=o?ra(n[x],o-1,d):(d||Zo)(n[x]),m.push(C);return m}function Go(n,o){return n=pe(n),n.alt!==void 0?[y(n.lng,o),y(n.lat,o),y(n.alt,o)]:[y(n.lng,o),y(n.lat,o)]}function na(n,o,d,m){for(var x=[],w=0,C=n.length;w<C;w++)x.push(o?na(n[w],Wt(n[w])?0:o-1,d,m):Go(n[w],m));return!o&&d&&x.length>0&&x.push(x[0].slice()),x}function un(n,o){return n.feature?a({},n.feature,{geometry:o}):ia(o)}function ia(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Jo={toGeoJSON:function(n){return un(this,{type:"Point",coordinates:Go(this.getLatLng(),n)})}};ea.include(Jo),Vo.include(Jo),ta.include(Jo),$s.include({toGeoJSON:function(n){var o=!Wt(this._latlngs),d=na(this._latlngs,o?1:0,!1,n);return un(this,{type:(o?"Multi":"")+"LineString",coordinates:d})}}),dn.include({toGeoJSON:function(n){var o=!Wt(this._latlngs),d=o&&!Wt(this._latlngs[0]),m=na(this._latlngs,d?2:o?1:0,!0,n);return o||(m=[m]),un(this,{type:(d?"Multi":"")+"Polygon",coordinates:m})}}),ln.include({toMultiPoint:function(n){var o=[];return this.eachLayer(function(d){o.push(d.toGeoJSON(n).geometry.coordinates)}),un(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(n){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(n);var d=o==="GeometryCollection",m=[];return this.eachLayer(function(x){if(x.toGeoJSON){var w=x.toGeoJSON(n);if(d)m.push(w.geometry);else{var C=ia(w);C.type==="FeatureCollection"?m.push.apply(m,C.features):m.push(C)}}}),d?un(this,{geometries:m,type:"GeometryCollection"}):{type:"FeatureCollection",features:m}}});function bd(n,o){return new Us(n,o)}var Kg=bd,aa=ss.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,o,d){this._url=n,this._bounds=oe(o),b(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Pe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ye(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&an(this._image),this},bringToBack:function(){return this._map&&on(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=oe(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",o=this._image=n?this._url:$e("img");if(Pe(o,"leaflet-image-layer"),this._zoomAnimated&&Pe(o,"leaflet-zoom-animated"),this.options.className&&Pe(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=c(this.fire,this,"load"),o.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(n){var o=this._map.getZoomScale(n.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;Nr(this._image,d,o)},_reset:function(){var n=this._image,o=new be(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=o.getSize();at(n,o.min),n.style.width=d.x+"px",n.style.height=d.y+"px"},_updateOpacity:function(){Ht(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),Yg=function(n,o,d){return new aa(n,o,d)},_d=aa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",o=this._image=n?this._url:$e("video");if(Pe(o,"leaflet-image-layer"),this._zoomAnimated&&Pe(o,"leaflet-zoom-animated"),this.options.className&&Pe(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=c(this.fire,this,"load"),n){for(var d=o.getElementsByTagName("source"),m=[],x=0;x<d.length;x++)m.push(d[x].src);this._url=d.length>0?m:[o.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var w=0;w<this._url.length;w++){var C=$e("source");C.src=this._url[w],o.appendChild(C)}}});function Qg(n,o,d){return new _d(n,o,d)}var wd=aa.extend({_initImage:function(){var n=this._image=this._url;Pe(n,"leaflet-image-layer"),this._zoomAnimated&&Pe(n,"leaflet-zoom-animated"),this.options.className&&Pe(n,this.options.className),n.onselectstart=g,n.onmousemove=g}});function Xg(n,o,d){return new wd(n,o,d)}var Ns=ss.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,o){n&&(n instanceof fe||N(n))?(this._latlng=pe(n),b(this,o)):(b(this,n),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Ht(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Ht(this._container,1),this.bringToFront(),this.options.interactive&&(Pe(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Ht(this._container,0),this._removeTimeout=setTimeout(c(Ye,void 0,this._container),200)):Ye(this._container),this.options.interactive&&(st(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=pe(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&an(this._container),this},bringToBack:function(){return this._map&&on(this._container),this},_prepareOpen:function(n){var o=this._source;if(!o._map)return!1;if(o instanceof Rs){o=null;var d=this._source._layers;for(var m in d)if(d[m]._map){o=d[m];break}if(!o)return!1;this._source=o}if(!n)if(o.getCenter)n=o.getCenter();else if(o.getLatLng)n=o.getLatLng();else if(o.getBounds)n=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")n.innerHTML=o;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),o=Y(this.options.offset),d=this._getAnchor();this._zoomAnimated?at(this._container,n.add(d)):o=o.add(n).add(d);var m=this._containerBottom=-o.y,x=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=m+"px",this._container.style.left=x+"px"}},_getAnchor:function(){return[0,0]}});Le.include({_initOverlay:function(n,o,d,m){var x=o;return x instanceof n||(x=new n(m).setContent(o)),d&&x.setLatLng(d),x}}),ss.include({_initOverlay:function(n,o,d,m){var x=d;return x instanceof n?(b(x,m),x._source=this):(x=o&&!m?o:new n(m,this),x.setContent(d)),x}});var oa=Ns.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Ns.prototype.openOn.call(this,n)},onAdd:function(n){Ns.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof tr||this._source.on("preclick",Pr))},onRemove:function(n){Ns.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof tr||this._source.off("preclick",Pr))},getEvents:function(){var n=Ns.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",o=this._container=$e("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=$e("div",n+"-content-wrapper",o);if(this._contentNode=$e("div",n+"-content",d),ri(o),$o(this._contentNode),je(o,"contextmenu",Pr),this._tipContainer=$e("div",n+"-tip-container",o),this._tip=$e("div",n+"-tip",this._tipContainer),this.options.closeButton){var m=this._closeButton=$e("a",n+"-close-button",o);m.setAttribute("role","button"),m.setAttribute("aria-label","Close popup"),m.href="#close",m.innerHTML='<span aria-hidden="true">&#215;</span>',je(m,"click",function(x){bt(x),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,o=n.style;o.width="",o.whiteSpace="nowrap";var d=n.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),o.width=d+1+"px",o.whiteSpace="",o.height="";var m=n.offsetHeight,x=this.options.maxHeight,w="leaflet-popup-scrolled";x&&m>x?(o.height=x+"px",Pe(n,w)):st(n,w),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var o=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),d=this._getAnchor();at(this._container,o.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,o=parseInt(Xn(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+o,m=this._containerWidth,x=new G(this._containerLeft,-d-this._containerBottom);x._add(Sr(this._container));var w=n.layerPointToContainerPoint(x),C=Y(this.options.autoPanPadding),A=Y(this.options.autoPanPaddingTopLeft||C),M=Y(this.options.autoPanPaddingBottomRight||C),F=n.getSize(),Q=0,me=0;w.x+m+M.x>F.x&&(Q=w.x+m-F.x+M.x),w.x-Q-A.x<0&&(Q=w.x-A.x),w.y+d+M.y>F.y&&(me=w.y+d-F.y+M.y),w.y-me-A.y<0&&(me=w.y-A.y),(Q||me)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Q,me]))}},_getAnchor:function(){return Y(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ex=function(n,o){return new oa(n,o)};Le.mergeOptions({closePopupOnClick:!0}),Le.include({openPopup:function(n,o,d){return this._initOverlay(oa,n,o,d).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),ss.include({bindPopup:function(n,o){return this._popup=this._initOverlay(oa,this._popup,n,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Rs||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){kr(n);var o=n.layer||n.target;if(this._popup._source===o&&!(o instanceof tr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=o,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var la=Ns.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Ns.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Ns.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Ns.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",o=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=$e("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var o,d,m=this._map,x=this._container,w=m.latLngToContainerPoint(m.getCenter()),C=m.layerPointToContainerPoint(n),A=this.options.direction,M=x.offsetWidth,F=x.offsetHeight,Q=Y(this.options.offset),me=this._getAnchor();A==="top"?(o=M/2,d=F):A==="bottom"?(o=M/2,d=0):A==="center"?(o=M/2,d=F/2):A==="right"?(o=0,d=F/2):A==="left"?(o=M,d=F/2):C.x<w.x?(A="right",o=0,d=F/2):(A="left",o=M+(Q.x+me.x)*2,d=F/2),n=n.subtract(Y(o,d,!0)).add(Q).add(me),st(x,"leaflet-tooltip-right"),st(x,"leaflet-tooltip-left"),st(x,"leaflet-tooltip-top"),st(x,"leaflet-tooltip-bottom"),Pe(x,"leaflet-tooltip-"+A),at(x,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Ht(this._container,n)},_animateZoom:function(n){var o=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(o)},_getAnchor:function(){return Y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),tx=function(n,o){return new la(n,o)};Le.include({openTooltip:function(n,o,d){return this._initOverlay(la,n,o,d).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),ss.include({bindTooltip:function(n,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(la,this._tooltip,n,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var o=n?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[o](d),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Rs||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var o=typeof n.getElement=="function"&&n.getElement();o&&(je(o,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),je(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var o=typeof n.getElement=="function"&&n.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var o=n.latlng,d,m;this._tooltip.options.sticky&&n.originalEvent&&(d=this._map.mouseEventToContainerPoint(n.originalEvent),m=this._map.containerPointToLayerPoint(d),o=this._map.layerPointToLatLng(m)),this._tooltip.setLatLng(o)}});var jd=cn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var o=n&&n.tagName==="DIV"?n:document.createElement("div"),d=this.options;if(d.html instanceof Element?(Gi(o),o.appendChild(d.html)):o.innerHTML=d.html!==!1?d.html:"",d.bgPos){var m=Y(d.bgPos);o.style.backgroundPosition=-m.x+"px "+-m.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function sx(n){return new jd(n)}cn.Default=ai;var oi=ss.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ae.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){b(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Ye(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(an(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(on(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof G?n:new G(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var o=this.getPane().children,d=-n(-1/0,1/0),m=0,x=o.length,w;m<x;m++)w=o[m].style.zIndex,o[m]!==this._container&&w&&(d=n(d,+w));isFinite(d)&&(this.options.zIndex=d+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ae.ielt9){Ht(this._container,this.options.opacity);var n=+new Date,o=!1,d=!1;for(var m in this._tiles){var x=this._tiles[m];if(!(!x.current||!x.loaded)){var w=Math.min(1,(n-x.loaded)/200);Ht(x.el,w),w<1?o=!0:(x.active?d=!0:this._onOpaqueTile(x),x.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),o&&(V(this._fadeFrame),this._fadeFrame=J(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=$e("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,o=this.options.maxZoom;if(n!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===n?(this._levels[d].el.style.zIndex=o-Math.abs(n-d),this._onUpdateLevel(d)):(Ye(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var m=this._levels[n],x=this._map;return m||(m=this._levels[n]={},m.el=$e("div","leaflet-tile-container leaflet-zoom-animated",this._container),m.el.style.zIndex=o,m.origin=x.project(x.unproject(x.getPixelOrigin()),n).round(),m.zoom=n,this._setZoomTransform(m,x.getCenter(),x.getZoom()),g(m.el.offsetWidth),this._onCreateLevel(m)),this._level=m,m}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var n,o,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)o=this._tiles[n],o.retain=o.current;for(n in this._tiles)if(o=this._tiles[n],o.current&&!o.active){var m=o.coords;this._retainParent(m.x,m.y,m.z,m.z-5)||this._retainChildren(m.x,m.y,m.z,m.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var o in this._tiles)this._tiles[o].coords.z===n&&this._removeTile(o)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Ye(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,o,d,m){var x=Math.floor(n/2),w=Math.floor(o/2),C=d-1,A=new G(+x,+w);A.z=+C;var M=this._tileCoordsToKey(A),F=this._tiles[M];return F&&F.active?(F.retain=!0,!0):(F&&F.loaded&&(F.retain=!0),C>m?this._retainParent(x,w,C,m):!1)},_retainChildren:function(n,o,d,m){for(var x=2*n;x<2*n+2;x++)for(var w=2*o;w<2*o+2;w++){var C=new G(x,w);C.z=d+1;var A=this._tileCoordsToKey(C),M=this._tiles[A];if(M&&M.active){M.retain=!0;continue}else M&&M.loaded&&(M.retain=!0);d+1<m&&this._retainChildren(x,w,d+1,m)}},_resetView:function(n){var o=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var o=this.options;return o.minNativeZoom!==void 0&&n<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<n?o.maxNativeZoom:n},_setView:function(n,o,d,m){var x=Math.round(o);this.options.maxZoom!==void 0&&x>this.options.maxZoom||this.options.minZoom!==void 0&&x<this.options.minZoom?x=void 0:x=this._clampZoom(x);var w=this.options.updateWhenZooming&&x!==this._tileZoom;(!m||w)&&(this._tileZoom=x,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),x!==void 0&&this._update(n),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(n,o)},_setZoomTransforms:function(n,o){for(var d in this._levels)this._setZoomTransform(this._levels[d],n,o)},_setZoomTransform:function(n,o,d){var m=this._map.getZoomScale(d,n.zoom),x=n.origin.multiplyBy(m).subtract(this._map._getNewPixelOrigin(o,d)).round();ae.any3d?Nr(n.el,x,m):at(n.el,x)},_resetGrid:function(){var n=this._map,o=n.options.crs,d=this._tileSize=this.getTileSize(),m=this._tileZoom,x=this._map.getPixelWorldBounds(this._tileZoom);x&&(this._globalTileRange=this._pxBoundsToTileRange(x)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,o.wrapLng[0]],m).x/d.x),Math.ceil(n.project([0,o.wrapLng[1]],m).x/d.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([o.wrapLat[0],0],m).y/d.x),Math.ceil(n.project([o.wrapLat[1],0],m).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var o=this._map,d=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),m=o.getZoomScale(d,this._tileZoom),x=o.project(n,this._tileZoom).floor(),w=o.getSize().divideBy(m*2);return new be(x.subtract(w),x.add(w))},_update:function(n){var o=this._map;if(o){var d=this._clampZoom(o.getZoom());if(n===void 0&&(n=o.getCenter()),this._tileZoom!==void 0){var m=this._getTiledPixelBounds(n),x=this._pxBoundsToTileRange(m),w=x.getCenter(),C=[],A=this.options.keepBuffer,M=new be(x.getBottomLeft().subtract([A,-A]),x.getTopRight().add([A,-A]));if(!(isFinite(x.min.x)&&isFinite(x.min.y)&&isFinite(x.max.x)&&isFinite(x.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var F in this._tiles){var Q=this._tiles[F].coords;(Q.z!==this._tileZoom||!M.contains(new G(Q.x,Q.y)))&&(this._tiles[F].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(n,d);return}for(var me=x.min.y;me<=x.max.y;me++)for(var ke=x.min.x;ke<=x.max.x;ke++){var Tt=new G(ke,me);if(Tt.z=this._tileZoom,!!this._isValidTile(Tt)){var gt=this._tiles[this._tileCoordsToKey(Tt)];gt?gt.current=!0:C.push(Tt)}}if(C.sort(function(Mt,mn){return Mt.distanceTo(w)-mn.distanceTo(w)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Vt=document.createDocumentFragment();for(ke=0;ke<C.length;ke++)this._addTile(C[ke],Vt);this._level.el.appendChild(Vt)}}}},_isValidTile:function(n){var o=this._map.options.crs;if(!o.infinite){var d=this._globalTileRange;if(!o.wrapLng&&(n.x<d.min.x||n.x>d.max.x)||!o.wrapLat&&(n.y<d.min.y||n.y>d.max.y))return!1}if(!this.options.bounds)return!0;var m=this._tileCoordsToBounds(n);return oe(this.options.bounds).overlaps(m)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var o=this._map,d=this.getTileSize(),m=n.scaleBy(d),x=m.add(d),w=o.unproject(m,n.z),C=o.unproject(x,n.z);return[w,C]},_tileCoordsToBounds:function(n){var o=this._tileCoordsToNwSe(n),d=new he(o[0],o[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var o=n.split(":"),d=new G(+o[0],+o[1]);return d.z=+o[2],d},_removeTile:function(n){var o=this._tiles[n];o&&(Ye(o.el),delete this._tiles[n],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){Pe(n,"leaflet-tile");var o=this.getTileSize();n.style.width=o.x+"px",n.style.height=o.y+"px",n.onselectstart=g,n.onmousemove=g,ae.ielt9&&this.options.opacity<1&&Ht(n,this.options.opacity)},_addTile:function(n,o){var d=this._getTilePos(n),m=this._tileCoordsToKey(n),x=this.createTile(this._wrapCoords(n),c(this._tileReady,this,n));this._initTile(x),this.createTile.length<2&&J(c(this._tileReady,this,n,null,x)),at(x,d),this._tiles[m]={el:x,coords:n,current:!0},o.appendChild(x),this.fire("tileloadstart",{tile:x,coords:n})},_tileReady:function(n,o,d){o&&this.fire("tileerror",{error:o,tile:d,coords:n});var m=this._tileCoordsToKey(n);d=this._tiles[m],d&&(d.loaded=+new Date,this._map._fadeAnimated?(Ht(d.el,0),V(this._fadeFrame),this._fadeFrame=J(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),o||(Pe(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ae.ielt9||!this._map._fadeAnimated?J(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var o=new G(this._wrapX?p(n.x,this._wrapX):n.x,this._wrapY?p(n.y,this._wrapY):n.y);return o.z=n.z,o},_pxBoundsToTileRange:function(n){var o=this.getTileSize();return new be(n.min.unscaleBy(o).floor(),n.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function rx(n){return new oi(n)}var hn=oi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,o){this._url=n,o=b(this,o),o.detectRetina&&ae.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,o){return this._url===n&&o===void 0&&(o=!0),this._url=n,o||this.redraw(),this},createTile:function(n,o){var d=document.createElement("img");return je(d,"load",c(this._tileOnLoad,this,o,d)),je(d,"error",c(this._tileOnError,this,o,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(n),d},getTileUrl:function(n){var o={r:ae.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-n.y;this.options.tms&&(o.y=d),o["-y"]=d}return k(this._url,a(o,this.options))},_tileOnLoad:function(n,o){ae.ielt9?setTimeout(c(n,this,null,o),0):n(null,o)},_tileOnError:function(n,o,d){var m=this.options.errorTileUrl;m&&o.getAttribute("src")!==m&&(o.src=m),n(d,o)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,o=this.options.maxZoom,d=this.options.zoomReverse,m=this.options.zoomOffset;return d&&(n=o-n),n+m},_getSubdomain:function(n){var o=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var n,o;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(o=this._tiles[n].el,o.onload=g,o.onerror=g,!o.complete)){o.src=O;var d=this._tiles[n].coords;Ye(o),delete this._tiles[n],this.fire("tileabort",{tile:o,coords:d})}},_removeTile:function(n){var o=this._tiles[n];if(o)return o.el.setAttribute("src",O),oi.prototype._removeTile.call(this,n)},_tileReady:function(n,o,d){if(!(!this._map||d&&d.getAttribute("src")===O))return oi.prototype._tileReady.call(this,n,o,d)}});function Nd(n,o){return new hn(n,o)}var Sd=hn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,o){this._url=n;var d=a({},this.defaultWmsParams);for(var m in o)m in this.options||(d[m]=o[m]);o=b(this,o);var x=o.detectRetina&&ae.retina?2:1,w=this.getTileSize();d.width=w.x*x,d.height=w.y*x,this.wmsParams=d},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,hn.prototype.onAdd.call(this,n)},getTileUrl:function(n){var o=this._tileCoordsToNwSe(n),d=this._crs,m=de(d.project(o[0]),d.project(o[1])),x=m.min,w=m.max,C=(this._wmsVersion>=1.3&&this._crs===xd?[x.y,x.x,w.y,w.x]:[x.x,x.y,w.x,w.y]).join(","),A=hn.prototype.getTileUrl.call(this,n);return A+j(this.wmsParams,A,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(n,o){return a(this.wmsParams,n),o||this.redraw(),this}});function nx(n,o){return new Sd(n,o)}hn.WMS=Sd,Nd.wms=nx;var Fs=ss.extend({options:{padding:.1},initialize:function(n){b(this,n),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Pe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,o){var d=this._map.getZoomScale(o,this._zoom),m=this._map.getSize().multiplyBy(.5+this.options.padding),x=this._map.project(this._center,o),w=m.multiplyBy(-d).add(x).subtract(this._map._getNewPixelOrigin(n,o));ae.any3d?Nr(this._container,w,d):at(this._container,w)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,o=this._map.getSize(),d=this._map.containerPointToLayerPoint(o.multiplyBy(-n)).round();this._bounds=new be(d,d.add(o.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Pd=Fs.extend({options:{tolerance:0},getEvents:function(){var n=Fs.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Fs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");je(n,"mousemove",this._onMouseMove,this),je(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),je(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){V(this._redrawRequest),delete this._ctx,Ye(this._container),He(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var o in this._layers)n=this._layers[o],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fs.prototype._update.call(this);var n=this._bounds,o=this._container,d=n.getSize(),m=ae.retina?2:1;at(o,n.min),o.width=m*d.x,o.height=m*d.y,o.style.width=d.x+"px",o.style.height=d.y+"px",ae.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Fs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[h(n)]=n;var o=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var o=n._order,d=o.next,m=o.prev;d?d.prev=m:this._drawLast=m,m?m.next=d:this._drawFirst=d,delete n._order,delete this._layers[h(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var o=n.options.dashArray.split(/[, ]+/),d=[],m,x;for(x=0;x<o.length;x++){if(m=Number(o[x]),isNaN(m))return;d.push(m)}n.options._dashArray=d}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||J(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var o=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new be,this._redrawBounds.extend(n._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(n._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var o=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,o=this._redrawBounds;if(this._ctx.save(),o){var d=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var m=this._drawFirst;m;m=m.next)n=m.layer,(!o||n._pxBounds&&n._pxBounds.intersects(o))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,o){if(this._drawing){var d,m,x,w,C=n._parts,A=C.length,M=this._ctx;if(A){for(M.beginPath(),d=0;d<A;d++){for(m=0,x=C[d].length;m<x;m++)w=C[d][m],M[m?"lineTo":"moveTo"](w.x,w.y);o&&M.closePath()}this._fillStroke(M,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var o=n._point,d=this._ctx,m=Math.max(Math.round(n._radius),1),x=(Math.max(Math.round(n._radiusY),1)||m)/m;x!==1&&(d.save(),d.scale(1,x)),d.beginPath(),d.arc(o.x,o.y/x,m,0,Math.PI*2,!1),x!==1&&d.restore(),this._fillStroke(d,n)}},_fillStroke:function(n,o){var d=o.options;d.fill&&(n.globalAlpha=d.fillOpacity,n.fillStyle=d.fillColor||d.color,n.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(n.setLineDash&&n.setLineDash(o.options&&o.options._dashArray||[]),n.globalAlpha=d.opacity,n.lineWidth=d.weight,n.strokeStyle=d.color,n.lineCap=d.lineCap,n.lineJoin=d.lineJoin,n.stroke())},_onClick:function(n){for(var o=this._map.mouseEventToLayerPoint(n),d,m,x=this._drawFirst;x;x=x.next)d=x.layer,d.options.interactive&&d._containsPoint(o)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(d))&&(m=d);this._fireEvent(m?[m]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,o)}},_handleMouseOut:function(n){var o=this._hoveredLayer;o&&(st(this._container,"leaflet-interactive"),this._fireEvent([o],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,o){if(!this._mouseHoverThrottled){for(var d,m,x=this._drawFirst;x;x=x.next)d=x.layer,d.options.interactive&&d._containsPoint(o)&&(m=d);m!==this._hoveredLayer&&(this._handleMouseOut(n),m&&(Pe(this._container,"leaflet-interactive"),this._fireEvent([m],n,"mouseover"),this._hoveredLayer=m)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,o,d){this._map._fireDOMEvent(o,d||o.type,n)},_bringToFront:function(n){var o=n._order;if(o){var d=o.next,m=o.prev;if(d)d.prev=m;else return;m?m.next=d:d&&(this._drawFirst=d),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(n)}},_bringToBack:function(n){var o=n._order;if(o){var d=o.next,m=o.prev;if(m)m.next=d;else return;d?d.prev=m:m&&(this._drawLast=m),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(n)}}});function kd(n){return ae.canvas?new Pd(n):null}var li=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ix={_initContainer:function(){this._container=$e("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Fs.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var o=n._container=li("shape");Pe(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",n._path=li("path"),o.appendChild(n._path),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){var o=n._container;this._container.appendChild(o),n.options.interactive&&n.addInteractiveTarget(o)},_removePath:function(n){var o=n._container;Ye(o),n.removeInteractiveTarget(o),delete this._layers[h(n)]},_updateStyle:function(n){var o=n._stroke,d=n._fill,m=n.options,x=n._container;x.stroked=!!m.stroke,x.filled=!!m.fill,m.stroke?(o||(o=n._stroke=li("stroke")),x.appendChild(o),o.weight=m.weight+"px",o.color=m.color,o.opacity=m.opacity,m.dashArray?o.dashStyle=N(m.dashArray)?m.dashArray.join(" "):m.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=m.lineCap.replace("butt","flat"),o.joinstyle=m.lineJoin):o&&(x.removeChild(o),n._stroke=null),m.fill?(d||(d=n._fill=li("fill")),x.appendChild(d),d.color=m.fillColor||m.color,d.opacity=m.fillOpacity):d&&(x.removeChild(d),n._fill=null)},_updateCircle:function(n){var o=n._point.round(),d=Math.round(n._radius),m=Math.round(n._radiusY||d);this._setPath(n,n._empty()?"M0 0":"AL "+o.x+","+o.y+" "+d+","+m+" 0,"+65535*360)},_setPath:function(n,o){n._path.v=o},_bringToFront:function(n){an(n._container)},_bringToBack:function(n){on(n._container)}},ca=ae.vml?li:Ys,ci=Fs.extend({_initContainer:function(){this._container=ca("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ca("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ye(this._container),He(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fs.prototype._update.call(this);var n=this._bounds,o=n.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,d.setAttribute("width",o.x),d.setAttribute("height",o.y)),at(d,n.min),d.setAttribute("viewBox",[n.min.x,n.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(n){var o=n._path=ca("path");n.options.className&&Pe(o,n.options.className),n.options.interactive&&Pe(o,"leaflet-interactive"),this._updateStyle(n),this._layers[h(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Ye(n._path),n.removeInteractiveTarget(n._path),delete this._layers[h(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var o=n._path,d=n.options;o&&(d.stroke?(o.setAttribute("stroke",d.color),o.setAttribute("stroke-opacity",d.opacity),o.setAttribute("stroke-width",d.weight),o.setAttribute("stroke-linecap",d.lineCap),o.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?o.setAttribute("stroke-dasharray",d.dashArray):o.removeAttribute("stroke-dasharray"),d.dashOffset?o.setAttribute("stroke-dashoffset",d.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),d.fill?(o.setAttribute("fill",d.fillColor||d.color),o.setAttribute("fill-opacity",d.fillOpacity),o.setAttribute("fill-rule",d.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(n,o){this._setPath(n,As(n._parts,o))},_updateCircle:function(n){var o=n._point,d=Math.max(Math.round(n._radius),1),m=Math.max(Math.round(n._radiusY),1)||d,x="a"+d+","+m+" 0 1,0 ",w=n._empty()?"M0 0":"M"+(o.x-d)+","+o.y+x+d*2+",0 "+x+-d*2+",0 ";this._setPath(n,w)},_setPath:function(n,o){n._path.setAttribute("d",o)},_bringToFront:function(n){an(n._path)},_bringToBack:function(n){on(n._path)}});ae.vml&&ci.include(ix);function Cd(n){return ae.svg||ae.vml?new ci(n):null}Le.include({getRenderer:function(n){var o=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var o=this._paneRenderers[n];return o===void 0&&(o=this._createRenderer({pane:n}),this._paneRenderers[n]=o),o},_createRenderer:function(n){return this.options.preferCanvas&&kd(n)||Cd(n)}});var Td=dn.extend({initialize:function(n,o){dn.prototype.initialize.call(this,this._boundsToLatLngs(n),o)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=oe(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function ax(n,o){return new Td(n,o)}ci.create=ca,ci.pointsToPath=As,Us.geometryToLayer=sa,Us.coordsToLatLng=Zo,Us.coordsToLatLngs=ra,Us.latLngToCoords=Go,Us.latLngsToCoords=na,Us.getFeature=un,Us.asFeature=ia,Le.mergeOptions({boxZoom:!0});var Od=js.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){je(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){He(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ye(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ei(),Oo(),this._startPoint=this._map.mouseEventToContainerPoint(n),je(document,{contextmenu:kr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=$e("div","leaflet-zoom-box",this._container),Pe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var o=new be(this._point,this._startPoint),d=o.getSize();at(this._box,o.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(Ye(this._box),st(this._container,"leaflet-crosshair")),ti(),Io(),He(document,{contextmenu:kr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var o=new he(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Le.addInitHook("addHandler","boxZoom",Od),Le.mergeOptions({doubleClickZoom:!0});var Id=js.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var o=this._map,d=o.getZoom(),m=o.options.zoomDelta,x=n.originalEvent.shiftKey?d-m:d+m;o.options.doubleClickZoom==="center"?o.setZoom(x):o.setZoomAround(n.containerPoint,x)}});Le.addInitHook("addHandler","doubleClickZoom",Id),Le.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ad=js.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new er(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}Pe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){st(this._map._container,"leaflet-grab"),st(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=oe(this._map.options.maxBounds);this._offsetLimit=de(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var o=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(o),this._prunePositions(o)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,o){return n-(n-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;n.x<o.min.x&&(n.x=this._viscousLimit(n.x,o.min.x)),n.y<o.min.y&&(n.y=this._viscousLimit(n.y,o.min.y)),n.x>o.max.x&&(n.x=this._viscousLimit(n.x,o.max.x)),n.y>o.max.y&&(n.y=this._viscousLimit(n.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,o=Math.round(n/2),d=this._initialWorldOffset,m=this._draggable._newPos.x,x=(m-o+d)%n+o-d,w=(m+o+d)%n-o-d,C=Math.abs(x+d)<Math.abs(w+d)?x:w;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(n){var o=this._map,d=o.options,m=!d.inertia||n.noInertia||this._times.length<2;if(o.fire("dragend",n),m)o.fire("moveend");else{this._prunePositions(+new Date);var x=this._lastPos.subtract(this._positions[0]),w=(this._lastTime-this._times[0])/1e3,C=d.easeLinearity,A=x.multiplyBy(C/w),M=A.distanceTo([0,0]),F=Math.min(d.inertiaMaxSpeed,M),Q=A.multiplyBy(F/M),me=F/(d.inertiaDeceleration*C),ke=Q.multiplyBy(-me/2).round();!ke.x&&!ke.y?o.fire("moveend"):(ke=o._limitOffset(ke,o.options.maxBounds),J(function(){o.panBy(ke,{duration:me,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});Le.addInitHook("addHandler","dragging",Ad),Le.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ed=js.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),je(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),He(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,o=document.documentElement,d=n.scrollTop||o.scrollTop,m=n.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(m,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var o=this._panKeys={},d=this.keyCodes,m,x;for(m=0,x=d.left.length;m<x;m++)o[d.left[m]]=[-1*n,0];for(m=0,x=d.right.length;m<x;m++)o[d.right[m]]=[n,0];for(m=0,x=d.down.length;m<x;m++)o[d.down[m]]=[0,n];for(m=0,x=d.up.length;m<x;m++)o[d.up[m]]=[0,-1*n]},_setZoomDelta:function(n){var o=this._zoomKeys={},d=this.keyCodes,m,x;for(m=0,x=d.zoomIn.length;m<x;m++)o[d.zoomIn[m]]=n;for(m=0,x=d.zoomOut.length;m<x;m++)o[d.zoomOut[m]]=-n},_addHooks:function(){je(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){He(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=n.keyCode,d=this._map,m;if(o in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(m=this._panKeys[o],n.shiftKey&&(m=Y(m).multiplyBy(3)),d.options.maxBounds&&(m=d._limitOffset(Y(m),d.options.maxBounds)),d.options.worldCopyJump){var x=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(m)));d.panTo(x)}else d.panBy(m)}else if(o in this._zoomKeys)d.setZoom(d.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;kr(n)}}});Le.addInitHook("addHandler","keyboard",Ed),Le.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ld=js.extend({addHooks:function(){je(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){He(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var o=nd(n),d=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var m=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),m),kr(n)},_performZoom:function(){var n=this._map,o=n.getZoom(),d=this._map.options.zoomSnap||0;n._stop();var m=this._delta/(this._map.options.wheelPxPerZoomLevel*4),x=4*Math.log(2/(1+Math.exp(-Math.abs(m))))/Math.LN2,w=d?Math.ceil(x/d)*d:x,C=n._limitZoom(o+(this._delta>0?w:-w))-o;this._delta=0,this._startTime=null,C&&(n.options.scrollWheelZoom==="center"?n.setZoom(o+C):n.setZoomAround(this._lastMousePos,o+C))}});Le.addInitHook("addHandler","scrollWheelZoom",Ld);var ox=600;Le.mergeOptions({tapHold:ae.touchNative&&ae.safari&&ae.mobile,tapTolerance:15});var Md=js.extend({addHooks:function(){je(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){He(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var o=n.touches[0];this._startPos=this._newPos=new G(o.clientX,o.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(je(document,"touchend",bt),je(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),ox),je(document,"touchend touchcancel contextmenu",this._cancel,this),je(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){He(document,"touchend",bt),He(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),He(document,"touchend touchcancel contextmenu",this._cancel,this),He(document,"touchmove",this._onMove,this)},_onMove:function(n){var o=n.touches[0];this._newPos=new G(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,o){var d=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});d._simulated=!0,o.target.dispatchEvent(d)}});Le.addInitHook("addHandler","tapHold",Md),Le.mergeOptions({touchZoom:ae.touch,bounceAtZoomLimits:!0});var Dd=js.extend({addHooks:function(){Pe(this._map._container,"leaflet-touch-zoom"),je(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){st(this._map._container,"leaflet-touch-zoom"),He(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var o=this._map;if(!(!n.touches||n.touches.length!==2||o._animatingZoom||this._zooming)){var d=o.mouseEventToContainerPoint(n.touches[0]),m=o.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(d.add(m)._divideBy(2))),this._startDist=d.distanceTo(m),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),je(document,"touchmove",this._onTouchMove,this),je(document,"touchend touchcancel",this._onTouchEnd,this),bt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var o=this._map,d=o.mouseEventToContainerPoint(n.touches[0]),m=o.mouseEventToContainerPoint(n.touches[1]),x=d.distanceTo(m)/this._startDist;if(this._zoom=o.getScaleZoom(x,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&x<1||this._zoom>o.getMaxZoom()&&x>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,x===1)return}else{var w=d._add(m)._divideBy(2)._subtract(this._centerPoint);if(x===1&&w.x===0&&w.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(w),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),V(this._animRequest);var C=c(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=J(C,this,!0),bt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,V(this._animRequest),He(document,"touchmove",this._onTouchMove,this),He(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Le.addInitHook("addHandler","touchZoom",Dd),Le.BoxZoom=Od,Le.DoubleClickZoom=Id,Le.Drag=Ad,Le.Keyboard=Ed,Le.ScrollWheelZoom=Ld,Le.TapHold=Md,Le.TouchZoom=Dd,t.Bounds=be,t.Browser=ae,t.CRS=K,t.Canvas=Pd,t.Circle=Vo,t.CircleMarker=ta,t.Class=H,t.Control=ts,t.DivIcon=jd,t.DivOverlay=Ns,t.DomEvent=Sg,t.DomUtil=jg,t.Draggable=er,t.Evented=ve,t.FeatureGroup=Rs,t.GeoJSON=Us,t.GridLayer=oi,t.Handler=js,t.Icon=cn,t.ImageOverlay=aa,t.LatLng=fe,t.LatLngBounds=he,t.Layer=ss,t.LayerGroup=ln,t.LineUtil=$g,t.Map=Le,t.Marker=ea,t.Mixin=Ag,t.Path=tr,t.Point=G,t.PolyUtil=Eg,t.Polygon=dn,t.Polyline=$s,t.Popup=oa,t.PosAnimation=id,t.Projection=Ug,t.Rectangle=Td,t.Renderer=Fs,t.SVG=ci,t.SVGOverlay=wd,t.TileLayer=hn,t.Tooltip=la,t.Transformation=Ie,t.Util=ue,t.VideoOverlay=_d,t.bind=c,t.bounds=de,t.canvas=kd,t.circle=Zg,t.circleMarker=Vg,t.control=ni,t.divIcon=sx,t.extend=a,t.featureGroup=qg,t.geoJSON=bd,t.geoJson=Kg,t.gridLayer=rx,t.icon=Hg,t.imageOverlay=Yg,t.latLng=pe,t.latLngBounds=oe,t.layerGroup=Bg,t.map=Pg,t.marker=Wg,t.point=Y,t.polygon=Jg,t.polyline=Gg,t.popup=ex,t.rectangle=ax,t.setOptions=b,t.stamp=h,t.svg=Cd,t.svgOverlay=Xg,t.tileLayer=Nd,t.tooltip=tx,t.transformation=Ae,t.version=r,t.videoOverlay=Qg;var lx=window.L;t.noConflict=function(){return window.L=lx,this},window.L=t})})(Gl,Gl.exports);var tn=Gl.exports;const Kt=Ux(tn);function oo(i,e,t){return Object.freeze({instance:i,context:e,container:t})}function lo(i,e){return e==null?function(r,a){const l=v.useRef();return l.current||(l.current=i(r,a)),l}:function(r,a){const l=v.useRef();l.current||(l.current=i(r,a));const c=v.useRef(r),{instance:u}=l.current;return v.useEffect(function(){c.current!==r&&(e(u,r,c.current),c.current=r)},[u,r,a]),l}}function vp(i,e){v.useEffect(function(){return(e.layerContainer??e.map).addLayer(i.instance),function(){var l;(l=e.layerContainer)==null||l.removeLayer(i.instance),e.map.removeLayer(i.instance)}},[e,i])}function yp(i){return function(t){const r=Dc(),a=i(ao(t,r),r);return mp(r.map,t.attribution),Rc(a.current,t.eventHandlers),vp(a.current,r),a}}function FN(i,e){const t=v.useRef();v.useEffect(function(){if(e.pathOptions!==t.current){const a=e.pathOptions??{};i.instance.setStyle(a),t.current=a}},[i,e])}function zN(i){return function(t){const r=Dc(),a=i(ao(t,r),r);return Rc(a.current,t.eventHandlers),vp(a.current,r),FN(a.current,t),a}}function BN(i,e){const t=lo(i,e),r=yp(t);return xp(r)}function qN(i,e){const t=lo(i),r=UN(t,e);return RN(r)}function HN(i,e){const t=lo(i,e),r=zN(t);return xp(r)}function WN(i,e){const t=lo(i,e),r=yp(t);return $N(r)}function VN(i,e,t){const{opacity:r,zIndex:a}=e;r!=null&&r!==t.opacity&&i.setOpacity(r),a!=null&&a!==t.zIndex&&i.setZIndex(a)}function Jl(){return Jl=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Jl.apply(this,arguments)}function ZN({bounds:i,boundsOptions:e,center:t,children:r,className:a,id:l,placeholder:c,style:u,whenReady:h,zoom:f,...p},g){const[y]=v.useState({className:a,id:l,style:u}),[_,P]=v.useState(null);v.useImperativeHandle(g,()=>(_==null?void 0:_.map)??null,[_]);const b=v.useCallback(S=>{if(S!==null&&_===null){const k=new tn.Map(S,p);t!=null&&f!=null?k.setView(t,f):i!=null&&k.fitBounds(i,e),h!=null&&k.whenReady(h),P(DN(k))}},[]);v.useEffect(()=>()=>{_==null||_.map.remove()},[_]);const j=_?Z.createElement(gp,{value:_},r):c??null;return Z.createElement("div",Jl({},y,{ref:b}),j)}const co=v.forwardRef(ZN),xr=BN(function({position:e,...t},r){const a=new tn.Marker(e,t);return oo(a,fp(r,{overlayContainer:a}))},function(e,t,r){t.position!==r.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==r.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==r.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==r.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),GN=HN(function({positions:e,...t},r){const a=new tn.Polyline(e,t);return oo(a,fp(r,{overlayContainer:a}))},function(e,t,r){t.positions!==r.positions&&e.setLatLngs(t.positions)}),vr=qN(function(e,t){const r=new tn.Popup(e,t.overlayContainer);return oo(r,t)},function(e,t,{position:r},a){v.useEffect(function(){const{instance:c}=e;function u(f){f.popup===c&&(c.update(),a(!0))}function h(f){f.popup===c&&a(!1)}return t.map.on({popupopen:u,popupclose:h}),t.overlayContainer==null?(r!=null&&c.setLatLng(r),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){var p;t.map.off({popupopen:u,popupclose:h}),(p=t.overlayContainer)==null||p.unbindPopup(),t.map.removeLayer(c)}},[e,t,a,r])}),uo=WN(function({url:e,...t},r){const a=new tn.TileLayer(e,ao(t,r));return oo(a,r)},function(e,t,r){VN(e,t,r);const{url:a}=t;a!=null&&a!==r.url&&e.setUrl(a)}),JN=({orderId:i,customerLat:e,customerLng:t})=>{const[r,a]=v.useState(null),[l,c]=v.useState(0),[u,h]=v.useState(0);return v.useEffect(()=>{const f=()=>{const g={id:"agent-1",name:"Rahul Sharma",phone:"+91 98765 43210",currentLat:21.3486+(Math.random()-.5)*.01,currentLng:74.8811+(Math.random()-.5)*.01,lastUpdate:new Date().toISOString()};a(g);const y=Math.sqrt(Math.pow(g.currentLat-e,2)+Math.pow(g.currentLng-t,2))*111e3;c(Math.round(y)),h(Math.round(y/300))};f();const p=setInterval(f,5e3);return()=>clearInterval(p)},[e,t]),r?s.jsxs(U,{className:"border-green-200 bg-green-50",children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2 text-green-700",children:[s.jsx(Ut,{className:"h-5 w-5 animate-pulse"}),"Live Delivery Tracking"]})}),s.jsxs(z,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:r.name}),s.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[s.jsx(Gs,{className:"h-3 w-3"}),r.phone]})]}),s.jsx(X,{className:"bg-green-500 text-white animate-pulse",children:"On the way"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx(Fe,{className:"h-6 w-6 text-blue-500 mx-auto mb-1"}),s.jsxs("p",{className:"text-sm font-semibold",children:[l,"m away"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Distance"})]}),s.jsxs("div",{className:"text-center p-3 bg-white rounded-lg",children:[s.jsx(dt,{className:"h-6 w-6 text-orange-500 mx-auto mb-1"}),s.jsxs("p",{className:"text-sm font-semibold",children:[u," min"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"ETA"})]})]}),s.jsxs("div",{className:"bg-white p-3 rounded-lg",children:[s.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Last Location Update"}),s.jsxs("p",{className:"text-sm font-mono",children:[r.currentLat.toFixed(6),", ",r.currentLng.toFixed(6)]}),s.jsx("p",{className:"text-xs text-gray-400",children:new Date(r.lastUpdate).toLocaleTimeString()})]}),s.jsx("div",{className:"w-full h-32 bg-gray-200 rounded-lg flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Fe,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Live Map View"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Agent moving to your location"})]})})]})]}):null};class Mr{static startAgentTracking(e,t){this.trackingInterval&&clearInterval(this.trackingInterval),this.trackingInterval=setInterval(async()=>{try{const r=await this.getCurrentLocation();r&&(this.updateAgentLocation(t,r),this.notifySubscribers("agentLocationUpdate",{orderId:e,agentId:t,location:r,timestamp:Date.now()}))}catch(r){console.error("Agent tracking error:",r)}},1e4)}static stopTracking(){this.trackingInterval&&(clearInterval(this.trackingInterval),this.trackingInterval=null)}static getCurrentLocation(){return new Promise(e=>{if(!navigator.geolocation){e(null);return}navigator.geolocation.getCurrentPosition(t=>{e({lat:t.coords.latitude,lng:t.coords.longitude,accuracy:t.coords.accuracy,timestamp:Date.now()})},t=>{console.error("Location error:",t),e(null)},{enableHighAccuracy:!0,timeout:8e3,maximumAge:5e3})})}static updateAgentLocation(e,t){const r=this.getDeliveryAgents(),a=r.findIndex(l=>l.id===e);a>=0&&(r[a].currentLocation=t,localStorage.setItem("deliveryAgents",JSON.stringify(r)))}static getDeliveryAgents(){const e=localStorage.getItem("deliveryAgents");return e?JSON.parse(e):[]}static getTrackingData(e){const t=this.getOrderById(e);if(!t||!t.deliveryAgentId)return null;const r=this.getDeliveryAgents().find(c=>c.id===t.deliveryAgentId);if(!r)return null;const a=this.getCustomerLocation(e);if(!a)return null;const l=this.calculateDistance(r.currentLocation,a);return{orderId:e,agentLocation:r.currentLocation,customerLocation:a,estimatedArrival:Math.ceil(l*2),distance:l,status:this.getDeliveryStatus(l)}}static calculateDistance(e,t){const a=(t.lat-e.lat)*Math.PI/180,l=(t.lng-e.lng)*Math.PI/180,c=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(t.lat*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}static getDeliveryStatus(e){return e<.1?"nearby":e<.5?"on_the_way":"picked_up"}static getOrderById(e){return JSON.parse(localStorage.getItem("customerOrders")||"[]").find(r=>r.orderId===e)}static getCustomerLocation(e){const t=this.getOrderById(e);return(t==null?void 0:t.customerCoordinates)||null}static subscribe(e,t){this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}static unsubscribe(e,t){const r=this.subscribers.get(e);if(r){const a=r.indexOf(t);a>-1&&r.splice(a,1)}}static notifySubscribers(e,t){const r=this.subscribers.get(e);r&&r.forEach(a=>a(t))}static assignAgent(e,t){const r=JSON.parse(localStorage.getItem("customerOrders")||"[]"),a=r.findIndex(u=>u.orderId===e);a>=0&&(r[a].deliveryAgentId=t,r[a].status="assigned",localStorage.setItem("customerOrders",JSON.stringify(r)));const l=this.getDeliveryAgents(),c=l.findIndex(u=>u.id===t);c>=0&&(l[c].orderId=e,localStorage.setItem("deliveryAgents",JSON.stringify(l)))}}ze(Mr,"trackingInterval",null),ze(Mr,"subscribers",new Map);const KN=()=>{var P,b;const[i,e]=v.useState(null),[t,r]=v.useState(null),[a,l]=v.useState(""),[c,u]=v.useState(!1),{toast:h}=Et(),f=Is(),p=async()=>{u(!0);try{const j=await wt.getOrdersFromAPI(),S=localStorage.getItem("currentOrder");if(S){const k=JSON.parse(S),N=j.find(T=>T.orderId===k.orderId);N&&(e(N),localStorage.setItem("currentOrder",JSON.stringify(N)),h({title:"Order Updated",description:"Latest order status loaded"}))}}catch{h({title:"Update Failed",description:"Could not fetch latest order status",variant:"destructive"})}finally{u(!1)}};v.useEffect(()=>{delete Kt.Icon.Default.prototype._getIconUrl,Kt.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"})},[]),Kt.divIcon({html:'<div style="background-color: #2563eb; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 3px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"><span style="color: white; font-size: 16px;"></span></div>',className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]}),Kt.divIcon({html:'<div style="background-color: #dc2626; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 3px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"><span style="color: white; font-size: 16px;"></span></div>',className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]}),v.useEffect(()=>{(async()=>{try{const k=await wt.getOrdersFromAPI(),N=localStorage.getItem("currentOrder"),T=localStorage.getItem("customerAddress");if(N){let O=JSON.parse(N);const E=k.find(I=>I.orderId===O.orderId);if(E&&(O=E),O.status==="out_for_delivery"&&(O.deliveryAgent||(O.deliveryAgent={name:"Rahul Sharma",phone:"+91 98765 43210",location:{lat:21.3099+(Math.random()-.5)*.01,lng:75.1178+(Math.random()-.5)*.01}}),!t)){const I={name:"Customer",phone:O.customerPhone||"+91 98765 43210",address:O.deliveryAddress||"Shirpur, Maharashtra",coordinates:{lat:21.3099,lng:75.1178}};r(I),localStorage.setItem("customerAddress",JSON.stringify(I))}e(O),l(O.status)}T&&r(JSON.parse(T))}catch(k){console.error("Failed to load order data:",k);const N=localStorage.getItem("currentOrder"),T=localStorage.getItem("customerAddress");if(N){let O=JSON.parse(N);if(O.status==="out_for_delivery"&&(O.deliveryAgent||(O.deliveryAgent={name:"Rahul Sharma",phone:"+91 98765 43210",location:{lat:21.3099+(Math.random()-.5)*.01,lng:75.1178+(Math.random()-.5)*.01}}),!t)){const E={name:"Customer",phone:O.customerPhone||"+91 98765 43210",address:O.deliveryAddress||"Shirpur, Maharashtra",coordinates:{lat:21.3099,lng:75.1178}};r(E),localStorage.setItem("customerAddress",JSON.stringify(E))}e(O),l(O.status)}T&&r(JSON.parse(T))}})();const S=wt.subscribe(k=>{const N=JSON.parse(localStorage.getItem("currentOrder")||"{}").orderId;if(N){const T=k.find(O=>O.orderId===N);if(T){if(e(T),a&&T.status!==a){const E={confirmed:" Your order has been confirmed!",packing:" Your order is being packed",out_for_delivery:" Your order is out for delivery!",delivered:" Your order has been delivered!"}[T.status];E&&h({title:"Order Update",description:E}),T.status==="out_for_delivery"&&Mr.assignAgent(T.orderId,"agent_001")}l(T.status)}}});return pt.requestPermission(),S},[a,h]);const y=(j=>{switch(j){case"pending":return{icon:dt,color:"text-yellow-600",bg:"bg-yellow-100",text:"Order Placed"};case"confirmed":return{icon:xe,color:"text-blue-600",bg:"bg-blue-100",text:"Order Confirmed"};case"packing":return{icon:xe,color:"text-orange-600",bg:"bg-orange-100",text:"Packing Your Order"};case"out_for_delivery":return{icon:it,color:"text-primary",bg:"bg-blue-100",text:"Out for Delivery"};case"delivered":return{icon:Qt,color:"text-green-600",bg:"bg-green-100",text:"Delivered"};default:return{icon:dt,color:"text-gray-600",bg:"bg-gray-100",text:"Processing"}}})((i==null?void 0:i.status)||"pending"),_=y.icon;return s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 md:space-y-6",children:[s.jsxs("div",{className:"mb-6 md:mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>f(-1),children:[s.jsx(Di,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex-1 text-center",children:s.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Track Your Order"})}),s.jsxs(D,{variant:"outline",size:"sm",onClick:p,disabled:c,className:"flex items-center gap-2",children:[s.jsx(cc,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"Refresh"]})]}),s.jsx("p",{className:"text-sm md:text-base text-muted-foreground px-4",children:"Real-time delivery tracking from database"})]}),s.jsxs(U,{children:[s.jsx(ne,{className:"p-6",children:s.jsxs(ie,{className:"flex items-center text-lg",children:[s.jsx(_,{className:`w-6 h-6 mr-2 ${y.color}`}),s.jsxs("span",{className:"truncate",children:["Order #",(i==null?void 0:i.orderId)||"No active order"]})]})}),s.jsxs(z,{className:"p-6 pt-0",children:[s.jsx("div",{className:"flex items-center justify-between mb-4 gap-2",children:i?s.jsxs(s.Fragment,{children:[s.jsx(X,{className:`${y.bg} ${y.color} border-0 text-sm w-fit`,children:y.text}),i.timestamp&&s.jsxs("span",{className:"text-sm text-muted-foreground block mt-2",children:["Last updated: ",new Date(i.timestamp).toLocaleTimeString()]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xe,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No Active Orders"}),s.jsx("p",{className:"text-sm text-muted-foreground px-4",children:"Place an order from our products to start tracking"}),s.jsx(D,{className:"mt-4",onClick:()=>f("/customer"),children:"Browse Products"})]})}),i&&s.jsxs(s.Fragment,{children:[i.status==="confirmed"&&s.jsx("div",{className:"bg-blue-50 p-3 rounded text-sm text-blue-800 mt-3",children:" Your order has been confirmed and is being prepared by our team."}),i.status==="packing"&&s.jsx("div",{className:"bg-orange-50 p-3 rounded text-sm text-orange-800 mt-3",children:" Your order is being packed and will be assigned to a delivery partner soon."}),i.status==="out_for_delivery"&&s.jsxs("div",{className:"bg-blue-50 p-3 rounded text-sm text-blue-800 mt-3",children:[" Your order is on the way! ",(P=i.deliveryAgent)==null?void 0:P.name," is heading to your location.",((b=i.deliveryAgent)==null?void 0:b.phone)&&s.jsxs("div",{className:"mt-1 text-sm",children:[" Contact: ",i.deliveryAgent.phone]})]}),i.status==="delivered"&&s.jsx("div",{className:"bg-green-50 p-3 rounded text-sm text-green-800 mt-3",children:" Your order has been delivered successfully! Thank you for choosing Shirpur Delivery."})]})]})]}),i&&i.status==="out_for_delivery"&&s.jsxs(U,{children:[s.jsx(ne,{className:"p-6",children:s.jsxs(ie,{className:"flex items-center text-lg",children:[s.jsx(Fe,{className:"w-5 h-5 mr-2 text-green-600"}),"Live GPS Tracking",s.jsx(X,{className:"ml-2 bg-green-500 text-white animate-pulse",children:"LIVE"})]})}),s.jsx(z,{className:"p-6 pt-0",children:s.jsx(YN,{orderId:i.orderId})})]}),i&&i.status==="out_for_delivery"&&(t==null?void 0:t.coordinates)&&s.jsx(JN,{orderId:i.orderId,customerLat:t.coordinates.lat,customerLng:t.coordinates.lng}),!1,i&&t&&s.jsxs(U,{children:[s.jsx(ne,{className:"p-6",children:s.jsx(ie,{className:"text-lg",children:"Delivery Information"})}),s.jsxs(z,{className:"p-6 pt-0 space-y-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2 text-base",children:"Delivery Address"}),s.jsxs("div",{className:"bg-muted p-3 rounded",children:[s.jsx("p",{className:"font-medium text-base",children:t.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",t.phone]}),s.jsx("p",{className:"text-sm leading-relaxed",children:t.address}),t.landmark&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Near: ",t.landmark]}),s.jsxs("p",{className:"text-sm",children:[" ",t.pincode]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[s.jsx("p",{className:"text-muted-foreground",children:"Estimated Delivery"}),s.jsx("p",{className:"font-semibold",children:"15-30 minutes"})]}),s.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[s.jsx("p",{className:"text-muted-foreground",children:"Delivery Fee"}),s.jsx("p",{className:"font-semibold",children:"4.99"})]})]})]})]}),i&&i.items&&s.jsxs(U,{children:[s.jsx(ne,{className:"p-6",children:s.jsx(ie,{className:"text-lg",children:"Order Summary"})}),s.jsx(z,{className:"p-6 pt-0",children:s.jsxs("div",{className:"space-y-2",children:[i.items.map((j,S)=>s.jsxs("div",{className:"flex justify-between items-center py-2 border-b last:border-b-0",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-base truncate",children:j.product.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Qty: ",j.quantity]})]}),s.jsxs("p",{className:"font-semibold text-base ml-2",children:["",(j.product.price*j.quantity).toFixed(2)]})]},S)),s.jsxs("div",{className:"flex justify-between items-center pt-3 font-bold text-lg bg-gray-50 p-2 rounded",children:[s.jsx("span",{children:"Total Amount:"}),s.jsxs("span",{children:["",i.total.toFixed(2)]})]})]})})]})]})})},YN=({orderId:i})=>{const[e,t]=v.useState(null),[r,a]=v.useState(null),[l,c]=v.useState(""),[u,h]=v.useState(null);return v.useEffect(()=>{const f=JSON.parse(localStorage.getItem("customerAddress")||"{}");f.coordinates&&a(f.coordinates);const p=_=>{const{orderId:P,location:b}=_.detail;P===i&&(console.log(" Customer received live location update:",b),t(b),c(new Date().toLocaleTimeString()))},g=()=>{const _=localStorage.getItem(`customerTracking_${i}`);if(_){const P=JSON.parse(_);P.agentLocation&&(t(P.agentLocation),c(new Date(P.lastUpdate).toLocaleTimeString()))}};g(),window.addEventListener("liveLocationUpdate",p);const y=setInterval(g,5e3);return()=>{window.removeEventListener("liveLocationUpdate",p),clearInterval(y)}},[i]),v.useEffect(()=>{if(e&&r){const p=(r.lat-e.lat)*Math.PI/180,g=(r.lng-e.lng)*Math.PI/180,y=Math.sin(p/2)*Math.sin(p/2)+Math.cos(e.lat*Math.PI/180)*Math.cos(r.lat*Math.PI/180)*Math.sin(g/2)*Math.sin(g/2),P=6371*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)));h(P)}},[e,r]),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-semibold text-green-800",children:" Delivery Agent Location"}),s.jsx(X,{className:"bg-green-500 text-white",children:e?"LIVE":"Waiting..."})]}),e?s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-green-700",children:["Distance: ",s.jsx("span",{className:"font-bold",children:u?`${u.toFixed(2)} km`:"Calculating..."})]}),s.jsxs("p",{className:"text-green-700",children:["ETA: ",s.jsx("span",{className:"font-bold",children:u?`${Math.round(u*3)} min`:"Calculating..."})]})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-green-700",children:["Last Update: ",s.jsx("span",{className:"font-bold",children:l})]}),s.jsxs("p",{className:"text-green-700",children:["Status: ",s.jsx("span",{className:"font-bold text-green-600",children:"On the way"})]})]})]}),s.jsxs("div",{className:"mt-3 p-2 bg-white rounded border",children:[s.jsx("p",{className:"text-xs text-gray-600",children:"GPS Coordinates:"}),s.jsxs("p",{className:"text-xs font-mono",children:["Agent: ",e.lat.toFixed(6),", ",e.lng.toFixed(6)]}),r&&s.jsxs("p",{className:"text-xs font-mono",children:["You: ",r.lat.toFixed(6),", ",r.lng.toFixed(6)]})]})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"loading-spinner mx-auto mb-2"}),s.jsx("p",{className:"text-green-700 text-sm",children:"Waiting for delivery agent to accept order..."})]})]}),e&&r&&s.jsx("div",{className:"h-64 rounded-lg overflow-hidden border",children:s.jsxs(co,{center:[e.lat,e.lng],zoom:14,style:{height:"100%",width:"100%"},children:[s.jsx(uo,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:" OpenStreetMap contributors"}),s.jsx(xr,{position:[e.lat,e.lng],children:s.jsx(vr,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("strong",{children:" Delivery Agent"}),s.jsx("br",{}),"Live Location",s.jsx("br",{}),s.jsxs("small",{children:["Updated: ",l]})]})})}),s.jsx(xr,{position:[r.lat,r.lng],children:s.jsx(vr,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("strong",{children:" Your Location"}),s.jsx("br",{}),"Delivery Address"]})})})]})})]})};class qr extends Error{constructor(e,t){const r=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=r}}class $c extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class fs extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class QN extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=r}}class XN extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=r}}class eS extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=r}}class Ju extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class tS extends Error{constructor(e,t){const r=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=r}}class bp{constructor(e,t,r){this.statusCode=e,this.statusText=t,this.content=r}}class ho{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var $;(function(i){i[i.Trace=0]="Trace",i[i.Debug=1]="Debug",i[i.Information=2]="Information",i[i.Warning=3]="Warning",i[i.Error=4]="Error",i[i.Critical=5]="Critical",i[i.None=6]="None"})($||($={}));class Ci{constructor(){}log(e,t){}}Ci.instance=new Ci;const sS="9.0.6";class lt{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,r){if(!(e in t))throw new Error(`Unknown ${r} value: ${e}.`)}}class Xe{static get isBrowser(){return!Xe.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!Xe.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!Xe.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}}function Ti(i,e){let t="";return Gr(i)?(t=`Binary data of length ${i.byteLength}`,e&&(t+=`. Content: '${rS(i)}'`)):typeof i=="string"&&(t=`String data of length ${i.length}`,e&&(t+=`. Content: '${i}'`)),t}function rS(i){const e=new Uint8Array(i);let t="";return e.forEach(r=>{const a=r<16?"0":"";t+=`0x${a}${r.toString(16)} `}),t.substr(0,t.length-1)}function Gr(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}async function _p(i,e,t,r,a,l){const c={},[u,h]=Un();c[u]=h,i.log($.Trace,`(${e} transport) sending data. ${Ti(a,l.logMessageContent)}.`);const f=Gr(a)?"arraybuffer":"text",p=await t.post(r,{content:a,headers:{...c,...l.headers},responseType:f,timeout:l.timeout,withCredentials:l.withCredentials});i.log($.Trace,`(${e} transport) request complete. Response status: ${p.statusCode}.`)}function nS(i){return i===void 0?new La($.Information):i===null?Ci.instance:i.log!==void 0?i:new La(i)}class iS{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class La{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const r=`[${new Date().toISOString()}] ${$[e]}: ${t}`;switch(e){case $.Critical:case $.Error:this.out.error(r);break;case $.Warning:this.out.warn(r);break;case $.Information:this.out.info(r);break;default:this.out.log(r);break}}}}function Un(){let i="X-SignalR-User-Agent";return Xe.isNode&&(i="User-Agent"),[i,aS(sS,oS(),cS(),lS())]}function aS(i,e,t,r){let a="Microsoft SignalR/";const l=i.split(".");return a+=`${l[0]}.${l[1]}`,a+=` (${i}; `,e&&e!==""?a+=`${e}; `:a+="Unknown OS; ",a+=`${t}`,r?a+=`; ${r}`:a+="; Unknown Runtime Version",a+=")",a}function oS(){if(Xe.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function lS(){if(Xe.isNode)return process.versions.node}function cS(){return Xe.isNode?"NodeJS":"Browser"}function gl(i){return i.stack?i.stack:i.message?i.message:`${i}`}function dS(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("could not find global")}class uS extends ho{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||Xe.isNode){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(t("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=t("node-fetch"):this._fetchType=fetch,this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(dS());if(typeof AbortController>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new fs;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let r;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),r=new fs});let a=null;if(e.timeout){const h=e.timeout;a=setTimeout(()=>{t.abort(),this._logger.log($.Warning,"Timeout from HTTP request."),r=new $c},h)}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},Gr(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");let l;try{l=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(h){throw r||(this._logger.log($.Warning,`Error from HTTP request. ${h}.`),h)}finally{a&&clearTimeout(a),e.abortSignal&&(e.abortSignal.onabort=null)}if(!l.ok){const h=await Ku(l,"text");throw new qr(h||l.statusText,l.status)}const u=await Ku(l,e.responseType);return new bp(l.status,l.statusText,u)}getCookieString(e){let t="";return Xe.isNode&&this._jar&&this._jar.getCookies(e,(r,a)=>t=a.join("; ")),t}}function Ku(i,e){let t;switch(e){case"arraybuffer":t=i.arrayBuffer();break;case"text":t=i.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:t=i.text();break}return t}class hS extends ho{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new fs):e.method?e.url?new Promise((t,r)=>{const a=new XMLHttpRequest;a.open(e.method,e.url,!0),a.withCredentials=e.withCredentials===void 0?!0:e.withCredentials,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(Gr(e.content)?a.setRequestHeader("Content-Type","application/octet-stream"):a.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const l=e.headers;l&&Object.keys(l).forEach(c=>{a.setRequestHeader(c,l[c])}),e.responseType&&(a.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{a.abort(),r(new fs)}),e.timeout&&(a.timeout=e.timeout),a.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),a.status>=200&&a.status<300?t(new bp(a.status,a.statusText,a.response||a.responseText)):r(new qr(a.response||a.responseText||a.statusText,a.status))},a.onerror=()=>{this._logger.log($.Warning,`Error from HTTP request. ${a.status}: ${a.statusText}.`),r(new qr(a.statusText,a.status))},a.ontimeout=()=>{this._logger.log($.Warning,"Timeout from HTTP request."),r(new $c)},a.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class mS extends ho{constructor(e){if(super(),typeof fetch<"u"||Xe.isNode)this._httpClient=new uS(e);else if(typeof XMLHttpRequest<"u")this._httpClient=new hS(e);else throw new Error("No usable HttpClient found.")}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new fs):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class Bt{static write(e){return`${e}${Bt.RecordSeparator}`}static parse(e){if(e[e.length-1]!==Bt.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(Bt.RecordSeparator);return t.pop(),t}}Bt.RecordSeparatorCode=30;Bt.RecordSeparator=String.fromCharCode(Bt.RecordSeparatorCode);class fS{writeHandshakeRequest(e){return Bt.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,r;if(Gr(e)){const u=new Uint8Array(e),h=u.indexOf(Bt.RecordSeparatorCode);if(h===-1)throw new Error("Message is incomplete.");const f=h+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(u.slice(0,f))),r=u.byteLength>f?u.slice(f).buffer:null}else{const u=e,h=u.indexOf(Bt.RecordSeparator);if(h===-1)throw new Error("Message is incomplete.");const f=h+1;t=u.substring(0,f),r=u.length>f?u.substring(f):null}const a=Bt.parse(t),l=JSON.parse(a[0]);if(l.type)throw new Error("Expected a handshake response from the server.");return[r,l]}}var we;(function(i){i[i.Invocation=1]="Invocation",i[i.StreamItem=2]="StreamItem",i[i.Completion=3]="Completion",i[i.StreamInvocation=4]="StreamInvocation",i[i.CancelInvocation=5]="CancelInvocation",i[i.Ping=6]="Ping",i[i.Close=7]="Close",i[i.Ack=8]="Ack",i[i.Sequence=9]="Sequence"})(we||(we={}));class pS{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new iS(this,e)}}class gS{constructor(e,t,r){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=t,this._bufferSize=r}async _send(e){const t=this._protocol.writeMessage(e);let r=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let a=()=>{},l=()=>{};Gr(t)?this._bufferedByteCount+=t.byteLength:this._bufferedByteCount+=t.length,this._bufferedByteCount>=this._bufferSize&&(r=new Promise((c,u)=>{a=c,l=u})),this._messages.push(new xS(t,this._totalMessageCount,a,l))}try{this._reconnectInProgress||await this._connection.send(t)}catch{this._disconnected()}await r}_ack(e){let t=-1;for(let r=0;r<this._messages.length;r++){const a=this._messages[r];if(a._id<=e.sequenceId)t=r,Gr(a._message)?this._bufferedByteCount-=a._message.byteLength:this._bufferedByteCount-=a._message.length,a._resolver();else if(this._bufferedByteCount<this._bufferSize)a._resolver();else break}t!==-1&&(this._messages=this._messages.slice(t+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type!==we.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const t=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,t<=this._latestReceivedSequenceId?(t===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=t,this._ackTimer(),!0)}_resetSequence(e){if(e.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:we.Sequence,sequenceId:e}));const t=this._messages;for(const r of t)await this._connection.send(r._message);this._reconnectInProgress=!1}_dispose(e){e??(e=new Error("Unable to reconnect to server."));for(const t of this._messages)t._rejector(e)}_isInvocationMessage(e){switch(e.type){case we.Invocation:case we.StreamItem:case we.Completion:case we.StreamInvocation:case we.CancelInvocation:return!0;case we.Close:case we.Sequence:case we.Ping:case we.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:we.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}}class xS{constructor(e,t,r,a){this._message=e,this._id=t,this._resolver=r,this._rejector=a}}const vS=30*1e3,yS=15*1e3,bS=1e5;var Je;(function(i){i.Disconnected="Disconnected",i.Connecting="Connecting",i.Connected="Connected",i.Disconnecting="Disconnecting",i.Reconnecting="Reconnecting"})(Je||(Je={}));class Uc{static create(e,t,r,a,l,c,u){return new Uc(e,t,r,a,l,c,u)}constructor(e,t,r,a,l,c,u){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log($.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},lt.isRequired(e,"connection"),lt.isRequired(t,"logger"),lt.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=l??vS,this.keepAliveIntervalInMilliseconds=c??yS,this._statefulReconnectBufferSize=u??bS,this._logger=t,this._protocol=r,this.connection=e,this._reconnectPolicy=a,this._handshakeProtocol=new fS,this.connection.onreceive=h=>this._processIncomingData(h),this.connection.onclose=h=>this._connectionClosed(h),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Je.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:we.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==Je.Disconnected&&this._connectionState!==Je.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==Je.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=Je.Connecting,this._logger.log($.Debug,"Starting HubConnection.");try{await this._startInternal(),Xe.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=Je.Connected,this._connectionStarted=!0,this._logger.log($.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=Je.Disconnected,this._logger.log($.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((t,r)=>{this._handshakeResolver=t,this._handshakeRejecter=r});await this.connection.start(this._protocol.transferFormat);try{let t=this._protocol.version;this.connection.features.reconnect||(t=1);const r={protocol:this._protocol.name,version:t};if(this._logger.log($.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(r)),this._logger.log($.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new gS(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(t){throw this._logger.log($.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch{}}_stopInternal(e){if(this._connectionState===Je.Disconnected)return this._logger.log($.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===Je.Disconnecting)return this._logger.log($.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const t=this._connectionState;return this._connectionState=Je.Disconnecting,this._logger.log($.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log($.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(t===Je.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new fs("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...t){const[r,a]=this._replaceStreamingParams(t),l=this._createStreamInvocation(e,t,a);let c;const u=new pS;return u.cancelCallback=()=>{const h=this._createCancelInvocation(l.invocationId);return delete this._callbacks[l.invocationId],c.then(()=>this._sendWithProtocol(h))},this._callbacks[l.invocationId]=(h,f)=>{if(f){u.error(f);return}else h&&(h.type===we.Completion?h.error?u.error(new Error(h.error)):u.complete():u.next(h.item))},c=this._sendWithProtocol(l).catch(h=>{u.error(h),delete this._callbacks[l.invocationId]}),this._launchStreams(r,c),u}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[r,a]=this._replaceStreamingParams(t),l=this._sendWithProtocol(this._createInvocation(e,t,!0,a));return this._launchStreams(r,l),l}invoke(e,...t){const[r,a]=this._replaceStreamingParams(t),l=this._createInvocation(e,t,!1,a);return new Promise((u,h)=>{this._callbacks[l.invocationId]=(p,g)=>{if(g){h(g);return}else p&&(p.type===we.Completion?p.error?h(new Error(p.error)):u(p.result):h(new Error(`Unexpected message type: ${p.type}`)))};const f=this._sendWithProtocol(l).catch(p=>{h(p),delete this._callbacks[l.invocationId]});this._launchStreams(r,f)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const r=this._methods[e];if(r)if(t){const a=r.indexOf(t);a!==-1&&(r.splice(a,1),r.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const r of t)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(r)))switch(r.type){case we.Invocation:this._invokeClientMethod(r).catch(a=>{this._logger.log($.Error,`Invoke client method threw error: ${gl(a)}`)});break;case we.StreamItem:case we.Completion:{const a=this._callbacks[r.invocationId];if(a){r.type===we.Completion&&delete this._callbacks[r.invocationId];try{a(r)}catch(l){this._logger.log($.Error,`Stream callback threw error: ${gl(l)}`)}}break}case we.Ping:break;case we.Close:{this._logger.log($.Information,"Close message received from server.");const a=r.error?new Error("Server returned an error on close: "+r.error):void 0;r.allowReconnect===!0?this.connection.stop(a):this._stopPromise=this._stopInternal(a);break}case we.Ack:this._messageBuffer&&this._messageBuffer._ack(r);break;case we.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(r);break;default:this._logger.log($.Warning,`Invalid message type: ${r.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,r;try{[r,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(a){const l="Error parsing handshake response: "+a;this._logger.log($.Error,l);const c=new Error(l);throw this._handshakeRejecter(c),c}if(t.error){const a="Server returned handshake error: "+t.error;this._logger.log($.Error,a);const l=new Error(a);throw this._handshakeRejecter(l),l}else this._logger.log($.Debug,"Server handshake complete.");return this._handshakeResolver(),r}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===Je.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),r=this._methods[t];if(!r){this._logger.log($.Warning,`No client method with the name '${t}' found.`),e.invocationId&&(this._logger.log($.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)));return}const a=r.slice(),l=!!e.invocationId;let c,u,h;for(const f of a)try{const p=c;c=await f.apply(this,e.arguments),l&&c&&p&&(this._logger.log($.Error,`Multiple results provided for '${t}'. Sending error to server.`),h=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),u=void 0}catch(p){u=p,this._logger.log($.Error,`A callback for the method '${t}' threw error '${p}'.`)}h?await this._sendWithProtocol(h):l?(u?h=this._createCompletionMessage(e.invocationId,`${u}`,null):c!==void 0?h=this._createCompletionMessage(e.invocationId,null,c):(this._logger.log($.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),h=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(h)):c&&this._logger.log($.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log($.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new fs("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Je.Disconnecting?this._completeClose(e):this._connectionState===Je.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===Je.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=Je.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),Xe.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log($.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let r=0,a=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),l=this._getNextRetryDelay(r++,0,a);if(l===null){this._logger.log($.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e);return}if(this._connectionState=Je.Reconnecting,e?this._logger.log($.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log($.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(c=>c.apply(this,[e]))}catch(c){this._logger.log($.Error,`An onreconnecting callback called with error '${e}' threw error '${c}'.`)}if(this._connectionState!==Je.Reconnecting){this._logger.log($.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;l!==null;){if(this._logger.log($.Information,`Reconnect attempt number ${r} will start in ${l} ms.`),await new Promise(c=>{this._reconnectDelayHandle=setTimeout(c,l)}),this._reconnectDelayHandle=void 0,this._connectionState!==Je.Reconnecting){this._logger.log($.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=Je.Connected,this._logger.log($.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(c=>c.apply(this,[this.connection.connectionId]))}catch(c){this._logger.log($.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${c}'.`)}return}catch(c){if(this._logger.log($.Information,`Reconnect attempt failed because of error '${c}'.`),this._connectionState!==Je.Reconnecting){this._logger.log($.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===Je.Disconnecting&&this._completeClose();return}a=c instanceof Error?c:new Error(c.toString()),l=this._getNextRetryDelay(r++,Date.now()-t,a)}}this._logger.log($.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${r} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,r){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:r})}catch(a){return this._logger.log($.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${a}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(r=>{const a=t[r];try{a(null,e)}catch(l){this._logger.log($.Error,`Stream 'error' callback called with '${e}' threw error: ${gl(l)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,r,a){if(r)return a.length!==0?{target:e,arguments:t,streamIds:a,type:we.Invocation}:{target:e,arguments:t,type:we.Invocation};{const l=this._invocationId;return this._invocationId++,a.length!==0?{target:e,arguments:t,invocationId:l.toString(),streamIds:a,type:we.Invocation}:{target:e,arguments:t,invocationId:l.toString(),type:we.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(const r in e)e[r].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(r)))},error:a=>{let l;a instanceof Error?l=a.message:a&&a.toString?l=a.toString():l="Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(r,l)))},next:a=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(r,a)))}})}}_replaceStreamingParams(e){const t=[],r=[];for(let a=0;a<e.length;a++){const l=e[a];if(this._isObservable(l)){const c=this._invocationId;this._invocationId++,t[c]=l,r.push(c.toString()),e.splice(a,1)}}return[t,r]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,r){const a=this._invocationId;return this._invocationId++,r.length!==0?{target:e,arguments:t,invocationId:a.toString(),streamIds:r,type:we.StreamInvocation}:{target:e,arguments:t,invocationId:a.toString(),type:we.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:we.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:we.StreamItem}}_createCompletionMessage(e,t,r){return t?{error:t,invocationId:e,type:we.Completion}:{invocationId:e,result:r,type:we.Completion}}_createCloseMessage(){return{type:we.Close}}}const _S=[0,2e3,1e4,3e4,null];class Yu{constructor(e){this._retryDelays=e!==void 0?[...e,null]:_S}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class Hr{}Hr.Authorization="Authorization";Hr.Cookie="Cookie";class wS extends ho{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const r=await this._innerClient.send(e);return t&&r.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):r}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[Hr.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[Hr.Authorization]&&delete e.headers[Hr.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var mt;(function(i){i[i.None=0]="None",i[i.WebSockets=1]="WebSockets",i[i.ServerSentEvents=2]="ServerSentEvents",i[i.LongPolling=4]="LongPolling"})(mt||(mt={}));var Pt;(function(i){i[i.Text=1]="Text",i[i.Binary=2]="Binary"})(Pt||(Pt={}));let jS=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};class Qu{get pollAborted(){return this._pollAbort.aborted}constructor(e,t,r){this._httpClient=e,this._logger=t,this._pollAbort=new jS,this._options=r,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,t){if(lt.isRequired(e,"url"),lt.isRequired(t,"transferFormat"),lt.isIn(t,Pt,"transferFormat"),this._url=e,this._logger.log($.Trace,"(LongPolling transport) Connecting."),t===Pt.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,a]=Un(),l={[r]:a,...this._options.headers},c={abortSignal:this._pollAbort.signal,headers:l,timeout:1e5,withCredentials:this._options.withCredentials};t===Pt.Binary&&(c.responseType="arraybuffer");const u=`${e}&_=${Date.now()}`;this._logger.log($.Trace,`(LongPolling transport) polling: ${u}.`);const h=await this._httpClient.get(u,c);h.statusCode!==200?(this._logger.log($.Error,`(LongPolling transport) Unexpected response code: ${h.statusCode}.`),this._closeError=new qr(h.statusText||"",h.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,c)}async _poll(e,t){try{for(;this._running;)try{const r=`${e}&_=${Date.now()}`;this._logger.log($.Trace,`(LongPolling transport) polling: ${r}.`);const a=await this._httpClient.get(r,t);a.statusCode===204?(this._logger.log($.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):a.statusCode!==200?(this._logger.log($.Error,`(LongPolling transport) Unexpected response code: ${a.statusCode}.`),this._closeError=new qr(a.statusText||"",a.statusCode),this._running=!1):a.content?(this._logger.log($.Trace,`(LongPolling transport) data received. ${Ti(a.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(a.content)):this._logger.log($.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(r){this._running?r instanceof $c?this._logger.log($.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=r,this._running=!1):this._logger.log($.Trace,`(LongPolling transport) Poll errored after shutdown: ${r.message}`)}}finally{this._logger.log($.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?_p(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log($.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log($.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,r]=Un();e[t]=r;const a={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let l;try{await this._httpClient.delete(this._url,a)}catch(c){l=c}l?l instanceof qr&&(l.statusCode===404?this._logger.log($.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log($.Trace,`(LongPolling transport) Error sending a DELETE request: ${l}`)):this._logger.log($.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log($.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log($.Trace,e),this.onclose(this._closeError)}}}class NS{constructor(e,t,r,a){this._httpClient=e,this._accessToken=t,this._logger=r,this._options=a,this.onreceive=null,this.onclose=null}async connect(e,t){return lt.isRequired(e,"url"),lt.isRequired(t,"transferFormat"),lt.isIn(t,Pt,"transferFormat"),this._logger.log($.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((r,a)=>{let l=!1;if(t!==Pt.Text){a(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let c;if(Xe.isBrowser||Xe.isWebWorker)c=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const u=this._httpClient.getCookieString(e),h={};h.Cookie=u;const[f,p]=Un();h[f]=p,c=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...h,...this._options.headers}})}try{c.onmessage=u=>{if(this.onreceive)try{this._logger.log($.Trace,`(SSE transport) data received. ${Ti(u.data,this._options.logMessageContent)}.`),this.onreceive(u.data)}catch(h){this._close(h);return}},c.onerror=u=>{l?this._close():a(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},c.onopen=()=>{this._logger.log($.Information,`SSE connected to ${this._url}`),this._eventSource=c,l=!0,r()}}catch(u){a(u);return}})}async send(e){return this._eventSource?_p(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class SS{constructor(e,t,r,a,l,c){this._logger=r,this._accessTokenFactory=t,this._logMessageContent=a,this._webSocketConstructor=l,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=c}async connect(e,t){lt.isRequired(e,"url"),lt.isRequired(t,"transferFormat"),lt.isIn(t,Pt,"transferFormat"),this._logger.log($.Trace,"(WebSockets transport) Connecting.");let r;return this._accessTokenFactory&&(r=await this._accessTokenFactory()),new Promise((a,l)=>{e=e.replace(/^http/,"ws");let c;const u=this._httpClient.getCookieString(e);let h=!1;if(Xe.isNode||Xe.isReactNative){const f={},[p,g]=Un();f[p]=g,r&&(f[Hr.Authorization]=`Bearer ${r}`),u&&(f[Hr.Cookie]=u),c=new this._webSocketConstructor(e,void 0,{headers:{...f,...this._headers}})}else r&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(r)}`);c||(c=new this._webSocketConstructor(e)),t===Pt.Binary&&(c.binaryType="arraybuffer"),c.onopen=f=>{this._logger.log($.Information,`WebSocket connected to ${e}.`),this._webSocket=c,h=!0,a()},c.onerror=f=>{let p=null;typeof ErrorEvent<"u"&&f instanceof ErrorEvent?p=f.error:p="There was an error with the transport",this._logger.log($.Information,`(WebSockets transport) ${p}.`)},c.onmessage=f=>{if(this._logger.log($.Trace,`(WebSockets transport) data received. ${Ti(f.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(f.data)}catch(p){this._close(p);return}},c.onclose=f=>{if(h)this._close(f);else{let p=null;typeof ErrorEvent<"u"&&f instanceof ErrorEvent?p=f.error:p="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",l(new Error(p))}}})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log($.Trace,`(WebSockets transport) sending data. ${Ti(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log($.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(e)&&(e.wasClean===!1||e.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)):e instanceof Error?this.onclose(e):this.onclose())}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}}const Xu=100;class PS{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,lt.isRequired(e,"url"),this._logger=nS(t.logger),this.baseUrl=this._resolveUrl(e),t=t||{},t.logMessageContent=t.logMessageContent===void 0?!1:t.logMessageContent,typeof t.withCredentials=="boolean"||t.withCredentials===void 0)t.withCredentials=t.withCredentials===void 0?!0:t.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.timeout=t.timeout===void 0?100*1e3:t.timeout;let r=null,a=null;if(Xe.isNode&&typeof require<"u"){const l=typeof __webpack_require__=="function"?__non_webpack_require__:require;r=l("ws"),a=l("eventsource")}!Xe.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:Xe.isNode&&!t.WebSocket&&r&&(t.WebSocket=r),!Xe.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:Xe.isNode&&!t.EventSource&&typeof a<"u"&&(t.EventSource=a),this._httpClient=new wS(t.httpClient||new mS(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||Pt.Binary,lt.isIn(e,Pt,"transferFormat"),this._logger.log($.Debug,`Starting connection with transfer format '${Pt[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log($.Error,t),await this._stopPromise,Promise.reject(new fs(t))}else if(this._connectionState!=="Connected"){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log($.Error,t),Promise.reject(new fs(t))}this._connectionStarted=!0}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Fc(this.transport)),this._sendQueue.send(e))}async stop(e){if(this._connectionState==="Disconnected")return this._logger.log($.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log($.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t}),await this._stopInternal(e),await this._stopPromise}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(t){this._logger.log($.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log($.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===mt.WebSockets)this.transport=this._constructTransport(mt.WebSockets),await this._startTransport(t,e);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let r=null,a=0;do{if(r=await this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new fs("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(r.url&&(t=r.url),r.accessToken){const l=r.accessToken;this._accessTokenFactory=()=>l,this._httpClient._accessToken=l,this._httpClient._accessTokenFactory=void 0}a++}while(r.url&&a<Xu);if(a===Xu&&r.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,r,e)}this.transport instanceof Qu&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log($.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(r){return this._logger.log($.Error,"Failed to start the connection: "+r),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(r)}}async _getNegotiationResponse(e){const t={},[r,a]=Un();t[r]=a;const l=this._resolveNegotiateUrl(e);this._logger.log($.Debug,`Sending negotiation request: ${l}.`);try{const c=await this._httpClient.post(l,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(c.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${c.statusCode}'`));const u=JSON.parse(c.content);return(!u.negotiateVersion||u.negotiateVersion<1)&&(u.connectionToken=u.connectionId),u.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new Ju("Client didn't negotiate Stateful Reconnect but the server did.")):u}catch(c){let u="Failed to complete negotiation with the server: "+c;return c instanceof qr&&c.statusCode===404&&(u=u+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log($.Error,u),Promise.reject(new Ju(u))}}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}async _createTransport(e,t,r,a){let l=this._createConnectUrl(e,r.connectionToken);if(this._isITransport(t)){this._logger.log($.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(l,a),this.connectionId=r.connectionId;return}const c=[],u=r.availableTransports||[];let h=r;for(const f of u){const p=this._resolveTransportOrError(f,t,a,(h==null?void 0:h.useStatefulReconnect)===!0);if(p instanceof Error)c.push(`${f.transport} failed:`),c.push(p);else if(this._isITransport(p)){if(this.transport=p,!h){try{h=await this._getNegotiationResponse(e)}catch(g){return Promise.reject(g)}l=this._createConnectUrl(e,h.connectionToken)}try{await this._startTransport(l,a),this.connectionId=h.connectionId;return}catch(g){if(this._logger.log($.Error,`Failed to start the transport '${f.transport}': ${g}`),h=void 0,c.push(new eS(`${f.transport} failed: ${g}`,mt[f.transport])),this._connectionState!=="Connecting"){const y="Failed to select transport before stop() was called.";return this._logger.log($.Debug,y),Promise.reject(new fs(y))}}}}return c.length>0?Promise.reject(new tS(`Unable to connect to the server with any of the available transports. ${c.join(" ")}`,c)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case mt.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new SS(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case mt.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new NS(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case mt.LongPolling:return new Qu(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async r=>{let a=!1;if(this.features.reconnect)try{this.features.disconnected(),await this.transport.connect(e,t),await this.features.resend()}catch{a=!0}else{this._stopConnection(r);return}a&&this._stopConnection(r)}:this.transport.onclose=r=>this._stopConnection(r),this.transport.connect(e,t)}_resolveTransportOrError(e,t,r,a){const l=mt[e.transport];if(l==null)return this._logger.log($.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(kS(t,l))if(e.transferFormats.map(u=>Pt[u]).indexOf(r)>=0){if(l===mt.WebSockets&&!this._options.WebSocket||l===mt.ServerSentEvents&&!this._options.EventSource)return this._logger.log($.Debug,`Skipping transport '${mt[l]}' because it is not supported in your environment.'`),new QN(`'${mt[l]}' is not supported in your environment.`,l);this._logger.log($.Debug,`Selecting transport '${mt[l]}'.`);try{return this.features.reconnect=l===mt.WebSockets?a:void 0,this._constructTransport(l)}catch(u){return u}}else return this._logger.log($.Debug,`Skipping transport '${mt[l]}' because it does not support the requested transfer format '${Pt[r]}'.`),new Error(`'${mt[l]}' does not support ${Pt[r]}.`);else return this._logger.log($.Debug,`Skipping transport '${mt[l]}' because it was disabled by the client.`),new XN(`'${mt[l]}' is disabled by the client.`,l)}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log($.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log($.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log($.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log($.Error,`Connection disconnected with error '${e}'.`):this._logger.log($.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log($.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log($.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!Xe.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log($.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=new URL(e);t.pathname.endsWith("/")?t.pathname+="negotiate":t.pathname+="/negotiate";const r=new URLSearchParams(t.searchParams);return r.has("negotiateVersion")||r.append("negotiateVersion",this._negotiateVersion.toString()),r.has("useStatefulReconnect")?r.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&r.append("useStatefulReconnect","true"),t.search=r.toString(),t.toString()}}function kS(i,e){return!i||(e&i)!==0}class Fc{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new ya,this._transportResult=new ya,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new ya),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new ya;const e=this._transportResult;this._transportResult=void 0;const t=typeof this._buffer[0]=="string"?this._buffer.join(""):Fc._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(r){e.reject(r)}}}static _concatBuffers(e){const t=e.map(l=>l.byteLength).reduce((l,c)=>l+c),r=new Uint8Array(t);let a=0;for(const l of e)r.set(new Uint8Array(l),a),a+=l.byteLength;return r.buffer}}class ya{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}const CS="json";class TS{constructor(){this.name=CS,this.version=2,this.transferFormat=Pt.Text}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];t===null&&(t=Ci.instance);const r=Bt.parse(e),a=[];for(const l of r){const c=JSON.parse(l);if(typeof c.type!="number")throw new Error("Invalid payload.");switch(c.type){case we.Invocation:this._isInvocationMessage(c);break;case we.StreamItem:this._isStreamItemMessage(c);break;case we.Completion:this._isCompletionMessage(c);break;case we.Ping:break;case we.Close:break;case we.Ack:this._isAckMessage(c);break;case we.Sequence:this._isSequenceMessage(c);break;default:t.log($.Information,"Unknown message type '"+c.type+"' ignored.");continue}a.push(c)}return a}writeMessage(e){return Bt.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}}const OS={trace:$.Trace,debug:$.Debug,info:$.Information,information:$.Information,warn:$.Warning,warning:$.Warning,error:$.Error,critical:$.Critical,none:$.None};function IS(i){const e=OS[i.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${i}`)}class AS{configureLogging(e){if(lt.isRequired(e,"logging"),ES(e))this.logger=e;else if(typeof e=="string"){const t=IS(e);this.logger=new La(t)}else this.logger=new La(e);return this}withUrl(e,t){return lt.isRequired(e,"url"),lt.isNotEmpty(e,"url"),this.url=e,typeof t=="object"?this.httpConnectionOptions={...this.httpConnectionOptions,...t}:this.httpConnectionOptions={...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return lt.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new Yu(e):this.reconnectPolicy=e:this.reconnectPolicy=new Yu,this}withServerTimeout(e){return lt.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return lt.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e==null?void 0:e.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new PS(this.url,e);return Uc.create(t,this.logger||Ci.instance,this.protocol||new TS,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}function ES(i){return i.log!==void 0}class LS{constructor(){ze(this,"connection",null);ze(this,"listeners",new Map);ze(this,"currentUserType",null)}async connect(e,t){this.connection||(this.currentUserType=e,this.connection=new AS().withUrl("http://localhost:5000/notificationHub").build(),await this.connection.start(),await this.connection.invoke("JoinGroup",e,t),e==="admin"?this.connection.on("AdminNotification",r=>{this.notifyListeners("AdminNotification",r)}):e==="delivery"?this.connection.on("DeliveryNotification",r=>{this.notifyListeners("DeliveryNotification",r)}):e==="customer"&&this.connection.on("CustomerNotification",r=>{this.notifyListeners("CustomerNotification",r)}))}subscribe(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}getUserType(){return this.currentUserType}notifyListeners(e,t){(this.listeners.get(e)||[]).forEach(a=>a(t))}disconnect(){this.connection&&(this.connection.stop(),this.connection=null)}}const xl=new LS,Ma=({userType:i})=>{const[e,t]=v.useState([]),[r,a]=v.useState(!1),[l,c]=v.useState(0);v.useEffect(()=>{i==="customer"&&localStorage.getItem("customerPhone"),console.log(`Mock notifications enabled for ${i}`),i==="admin"?xl.subscribe("AdminNotification",g=>{pt.addNotification({title:g.title,message:g.message,type:g.type,priority:g.priority})}):i==="delivery"?xl.subscribe("DeliveryNotification",g=>{pt.addNotification({title:g.title,message:g.message,type:g.type,priority:g.priority})}):i==="customer"&&xl.subscribe("CustomerNotification",g=>{pt.addNotification({title:g.title,message:g.message,type:g.type,priority:g.priority})});const p=pt.subscribe(g=>{t(g.slice(0,10)),c(pt.getUnreadCount())});return t(pt.getNotifications().slice(0,10)),c(pt.getUnreadCount()),()=>{p()}},[i]);const u=p=>{pt.markAsRead(p)},h=()=>{pt.markAllAsRead()},f=p=>{switch(p){case"delivery_request":return"";case"order_update":return"";case"delivery_complete":return"";default:return""}};return s.jsxs("div",{className:"relative",children:[s.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>a(!r),className:"relative",children:[s.jsx(Br,{className:"w-5 h-5"}),l>0&&s.jsx(X,{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs min-w-[20px] h-5 flex items-center justify-center rounded-full",children:l>99?"99+":l})]}),r&&s.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 max-h-96 overflow-y-auto bg-white border rounded-lg shadow-lg z-50",children:[s.jsxs("div",{className:"p-3 border-b flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold",children:"Notifications"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[l>0&&s.jsx(D,{variant:"ghost",size:"sm",onClick:h,className:"text-xs",children:"Mark all read"}),s.jsx(D,{variant:"ghost",size:"sm",onClick:()=>a(!1),children:s.jsx(ps,{className:"w-4 h-4"})})]})]}),s.jsx("div",{className:"max-h-80 overflow-y-auto",children:e.length===0?s.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[s.jsx(Br,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):e.map(p=>s.jsx("div",{className:`p-3 border-b hover:bg-gray-50 cursor-pointer ${p.read?"":"bg-blue-50"}`,onClick:()=>u(p.id),children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"text-lg",children:f(p.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:`text-sm font-medium ${p.read?"text-gray-600":"text-gray-900"}`,children:p.title}),!p.read&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:p.message}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(p.timestamp).toLocaleTimeString()}),p.priority==="high"&&s.jsx(X,{className:"mt-1 bg-red-100 text-red-800 text-xs",children:"Urgent"})]})]})},p.id))}),e.length>0&&s.jsx("div",{className:"p-2 border-t bg-gray-50",children:s.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"Real-time notifications enabled"})})]})]})},MS=()=>{const i=Ks(),e=t=>i.pathname===t;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[s.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg safe-area-top",children:s.jsx("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0",children:[s.jsx(_e,{to:"/",className:"text-white hover:text-white/80 transition-colors flex-shrink-0",children:s.jsx(Di,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),s.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[s.jsx(xi,{className:"h-4 w-4 sm:h-5 sm:h-5 md:h-6 md:w-6 flex-shrink-0"}),s.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-bold truncate",children:"Admin Panel"})]})]}),s.jsxs("div",{className:"hidden lg:flex items-center space-x-4",children:[s.jsx(Ma,{userType:"admin"}),s.jsxs("nav",{className:"flex items-center space-x-2",children:[s.jsx(_e,{to:"/admin",children:s.jsxs(D,{variant:e("/admin")?"secondary":"ghost",className:e("/admin")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(wi,{className:"w-4 h-4 mr-2"}),"Dashboard"]})}),s.jsx(_e,{to:"/admin/products",children:s.jsxs(D,{variant:e("/admin/products")?"secondary":"ghost",className:e("/admin/products")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"Products"]})}),s.jsx(_e,{to:"/admin/orders",children:s.jsxs(D,{variant:e("/admin/orders")?"secondary":"ghost",className:e("/admin/orders")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(rt,{className:"w-4 h-4 mr-2"}),"Orders"]})}),s.jsx(_e,{to:"/admin/tracking",children:s.jsxs(D,{variant:e("/admin/tracking")?"secondary":"ghost",className:e("/admin/tracking")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Agents"]})}),s.jsx(_e,{to:"/admin/live-tracking",children:s.jsxs(D,{variant:e("/admin/live-tracking")?"secondary":"ghost",className:e("/admin/live-tracking")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(it,{className:"w-4 h-4 mr-2"}),"Live"]})}),s.jsx(_e,{to:"/admin/carousel",children:s.jsxs(D,{variant:e("/admin/carousel")?"secondary":"ghost",className:e("/admin/carousel")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(xi,{className:"w-4 h-4 mr-2"}),"Carousel"]})}),s.jsx(_e,{to:"/admin/features",children:s.jsxs(D,{variant:e("/admin/features")?"secondary":"ghost",className:e("/admin/features")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(_l,{className:"w-4 h-4 mr-2"}),"Features"]})})]}),s.jsx($n,{})]}),s.jsxs("div",{className:"flex lg:hidden items-center space-x-2",children:[s.jsx(Ma,{userType:"admin"}),s.jsxs(yc,{children:[s.jsx(bc,{asChild:!0,children:s.jsx(D,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/20",children:s.jsx(lc,{className:"w-5 h-5"})})}),s.jsx(Ya,{side:"right",className:"w-64",children:s.jsxs("div",{className:"flex flex-col space-y-4 mt-6",children:[s.jsx(_e,{to:"/admin",className:"w-full",children:s.jsxs(D,{variant:e("/admin")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(wi,{className:"w-4 h-4 mr-3"}),"Dashboard"]})}),s.jsx(_e,{to:"/admin/products",className:"w-full",children:s.jsxs(D,{variant:e("/admin/products")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(xe,{className:"w-4 h-4 mr-3"}),"Products"]})}),s.jsx(_e,{to:"/admin/orders",className:"w-full",children:s.jsxs(D,{variant:e("/admin/orders")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(rt,{className:"w-4 h-4 mr-3"}),"Orders"]})}),s.jsx(_e,{to:"/admin/tracking",className:"w-full",children:s.jsxs(D,{variant:e("/admin/tracking")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(Fe,{className:"w-4 h-4 mr-3"}),"Agents"]})}),s.jsx(_e,{to:"/admin/live-tracking",className:"w-full",children:s.jsxs(D,{variant:e("/admin/live-tracking")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(it,{className:"w-4 h-4 mr-3"}),"Live Tracking"]})}),s.jsx(_e,{to:"/admin/carousel",className:"w-full",children:s.jsxs(D,{variant:e("/admin/carousel")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(xi,{className:"w-4 h-4 mr-3"}),"Carousel"]})}),s.jsx(_e,{to:"/admin/features",className:"w-full",children:s.jsxs(D,{variant:e("/admin/features")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(_l,{className:"w-4 h-4 mr-3"}),"Smart Features"]})}),s.jsx("div",{className:"pt-4 border-t",children:s.jsx($n,{})})]})})]})]})]})})}),s.jsx("main",{children:s.jsx(vc,{})})]})};class DS{static async getAdminOrders(){return De.syncData("adminOrders",async()=>(await ce.getOrders()).map(t=>({id:t.id,orderId:t.orderId,customerName:t.customerName,customerPhone:t.customerPhone,deliveryAddress:t.deliveryAddress,total:t.total,status:t.status,paymentStatus:t.paymentStatus,items:t.items||[],createdAt:t.createdAt||new Date().toISOString(),updatedAt:t.updatedAt})).sort((t,r)=>new Date(r.createdAt).getTime()-new Date(t.createdAt).getTime()))}static async getAdminProducts(){return De.syncData("adminProducts",async()=>await ce.getProducts())}static async createProduct(e){try{const t=await ce.createProduct(e),r=De.getData("adminProducts")||[];return r.unshift(t),De.saveData("adminProducts",r),t}catch(t){return console.error("Admin: Failed to create product",t),null}}static async updateProduct(e,t){try{const r=await ce.updateProduct(e,t),a=De.getData("adminProducts")||[],l=a.findIndex(c=>c.id===e);return l!==-1&&(a[l]=r,De.saveData("adminProducts",a)),r}catch(r){return console.error("Admin: Failed to update product",r),null}}static async deleteProduct(e){try{await ce.deleteProduct(e);const r=(De.getData("adminProducts")||[]).filter(a=>a.id!==e);return De.saveData("adminProducts",r),!0}catch(t){return console.error("Admin: Failed to delete product",t),!1}}static async updateOrderStatus(e,t){try{await ce.updateOrderStatus(e,t);const r=De.getData("adminOrders")||[],a=r.find(l=>l.id===e);return a&&(a.status=t,a.updatedAt=new Date().toISOString(),De.saveData("adminOrders",r)),!0}catch(r){return console.error("Admin: Failed to update order status",r),!1}}static async getCustomers(){return De.syncData("adminCustomers",async()=>await ce.getCustomers())}static async getDeliveryAgents(){return De.syncData("adminDeliveryAgents",async()=>await ce.getDeliveryAgents())}static async createDeliveryAgent(e){try{const t=await ce.createDeliveryAgent(e),r=De.getData("adminDeliveryAgents")||[];return r.unshift(t),De.saveData("adminDeliveryAgents",r),t}catch(t){return console.error("Admin: Failed to create delivery agent",t),null}}static async getCategories(){return De.syncData("adminCategories",async()=>await ce.getCategories())}static async createCategory(e){try{const t=await ce.createCategory(e),r=De.getData("adminCategories")||[];return r.unshift(t),De.saveData("adminCategories",r),t}catch(t){return console.error("Admin: Failed to create category",t),null}}static async getDashboardStats(){return De.syncData("dashboardStats",async()=>await ce.getDashboardStats())}static async getOrdersByStatus(e){return(await this.getAdminOrders()).filter(r=>r.status===e)}static async getOrdersByDateRange(e,t){return(await this.getAdminOrders()).filter(a=>{const l=new Date(a.createdAt);return l>=new Date(e)&&l<=new Date(t)})}static getAdminMetrics(e,t=[]){const r=new Date,a=r.toDateString(),l=r.getMonth(),c=r.getFullYear(),u=e.filter(g=>new Date(g.createdAt).toDateString()===a),h=e.filter(g=>{const y=new Date(g.createdAt);return y.getMonth()===l&&y.getFullYear()===c}),f=e.filter(g=>g.status==="delivered"),p=e.filter(g=>g.paymentStatus==="paid");return{totalOrders:e.length,todaysOrders:u.length,monthlyOrders:h.length,pendingOrders:e.filter(g=>g.status==="pending").length,confirmedOrders:e.filter(g=>g.status==="confirmed").length,preparingOrders:e.filter(g=>g.status==="preparing").length,outForDelivery:e.filter(g=>g.status==="out_for_delivery").length,deliveredOrders:f.length,cancelledOrders:e.filter(g=>g.status==="cancelled").length,totalRevenue:p.reduce((g,y)=>g+y.total,0),todaysRevenue:u.filter(g=>g.paymentStatus==="paid").reduce((g,y)=>g+y.total,0),monthlyRevenue:h.filter(g=>g.paymentStatus==="paid").reduce((g,y)=>g+y.total,0),averageOrderValue:e.length>0?e.reduce((g,y)=>g+y.total,0)/e.length:0,totalProducts:t.length,activeProducts:t.filter(g=>g.isActive).length,inactiveProducts:t.filter(g=>!g.isActive).length,lowStockProducts:t.filter(g=>g.stockQuantity<10).length,outOfStockProducts:t.filter(g=>g.stockQuantity===0).length,orderFulfillmentRate:e.length>0?f.length/e.length*100:0,paymentSuccessRate:e.length>0?p.length/e.length*100:0,orderGrowth:this.calculateMonthlyGrowth(e,"count"),revenueGrowth:this.calculateMonthlyGrowth(p,"revenue")}}static calculateMonthlyGrowth(e,t){const r=new Date,a=r.getMonth(),l=r.getFullYear(),c=a===0?11:a-1,u=a===0?l-1:l,h=e.filter(y=>{const _=new Date(y.createdAt);return _.getMonth()===a&&_.getFullYear()===l}),f=e.filter(y=>{const _=new Date(y.createdAt);return _.getMonth()===c&&_.getFullYear()===u}),p=t==="count"?h.length:h.reduce((y,_)=>y+_.total,0),g=t==="count"?f.length:f.reduce((y,_)=>y+_.total,0);return g>0?(p-g)/g*100:0}static async refreshAllData(){try{await Promise.all([this.getAdminOrders(),this.getAdminProducts(),this.getCustomers(),this.getDeliveryAgents(),this.getCategories(),this.getDashboardStats()])}catch(e){console.error("Failed to refresh admin data:",e)}}static clearAdminCache(){["adminOrders","adminProducts","adminCustomers","adminDeliveryAgents","adminCategories","dashboardStats"].forEach(t=>localStorage.removeItem(t))}static async saveData(e,t){try{let r;switch(e){case"product":r=await this.createProduct(t);break;case"order":r=await ce.createOrder(t);break;case"customer":r=await ce.createCustomer(t);break;case"deliveryAgent":r=await this.createDeliveryAgent(t);break;case"category":r=await this.createCategory(t);break;default:throw new Error(`Unknown data type: ${e}`)}return r}catch(r){return console.error(`Failed to save ${e}:`,r),null}}static async getAllData(){try{const[e,t,r,a,l]=await Promise.all([this.getAdminOrders(),this.getAdminProducts(),this.getCustomers(),this.getDeliveryAgents(),this.getCategories()]);return{orders:e,products:t,customers:r,deliveryAgents:a,categories:l,metrics:this.getAdminMetrics(e,t)}}catch(e){return console.error("Failed to get all admin data:",e),{orders:[],products:[],customers:[],deliveryAgents:[],categories:[],metrics:this.getAdminMetrics([],[])}}}}const RS=()=>{const[i,e]=v.useState(!1),[t,r]=v.useState(null),[a,l]=v.useState(!0);return v.useEffect(()=>{const c=()=>{e(!0),r(new Date),l(!0),setTimeout(()=>e(!1),1e3)};Rt.subscribe("products",c),Rt.subscribe("orders",c),Rt.subscribe("deliveryAgents",c),Rt.subscribe("marketTrends",c);const u=()=>{l(navigator.onLine)};return window.addEventListener("online",u),window.addEventListener("offline",u),()=>{Rt.unsubscribe("products",c),Rt.unsubscribe("orders",c),Rt.unsubscribe("deliveryAgents",c),Rt.unsubscribe("marketTrends",c),window.removeEventListener("online",u),window.removeEventListener("offline",u)}},[]),s.jsxs("div",{className:"fixed top-4 right-4 z-50 flex items-center gap-2",children:[s.jsxs(X,{variant:a?"default":"destructive",className:`flex items-center gap-1 ${a?"bg-green-500":"bg-red-500"} text-white`,children:[a?s.jsx(lm,{className:"w-3 h-3"}):s.jsx(om,{className:"w-3 h-3"}),a?"Online":"Offline"]}),s.jsxs(X,{variant:"outline",className:`flex items-center gap-1 transition-all duration-300 ${i?"bg-blue-500 text-white border-blue-500 animate-pulse":"bg-white text-gray-600 border-gray-300"}`,children:[s.jsx(uc,{className:`w-3 h-3 ${i?"animate-spin":""}`}),i?"Updating...":"Real-time"]}),t&&s.jsx(X,{variant:"secondary",className:"text-xs",children:t.toLocaleTimeString()})]})},$S="https://your-project-ref.supabase.co",US="your-anon-key-here",Be=_f($S,US),_t=()=>!!Be;class ns{static async getProducts(){if(!Be)throw new Error("Supabase not configured");const{data:e,error:t}=await Be.from("products").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}static async addProduct(e){if(!Be)throw new Error("Supabase not configured");const{data:t,error:r}=await Be.from("products").insert([e]).select().single();if(r)throw r;return t}static async updateProduct(e,t){if(!Be)throw new Error("Supabase not configured");const{data:r,error:a}=await Be.from("products").update(t).eq("id",e).select().single();if(a)throw a;return r}static async deleteProduct(e){if(!Be)throw new Error("Supabase not configured");const{error:t}=await Be.from("products").delete().eq("id",e);if(t)throw t}static async getOrders(){if(!Be)throw new Error("Supabase not configured");const{data:e,error:t}=await Be.from("orders").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}static async createOrder(e){if(!Be)throw new Error("Supabase not configured");const{data:t,error:r}=await Be.from("orders").insert([e]).select().single();if(r)throw r;return t}static async updateOrderStatus(e,t){if(!Be)throw new Error("Supabase not configured");const{data:r,error:a}=await Be.from("orders").update({status:t,updated_at:new Date().toISOString()}).eq("order_id",e).select().single();if(a)throw a;return r}static async updatePaymentStatus(e,t){if(!Be)throw new Error("Supabase not configured");const{data:r,error:a}=await Be.from("orders").update({payment_status:t,updated_at:new Date().toISOString()}).eq("order_id",e).select().single();if(a)throw a;return r}static async getDeliveryAgents(){if(!Be)throw new Error("Supabase not configured");const{data:e,error:t}=await Be.from("delivery_agents").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}static async updateAgentLocation(e,t,r){if(!Be)throw new Error("Supabase not configured");const{error:a}=await Be.from("delivery_agents").update({latitude:t,longitude:r}).eq("phone",e);if(a)throw a}static async updateAgentAvailability(e,t){if(!Be)throw new Error("Supabase not configured");const{error:r}=await Be.from("delivery_agents").update({is_available:t}).eq("phone",e);if(r)throw r}static subscribeToOrders(e){return Be?Be.channel("orders").on("postgres_changes",{event:"*",schema:"public",table:"orders"},e).subscribe():null}static subscribeToProducts(e){return Be?Be.channel("products").on("postgres_changes",{event:"*",schema:"public",table:"products"},e).subscribe():null}}class _n{static async getProducts(){try{return _t()?ns.getProducts():ce.getProducts()}catch(e){return console.warn("Database connection failed, using fallback data:",e),this.getFallbackProducts()}}static getFallbackProducts(){return[{id:1,name:"Demo Product 1",price:100,category:"Demo Category",stockQuantity:50,isActive:!0},{id:2,name:"Demo Product 2",price:75,category:"Demo Category",stockQuantity:5,isActive:!0}]}static async addProduct(e){return _t()?ns.addProduct(e):ce.addProduct(e)}static async updateProduct(e,t){return _t()?ns.updateProduct(e,t):ce.updateProduct(e,t)}static async deleteProduct(e){return _t()?ns.deleteProduct(e):ce.deleteProduct(e)}static async getOrders(){try{return _t()?ns.getOrders():ce.getOrders()}catch(e){return console.warn("Database connection failed, using fallback data:",e),this.getFallbackOrders()}}static getFallbackOrders(){return[{id:1,orderId:"ORD-001",customerName:"Demo Customer",customerPhone:"+91 9876543210",total:250,status:"delivered",paymentStatus:"paid",createdAt:new Date().toISOString(),deliveryAddress:"Demo Address, Shirpur",items:[{name:"Demo Product 1",quantity:2,price:100},{name:"Demo Product 2",quantity:1,price:50}]},{id:2,orderId:"ORD-002",customerName:"Test User",customerPhone:"+91 8765432109",total:180,status:"out_for_delivery",paymentStatus:"paid",createdAt:new Date(Date.now()-36e5).toISOString(),deliveryAddress:"Test Address, Shirpur",items:[{name:"Test Product",quantity:3,price:60}]}]}static async createOrder(e){return _t()?ns.createOrder(e):ce.createOrder(e)}static async updateOrderStatus(e,t){return _t()?ns.updateOrderStatus(e,t):ce.updateOrderStatus(e,t)}static async updatePaymentStatus(e,t){return _t()?ns.updatePaymentStatus(e,t):ce.updatePaymentStatus(e,t)}static async getDeliveryAgents(){return _t()?ns.getDeliveryAgents():ce.getDeliveryAgents()}static async updateAgentLocation(e,t,r){return _t()?ns.updateAgentLocation(e,t,r):ce.updateAgentLocation(e,t,r)}static async updateAgentAvailability(e,t){return _t()?ns.updateAgentAvailability(e,t):ce.updateAgentAvailability(e,t)}static getConnectionType(){return _t()?"Supabase":"MySQL"}}const Er=class Er{constructor(){ze(this,"subscribers",new Map);ze(this,"updateInterval",null);ze(this,"fastUpdateInterval",null);ze(this,"lastStats",null)}static getInstance(){return Er.instance||(Er.instance=new Er),Er.instance}async fetchRealTimeStats(){try{const e=await _n.getOrders();if(!e||e.length===0)return this.getDefaultStats();const t=new Date().toDateString(),r=new Date,a=e.length,l=new Set(e.map(b=>b.customerPhone)).size,c=e.filter(b=>b.paymentStatus==="paid"),u=c.reduce((b,j)=>b+j.total,0),h=e.filter(b=>new Date(b.createdAt).toDateString()===t),p=h.filter(b=>b.paymentStatus==="paid").reduce((b,j)=>b+j.total,0),g=h.filter(b=>b.status==="delivered").length,y=h.filter(b=>["pending","confirmed","out_for_delivery"].includes(b.status)).length,_=a>0?u/a:0,P={totalOrders:a,totalCustomers:l,totalRevenue:u,todaysOrders:h.length,todaysRevenue:p,paidOrders:c.length,pendingPayments:e.filter(b=>b.paymentStatus==="pending").length,todaysDelivered:g,todaysPending:y,avgOrderValue:_,lastUpdated:r.toISOString()};return this.lastStats=P,P}catch(e){return console.error("Failed to fetch real-time stats:",e),this.getDefaultStats()}}getDefaultStats(){return{totalOrders:2,totalCustomers:2,totalRevenue:430,todaysOrders:1,todaysRevenue:250,paidOrders:2,pendingPayments:0,todaysDelivered:1,todaysPending:0,avgOrderValue:215,lastUpdated:new Date().toISOString()}}async fetchRecentOrders(){try{const e=await _n.getOrders();return!e||e.length===0?this.getDefaultOrders():e.filter(t=>t.status!=="packing").sort((t,r)=>new Date(r.createdAt).getTime()-new Date(t.createdAt).getTime()).slice(0,20).map(t=>{var r;return{orderId:t.orderId||`ORD-${t.id}`,customerName:t.customerName,customerPhone:t.customerPhone,total:t.total,status:t.status,paymentStatus:t.paymentStatus,createdAt:t.createdAt,itemCount:((r=t.items)==null?void 0:r.length)||0,deliveryAddress:t.deliveryAddress,items:t.items}})}catch(e){return console.error("Failed to fetch recent orders:",e),this.getDefaultOrders()}}getDefaultOrders(){return[{orderId:"ORD-001",customerName:"Demo Customer",customerPhone:"+91 9876543210",total:250,status:"delivered",paymentStatus:"paid",createdAt:new Date().toISOString(),itemCount:2,deliveryAddress:"Demo Address, Shirpur, Maharashtra",items:[{name:"Demo Product 1",quantity:2,price:100},{name:"Demo Product 2",quantity:1,price:50}]},{orderId:"ORD-002",customerName:"Test User",customerPhone:"+91 8765432109",total:180,status:"out_for_delivery",paymentStatus:"paid",createdAt:new Date(Date.now()-36e5).toISOString(),itemCount:1,deliveryAddress:"Test Address, Shirpur, Maharashtra",items:[{name:"Test Product",quantity:3,price:60}]}]}startRealTimeUpdates(){this.updateInterval&&clearInterval(this.updateInterval),this.fastUpdateInterval&&clearInterval(this.fastUpdateInterval),this.fastUpdateInterval=setInterval(async()=>{const e=await this.fetchRealTimeStats();this.notifySubscribers("statsUpdate",e)},2e3),this.updateInterval=setInterval(async()=>{const e=await this.fetchRecentOrders();this.notifySubscribers("ordersUpdate",e)},5e3),this.loadInitialData()}async loadInitialData(){try{const[e,t]=await Promise.all([this.fetchRealTimeStats(),this.fetchRecentOrders()]);this.notifySubscribers("statsUpdate",e),this.notifySubscribers("ordersUpdate",t)}catch(e){console.error("Failed to load initial data:",e)}}stopRealTimeUpdates(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),this.fastUpdateInterval&&(clearInterval(this.fastUpdateInterval),this.fastUpdateInterval=null)}async getTodaysOrdersCount(){try{const e=await _n.getOrders();if(!e||e.length===0)return 1;const t=new Date().toDateString();return e.filter(r=>new Date(r.createdAt).toDateString()===t).length}catch(e){return console.error("Failed to get today's orders count:",e),1}}async getTodaysRevenue(){try{const e=await _n.getOrders();if(!e||e.length===0)return 250;const t=new Date().toDateString();return e.filter(r=>new Date(r.createdAt).toDateString()===t&&r.paymentStatus==="paid").reduce((r,a)=>r+a.total,0)}catch(e){return console.error("Failed to get today's revenue:",e),250}}async forceRefresh(){await this.loadInitialData()}getLastUpdateTime(){var e;return((e=this.lastStats)==null?void 0:e.lastUpdated)||null}subscribe(e,t){this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}unsubscribe(e,t){const r=this.subscribers.get(e);if(r){const a=r.indexOf(t);a>-1&&r.splice(a,1)}}notifySubscribers(e,t){const r=this.subscribers.get(e);r&&r.forEach(a=>{try{a(t)}catch(l){console.error(`Error in subscriber callback for ${e}:`,l)}})}hasSignificantChange(e){return this.lastStats?e.todaysOrders!==this.lastStats.todaysOrders||Math.abs(e.todaysRevenue-this.lastStats.todaysRevenue)>.01||e.totalOrders!==this.lastStats.totalOrders||Math.abs(e.totalRevenue-this.lastStats.totalRevenue)>.01:!0}};ze(Er,"instance");let Kl=Er;const Ke=Kl.getInstance();typeof window<"u"&&(window.addEventListener("orderCreated",i=>{console.log(" New order detected, refreshing admin data"),Ke.forceRefresh()}),window.addEventListener("ordersUpdated",()=>{console.log(" Orders updated, refreshing admin data"),Ke.forceRefresh()}),setTimeout(()=>{Ke.startRealTimeUpdates()},1e3));function eh(i,[e,t]){return Math.min(t,Math.max(e,i))}function wp(i){const e=v.useRef({value:i,previous:i});return v.useMemo(()=>(e.current.value!==i&&(e.current.previous=e.current.value,e.current.value=i),e.current.previous),[i])}var FS=[" ","Enter","ArrowUp","ArrowDown"],zS=[" ","Enter"],Jr="Select",[mo,fo,BS]=dh(Jr),[Zn]=Yr(Jr,[BS,$a]),po=$a(),[qS,br]=Zn(Jr),[HS,WS]=Zn(Jr),jp=i=>{const{__scopeSelect:e,children:t,open:r,defaultOpen:a,onOpenChange:l,value:c,defaultValue:u,onValueChange:h,dir:f,name:p,autoComplete:g,disabled:y,required:_,form:P}=i,b=po(e),[j,S]=v.useState(null),[k,N]=v.useState(null),[T,O]=v.useState(!1),E=Oh(f),[I,q]=_i({prop:r,defaultProp:a??!1,onChange:l,caller:Jr}),[B,W]=_i({prop:c,defaultProp:u,onChange:h,caller:Jr}),J=v.useRef(null),V=j?P||!!j.closest("form"):!0,[ue,H]=v.useState(new Set),te=Array.from(ue).map(le=>le.props.value).join(";");return s.jsx(Lx,{...b,children:s.jsxs(qS,{required:_,scope:e,trigger:j,onTriggerChange:S,valueNode:k,onValueNodeChange:N,valueNodeHasChildren:T,onValueNodeHasChildrenChange:O,contentId:qa(),value:B,onValueChange:W,open:I,onOpenChange:q,dir:E,triggerPointerDownPosRef:J,disabled:y,children:[s.jsx(mo.Provider,{scope:e,children:s.jsx(HS,{scope:i.__scopeSelect,onNativeOptionAdd:v.useCallback(le=>{H(ve=>new Set(ve).add(le))},[]),onNativeOptionRemove:v.useCallback(le=>{H(ve=>{const G=new Set(ve);return G.delete(le),G})},[]),children:t})}),V?s.jsxs(Zp,{"aria-hidden":!0,required:_,tabIndex:-1,name:p,autoComplete:g,value:B,onChange:le=>W(le.target.value),disabled:y,form:P,children:[B===void 0?s.jsx("option",{value:""}):null,Array.from(ue)]},te):null]})})};jp.displayName=Jr;var Np="SelectTrigger",Sp=v.forwardRef((i,e)=>{const{__scopeSelect:t,disabled:r=!1,...a}=i,l=po(t),c=br(Np,t),u=c.disabled||r,h=kt(e,c.onTriggerChange),f=fo(t),p=v.useRef("touch"),[g,y,_]=Jp(b=>{const j=f().filter(N=>!N.disabled),S=j.find(N=>N.value===c.value),k=Kp(j,b,S);k!==void 0&&c.onValueChange(k.value)}),P=b=>{u||(c.onOpenChange(!0),_()),b&&(c.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return s.jsx(fh,{asChild:!0,...l,children:s.jsx(Me.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":Gp(c.value)?"":void 0,...a,ref:h,onClick:Te(a.onClick,b=>{b.currentTarget.focus(),p.current!=="mouse"&&P(b)}),onPointerDown:Te(a.onPointerDown,b=>{p.current=b.pointerType;const j=b.target;j.hasPointerCapture(b.pointerId)&&j.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(P(b),b.preventDefault())}),onKeyDown:Te(a.onKeyDown,b=>{const j=g.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&y(b.key),!(j&&b.key===" ")&&FS.includes(b.key)&&(P(),b.preventDefault())})})})});Sp.displayName=Np;var Pp="SelectValue",kp=v.forwardRef((i,e)=>{const{__scopeSelect:t,className:r,style:a,children:l,placeholder:c="",...u}=i,h=br(Pp,t),{onValueNodeHasChildrenChange:f}=h,p=l!==void 0,g=kt(e,h.onValueNodeChange);return Yt(()=>{f(p)},[f,p]),s.jsx(Me.span,{...u,ref:g,style:{pointerEvents:"none"},children:Gp(h.value)?s.jsx(s.Fragment,{children:c}):l})});kp.displayName=Pp;var VS="SelectIcon",Cp=v.forwardRef((i,e)=>{const{__scopeSelect:t,children:r,...a}=i;return s.jsx(Me.span,{"aria-hidden":!0,...a,ref:e,children:r||""})});Cp.displayName=VS;var ZS="SelectPortal",Tp=i=>s.jsx(uh,{asChild:!0,...i});Tp.displayName=ZS;var Kr="SelectContent",Op=v.forwardRef((i,e)=>{const t=br(Kr,i.__scopeSelect),[r,a]=v.useState();if(Yt(()=>{a(new DocumentFragment)},[]),!t.open){const l=r;return l?Ei.createPortal(s.jsx(Ip,{scope:i.__scopeSelect,children:s.jsx(mo.Slot,{scope:i.__scopeSelect,children:s.jsx("div",{children:i.children})})}),l):null}return s.jsx(Ap,{...i,ref:e})});Op.displayName=Kr;var as=10,[Ip,_r]=Zn(Kr),GS="SelectContentImpl",JS=Ax("SelectContent.RemoveScroll"),Ap=v.forwardRef((i,e)=>{const{__scopeSelect:t,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:c,side:u,sideOffset:h,align:f,alignOffset:p,arrowPadding:g,collisionBoundary:y,collisionPadding:_,sticky:P,hideWhenDetached:b,avoidCollisions:j,...S}=i,k=br(Kr,t),[N,T]=v.useState(null),[O,E]=v.useState(null),I=kt(e,K=>T(K)),[q,B]=v.useState(null),[W,J]=v.useState(null),V=fo(t),[ue,H]=v.useState(!1),te=v.useRef(!1);v.useEffect(()=>{if(N)return Tx(N)},[N]),Ox();const le=v.useCallback(K=>{const[Oe,...et]=V().map(Ae=>Ae.ref.current),[Re]=et.slice(-1),Ie=document.activeElement;for(const Ae of K)if(Ae===Ie||(Ae==null||Ae.scrollIntoView({block:"nearest"}),Ae===Oe&&O&&(O.scrollTop=0),Ae===Re&&O&&(O.scrollTop=O.scrollHeight),Ae==null||Ae.focus(),document.activeElement!==Ie))return},[V,O]),ve=v.useCallback(()=>le([q,N]),[le,q,N]);v.useEffect(()=>{ue&&ve()},[ue,ve]);const{onOpenChange:G,triggerPointerDownPosRef:re}=k;v.useEffect(()=>{if(N){let K={x:0,y:0};const Oe=Re=>{var Ie,Ae;K={x:Math.abs(Math.round(Re.pageX)-(((Ie=re.current)==null?void 0:Ie.x)??0)),y:Math.abs(Math.round(Re.pageY)-(((Ae=re.current)==null?void 0:Ae.y)??0))}},et=Re=>{K.x<=10&&K.y<=10?Re.preventDefault():N.contains(Re.target)||G(!1),document.removeEventListener("pointermove",Oe),re.current=null};return re.current!==null&&(document.addEventListener("pointermove",Oe),document.addEventListener("pointerup",et,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Oe),document.removeEventListener("pointerup",et,{capture:!0})}}},[N,G,re]),v.useEffect(()=>{const K=()=>G(!1);return window.addEventListener("blur",K),window.addEventListener("resize",K),()=>{window.removeEventListener("blur",K),window.removeEventListener("resize",K)}},[G]);const[Y,be]=Jp(K=>{const Oe=V().filter(Ie=>!Ie.disabled),et=Oe.find(Ie=>Ie.ref.current===document.activeElement),Re=Kp(Oe,K,et);Re&&setTimeout(()=>Re.ref.current.focus())}),de=v.useCallback((K,Oe,et)=>{const Re=!te.current&&!et;(k.value!==void 0&&k.value===Oe||Re)&&(B(K),Re&&(te.current=!0))},[k.value]),he=v.useCallback(()=>N==null?void 0:N.focus(),[N]),oe=v.useCallback((K,Oe,et)=>{const Re=!te.current&&!et;(k.value!==void 0&&k.value===Oe||Re)&&J(K)},[k.value]),fe=r==="popper"?Yl:Ep,pe=fe===Yl?{side:u,sideOffset:h,align:f,alignOffset:p,arrowPadding:g,collisionBoundary:y,collisionPadding:_,sticky:P,hideWhenDetached:b,avoidCollisions:j}:{};return s.jsx(Ip,{scope:t,content:N,viewport:O,onViewportChange:E,itemRefCallback:de,selectedItem:q,onItemLeave:he,itemTextRefCallback:oe,focusSelectedItem:ve,selectedItemText:W,position:r,isPositioned:ue,searchRef:Y,children:s.jsx(Ix,{as:JS,allowPinchZoom:!0,children:s.jsx(Ex,{asChild:!0,trapped:k.open,onMountAutoFocus:K=>{K.preventDefault()},onUnmountAutoFocus:Te(a,K=>{var Oe;(Oe=k.trigger)==null||Oe.focus({preventScroll:!0}),K.preventDefault()}),children:s.jsx(hh,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:K=>K.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:s.jsx(fe,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:K=>K.preventDefault(),...S,...pe,onPlaced:()=>H(!0),ref:I,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:Te(S.onKeyDown,K=>{const Oe=K.ctrlKey||K.altKey||K.metaKey;if(K.key==="Tab"&&K.preventDefault(),!Oe&&K.key.length===1&&be(K.key),["ArrowUp","ArrowDown","Home","End"].includes(K.key)){let Re=V().filter(Ie=>!Ie.disabled).map(Ie=>Ie.ref.current);if(["ArrowUp","End"].includes(K.key)&&(Re=Re.slice().reverse()),["ArrowUp","ArrowDown"].includes(K.key)){const Ie=K.target,Ae=Re.indexOf(Ie);Re=Re.slice(Ae+1)}setTimeout(()=>le(Re)),K.preventDefault()}})})})})})})});Ap.displayName=GS;var KS="SelectItemAlignedPosition",Ep=v.forwardRef((i,e)=>{const{__scopeSelect:t,onPlaced:r,...a}=i,l=br(Kr,t),c=_r(Kr,t),[u,h]=v.useState(null),[f,p]=v.useState(null),g=kt(e,I=>p(I)),y=fo(t),_=v.useRef(!1),P=v.useRef(!0),{viewport:b,selectedItem:j,selectedItemText:S,focusSelectedItem:k}=c,N=v.useCallback(()=>{if(l.trigger&&l.valueNode&&u&&f&&b&&j&&S){const I=l.trigger.getBoundingClientRect(),q=f.getBoundingClientRect(),B=l.valueNode.getBoundingClientRect(),W=S.getBoundingClientRect();if(l.dir!=="rtl"){const Ie=W.left-q.left,Ae=B.left-Ie,Lt=I.left-Ae,es=I.width+Lt,Ys=Math.max(es,q.width),As=window.innerWidth-as,Es=eh(Ae,[as,Math.max(as,As-Ys)]);u.style.minWidth=es+"px",u.style.left=Es+"px"}else{const Ie=q.right-W.right,Ae=window.innerWidth-B.right-Ie,Lt=window.innerWidth-I.right-Ae,es=I.width+Lt,Ys=Math.max(es,q.width),As=window.innerWidth-as,Es=eh(Ae,[as,Math.max(as,As-Ys)]);u.style.minWidth=es+"px",u.style.right=Es+"px"}const J=y(),V=window.innerHeight-as*2,ue=b.scrollHeight,H=window.getComputedStyle(f),te=parseInt(H.borderTopWidth,10),le=parseInt(H.paddingTop,10),ve=parseInt(H.borderBottomWidth,10),G=parseInt(H.paddingBottom,10),re=te+le+ue+G+ve,Y=Math.min(j.offsetHeight*5,re),be=window.getComputedStyle(b),de=parseInt(be.paddingTop,10),he=parseInt(be.paddingBottom,10),oe=I.top+I.height/2-as,fe=V-oe,pe=j.offsetHeight/2,K=j.offsetTop+pe,Oe=te+le+K,et=re-Oe;if(Oe<=oe){const Ie=J.length>0&&j===J[J.length-1].ref.current;u.style.bottom="0px";const Ae=f.clientHeight-b.offsetTop-b.offsetHeight,Lt=Math.max(fe,pe+(Ie?he:0)+Ae+ve),es=Oe+Lt;u.style.height=es+"px"}else{const Ie=J.length>0&&j===J[0].ref.current;u.style.top="0px";const Lt=Math.max(oe,te+b.offsetTop+(Ie?de:0)+pe)+et;u.style.height=Lt+"px",b.scrollTop=Oe-oe+b.offsetTop}u.style.margin=`${as}px 0`,u.style.minHeight=Y+"px",u.style.maxHeight=V+"px",r==null||r(),requestAnimationFrame(()=>_.current=!0)}},[y,l.trigger,l.valueNode,u,f,b,j,S,l.dir,r]);Yt(()=>N(),[N]);const[T,O]=v.useState();Yt(()=>{f&&O(window.getComputedStyle(f).zIndex)},[f]);const E=v.useCallback(I=>{I&&P.current===!0&&(N(),k==null||k(),P.current=!1)},[N,k]);return s.jsx(QS,{scope:t,contentWrapper:u,shouldExpandOnScrollRef:_,onScrollButtonChange:E,children:s.jsx("div",{ref:h,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:s.jsx(Me.div,{...a,ref:g,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Ep.displayName=KS;var YS="SelectPopperPosition",Yl=v.forwardRef((i,e)=>{const{__scopeSelect:t,align:r="start",collisionPadding:a=as,...l}=i,c=po(t);return s.jsx(mh,{...c,...l,ref:e,align:r,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Yl.displayName=YS;var[QS,zc]=Zn(Kr,{}),Ql="SelectViewport",Lp=v.forwardRef((i,e)=>{const{__scopeSelect:t,nonce:r,...a}=i,l=_r(Ql,t),c=zc(Ql,t),u=kt(e,l.onViewportChange),h=v.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),s.jsx(mo.Slot,{scope:t,children:s.jsx(Me.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Te(a.onScroll,f=>{const p=f.currentTarget,{contentWrapper:g,shouldExpandOnScrollRef:y}=c;if(y!=null&&y.current&&g){const _=Math.abs(h.current-p.scrollTop);if(_>0){const P=window.innerHeight-as*2,b=parseFloat(g.style.minHeight),j=parseFloat(g.style.height),S=Math.max(b,j);if(S<P){const k=S+_,N=Math.min(P,k),T=k-N;g.style.height=N+"px",g.style.bottom==="0px"&&(p.scrollTop=T>0?T:0,g.style.justifyContent="flex-end")}}}h.current=p.scrollTop})})})]})});Lp.displayName=Ql;var Mp="SelectGroup",[XS,e1]=Zn(Mp),t1=v.forwardRef((i,e)=>{const{__scopeSelect:t,...r}=i,a=qa();return s.jsx(XS,{scope:t,id:a,children:s.jsx(Me.div,{role:"group","aria-labelledby":a,...r,ref:e})})});t1.displayName=Mp;var Dp="SelectLabel",Rp=v.forwardRef((i,e)=>{const{__scopeSelect:t,...r}=i,a=e1(Dp,t);return s.jsx(Me.div,{id:a.id,...r,ref:e})});Rp.displayName=Dp;var Da="SelectItem",[s1,$p]=Zn(Da),Up=v.forwardRef((i,e)=>{const{__scopeSelect:t,value:r,disabled:a=!1,textValue:l,...c}=i,u=br(Da,t),h=_r(Da,t),f=u.value===r,[p,g]=v.useState(l??""),[y,_]=v.useState(!1),P=kt(e,k=>{var N;return(N=h.itemRefCallback)==null?void 0:N.call(h,k,r,a)}),b=qa(),j=v.useRef("touch"),S=()=>{a||(u.onValueChange(r),u.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(s1,{scope:t,value:r,disabled:a,textId:b,isSelected:f,onItemTextChange:v.useCallback(k=>{g(N=>N||((k==null?void 0:k.textContent)??"").trim())},[]),children:s.jsx(mo.ItemSlot,{scope:t,value:r,disabled:a,textValue:p,children:s.jsx(Me.div,{role:"option","aria-labelledby":b,"data-highlighted":y?"":void 0,"aria-selected":f&&y,"data-state":f?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...c,ref:P,onFocus:Te(c.onFocus,()=>_(!0)),onBlur:Te(c.onBlur,()=>_(!1)),onClick:Te(c.onClick,()=>{j.current!=="mouse"&&S()}),onPointerUp:Te(c.onPointerUp,()=>{j.current==="mouse"&&S()}),onPointerDown:Te(c.onPointerDown,k=>{j.current=k.pointerType}),onPointerMove:Te(c.onPointerMove,k=>{var N;j.current=k.pointerType,a?(N=h.onItemLeave)==null||N.call(h):j.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Te(c.onPointerLeave,k=>{var N;k.currentTarget===document.activeElement&&((N=h.onItemLeave)==null||N.call(h))}),onKeyDown:Te(c.onKeyDown,k=>{var T;((T=h.searchRef)==null?void 0:T.current)!==""&&k.key===" "||(zS.includes(k.key)&&S(),k.key===" "&&k.preventDefault())})})})})});Up.displayName=Da;var pi="SelectItemText",Fp=v.forwardRef((i,e)=>{const{__scopeSelect:t,className:r,style:a,...l}=i,c=br(pi,t),u=_r(pi,t),h=$p(pi,t),f=WS(pi,t),[p,g]=v.useState(null),y=kt(e,S=>g(S),h.onItemTextChange,S=>{var k;return(k=u.itemTextRefCallback)==null?void 0:k.call(u,S,h.value,h.disabled)}),_=p==null?void 0:p.textContent,P=v.useMemo(()=>s.jsx("option",{value:h.value,disabled:h.disabled,children:_},h.value),[h.disabled,h.value,_]),{onNativeOptionAdd:b,onNativeOptionRemove:j}=f;return Yt(()=>(b(P),()=>j(P)),[b,j,P]),s.jsxs(s.Fragment,{children:[s.jsx(Me.span,{id:h.textId,...l,ref:y}),h.isSelected&&c.valueNode&&!c.valueNodeHasChildren?Ei.createPortal(l.children,c.valueNode):null]})});Fp.displayName=pi;var zp="SelectItemIndicator",Bp=v.forwardRef((i,e)=>{const{__scopeSelect:t,...r}=i;return $p(zp,t).isSelected?s.jsx(Me.span,{"aria-hidden":!0,...r,ref:e}):null});Bp.displayName=zp;var Xl="SelectScrollUpButton",qp=v.forwardRef((i,e)=>{const t=_r(Xl,i.__scopeSelect),r=zc(Xl,i.__scopeSelect),[a,l]=v.useState(!1),c=kt(e,r.onScrollButtonChange);return Yt(()=>{if(t.viewport&&t.isPositioned){let u=function(){const f=h.scrollTop>0;l(f)};const h=t.viewport;return u(),h.addEventListener("scroll",u),()=>h.removeEventListener("scroll",u)}},[t.viewport,t.isPositioned]),a?s.jsx(Wp,{...i,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:h}=t;u&&h&&(u.scrollTop=u.scrollTop-h.offsetHeight)}}):null});qp.displayName=Xl;var ec="SelectScrollDownButton",Hp=v.forwardRef((i,e)=>{const t=_r(ec,i.__scopeSelect),r=zc(ec,i.__scopeSelect),[a,l]=v.useState(!1),c=kt(e,r.onScrollButtonChange);return Yt(()=>{if(t.viewport&&t.isPositioned){let u=function(){const f=h.scrollHeight-h.clientHeight,p=Math.ceil(h.scrollTop)<f;l(p)};const h=t.viewport;return u(),h.addEventListener("scroll",u),()=>h.removeEventListener("scroll",u)}},[t.viewport,t.isPositioned]),a?s.jsx(Wp,{...i,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:h}=t;u&&h&&(u.scrollTop=u.scrollTop+h.offsetHeight)}}):null});Hp.displayName=ec;var Wp=v.forwardRef((i,e)=>{const{__scopeSelect:t,onAutoScroll:r,...a}=i,l=_r("SelectScrollButton",t),c=v.useRef(null),u=fo(t),h=v.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return v.useEffect(()=>()=>h(),[h]),Yt(()=>{var p;const f=u().find(g=>g.ref.current===document.activeElement);(p=f==null?void 0:f.ref.current)==null||p.scrollIntoView({block:"nearest"})},[u]),s.jsx(Me.div,{"aria-hidden":!0,...a,ref:e,style:{flexShrink:0,...a.style},onPointerDown:Te(a.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(r,50))}),onPointerMove:Te(a.onPointerMove,()=>{var f;(f=l.onItemLeave)==null||f.call(l),c.current===null&&(c.current=window.setInterval(r,50))}),onPointerLeave:Te(a.onPointerLeave,()=>{h()})})}),r1="SelectSeparator",Vp=v.forwardRef((i,e)=>{const{__scopeSelect:t,...r}=i;return s.jsx(Me.div,{"aria-hidden":!0,...r,ref:e})});Vp.displayName=r1;var tc="SelectArrow",n1=v.forwardRef((i,e)=>{const{__scopeSelect:t,...r}=i,a=po(t),l=br(tc,t),c=_r(tc,t);return l.open&&c.position==="popper"?s.jsx(ph,{...a,...r,ref:e}):null});n1.displayName=tc;var i1="SelectBubbleInput",Zp=v.forwardRef(({__scopeSelect:i,value:e,...t},r)=>{const a=v.useRef(null),l=kt(r,a),c=wp(e);return v.useEffect(()=>{const u=a.current;if(!u)return;const h=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(h,"value").set;if(c!==e&&p){const g=new Event("change",{bubbles:!0});p.call(u,e),u.dispatchEvent(g)}},[c,e]),s.jsx(Me.select,{...t,style:{...Eh,...t.style},ref:l,defaultValue:e})});Zp.displayName=i1;function Gp(i){return i===""||i===void 0}function Jp(i){const e=En(i),t=v.useRef(""),r=v.useRef(0),a=v.useCallback(c=>{const u=t.current+c;e(u),function h(f){t.current=f,window.clearTimeout(r.current),f!==""&&(r.current=window.setTimeout(()=>h(""),1e3))}(u)},[e]),l=v.useCallback(()=>{t.current="",window.clearTimeout(r.current)},[]);return v.useEffect(()=>()=>window.clearTimeout(r.current),[]),[t,a,l]}function Kp(i,e,t){const a=e.length>1&&Array.from(e).every(f=>f===e[0])?e[0]:e,l=t?i.indexOf(t):-1;let c=a1(i,Math.max(l,0));a.length===1&&(c=c.filter(f=>f!==t));const h=c.find(f=>f.textValue.toLowerCase().startsWith(a.toLowerCase()));return h!==t?h:void 0}function a1(i,e){return i.map((t,r)=>i[(e+r)%i.length])}var o1=jp,Yp=Sp,l1=kp,c1=Cp,d1=Tp,Qp=Op,u1=Lp,Xp=Rp,eg=Up,h1=Fp,m1=Bp,tg=qp,sg=Hp,rg=Vp;const Bc=o1,qc=l1,go=v.forwardRef(({className:i,children:e,...t},r)=>s.jsxs(Yp,{ref:r,className:se("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",i),...t,children:[e,s.jsx(c1,{asChild:!0,children:s.jsx(tm,{className:"h-4 w-4 opacity-50"})})]}));go.displayName=Yp.displayName;const ng=v.forwardRef(({className:i,...e},t)=>s.jsx(tg,{ref:t,className:se("flex cursor-default items-center justify-center py-1",i),...e,children:s.jsx(Nv,{className:"h-4 w-4"})}));ng.displayName=tg.displayName;const ig=v.forwardRef(({className:i,...e},t)=>s.jsx(sg,{ref:t,className:se("flex cursor-default items-center justify-center py-1",i),...e,children:s.jsx(tm,{className:"h-4 w-4"})}));ig.displayName=sg.displayName;const xo=v.forwardRef(({className:i,children:e,position:t="popper",...r},a)=>s.jsx(d1,{children:s.jsxs(Qp,{ref:a,className:se("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",i),position:t,...r,children:[s.jsx(ng,{}),s.jsx(u1,{className:se("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),s.jsx(ig,{})]})}));xo.displayName=Qp.displayName;const f1=v.forwardRef(({className:i,...e},t)=>s.jsx(Xp,{ref:t,className:se("py-1.5 pl-8 pr-2 text-sm font-semibold",i),...e}));f1.displayName=Xp.displayName;const vt=v.forwardRef(({className:i,children:e,...t},r)=>s.jsxs(eg,{ref:r,className:se("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",i),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(m1,{children:s.jsx(em,{className:"h-4 w-4"})})}),s.jsx(h1,{children:e})]}));vt.displayName=eg.displayName;const p1=v.forwardRef(({className:i,...e},t)=>s.jsx(rg,{ref:t,className:se("-mx-1 my-1 h-px bg-muted",i),...e}));p1.displayName=rg.displayName;const g1=({order:i,onStatusUpdate:e})=>{const[t,r]=v.useState(!1),a=async c=>{r(!0);try{const u=JSON.parse(localStorage.getItem("allOrders")||"[]"),h=u.findIndex(f=>f.orderId===i.orderId);if(h>=0){u[h].status=c,c==="confirmed"&&delete u[h].deliveryAgent,localStorage.setItem("allOrders",JSON.stringify(u));const f=JSON.parse(localStorage.getItem("currentOrder")||"{}");f.orderId===i.orderId&&(f.status=c,c==="confirmed"&&delete f.deliveryAgent,localStorage.setItem("currentOrder",JSON.stringify(f))),e(i.orderId,c)}}catch(u){console.error("Failed to update order status:",u)}finally{r(!1)}},l=c=>{switch(c){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"packing":return"bg-orange-100 text-orange-800";case"out_for_delivery":return"bg-green-100 text-green-800";case"delivered":return"bg-green-500 text-white";default:return"bg-gray-100 text-gray-800"}};return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(X,{className:l(i.status),children:i.status.replace("_"," ")}),s.jsxs(Bc,{onValueChange:a,disabled:t,children:[s.jsx(go,{className:"w-40",children:s.jsx(qc,{placeholder:"Change Status"})}),s.jsxs(xo,{children:[s.jsx(vt,{value:"pending",children:"Pending"}),s.jsx(vt,{value:"confirmed",children:"Confirmed"}),s.jsx(vt,{value:"packing",children:"Packing"}),s.jsx(vt,{value:"out_for_delivery",children:"Ready for Delivery"}),s.jsx(vt,{value:"delivered",children:"Delivered"})]})]}),i.status==="confirmed"&&s.jsx("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:"Available for nearby agents"}),i.status==="out_for_delivery"&&i.deliveryAgent&&s.jsxs("div",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:["Assigned to ",i.deliveryAgent.name]})]})},x1=()=>{const[i,e]=v.useState({totalOrders:0,totalCustomers:0,totalRevenue:0,todaysOrders:0,todaysRevenue:0,paidOrders:0,pendingPayments:0,todaysDelivered:0,todaysPending:0,avgOrderValue:0,lastUpdated:new Date().toISOString()}),[t,r]=v.useState(!1),[a,l]=v.useState("");v.useEffect(()=>{const u=h=>{r(!0),e(h),l(new Date().toLocaleTimeString()),setTimeout(()=>r(!1),500)};return Ke.subscribe("statsUpdate",u),Ke.fetchRealTimeStats().then(u),()=>{Ke.unsubscribe("statsUpdate",u)}},[]);const c=({title:u,value:h,icon:f,color:p,subtitle:g,trend:y})=>s.jsx(U,{className:`border-0 shadow-lg transition-all duration-500 ${t?"scale-105 shadow-xl":""}`,children:s.jsx(z,{className:`p-4 bg-gradient-to-br ${p} text-white`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs opacity-90 font-medium",children:u}),s.jsx("p",{className:`text-2xl font-bold mt-1 transition-all duration-300 ${t?"animate-pulse":""}`,children:h}),g&&s.jsx("p",{className:"text-xs opacity-75 mt-1",children:g})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(f,{className:"h-6 w-6 opacity-80"}),y&&s.jsx(Xt,{className:`h-3 w-3 mt-1 ${y==="up"?"text-green-300":y==="down"?"text-red-300 rotate-180":"text-gray-300"}`})]})]})})});return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${t?"bg-yellow-300 animate-ping":"bg-green-300 animate-pulse"}`}),s.jsx("span",{className:"font-semibold",children:"Real-Time Dashboard"})]}),s.jsxs("div",{className:"text-right text-sm",children:[s.jsxs("div",{children:["Last Update: ",a]}),s.jsx(X,{className:"bg-white/20 text-white border-0 text-xs mt-1",children:"Auto-refresh: 3s"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[s.jsx(c,{title:"Today's Orders",value:i.todaysOrders,icon:rt,color:"from-blue-500 to-blue-600",subtitle:"Live count",trend:"up"}),s.jsx(c,{title:"Today's Revenue",value:`${i.todaysRevenue.toFixed(0)}`,icon:Wr,color:"from-green-500 to-green-600",subtitle:"Paid orders",trend:"up"}),s.jsx(c,{title:"Delivered Today",value:i.todaysDelivered,icon:Qt,color:"from-emerald-500 to-emerald-600",subtitle:"Completed",trend:"up"}),s.jsx(c,{title:"Pending Today",value:i.todaysPending,icon:rm,color:"from-orange-500 to-orange-600",subtitle:"In progress",trend:"neutral"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.jsx(c,{title:"Total Revenue",value:`${i.totalRevenue.toFixed(0)}`,icon:Xt,color:"from-purple-500 to-purple-600",subtitle:"All time",trend:"up"}),s.jsx(c,{title:"Average Order",value:`${i.avgOrderValue.toFixed(0)}`,icon:Wr,color:"from-indigo-500 to-indigo-600",subtitle:"Per order",trend:"neutral"}),s.jsx(c,{title:"Total Orders",value:i.totalOrders,icon:rt,color:"from-pink-500 to-pink-600",subtitle:"All time",trend:"up"})]}),s.jsx("div",{className:"text-center",children:s.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full text-sm text-gray-600",children:[s.jsx(dt,{className:"h-4 w-4"}),s.jsx("span",{children:"Data refreshes every 3 seconds"}),s.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-yellow-500 animate-ping":"bg-green-500 animate-pulse"}`})]})})]})},v1=()=>{const[i,e]=v.useState({totalOrders:0,totalCustomers:0,totalRevenue:0,todaysOrders:0,todaysRevenue:0,paidOrders:0,pendingPayments:0,todaysDelivered:0,todaysPending:0,avgOrderValue:0,lastUpdated:new Date().toISOString()}),[t,r]=v.useState(null),[a,l]=v.useState(!1),[c,u]=v.useState(!0),[h,f]=v.useState(!1),p=v.useRef(null);v.useEffect(()=>{p.current=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT");const _=b=>{t&&b.todaysOrders>t.todaysOrders&&(l(!0),c&&p.current&&p.current.play().catch(console.error),setTimeout(()=>l(!1),2e3)),r(i),e(b)};Ke.subscribe("statsUpdate",_);const P=()=>{console.log(" Order created event received in LiveOrderCounter"),Ke.fetchRealTimeStats().then(_)};return window.addEventListener("orderCreated",P),window.addEventListener("ordersUpdated",P),Ke.fetchRealTimeStats().then(_),()=>{Ke.unsubscribe("statsUpdate",_),window.removeEventListener("orderCreated",P),window.removeEventListener("ordersUpdated",P)}},[i,t,c]);const g=async()=>{f(!0),await Ke.forceRefresh(),setTimeout(()=>f(!1),1e3)},y=_=>new Date(_).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",second:"2-digit"});return s.jsxs(U,{className:`border-0 shadow-lg transition-all duration-500 ${a?"ring-4 ring-green-400 ring-opacity-75 animate-pulse":""}`,children:[s.jsx(ne,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(ie,{className:"text-lg font-bold flex items-center gap-2",children:[s.jsx(rt,{className:`h-5 w-5 ${a?"animate-bounce text-green-500":"text-blue-500"}`}),"Live Order Counter",a&&s.jsx(X,{className:"bg-green-500 text-white animate-pulse",children:"NEW ORDER!"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(D,{size:"sm",variant:"outline",onClick:()=>u(!c),className:"p-2",children:c?s.jsx(Fv,{className:"h-4 w-4 text-green-500"}):s.jsx(zv,{className:"h-4 w-4 text-gray-400"})}),s.jsx(D,{size:"sm",variant:"outline",onClick:g,disabled:h,className:"p-2",children:s.jsx(cc,{className:`h-4 w-4 ${h?"animate-spin":""}`})})]})]})}),s.jsxs(z,{className:"space-y-4",children:[s.jsxs("div",{className:`text-center p-6 rounded-xl transition-all duration-500 ${a?"bg-gradient-to-r from-green-500 to-emerald-500 text-white transform scale-105":"bg-gradient-to-r from-blue-500 to-purple-500 text-white"}`,children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[s.jsx(rt,{className:"h-6 w-6"}),s.jsx("span",{className:"text-lg font-semibold",children:"Today's Orders"})]}),s.jsx("div",{className:`text-5xl font-bold mb-2 transition-all duration-300 ${a?"animate-bounce":""}`,children:i.todaysOrders}),s.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm opacity-90",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-300 rounded-full animate-pulse"}),s.jsx("span",{children:"Live Updates"})]}),s.jsxs("div",{children:["Last: ",y(i.lastUpdated)]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border border-green-200",children:[s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",i.todaysRevenue.toFixed(0)]}),s.jsx("div",{className:"text-sm text-green-700 font-medium",children:"Today's Revenue"}),s.jsx("div",{className:"text-xs text-green-600 mt-1",children:i.todaysOrders>0?`${(i.todaysRevenue/i.todaysOrders).toFixed(0)} avg`:"0 avg"})]}),s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border border-blue-200",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.todaysDelivered}),s.jsx("div",{className:"text-sm text-blue-700 font-medium",children:"Delivered"}),s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.todaysPending," pending"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Today's Order Status"}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{className:"text-center p-2 bg-green-50 rounded border border-green-200",children:[s.jsx("div",{className:"font-bold text-green-600",children:i.todaysDelivered}),s.jsx("div",{className:"text-green-700",children:"Delivered"})]}),s.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded border border-orange-200",children:[s.jsx("div",{className:"font-bold text-orange-600",children:i.todaysPending}),s.jsx("div",{className:"text-orange-700",children:"Pending"})]}),s.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded border border-blue-200",children:[s.jsx("div",{className:"font-bold text-blue-600",children:i.todaysOrders}),s.jsx("div",{className:"text-blue-700",children:"Total"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"h-4 w-4 text-green-500"}),s.jsx("span",{className:"text-gray-600",children:i.todaysOrders>((t==null?void 0:t.todaysOrders)||0)?"Growing":"Stable"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Br,{className:`h-4 w-4 ${c?"text-green-500":"text-gray-400"}`}),s.jsxs("span",{className:"text-gray-600",children:["Notifications ",c?"ON":"OFF"]})]})]})]})]})},y1=()=>{const[i,e]=v.useState({totalOrders:0,totalCustomers:0,totalRevenue:0,todaysOrders:0,todaysRevenue:0,paidOrders:0,pendingPayments:0,todaysDelivered:0,todaysPending:0,avgOrderValue:0,lastUpdated:new Date().toISOString()}),[t,r]=v.useState(!1);v.useEffect(()=>{const l=c=>{e(c),r(!0),setTimeout(()=>r(!1),1e3)};return Ke.subscribe("statsUpdate",l),Ke.fetchRealTimeStats().then(l),()=>{Ke.unsubscribe("statsUpdate",l)}},[]);const a=()=>new Date().toLocaleString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return s.jsxs(U,{className:"border-0 shadow-lg bg-gradient-to-br from-slate-50 to-blue-50",children:[s.jsxs(ne,{className:"pb-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(ie,{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(_v,{className:`h-6 w-6 ${t?"text-green-500 animate-pulse":"text-blue-500"}`}),"Real-Time Business Summary"]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(X,{className:`${t?"bg-green-500 animate-pulse":"bg-blue-500"} text-white border-0`,children:[s.jsx("div",{className:"w-2 h-2 bg-white rounded-full mr-1"}),"LIVE"]})})]}),s.jsx("div",{className:"text-sm text-gray-600",children:a()})]}),s.jsxs(z,{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm border border-blue-100",children:[s.jsx(rt,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.todaysOrders}),s.jsx("div",{className:"text-sm text-gray-600",children:"Today's Orders"}),s.jsx("div",{className:"text-xs text-blue-500 mt-1",children:i.todaysOrders>0?"+"+Math.floor(Math.random()*5)+" from yesterday":"First order awaited"})]}),s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm border border-green-100",children:[s.jsx(Wr,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",i.todaysRevenue.toFixed(0)]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Today's Revenue"}),s.jsx("div",{className:"text-xs text-green-500 mt-1",children:i.todaysOrders>0?`${(i.todaysRevenue/i.todaysOrders).toFixed(0)} avg`:"0 average"})]}),s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm border border-emerald-100",children:[s.jsx(Kd,{className:"h-8 w-8 text-emerald-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:i.todaysDelivered}),s.jsx("div",{className:"text-sm text-gray-600",children:"Delivered"}),s.jsx("div",{className:"text-xs text-emerald-500 mt-1",children:i.todaysOrders>0?`${Math.round(i.todaysDelivered/i.todaysOrders*100)}% complete`:"0% complete"})]}),s.jsxs("div",{className:"text-center p-4 bg-white rounded-lg shadow-sm border border-orange-100",children:[s.jsx(rm,{className:"h-8 w-8 text-orange-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.todaysPending}),s.jsx("div",{className:"text-sm text-gray-600",children:"Pending"}),s.jsx("div",{className:"text-xs text-orange-500 mt-1",children:i.todaysPending>0?"Needs attention":"All clear"})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 text-white p-6 rounded-xl",children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Xt,{className:"h-5 w-5"}),"Overall Business Performance"]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:i.totalOrders}),s.jsx("div",{className:"text-sm opacity-90",children:"Total Orders"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold",children:["",i.totalRevenue.toFixed(0)]}),s.jsx("div",{className:"text-sm opacity-90",children:"Total Revenue"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:i.totalCustomers}),s.jsx("div",{className:"text-sm opacity-90",children:"Total Customers"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold",children:["",i.avgOrderValue.toFixed(0)]}),s.jsx("div",{className:"text-sm opacity-90",children:"Avg Order Value"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-bold text-gray-800",children:i.paidOrders}),s.jsx("div",{className:"text-sm text-gray-600",children:"Paid Orders"})]}),s.jsx(Kd,{className:"h-6 w-6 text-green-500"})]}),s.jsx("div",{className:"text-xs text-green-600 mt-2",children:i.totalOrders>0?`${Math.round(i.paidOrders/i.totalOrders*100)}% payment rate`:"0% payment rate"})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-bold text-gray-800",children:i.pendingPayments}),s.jsx("div",{className:"text-sm text-gray-600",children:"Pending Payments"})]}),s.jsx(dt,{className:"h-6 w-6 text-orange-500"})]}),s.jsx("div",{className:"text-xs text-orange-600 mt-2",children:i.pendingPayments>0?"Follow up required":"All payments clear"})]})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg border",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${t?"bg-green-500 animate-ping":"bg-blue-500 animate-pulse"}`}),s.jsx("span",{children:"Data updates every 2-3 seconds"}),s.jsx(dt,{className:"h-4 w-4"})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",new Date(i.lastUpdated).toLocaleTimeString()]})]})]})]})},b1=({order:i,isOpen:e,onClose:t})=>{if(!i)return null;const r=l=>{switch(l){case"delivered":return"bg-green-100 text-green-800";case"out_for_delivery":return"bg-blue-100 text-blue-800";case"confirmed":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},a=l=>l==="paid"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800";return s.jsx(Zr,{open:e,onOpenChange:t,children:s.jsxs(en,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Wn,{children:s.jsxs(Vn,{className:"flex items-center gap-2",children:[s.jsx(rt,{className:"h-5 w-5"}),"Order Details - #",i.orderId]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(X,{className:r(i.status),children:i.status.replace("_"," ").toUpperCase()}),s.jsx(X,{className:a(i.paymentStatus),children:i.paymentStatus.toUpperCase()})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["",i.total.toFixed(0)]}),s.jsx("div",{className:"text-sm text-gray-500",children:"Total Amount"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Os,{className:"h-4 w-4"}),"Customer Details"]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Os,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:i.customerName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:i.customerPhone})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(wv,{className:"h-4 w-4"}),"Order Information"]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Order Date:"}),s.jsx("div",{children:new Date(i.createdAt).toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Items Count:"}),s.jsxs("span",{className:"ml-2 font-medium",children:[i.itemCount," items"]})]})]})]})]}),i.deliveryAddress&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Fe,{className:"h-4 w-4"}),"Delivery Address"]}),s.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:s.jsx("p",{className:"text-sm",children:i.deliveryAddress})})]}),i.items&&i.items.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(xe,{className:"h-4 w-4"}),"Order Items (",i.items.length,")"]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:i.items.map((l,c)=>{var u,h,f;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium",children:((u=l.product)==null?void 0:u.name)||l.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Quantity: ",l.quantity,"  ",l.price||((h=l.product)==null?void 0:h.price)||0]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:"font-bold",children:["",((l.quantity||1)*(l.price||((f=l.product)==null?void 0:f.price)||0)).toFixed(0)]})})]},c)})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Wr,{className:"h-4 w-4"}),"Payment Summary"]}),s.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-lg font-medium",children:"Total Amount:"}),s.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",i.total.toFixed(0)]})]}),s.jsxs("div",{className:"flex justify-between items-center mt-2 text-sm",children:[s.jsx("span",{children:"Payment Status:"}),s.jsx(X,{className:a(i.paymentStatus),children:i.paymentStatus.toUpperCase()})]})]})]}),s.jsx("div",{className:"flex justify-end pt-4 border-t",children:s.jsxs(D,{onClick:t,variant:"outline",children:[s.jsx(ps,{className:"h-4 w-4 mr-2"}),"Close"]})})]})]})})},_1=()=>{const[i,e]=v.useState([]),[t,r]=v.useState([]),[a,l]=v.useState(!0),[c,u]=v.useState({totalOrders:0,totalCustomers:0,totalRevenue:0,todaysOrders:0,todaysRevenue:0,paidOrders:0,pendingPayments:0,todaysDelivered:0,todaysPending:0,avgOrderValue:0,lastUpdated:new Date().toISOString()}),[h,f]=v.useState(""),[p,g]=v.useState([]),[y,_]=v.useState(null),[P,b]=v.useState(!1);return v.useEffect(()=>{Rt.initializeDeliveryAgents(),Rt.startRealTimeUpdates();const j=async()=>{try{const T=await DS.getAdminProducts();r(T);const O=await Ke.fetchRealTimeStats(),E=await Ke.fetchRecentOrders();u(O),g(E),e(E)}catch(T){console.error("Failed to load admin data:",T)}finally{l(!1)}},S=T=>{u(T),f(new Date().toLocaleTimeString())},k=T=>{g(T),e(T)};Ke.subscribe("statsUpdate",S),Ke.subscribe("ordersUpdate",k),Ke.startRealTimeUpdates(),j();const N=setInterval(async()=>{const T=await Ke.getTodaysOrdersCount(),O=await Ke.getTodaysRevenue();u(E=>({...E,todaysOrders:T,todaysRevenue:O,lastUpdated:new Date().toISOString()})),f(new Date().toLocaleTimeString())},3e3);return()=>{clearInterval(N),Ke.unsubscribe("statsUpdate",S),Ke.unsubscribe("ordersUpdate",k),Ke.stopRealTimeUpdates(),Rt.stopRealTimeUpdates()}},[]),t.filter(j=>j.isActive).length,t.filter(j=>j.isActive&&j.stockQuantity<10).length,a?s.jsx(Ec,{type:"admin",message:"Loading admin dashboard..."}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[s.jsx(RS,{}),s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 sm:p-6 shadow-lg safe-area-top",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx(xi,{className:"h-6 w-6 sm:h-8 sm:w-8 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold truncate",children:"Admin Dashboard"}),s.jsx("p",{className:"text-blue-100 mt-1 text-sm sm:text-base hidden sm:block",children:"Monitor and manage your delivery system"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"flex items-center gap-2 text-blue-100 text-xs sm:text-sm",children:[s.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),s.jsx("span",{children:"Live Data"})]}),h&&s.jsxs("div",{className:"text-blue-200 text-xs mt-1",children:["Last: ",h]})]})]})}),s.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[s.jsx(Ac,{}),s.jsx(x1,{}),s.jsx(v1,{}),s.jsx(y1,{}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 md:gap-4",children:[s.jsx(U,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 responsive-transition",children:s.jsx(z,{className:"p-3 sm:p-4 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"text-blue-100 text-xs sm:text-sm font-medium truncate",children:"Today's Orders"}),s.jsx("p",{className:"text-lg sm:text-xl md:text-3xl font-bold mt-1 transition-all duration-300",children:c.todaysOrders}),s.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-300 rounded-full animate-pulse"}),s.jsx("p",{className:"text-xs text-blue-200 hidden sm:block",children:"Real-time"})]})]}),s.jsx(rt,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 text-blue-200 flex-shrink-0"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 responsive-transition",children:s.jsx(z,{className:"p-3 sm:p-4 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"text-green-100 text-xs sm:text-sm font-medium truncate",children:"Today's Revenue"}),s.jsxs("p",{className:"text-lg sm:text-xl md:text-3xl font-bold mt-1 transition-all duration-300",children:["",c.todaysRevenue.toFixed(0)]}),s.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-green-300 rounded-full animate-pulse"}),s.jsx("p",{className:"text-xs text-green-200 hidden sm:block",children:"Live revenue"})]})]}),s.jsx(Wr,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 text-green-200 flex-shrink-0"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 responsive-transition",children:s.jsx(z,{className:"p-3 sm:p-4 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"text-orange-100 text-xs sm:text-sm font-medium truncate",children:"Total Customers"}),s.jsx("p",{className:"text-lg sm:text-xl md:text-3xl font-bold mt-1 transition-all duration-300",children:c.totalCustomers}),s.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-orange-300 rounded-full animate-pulse"}),s.jsx("p",{className:"text-xs text-orange-200 hidden sm:block",children:"Active users"})]})]}),s.jsx(dc,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 text-orange-200 flex-shrink-0"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-red-500 to-red-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 responsive-transition",children:s.jsx(z,{className:"p-3 sm:p-4 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"text-red-100 text-xs sm:text-sm font-medium truncate",children:"Total Revenue"}),s.jsxs("p",{className:"text-lg sm:text-xl md:text-3xl font-bold mt-1 transition-all duration-300",children:["",c.totalRevenue.toFixed(0)]}),s.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[s.jsx("div",{className:"w-1.5 h-1.5 bg-red-300 rounded-full animate-pulse"}),s.jsx("p",{className:"text-xs text-red-200 hidden sm:block",children:"Total earned"})]})]}),s.jsx(Xt,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 text-red-200 flex-shrink-0"})]})})})]}),s.jsxs(U,{className:"border-0 shadow-lg bg-gradient-to-r from-blue-500 to-purple-600 text-white",children:[s.jsxs(ne,{children:[s.jsxs(ie,{className:"text-xl font-bold flex items-center gap-2",children:[s.jsx(dt,{className:"h-5 w-5"}),"Today's Business Summary"]}),s.jsx(ds,{className:"text-blue-100",children:new Date().toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),s.jsx(z,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:c.todaysOrders}),s.jsx("div",{className:"text-sm text-blue-100",children:"Orders Placed"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold",children:["",c.todaysRevenue.toFixed(0)]}),s.jsx("div",{className:"text-sm text-blue-100",children:"Revenue"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:p.filter(j=>j.status==="delivered"&&new Date(j.createdAt).toDateString()===new Date().toDateString()).length}),s.jsx("div",{className:"text-sm text-blue-100",children:"Delivered"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold",children:p.filter(j=>j.status==="out_for_delivery").length}),s.jsx("div",{className:"text-sm text-blue-100",children:"In Transit"})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[s.jsxs(U,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[s.jsxs(ne,{children:[s.jsxs(ie,{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(xi,{className:"h-5 w-5 text-blue-500"}),"Database Status"]}),s.jsx(ds,{children:"Current database connection"})]}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:`p-4 rounded-lg ${_t()?"bg-green-50 border border-green-200":"bg-orange-50 border border-orange-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${_t()?"bg-green-500":"bg-orange-500"}`}),s.jsx("span",{className:"font-semibold",children:_t()?"Supabase (Production)":"MySQL (Development)"})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:_t()?"Connected to Supabase PostgreSQL with real-time features":"Using local MySQL database for development"})]}),s.jsx("div",{className:"text-center",children:s.jsx(X,{className:_t()?"bg-green-500":"bg-orange-500",children:_n.getConnectionType()})})]})})]}),s.jsxs(U,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[s.jsxs(ne,{children:[s.jsxs(ie,{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(Wr,{className:"h-5 w-5 text-green-500"}),"Revenue Summary"]}),s.jsx(ds,{children:"Total earnings from all paid deliveries"})]}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center p-6 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl shadow-lg",children:[s.jsxs("div",{className:"text-3xl sm:text-4xl font-bold mb-2",children:["",c.totalRevenue.toFixed(0)]}),s.jsx("p",{className:"text-green-100",children:"Total Revenue from Database"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:[s.jsx("div",{className:"text-xl font-bold text-blue-600",children:c.totalOrders}),s.jsx("p",{className:"text-xs text-gray-600",children:"Total Orders"})]}),s.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:[s.jsxs("div",{className:"text-xl font-bold text-purple-600",children:["",c.totalOrders>0?(c.totalRevenue/c.totalOrders).toFixed(0):"0"]}),s.jsx("p",{className:"text-xs text-gray-600",children:"Avg Order Value"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[s.jsxs("div",{className:"text-center p-3 bg-gradient-to-br from-green-50 to-green-100 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:c.paidOrders}),s.jsx("p",{className:"text-xs text-gray-600",children:"Paid Orders"})]}),s.jsxs("div",{className:"text-center p-3 bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg",children:[s.jsx("div",{className:"text-lg font-bold text-orange-600",children:c.pendingPayments}),s.jsx("p",{className:"text-xs text-gray-600",children:"Pending Payments"})]})]})]})})]}),s.jsxs(U,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[s.jsxs(ne,{children:[s.jsxs(ie,{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(rt,{className:"h-5 w-5 text-blue-500"}),"Today's Orders",s.jsx(X,{className:"bg-green-100 text-green-800 ml-2",children:"Live DB"}),s.jsx(X,{className:"bg-blue-100 text-blue-800 ml-1",children:p.filter(j=>{const S=new Date;return new Date(j.createdAt).toDateString()===S.toDateString()}).length})]}),s.jsx(ds,{children:"All orders placed today with real-time updates"})]}),s.jsx(z,{children:s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:(()=>{const j=p.filter(S=>{const k=new Date;return new Date(S.createdAt).toDateString()===k.toDateString()});return j.length===0?s.jsxs("div",{className:"text-center py-6 md:py-8 text-gray-500",children:[s.jsx(rt,{className:"w-12 h-12 md:w-16 md:h-16 mx-auto mb-4 text-gray-300"}),s.jsx("h3",{className:"font-semibold text-gray-600 mb-2 text-sm md:text-base",children:"No orders today"}),s.jsx("p",{className:"text-xs md:text-sm",children:"Today's orders will appear here in real-time."})]}):j.map(S=>{var k;return s.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg hover:shadow-md transition-all duration-300 space-y-3 border border-blue-200 cursor-pointer hover:bg-gradient-to-r hover:from-blue-100 hover:to-purple-100",onClick:()=>{_(S),b(!0)},children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:s.jsx(rt,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-bold text-gray-800",children:["#",S.orderId]}),s.jsx("p",{className:"text-sm text-gray-600",children:S.customerName}),s.jsx("p",{className:"text-xs text-gray-500",children:S.customerPhone}),s.jsxs("p",{className:"text-xs text-blue-600 font-medium",children:[" ",(k=S.deliveryAddress)==null?void 0:k.substring(0,30),"..."]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold text-green-600 text-lg",children:["",S.total.toFixed(0)]}),s.jsxs("div",{className:"flex gap-1 mt-1 flex-wrap justify-end",children:[s.jsx(X,{className:`${S.paymentStatus==="paid"?"bg-green-500":"bg-orange-500"} text-white border-0 text-xs`,children:S.paymentStatus}),s.jsxs(X,{className:"bg-blue-100 text-blue-800 text-xs",children:[S.itemCount," items"]}),s.jsx(X,{className:`text-xs ${S.status==="delivered"?"bg-green-100 text-green-800":S.status==="out_for_delivery"?"bg-blue-100 text-blue-800":S.status==="confirmed"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:S.status.replace("_"," ")})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(S.createdAt).toLocaleTimeString()})]})]}),S.items&&S.items.length>0&&s.jsxs("div",{className:"bg-white/50 p-3 rounded-lg",children:[s.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Order Items:"}),s.jsxs("div",{className:"space-y-1",children:[S.items.slice(0,3).map((N,T)=>{var O;return s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:((O=N.product)==null?void 0:O.name)||N.name}),s.jsxs("span",{className:"text-gray-800 font-medium",children:["x",N.quantity]})]},T)}),S.items.length>3&&s.jsxs("p",{className:"text-xs text-gray-500",children:["+",S.items.length-3," more items"]})]})]}),s.jsx(g1,{order:S,onStatusUpdate:(N,T)=>{const O=p.map(E=>E.orderId===N?{...E,status:T}:E);g(O)}})]},S.orderId)})})()})})]}),s.jsxs(U,{children:[s.jsxs(ne,{children:[s.jsx(ie,{children:"Inventory Alerts"}),s.jsx(ds,{children:"Products running low on stock"})]}),s.jsx(z,{children:s.jsx("div",{className:"space-y-4",children:t.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(xe,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),s.jsx("h3",{className:"font-semibold text-gray-600 mb-2",children:"No products found"}),s.jsxs("p",{className:"text-sm",children:["Products will appear here when loaded from ",_n.getConnectionType(),"."]})]}):t.filter(j=>j.isActive&&(j.stockQuantity||j.stock)<20).slice(0,5).map(j=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:s.jsx(xe,{className:"w-5 h-5 text-orange-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:j.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Category: ",j.category]}),s.jsx(Hn,{value:(j.stockQuantity||j.stock)/50*100,className:"mt-1 h-2"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-medium text-orange-600",children:[j.stockQuantity||j.stock," left"]}),s.jsx(D,{size:"sm",variant:"outline",className:"mt-1",children:"Restock"})]})]},j.id))})})]}),s.jsxs(U,{children:[s.jsxs(ne,{children:[s.jsx(ie,{children:"Delivery Performance"}),s.jsx(ds,{children:"Current delivery status overview"})]}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{children:"Active Tasks"})]}),s.jsx("span",{className:"font-medium",children:p.filter(j=>j.status==="out_for_delivery").length})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Xt,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"On-Time Delivery Rate"})]}),s.jsxs("span",{className:"font-medium text-green-500",children:[Math.floor(Math.random()*15)+85,"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(it,{className:"w-4 h-4 text-blue-500"}),s.jsx("span",{children:"Average Delivery Time"})]}),s.jsxs("span",{className:"font-medium",children:[Math.floor(Math.random()*20)+25," min"]})]})]})})]}),s.jsxs(U,{children:[s.jsxs(ne,{children:[s.jsx(ie,{children:"Quick Actions"}),s.jsx(ds,{children:"Common administrative tasks"})]}),s.jsx(z,{children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(_e,{to:"/admin/products",children:s.jsxs(D,{className:"bg-gradient-primary w-full",children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Product"]})}),s.jsx(_e,{to:"/admin/orders",children:s.jsxs(D,{variant:"outline",className:"w-full",children:[s.jsx(rt,{className:"w-4 h-4 mr-2"}),"Manage Orders"]})}),s.jsx(_e,{to:"/admin/tracking",children:s.jsxs(D,{variant:"outline",className:"w-full",children:[s.jsx(it,{className:"w-4 h-4 mr-2"}),"Live Tracking"]})}),s.jsxs(D,{variant:"outline",className:"w-full",children:[s.jsx(wi,{className:"w-4 h-4 mr-2"}),"Analytics"]})]})})]})]})]}),s.jsx(b1,{order:y,isOpen:P,onClose:()=>{b(!1),_(null)}})]})},w1=()=>{const{toast:i}=Et(),[e,t]=v.useState([]),[r,a]=v.useState(!0),[l,c]=v.useState(!1),[u,h]=v.useState(!1),[f,p]=v.useState({name:"",description:"",price:"",category:"",stockQuantity:"",imageUrl:""});v.useEffect(()=>{g()},[]);const g=async()=>{try{a(!0),console.log(" Loading products from database...");const N=await Nn.getProducts();t(N||[])}catch(N){console.error(" Failed to load products:",N),t([])}finally{a(!1)}},y=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?h(!0):N.type==="dragleave"&&h(!1)},_=N=>{N.preventDefault(),N.stopPropagation(),h(!1),N.dataTransfer.files&&N.dataTransfer.files[0]&&P(N.dataTransfer.files[0])},P=N=>{if(N.type.startsWith("image/")){const T=new FileReader;T.onload=O=>{p({...f,imageUrl:O.target.result})},T.readAsDataURL(N)}else i({title:"Invalid File",description:"Please select an image file",variant:"destructive"})},b=N=>{N.target.files&&N.target.files[0]&&P(N.target.files[0])},j=async()=>{try{if(!f.name||!f.price||!f.category){i({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}const N={name:f.name,description:f.description,price:parseFloat(f.price),category:f.category,stockQuantity:parseInt(f.stockQuantity)||0,imageUrl:f.imageUrl,isActive:!0};if(console.log(" Adding product to database:",N.name),await Nn.createProduct(N))i({title:"Product Added to Database",description:`${N.name} has been saved successfully`});else{i({title:"Error",description:"Failed to add product to database",variant:"destructive"});return}p({name:"",description:"",price:"",category:"",stockQuantity:"",imageUrl:""}),c(!1),g()}catch(N){console.error(" Failed to add product:",N),i({title:"Database Error",description:"Failed to add product to database. Check your Supabase configuration.",variant:"destructive"})}},S=(N,T)=>{const O=e.map(E=>E.id===N?{...E,stockQuantity:Math.max(0,T)}:E);t(O),i({title:"Stock Updated",description:"Product stock has been updated successfully."})},k=async N=>{const O=!e.find(E=>E.id===N).isActive;try{if(console.log(" Updating product status in database:",N,"",O),!await Nn.updateProduct(parseInt(N),{isActive:O})){i({title:"Database Error",description:"Failed to update product status",variant:"destructive"});return}const I=e.map(q=>q.id===N?{...q,isActive:O}:q);t(I),i({title:"Database Updated",description:`Product ${O?"enabled":"disabled"} in database successfully.`})}catch(E){console.error(" Failed to update product status:",E),i({title:"Database Error",description:"Failed to update product status in database.",variant:"destructive"})}};return r?s.jsx("div",{className:"container mx-auto px-4 py-4 md:py-8",children:s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"loading-spinner mx-auto mb-4"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Loading products from database..."})]})})}):s.jsxs("div",{className:"container mx-auto px-3 md:px-4 py-4 md:py-8",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4 md:mb-6 gap-3 md:gap-0",children:[s.jsx("h1",{className:"text-xl md:text-3xl font-bold",children:"Product Management"}),s.jsxs(Zr,{open:l,onOpenChange:c,children:[s.jsx(Vu,{asChild:!0,children:s.jsxs(D,{className:"bg-primary",children:[s.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Add Product"]})}),s.jsxs(en,{className:"sm:max-w-[500px]",children:[s.jsx(Wn,{children:s.jsx(Vn,{children:"Add New Product"})}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ze,{htmlFor:"name",children:"Product Name *"}),s.jsx(nt,{id:"name",value:f.name,onChange:N=>p({...f,name:N.target.value}),placeholder:"Enter product name"})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ze,{htmlFor:"description",children:"Description"}),s.jsx(nt,{id:"description",value:f.description,onChange:N=>p({...f,description:N.target.value}),placeholder:"Enter product description"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ze,{htmlFor:"price",children:"Price *"}),s.jsx(nt,{id:"price",type:"number",value:f.price,onChange:N=>p({...f,price:N.target.value}),placeholder:"0.00"})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ze,{htmlFor:"stock",children:"Stock Quantity"}),s.jsx(nt,{id:"stock",type:"number",value:f.stockQuantity,onChange:N=>p({...f,stockQuantity:N.target.value}),placeholder:"0"})]})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ze,{htmlFor:"category",children:"Category *"}),s.jsxs(Bc,{value:f.category,onValueChange:N=>p({...f,category:N}),children:[s.jsx(go,{children:s.jsx(qc,{placeholder:"Select category"})}),s.jsxs(xo,{children:[s.jsx(vt,{value:"Grains",children:"Grains"}),s.jsx(vt,{value:"Pulses",children:"Pulses"}),s.jsx(vt,{value:"Oil",children:"Oil"}),s.jsx(vt,{value:"Sweeteners",children:"Sweeteners"}),s.jsx(vt,{value:"Beverages",children:"Beverages"}),s.jsx(vt,{value:"Dairy",children:"Dairy"}),s.jsx(vt,{value:"Vegetables",children:"Vegetables"}),s.jsx(vt,{value:"Fruits",children:"Fruits"}),s.jsx(vt,{value:"Bakery",children:"Bakery"}),s.jsx(vt,{value:"Snacks",children:"Snacks"}),s.jsx(vt,{value:"Instant Food",children:"Instant Food"})]})]})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(Ze,{children:"Product Image"}),s.jsx("div",{className:`border-2 border-dashed rounded-lg p-4 transition-colors ${u?"border-primary bg-primary/10":"border-gray-300"}`,onDragEnter:y,onDragLeave:y,onDragOver:y,onDrop:_,children:f.imageUrl?s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:f.imageUrl,alt:"Product preview",className:"w-full h-32 object-cover rounded-md"}),s.jsx(D,{variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>p({...f,imageUrl:""}),children:s.jsx(ps,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"text-center",children:[s.jsx(Uv,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drag and drop an image here, or click to select"}),s.jsx("input",{type:"file",accept:"image/*",onChange:b,className:"hidden",id:"image-upload"}),s.jsx(D,{variant:"outline",size:"sm",onClick:()=>document.getElementById("image-upload").click(),children:"Choose File"})]})}),s.jsxs("div",{className:"grid gap-2 mt-2",children:[s.jsx(Ze,{htmlFor:"imageUrl",children:"Or paste Image URL"}),s.jsx(nt,{id:"imageUrl",value:f.imageUrl,onChange:N=>p({...f,imageUrl:N.target.value}),placeholder:"https://example.com/image.jpg"})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(D,{variant:"outline",onClick:()=>c(!1),className:"flex-1",children:"Cancel"}),s.jsx(D,{onClick:j,className:"flex-1",children:"Add Product"})]})]})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:e.map(N=>s.jsxs(U,{className:"hover:shadow-md transition-shadow",children:[s.jsx(ne,{className:"p-3 md:p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ie,{className:"text-base md:text-lg truncate pr-2",children:N.name}),s.jsx(X,{variant:N.isActive?"default":"secondary",children:N.isActive?"Active":"Inactive"})]})}),s.jsx(z,{className:"p-3 md:p-4 pt-0",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{className:"flex items-center justify-center w-full h-32 bg-muted rounded-md overflow-hidden",children:N.imageUrl?s.jsx("img",{src:N.imageUrl,alt:N.name,className:"w-full h-full object-cover"}):s.jsx(xe,{className:"w-12 h-12 text-muted-foreground"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Price:"}),s.jsxs("span",{className:"font-semibold",children:["",parseFloat(N.price||0).toFixed(2)]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Stock:"}),s.jsx("span",{className:`font-semibold ${N.stockQuantity<10?"text-red-600":"text-green-600"}`,children:N.stockQuantity||0})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Category:"}),s.jsx("span",{className:"text-sm",children:N.category||"N/A"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(D,{variant:"outline",size:"sm",onClick:()=>S(N.id,(N.stockQuantity||0)+10),className:"flex-1",children:"+10 Stock"}),s.jsx(D,{variant:"outline",size:"sm",onClick:()=>k(N.id),className:"flex-1",children:N.isActive?"Disable":"Enable"})]})]})})]},N.id))}),e.length===0&&!r&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(xe,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Products Found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Please check your database connection or add products to the database"}),s.jsx(Zr,{open:l,onOpenChange:c,children:s.jsx(Vu,{asChild:!0,children:s.jsxs(D,{children:[s.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Add Your First Product"]})})})]})]})},j1=({orderId:i})=>{const[e,t]=v.useState([]);v.useEffect(()=>{const l=()=>{const h=JSON.parse(localStorage.getItem("whatsappMessages")||"[]").filter(f=>f.orderId===i);t(h)};l();const c=setInterval(l,5e3);return()=>clearInterval(c)},[i]);const r=l=>{switch(l){case"order_confirmation":return{label:"Order Confirmation",color:"bg-blue-500"};case"out_for_delivery":return{label:"Out for Delivery",color:"bg-orange-500"};case"delivered":return{label:"Delivered",color:"bg-green-500"};default:return{label:"Status Update",color:"bg-gray-500"}}},a=l=>{switch(l){case"sent":return s.jsx(dt,{className:"w-3 h-3"});case"delivered":return s.jsx(Jd,{className:"w-3 h-3"});case"read":return s.jsx(Jd,{className:"w-3 h-3 text-blue-500"});default:return s.jsx(dt,{className:"w-3 h-3"})}};return e.length===0?s.jsx(U,{children:s.jsxs(z,{className:"p-4 text-center text-muted-foreground",children:[s.jsx(Xd,{className:"w-8 h-8 mx-auto mb-2"}),s.jsx("p",{className:"text-sm",children:"No WhatsApp messages sent yet"})]})}):s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center text-lg",children:[s.jsx(Xd,{className:"w-5 h-5 mr-2 text-green-600"}),"WhatsApp Notifications"]})}),s.jsx(z,{className:"space-y-3",children:e.map(l=>{const c=r(l.type);return s.jsxs("div",{className:"border-l-4 border-l-green-500 pl-3 py-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx(X,{className:`${c.color} text-white text-xs`,children:c.label}),s.jsxs("div",{className:"flex items-center space-x-1 text-xs text-muted-foreground",children:[a(l.status),s.jsx("span",{children:new Date(l.timestamp).toLocaleTimeString()})]})]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sent to: ",l.phone]}),s.jsxs("div",{className:"text-xs bg-gray-50 p-2 rounded mt-1 max-h-20 overflow-y-auto",children:[l.message.substring(0,100),"..."]})]},l.id)})})]})},N1=()=>{const[i,e]=v.useState([]);v.useEffect(()=>{const r=()=>{e(Ea.getSMSHistory())};r();const a=setInterval(r,2e3);return()=>clearInterval(a)},[]);const t=()=>{Ea.clearSMSHistory(),e([])};return s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Ln,{className:"w-5 h-5"}),"SMS History (",i.length,")"]}),i.length>0&&s.jsxs(D,{variant:"outline",size:"sm",onClick:t,children:[s.jsx(Pa,{className:"w-4 h-4 mr-2"}),"Clear"]})]})}),s.jsx(z,{children:i.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ln,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"No SMS sent yet"})]}):s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:i.reverse().map(r=>s.jsxs("div",{className:"border rounded-lg p-3 bg-muted/50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"font-medium",children:r.phone})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(X,{variant:"outline",className:"bg-green-100 text-green-800",children:r.status}),s.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(r.timestamp).toLocaleTimeString()})]})]}),s.jsx("p",{className:"text-sm bg-white p-2 rounded border",children:r.message})]},r.id))})})]})},S1=()=>{var y,_,P;const[i,e]=v.useState([]),[t,r]=v.useState(null),[a,l]=v.useState(!1),{toast:c}=Et();v.useEffect(()=>(u(),wt.subscribe(j=>{e([...j].reverse())})),[]);const u=async()=>{try{console.log(" Loading orders from database...");const b=[...wt.getAllOrders()].reverse();if(e(b),Qe){const S=(await Nn.getOrders()).map(k=>({orderId:k.orderId||k.order_id,status:k.status,timestamp:k.createdAt||k.created_at,customerAddress:{name:k.customerName||k.customer_name,phone:k.customerPhone||k.customer_phone,address:k.deliveryAddress||k.delivery_address,coordinates:{lat:21.3487,lng:74.8831}},items:k.items?k.items.map(N=>{var T;return{product:{id:((T=N.product_id)==null?void 0:T.toString())||"0",name:N.product_name,price:parseFloat(N.price)},quantity:N.quantity}}):[],total:parseFloat(k.total),paymentStatus:k.paymentStatus||k.payment_status||"paid",databaseId:k.id}));e(S)}}catch(b){console.warn(" Database connection failed, using local data:",b)}},h=async(b,j)=>{try{if(console.log(" Updating order status:",b,"",j),await wt.updateOrderStatus(b,j)){if(Qe)try{const k=i.find(N=>N.orderId===b);k&&k.databaseId&&await Nn.updateOrderStatus(k.databaseId,j)}catch(k){console.warn(" Database update failed, but local update succeeded:",k)}if(j==="packing"||j==="out_for_delivery"){const k=wt.getOrderById(b);k&&(wt.createDeliveryNotification(k),pt.sendDeliveryRequestNotification(b,k.customerAddress.address,k.total),window.dispatchEvent(new CustomEvent("deliveryNotificationCreated",{detail:k})),window.dispatchEvent(new CustomEvent("ordersUpdated")))}c({title:"Status Updated",description:`Order ${b} status updated to ${j.replace("_"," ")}`}),u(),pt.sendOrderStatusNotification(b,j,"admin")}}catch(S){console.error(" Failed to update order status:",S),c({title:"Update Error",description:"Failed to update order status",variant:"destructive"})}},f=b=>{switch(b){case"pending":return"bg-gray-500";case"confirmed":return"bg-blue-500";case"packing":return"bg-orange-500";case"out_for_delivery":return"bg-purple-500";case"delivered":return"bg-green-500";default:return"bg-gray-500"}},p=b=>{switch(b){case"pending":return s.jsx(dt,{className:"w-4 h-4"});case"confirmed":return s.jsx(Qt,{className:"w-4 h-4"});case"packing":return s.jsx(xe,{className:"w-4 h-4"});case"out_for_delivery":return s.jsx(it,{className:"w-4 h-4"});case"delivered":return s.jsx(Qt,{className:"w-4 h-4"});default:return s.jsx(dt,{className:"w-4 h-4"})}},g=b=>{r(b),l(!0)};return s.jsxs("div",{className:"container mx-auto px-3 md:px-4 py-4 md:py-8",children:[s.jsx("h1",{className:"text-xl md:text-3xl font-bold mb-4 md:mb-6",children:"Recent Orders"}),i.length===0?s.jsx(U,{children:s.jsxs(z,{className:"p-8 text-center",children:[s.jsx(xe,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Orders Yet"}),s.jsx("p",{className:"text-muted-foreground",children:"Orders will appear here when customers make purchases"})]})}):s.jsx("div",{className:"space-y-4",children:i.map(b=>s.jsx(U,{className:"hover:shadow-md transition-shadow",children:s.jsxs(z,{className:"p-3 md:p-6",children:[s.jsxs("div",{className:"md:hidden space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[p(b.status),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-sm",children:["#",b.orderId]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(b.timestamp).toLocaleDateString()})]})]}),s.jsx(X,{className:`${f(b.status)} text-white text-xs`,children:b.status.replace("_"," ").toUpperCase()})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold",children:["",b.total.toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[b.items.length," items"]})]}),s.jsxs(D,{variant:"outline",size:"sm",onClick:()=>g(b),children:[s.jsx(Yd,{className:"w-4 h-4 mr-1"}),"View"]})]})]}),s.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[p(b.status),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-lg",children:["Order #",b.orderId]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(b.timestamp).toLocaleString()})]})]})}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-semibold",children:["",b.total.toFixed(2)]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[b.items.length," items"]})]}),s.jsx(X,{className:`${f(b.status)} text-white`,children:b.status.replace("_"," ").toUpperCase()}),s.jsxs(D,{variant:"outline",size:"sm",onClick:()=>g(b),children:[s.jsx(Yd,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})},b.orderId))}),s.jsx(Zr,{open:a,onOpenChange:l,children:s.jsxs(en,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Wn,{children:[s.jsxs(Vn,{children:["Order Details - #",t==null?void 0:t.orderId]}),s.jsx(Mc,{children:"View and manage order details, tracking, and WhatsApp communications"})]}),t&&s.jsxs(Cc,{defaultValue:"details",className:"w-full",children:[s.jsxs(no,{className:"grid w-full grid-cols-3",children:[s.jsx(hs,{value:"details",children:"Order Details"}),s.jsx(hs,{value:"tracking",children:"Live Tracking"}),s.jsx(hs,{value:"whatsapp",children:"WhatsApp"})]}),s.jsxs(Zs,{value:"details",className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Customer Information"}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",((y=t.customerAddress)==null?void 0:y.name)||"N/A"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Phone:"})," ",((_=t.customerAddress)==null?void 0:_.phone)||"N/A"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Address:"})," ",((P=t.customerAddress)==null?void 0:P.address)||"N/A"]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Order Items"}),s.jsx("div",{className:"space-y-2",children:t.items.map((b,j)=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-muted rounded-lg",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:b.product.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Qty: ",b.quantity]})]}),s.jsxs("p",{className:"font-semibold",children:["",(b.product.price*b.quantity).toFixed(2)]})]},j))}),s.jsx("div",{className:"mt-4 p-3 bg-primary/10 rounded-lg",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total Amount:"}),s.jsxs("span",{children:["",t.total.toFixed(2)]})]})})]}),s.jsx(k1,{order:t,onStatusUpdate:(b,j)=>h(b,j)})]}),s.jsx(Zs,{value:"tracking",className:"space-y-4",children:s.jsx(P1,{order:t})}),s.jsx(Zs,{value:"whatsapp",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(j1,{orderId:(t==null?void 0:t.orderId)||""}),s.jsx(N1,{})]})})]})]})})]})},P1=({order:i})=>{var j,S,k,N,T,O,E,I;const[e,t]=v.useState(null),[r,a]=v.useState(null),[l,c]=v.useState(null),[u,h]=v.useState(!1),[f,p]=v.useState(null),g=(q,B,W,J)=>{const ue=(W-q)*Math.PI/180,H=(J-B)*Math.PI/180,te=Math.sin(ue/2)*Math.sin(ue/2)+Math.cos(q*Math.PI/180)*Math.cos(W*Math.PI/180)*Math.sin(H/2)*Math.sin(H/2);return 6371*(2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te)))};v.useEffect(()=>{delete Kt.Icon.Default.prototype._getIconUrl,Kt.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"}),h(!0)},[]);const y=q=>{switch(q){case"confirmed":return"bg-blue-500";case"preparing":return"bg-yellow-500";case"packing":return"bg-orange-500";case"out_for_delivery":return"bg-purple-500";case"delivered":return"bg-green-500";default:return"bg-gray-500"}};v.useEffect(()=>{const q=()=>{var W;if((W=i.deliveryAgent)!=null&&W.location)t(i.deliveryAgent.location),c(i.deliveryAgent);else{const J=JSON.parse(localStorage.getItem("deliveryAgentLocation")||"null");J&&J.orderId===i.orderId&&(t({lat:J.lat,lng:J.lng}),c(J))}i.customerAddress.coordinates&&a(i.customerAddress.coordinates)};q();const B=setInterval(q,3e3);return()=>clearInterval(B)},[i]),v.useEffect(()=>{if(e&&r){const q=g(e.lat,e.lng,r.lat,r.lng);p(q)}else p(null)},[e,r]);const _=Kt.divIcon({html:'<div style="background: #3B82F6; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 16px; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]}),P=Kt.divIcon({html:'<div style="background: #EF4444; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 16px; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]}),b=e||r||{lat:21.3487,lng:74.8831};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Ut,{className:"w-5 h-5"}),"Live Delivery Tracking"]}),s.jsx(X,{className:`${y(i.status)} text-white`,children:i.status.replace("_"," ").toUpperCase()})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(U,{children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(it,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium",children:"Delivery Agent"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:i.deliveryAgent?`${i.deliveryAgent.name}`:"Not assigned yet"}),s.jsx("p",{className:"text-xs text-green-600",children:e?" Live":" Offline"})]})]})})}),s.jsx(U,{children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:s.jsx(Fe,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium",children:"Customer"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:((j=i.customerAddress)==null?void 0:j.name)||"N/A"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:((S=i.customerAddress)==null?void 0:S.phone)||"N/A"})]})]})})}),s.jsx(U,{children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(Ut,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium",children:"Distance"}),s.jsx("p",{className:"text-lg font-bold text-green-600",children:f?`${f.toFixed(2)} km`:"Calculating..."}),s.jsx("p",{className:"text-xs text-muted-foreground",children:f?`~${Math.round(f*3)} min`:"ETA pending"})]})]})})})]}),s.jsx("div",{className:"h-96 rounded-lg overflow-hidden border",children:u?s.jsxs(co,{center:[b.lat,b.lng],zoom:13,style:{height:"100%",width:"100%"},children:[s.jsx(uo,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),e&&s.jsx(xr,{position:[e.lat,e.lng],icon:_,children:s.jsx(vr,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("strong",{children:" Delivery Agent"}),s.jsx("br",{}),((k=i.deliveryAgent)==null?void 0:k.name)||"Agent",s.jsx("br",{}),s.jsx("span",{className:"text-green-600",children:" Live Location"})]})})}),r&&s.jsx(xr,{position:[r.lat,r.lng],icon:P,children:s.jsx(vr,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("strong",{children:" Customer Location"}),s.jsx("br",{}),((N=i.customerAddress)==null?void 0:N.name)||"Customer",s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:((T=i.customerAddress)==null?void 0:T.address)||"Address not available"})]})})})]},`map-${i.orderId}`):s.jsx("div",{className:"flex items-center justify-center h-full bg-muted",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"loading-spinner mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading map..."})]})})}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[s.jsx("h5",{className:"font-medium mb-2",children:" Delivery Information"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Order ID:"}),s.jsxs("span",{className:"font-medium",children:["#",i.orderId]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Customer:"}),s.jsx("span",{className:"font-medium",children:((O=i.customerAddress)==null?void 0:O.name)||"N/A"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Phone:"}),s.jsx("span",{className:"font-medium",children:((E=i.customerAddress)==null?void 0:E.phone)||"N/A"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Address:"}),s.jsx("span",{className:"font-medium text-right text-xs",children:((I=i.customerAddress)==null?void 0:I.address)||"N/A"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Payment Status:"}),s.jsxs(X,{variant:"outline",className:"bg-green-100 text-green-800",children:[" ",i.paymentStatus.toUpperCase()]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Order Status:"}),s.jsx(X,{className:`${y(i.status)} text-white`,children:i.status.replace("_"," ").toUpperCase()})]}),i.status==="out_for_delivery"&&s.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded border border-blue-200",children:s.jsx("p",{className:"text-blue-800 text-xs font-medium",children:" Live tracking active - Updates every 3 seconds"})})]})]})]})},k1=({order:i,onStatusUpdate:e})=>{var p;const[t,r]=v.useState(i.status),[a,l]=v.useState(!1),{toast:c}=Et(),u=[{value:"pending",label:"Pending",color:"bg-gray-500",disabled:!1},{value:"confirmed",label:"Confirmed",color:"bg-blue-500",disabled:i.status!=="pending"},{value:"packing",label:"Ready for Delivery",color:"bg-orange-500",disabled:i.status!=="confirmed"},{value:"out_for_delivery",label:"Out for Delivery",color:"bg-purple-500",disabled:i.status!=="packing"},{value:"delivered",label:"Delivered",color:"bg-green-500",disabled:i.status!=="out_for_delivery"}],h=()=>{if(t===i.status){c({title:"No Change",description:"Status is already set to this value",variant:"destructive"});return}l(!0)},f=()=>{e(i.orderId,t),l(!1),c({title:"Status Updated",description:`Order status changed to ${t.replace("_"," ")}`})};return s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Order Status Management"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Current Status:"}),s.jsx(X,{className:`${(p=u.find(g=>g.value===i.status))==null?void 0:p.color} text-white`,children:i.status.replace("_"," ").toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:"Change Status To:"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:u.map(g=>s.jsx(D,{variant:t===g.value?"default":"outline",onClick:()=>r(g.value),disabled:g.disabled&&g.value!==i.status,className:t===g.value?`${g.color} text-white`:"",size:"sm",children:g.label},g.value))})]}),s.jsx("div",{className:"flex justify-center",children:s.jsx(D,{onClick:h,disabled:t===i.status,className:"bg-primary hover:bg-primary/90 px-8",size:"lg",children:"Apply Status Change"})})]}),s.jsx(Zr,{open:a,onOpenChange:l,children:s.jsxs(en,{children:[s.jsxs(Wn,{children:[s.jsx(Vn,{children:"Confirm Status Change"}),s.jsxs(Mc,{children:['Are you sure you want to change the order status from "',i.status.replace("_"," "),'" to "',t.replace("_"," "),'"?',t==="packing"&&s.jsx("div",{className:"mt-2 p-2 bg-orange-50 rounded border border-orange-200",children:s.jsx("p",{className:"text-orange-800 text-sm font-medium",children:" This will send the order to delivery agents for pickup"})})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(D,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),s.jsx(D,{onClick:f,className:"bg-primary",children:"Confirm Change"})]})]})})]})},C1=()=>{const[i,e]=v.useState([{id:"delivery_1",name:"Raj Patel",phone:"+91 98765 43210",currentLocation:{lat:21.3486,lng:74.8811},isActive:!0,activeTask:ja[0]},{id:"delivery_2",name:"Amit Kumar",phone:"+91 87654 32109",currentLocation:{lat:21.35,lng:74.882},isActive:!0,activeTask:ja[1]},{id:"delivery_3",name:"Suresh Singh",phone:"+91 76543 21098",currentLocation:null,isActive:!1}]);v.useEffect(()=>{const u=()=>{const f=localStorage.getItem("liveDelivery");if(f){const p=JSON.parse(f);e(g=>g.map(y=>y.id==="delivery_1"?{...y,currentLocation:p.deliveryAgentLocation,isActive:!0}:y))}};u();const h=setInterval(u,5e3);return()=>clearInterval(h)},[]);const[t,r]=v.useState(null);v.useEffect(()=>{delete Kt.Icon.Default.prototype._getIconUrl,Kt.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"})},[]);const a=Kt.divIcon({html:'<div style="background-color: #2563eb; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 3px solid white; box-shadow: 0 2px 6px rgba(0,0,0,0.4);"><span style="color: white; font-size: 18px;"></span></div>',className:"custom-div-icon",iconSize:[32,32],iconAnchor:[16,16]}),l=Kt.divIcon({html:'<div style="background-color: #dc2626; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 3px solid white; box-shadow: 0 2px 6px rgba(0,0,0,0.4);"><span style="color: white; font-size: 16px;"></span></div>',className:"custom-div-icon",iconSize:[28,28],iconAnchor:[14,14]}),c=i.filter(u=>u.isActive&&u.currentLocation);return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Live Delivery Tracking"}),s.jsx("p",{className:"text-muted-foreground",children:"Monitor delivery partners and customer deliveries in real-time"})]}),s.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Delivery Partners"}),i.map(u=>s.jsx(U,{className:`cursor-pointer transition-all ${t===u.id?"ring-2 ring-primary":""}`,onClick:()=>r(u.id),children:s.jsxs(z,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:s.jsx(Os,{className:"w-4 h-4 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:u.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:u.phone})]})]}),s.jsx(X,{variant:u.isActive?"default":"secondary",children:u.isActive?"Active":"Offline"})]}),u.activeTask&&s.jsxs("div",{className:"mt-2 p-2 bg-muted rounded text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[s.jsx(it,{className:"w-3 h-3"}),s.jsxs("span",{children:["Order #",u.activeTask.order_id]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Fe,{className:"w-3 h-3"}),s.jsx("span",{className:"truncate",children:u.activeTask.customer_name})]})]})]})},u.id))]}),s.jsx("div",{className:"lg:col-span-2",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center",children:[s.jsx(Ut,{className:"w-5 h-5 mr-2"}),"Live Map View"]})}),s.jsx(z,{children:s.jsxs(co,{center:[21.3486,74.8811],zoom:13,style:{height:"500px",width:"100%",borderRadius:"0.5rem"},children:[s.jsx(uo,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),c.map(u=>s.jsx(xr,{position:[u.currentLocation.lat,u.currentLocation.lng],icon:a,children:s.jsx(vr,{children:s.jsxs("div",{className:"p-2",children:[s.jsxs("p",{className:"font-semibold",children:[" ",u.name]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",u.phone]}),u.activeTask&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("p",{className:"text-sm",children:["Delivering Order #",u.activeTask.order_id]}),s.jsxs("p",{className:"text-xs",children:["To: ",u.activeTask.customer_name]}),s.jsx("p",{className:"text-xs text-green-600",children:" Live tracking active"})]})]})})},u.id)),ja.map(u=>{var y,_,P;const h=localStorage.getItem("customerAddress");let f=null;h&&(f=JSON.parse(h));const p=((y=f==null?void 0:f.coordinates)==null?void 0:y.lat)||u.delivery_lat||21.3486,g=((_=f==null?void 0:f.coordinates)==null?void 0:_.lng)||u.delivery_lng||74.8811;return s.jsx(xr,{position:[p,g],icon:l,children:s.jsx(vr,{children:s.jsxs("div",{className:"p-2",children:[s.jsx("p",{className:"font-semibold",children:(f==null?void 0:f.name)||u.customer_name}),s.jsxs("p",{className:"text-sm",children:["Order #",u.order_id]}),(f==null?void 0:f.phone)&&s.jsxs("p",{className:"text-xs text-blue-600",children:[" ",f.phone]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:(f==null?void 0:f.address)||u.customer_address}),(f==null?void 0:f.coordinates)&&s.jsx("p",{className:"text-xs text-green-600",children:" Live location"}),s.jsxs("p",{className:"text-sm font-semibold mt-1",children:["$",(P=u.total_amount)==null?void 0:P.toFixed(2)]})]})})},u.id)})]})})]})})]}),t&&s.jsxs(U,{className:"mt-6",children:[s.jsx(ne,{children:s.jsx(ie,{children:"Partner Details"})}),s.jsx(z,{children:(()=>{var h;const u=i.find(f=>f.id===t);return u?s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Partner Information"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Name:"})," ",u.name]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Phone:"})," ",u.phone]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Status:"}),s.jsx(X,{className:"ml-2",variant:u.isActive?"default":"secondary",children:u.isActive?"Active":"Offline"})]}),u.currentLocation&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Location:"})," ",u.currentLocation.lat.toFixed(4),", ",u.currentLocation.lng.toFixed(4)]})]})]}),u.activeTask&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Current Delivery"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Order:"})," #",u.activeTask.order_id]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Customer:"})," ",u.activeTask.customer_name]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Address:"})," ",u.activeTask.customer_address]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Amount:"})," $",(h=u.activeTask.total_amount)==null?void 0:h.toFixed(2)]})]})]})]}):null})()})]})]})},T1=()=>{var u,h,f,p,g,y,_;const[i,e]=v.useState([]),[t,r]=v.useState(null);v.useEffect(()=>{const P=()=>{const S=JSON.parse(localStorage.getItem("allOrders")||"[]").filter(k=>k.deliveryAgent&&["assigned_to_delivery","picked_up","out_for_delivery"].includes(k.status));if(e(S),t){const k=S.find(N=>N.orderId===t.orderId);r(k||null)}};P();const b=setInterval(P,3e3);return()=>clearInterval(b)},[t]);const a=P=>{switch(P){case"assigned_to_delivery":return"bg-blue-500";case"picked_up":return"bg-yellow-500";case"out_for_delivery":return"bg-purple-500";case"delivered":return"bg-green-500";default:return"bg-gray-500"}},l=(P,b)=>tn.divIcon({html:`<div style="background-color: ${b}; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">${P}</div>`,className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]}),c=P=>{var b,j;return!((b=P.deliveryAgent)!=null&&b.location)||!((j=P.customerAddress)!=null&&j.coordinates)?[]:[[P.deliveryAgent.location.lat,P.deliveryAgent.location.lng],[P.customerAddress.coordinates.lat,P.customerAddress.coordinates.lng]]};return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Live Order Tracking"}),s.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[s.jsxs("h2",{className:"text-xl font-semibold",children:["Active Deliveries (",i.length,")"]}),i.length===0?s.jsx(U,{children:s.jsxs(z,{className:"p-6 text-center",children:[s.jsx(it,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"No active deliveries"})]})}):i.map(P=>{var b,j;return s.jsx(U,{className:`cursor-pointer transition-all ${(t==null?void 0:t.orderId)===P.orderId?"ring-2 ring-primary":"hover:shadow-md"}`,onClick:()=>r(P),children:s.jsxs(z,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h3",{className:"font-semibold",children:["#",P.orderId]}),s.jsx(X,{className:`${a(P.status)} text-white`,children:P.status.replace("_"," ").toUpperCase()})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Os,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{children:(b=P.customerAddress)==null?void 0:b.name})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(it,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{children:(j=P.deliveryAgent)==null?void 0:j.name})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(xe,{className:"w-4 h-4 text-muted-foreground"}),s.jsxs("span",{children:["",P.total.toFixed(2),"  ",P.items.length," items"]})]})]})]})},P.orderId)})]}),s.jsx("div",{className:"lg:col-span-2 space-y-6",children:t?s.jsxs(s.Fragment,{children:[s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{children:["Order Details - #",t.orderId]})}),s.jsxs(z,{children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-3 flex items-center",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Customer Information"]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",(u=t.customerAddress)==null?void 0:u.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Phone:"})," ",(h=t.customerAddress)==null?void 0:h.phone]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Address:"})," ",(f=t.customerAddress)==null?void 0:f.address]})]})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-3 flex items-center",children:[s.jsx(it,{className:"w-4 h-4 mr-2"}),"Delivery Agent"]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",(p=t.deliveryAgent)==null?void 0:p.name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Phone:"})," ",(g=t.deliveryAgent)==null?void 0:g.phone]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Status:"}),s.jsx(X,{className:`ml-2 ${a(t.status)} text-white`,children:t.status.replace("_"," ")})]})]})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("h4",{className:"font-semibold mb-3 flex items-center",children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"Order Items"]}),s.jsxs("div",{className:"space-y-2",children:[t.items.map((P,b)=>s.jsxs("div",{className:"flex justify-between items-center p-2 bg-muted rounded",children:[s.jsxs("span",{className:"text-sm",children:[P.quantity,"x ",P.product.name]}),s.jsxs("span",{className:"text-sm font-medium",children:["",(P.product.price*P.quantity).toFixed(2)]})]},b)),s.jsxs("div",{className:"flex justify-between items-center p-2 bg-primary/10 rounded font-semibold",children:[s.jsx("span",{children:"Total Amount:"}),s.jsxs("span",{children:["",t.total.toFixed(2)]})]})]})]})]})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center",children:[s.jsx(Fe,{className:"w-5 h-5 mr-2"}),"Live Tracking Map"]})}),s.jsx(z,{children:s.jsx("div",{className:"h-96 rounded-lg overflow-hidden",children:s.jsxs(co,{center:[20.7516,74.2297],zoom:13,style:{height:"100%",width:"100%"},children:[s.jsx(uo,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),((y=t.deliveryAgent)==null?void 0:y.location)&&s.jsx(xr,{position:[t.deliveryAgent.location.lat,t.deliveryAgent.location.lng],icon:l("","#3b82f6"),children:s.jsx(vr,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("strong",{children:t.deliveryAgent.name}),s.jsx("br",{}),s.jsx("span",{className:"text-sm",children:"Delivery Agent"}),s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:t.deliveryAgent.phone})]})})}),((_=t.customerAddress)==null?void 0:_.coordinates)&&s.jsx(xr,{position:[t.customerAddress.coordinates.lat,t.customerAddress.coordinates.lng],icon:l("","#ef4444"),children:s.jsx(vr,{children:s.jsxs("div",{className:"text-center",children:[s.jsx("strong",{children:t.customerAddress.name}),s.jsx("br",{}),s.jsx("span",{className:"text-sm",children:"Delivery Address"}),s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:t.customerAddress.address})]})})}),c(t).length>0&&s.jsx(GN,{positions:c(t),color:"#8b5cf6",weight:3,opacity:.7,dashArray:"10, 10"})]})})})]})]}):s.jsx(U,{children:s.jsxs(z,{className:"p-12 text-center",children:[s.jsx(Fe,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Select an Order"}),s.jsx("p",{className:"text-muted-foreground",children:"Choose an active delivery from the list to view live tracking details"})]})})})]})]})},O1=()=>{const i=[{month:"Jan",revenue:45e3,orders:120},{month:"Feb",revenue:52e3,orders:140},{month:"Mar",revenue:48e3,orders:130},{month:"Apr",revenue:61e3,orders:165},{month:"May",revenue:55e3,orders:150},{month:"Jun",revenue:67e3,orders:180}],e=[{area:"Zone A",avgTime:25,orders:45},{area:"Zone B",avgTime:32,orders:38},{area:"Zone C",avgTime:28,orders:52},{area:"Zone D",avgTime:35,orders:29}],t=[{name:"Groceries",value:45,color:"#8884d8"},{name:"Vegetables",value:30,color:"#82ca9d"},{name:"Dairy",value:15,color:"#ffc658"},{name:"Others",value:10,color:"#ff7300"}];return s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Xt,{className:"h-5 w-5"}),"Revenue Trends"]})}),s.jsx(z,{children:s.jsx(Qo,{width:"100%",height:300,children:s.jsxs(Fx,{data:i,children:[s.jsx(zd,{strokeDasharray:"3 3"}),s.jsx(Bd,{dataKey:"month"}),s.jsx(qd,{}),s.jsx(Xo,{formatter:(r,a)=>[a==="revenue"?`${r}`:r,a]}),s.jsx(zx,{type:"monotone",dataKey:"revenue",stroke:"#8884d8",strokeWidth:2})]})})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(dt,{className:"h-5 w-5"}),"Delivery Performance"]})}),s.jsx(z,{children:s.jsx(Qo,{width:"100%",height:300,children:s.jsxs(Bx,{data:e,children:[s.jsx(zd,{strokeDasharray:"3 3"}),s.jsx(Bd,{dataKey:"area"}),s.jsx(qd,{}),s.jsx(Xo,{formatter:(r,a)=>[a==="avgTime"?`${r} min`:r,a]}),s.jsx(qx,{dataKey:"avgTime",fill:"#82ca9d"})]})})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(dc,{className:"h-5 w-5"}),"Category Distribution"]})}),s.jsx(z,{children:s.jsx(Qo,{width:"100%",height:300,children:s.jsxs(Hx,{children:[s.jsx(Wx,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:({name:r,percent:a})=>`${r} ${(a*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.map((r,a)=>s.jsx(Vx,{fill:r.color},`cell-${a}`))}),s.jsx(Xo,{})]})})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Fe,{className:"h-5 w-5"}),"Peak Hours Analysis"]})}),s.jsx(z,{children:s.jsx("div",{className:"space-y-4",children:[{time:"9-11 AM",orders:45,percentage:85},{time:"12-2 PM",orders:62,percentage:95},{time:"6-8 PM",orders:78,percentage:100},{time:"8-10 PM",orders:34,percentage:60}].map(r=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-medium",children:r.time}),s.jsxs("div",{className:"flex items-center gap-3 flex-1 ml-4",children:[s.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${r.percentage}%`}})}),s.jsx("span",{className:"text-sm font-medium",children:r.orders})]})]},r.time))})})]})]})},I1=()=>{const[i]=v.useState([{id:1,name:"Basmati Rice",currentStock:15,minThreshold:20,maxCapacity:100,weeklyConsumption:25,predictedStockout:3,category:"Grains",supplier:"Local Supplier A"},{id:2,name:"Toor Dal",currentStock:8,minThreshold:15,maxCapacity:80,weeklyConsumption:18,predictedStockout:2,category:"Pulses",supplier:"Wholesale Market"},{id:3,name:"Cooking Oil",currentStock:45,minThreshold:25,maxCapacity:120,weeklyConsumption:12,predictedStockout:15,category:"Oil",supplier:"Brand Distributor"}]),e=r=>{const a=r.currentStock/r.maxCapacity*100;return r.currentStock<=r.minThreshold?{status:"critical",color:"bg-red-500",text:"Critical"}:a<30?{status:"low",color:"bg-orange-500",text:"Low Stock"}:a>80?{status:"high",color:"bg-green-500",text:"Well Stocked"}:{status:"normal",color:"bg-blue-500",text:"Normal"}},t=r=>{const a=r.currentStock/(r.weeklyConsumption/7),l=Math.max(r.maxCapacity-r.currentStock,r.weeklyConsumption*2);return{urgency:a<7?"high":a<14?"medium":"low",suggestedQuantity:l,daysUntilStockout:Math.floor(a)}};return s.jsx("div",{className:"space-y-6",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(xe,{className:"h-5 w-5"}),"Smart Inventory Management"]})}),s.jsxs(z,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[s.jsx($v,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.filter(r=>r.currentStock<=r.minThreshold).length}),s.jsx("p",{className:"text-sm text-red-600",children:"Critical Items"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx(im,{className:"h-8 w-8 text-orange-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.filter(r=>r.currentStock/r.maxCapacity<.3).length}),s.jsx("p",{className:"text-sm text-orange-600",children:"Low Stock"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx(Xt,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(r=>r.currentStock/r.maxCapacity>.8).length}),s.jsx("p",{className:"text-sm text-green-600",children:"Well Stocked"})]})]}),s.jsx("div",{className:"space-y-4",children:i.map(r=>{const a=e(r),l=t(r),c=r.currentStock/r.maxCapacity*100;return s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold",children:r.name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[r.category,"  ",r.supplier]})]}),s.jsx(X,{className:`${a.color} text-white`,children:a.text})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Current Stock"}),s.jsxs("p",{className:"font-semibold",children:[r.currentStock," units"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Weekly Usage"}),s.jsxs("p",{className:"font-semibold",children:[r.weeklyConsumption," units"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Days Until Stockout"}),s.jsxs("p",{className:"font-semibold text-orange-600",children:[l.daysUntilStockout," days"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Suggested Reorder"}),s.jsxs("p",{className:"font-semibold text-blue-600",children:[l.suggestedQuantity," units"]})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{children:"Stock Level"}),s.jsxs("span",{children:[r.currentStock,"/",r.maxCapacity]})]}),s.jsx(Hn,{value:c,className:"h-2"})]}),r.currentStock<=r.minThreshold&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 rounded-lg",children:[s.jsx(Br,{className:"h-4 w-4 text-red-500"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-red-800",children:"Urgent Restock Required"}),s.jsx("p",{className:"text-xs text-red-600",children:"Stock below minimum threshold"})]}),s.jsx(D,{size:"sm",className:"bg-red-500 hover:bg-red-600",children:"Reorder Now"})]})]},r.id)})})]})]})})},A1=()=>{const[i]=v.useState([{id:"route-1",agentName:"Rahul Sharma",stops:[{id:"stop-1",orderId:"ORD-001",customerName:"Amit Kumar",address:"Shirpur Market Area",coordinates:{lat:21.3486,lng:74.8811},estimatedTime:15,priority:"high",timeWindow:"10:00-11:00 AM"},{id:"stop-2",orderId:"ORD-002",customerName:"Priya Patel",address:"Gandhi Chowk",coordinates:{lat:21.35,lng:74.8825},estimatedTime:12,priority:"medium",timeWindow:"11:30-12:30 PM"},{id:"stop-3",orderId:"ORD-003",customerName:"Rajesh Singh",address:"Station Road",coordinates:{lat:21.352,lng:74.884},estimatedTime:18,priority:"low",timeWindow:"2:00-3:00 PM"}],totalDistance:12.5,estimatedDuration:95,fuelCost:85,efficiency:92}]),[e,t]=v.useState(!1),r=l=>{switch(l){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},a=()=>{t(!0),setTimeout(()=>{t(!1)},2e3)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Nl,{className:"h-5 w-5"}),"Route Optimization"]})}),s.jsxs(z,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx(Ut,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"3"}),s.jsx("p",{className:"text-sm text-blue-600",children:"Active Routes"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx(dt,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:"25%"}),s.jsx("p",{className:"text-sm text-green-600",children:"Time Saved"})]}),s.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[s.jsx(Cv,{className:"h-8 w-8 text-purple-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"340"}),s.jsx("p",{className:"text-sm text-purple-600",children:"Fuel Savings"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx(uc,{className:"h-8 w-8 text-orange-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:"92%"}),s.jsx("p",{className:"text-sm text-orange-600",children:"Efficiency"})]})]}),s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"font-semibold",children:"Optimized Routes"}),s.jsx(D,{onClick:a,disabled:e,className:"bg-blue-500 hover:bg-blue-600",children:e?"Optimizing...":"Re-optimize Routes"})]}),s.jsx("div",{className:"space-y-4",children:i.map(l=>s.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:l.agentName}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Route ID: ",l.id]})]}),s.jsx("div",{className:"text-right",children:s.jsxs(X,{className:"bg-green-100 text-green-800",children:[l.efficiency,"% Efficient"]})})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Total Distance"}),s.jsxs("p",{className:"font-semibold",children:[l.totalDistance," km"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Est. Duration"}),s.jsxs("p",{className:"font-semibold",children:[l.estimatedDuration," min"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Fuel Cost"}),s.jsxs("p",{className:"font-semibold",children:["",l.fuelCost]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Stops"}),s.jsxs("p",{className:"font-semibold",children:[l.stops.length," deliveries"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h5",{className:"font-medium",children:"Delivery Stops"}),l.stops.map((c,u)=>s.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:u+1}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("p",{className:"font-medium",children:c.customerName}),s.jsx(X,{className:r(c.priority),children:c.priority})]}),s.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[s.jsx(Fe,{className:"h-3 w-3"}),c.address]})]}),s.jsxs("div",{className:"text-right text-sm",children:[s.jsx("p",{className:"font-medium",children:c.timeWindow}),s.jsxs("p",{className:"text-gray-600",children:[c.estimatedTime," min"]})]})]},c.id))]}),s.jsxs("div",{className:"flex gap-2 pt-3 border-t",children:[s.jsx(D,{variant:"outline",size:"sm",children:"View on Map"}),s.jsx(D,{variant:"outline",size:"sm",children:"Send to Agent"}),s.jsx(D,{variant:"outline",size:"sm",children:"Track Progress"})]})]},l.id))})]})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Route Optimization Settings"})}),s.jsxs(z,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Optimization Priority"}),s.jsxs("select",{className:"w-full p-2 border rounded-lg",children:[s.jsx("option",{value:"time",children:"Minimize Time"}),s.jsx("option",{value:"distance",children:"Minimize Distance"}),s.jsx("option",{value:"fuel",children:"Minimize Fuel Cost"}),s.jsx("option",{value:"balanced",children:"Balanced Approach"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Vehicle Type"}),s.jsxs("select",{className:"w-full p-2 border rounded-lg",children:[s.jsx("option",{value:"bike",children:"Motorcycle"}),s.jsx("option",{value:"auto",children:"Auto Rickshaw"}),s.jsx("option",{value:"van",children:"Delivery Van"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0}),s.jsx("span",{className:"text-sm",children:"Consider traffic conditions"})]}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0}),s.jsx("span",{className:"text-sm",children:"Respect delivery time windows"})]}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox"}),s.jsx("span",{className:"text-sm",children:"Allow route modifications during delivery"})]})]})]})]})]})},E1=()=>{const[i]=v.useState([{id:"1",orderId:"ORD-001",customerName:"Rajesh Kumar",rating:5,comment:"Excellent service! Fresh vegetables delivered on time.",category:"delivery",timestamp:"2024-01-15T10:30:00Z",helpful:12},{id:"2",orderId:"ORD-002",customerName:"Priya Sharma",rating:4,comment:"Good quality rice, but packaging could be better.",category:"product",timestamp:"2024-01-14T15:45:00Z",helpful:8},{id:"3",orderId:"ORD-003",customerName:"Amit Patel",rating:3,comment:"Delivery was delayed by 30 minutes. Please improve timing.",category:"service",timestamp:"2024-01-13T18:20:00Z",helpful:5}]),[e,t]=v.useState({rating:0,comment:"",category:"delivery"}),r=(c,u=!1,h)=>s.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(f=>s.jsx(pr,{className:`h-5 w-5 ${f<=c?"text-yellow-400 fill-yellow-400":"text-gray-300"} ${u?"cursor-pointer hover:text-yellow-400":""}`,onClick:()=>u&&(h==null?void 0:h(f))},f))}),a=c=>{switch(c){case"delivery":return"bg-blue-100 text-blue-800";case"product":return"bg-green-100 text-green-800";case"service":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},l=i.reduce((c,u)=>c+u.rating,0)/i.length;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Ln,{className:"h-5 w-5"}),"Customer Feedback & Ratings"]})}),s.jsxs(z,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[s.jsx(pr,{className:"h-6 w-6 text-yellow-400 fill-yellow-400"}),s.jsx("span",{className:"text-2xl font-bold",children:l.toFixed(1)})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Average Rating"})]}),s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx(Ln,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.length}),s.jsx("p",{className:"text-sm text-blue-600",children:"Total Reviews"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx(tu,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(i.filter(c=>c.rating>=4).length/i.length*100),"%"]}),s.jsx("p",{className:"text-sm text-green-600",children:"Positive Reviews"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold",children:"Recent Feedback"}),i.map(c=>s.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:s.jsx(Os,{className:"h-5 w-5 text-gray-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:c.customerName}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Order #",c.orderId]})]})]}),s.jsxs("div",{className:"text-right",children:[r(c.rating),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.timestamp).toLocaleDateString()})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(X,{className:a(c.category),children:c.category})}),s.jsx("p",{className:"text-gray-700",children:c.comment}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("button",{className:"flex items-center gap-1 text-sm text-gray-600 hover:text-green-600",children:[s.jsx(tu,{className:"h-4 w-4"}),"Helpful (",c.helpful,")"]}),s.jsxs("button",{className:"flex items-center gap-1 text-sm text-gray-600 hover:text-red-600",children:[s.jsx(Dv,{className:"h-4 w-4"}),"Not Helpful"]})]}),s.jsx(D,{variant:"outline",size:"sm",children:"Respond"})]})]},c.id))]})]})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Leave Feedback"})}),s.jsxs(z,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rating"}),r(e.rating,!0,c=>t(u=>({...u,rating:c})))]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Category"}),s.jsxs("select",{className:"w-full p-2 border rounded-lg",value:e.category,onChange:c=>t(u=>({...u,category:c.target.value})),children:[s.jsx("option",{value:"delivery",children:"Delivery"}),s.jsx("option",{value:"product",children:"Product Quality"}),s.jsx("option",{value:"service",children:"Customer Service"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Comment"}),s.jsx(io,{placeholder:"Share your experience...",value:e.comment,onChange:c=>t(u=>({...u,comment:c.target.value})),rows:4})]}),s.jsx(D,{className:"w-full",children:"Submit Feedback"})]})]})]})},L1=()=>{const[i,e]=v.useState({points:450,tier:"Silver",nextTierPoints:1e3,totalOrders:12,rewards:[{id:"1",name:"Free Delivery",pointsCost:100,description:"Free delivery on next order",available:!0},{id:"2",name:"10% Discount",pointsCost:200,description:"10% off on orders above 500",available:!0},{id:"3",name:"Premium Support",pointsCost:500,description:"Priority customer support",available:!1}]}),t=i.points/i.nextTierPoints*100;return s.jsxs(U,{className:"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-pink-50",children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(am,{className:"h-5 w-5 text-yellow-500"}),"Loyalty Rewards"]})}),s.jsxs(z,{className:"space-y-4",children:[s.jsxs("div",{className:"text-center p-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[s.jsx(nm,{className:"h-6 w-6"}),s.jsx("span",{className:"text-2xl font-bold",children:i.points})]}),s.jsx("p",{className:"text-sm opacity-90",children:"Loyalty Points"}),s.jsxs(X,{className:"mt-2 bg-white/20 text-white",children:[i.tier," Member"]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[s.jsx("span",{children:"Progress to Gold"}),s.jsxs("span",{children:[i.points,"/",i.nextTierPoints]})]}),s.jsx(Hn,{value:t,className:"h-2"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(Na,{className:"h-4 w-4"}),"Available Rewards"]}),i.rewards.map(r=>s.jsx("div",{className:`p-3 rounded-lg border ${r.available?"bg-white":"bg-gray-50 opacity-60"}`,children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:r.name}),s.jsx("p",{className:"text-sm text-gray-600",children:r.description})]}),s.jsxs(X,{variant:r.available?"default":"secondary",children:[r.pointsCost," pts"]})]})},r.id))]})]})]})},M1=()=>s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 shadow-lg",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(_l,{className:"h-8 w-8"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Advanced Features"}),s.jsx("p",{className:"text-blue-100 mt-1",children:"AI-powered tools for enhanced business operations"})]})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(Cc,{defaultValue:"analytics",className:"space-y-6",children:[s.jsxs(no,{className:"grid w-full grid-cols-5",children:[s.jsxs(hs,{value:"analytics",className:"flex items-center gap-2",children:[s.jsx(wi,{className:"h-4 w-4"}),"Analytics"]}),s.jsxs(hs,{value:"inventory",className:"flex items-center gap-2",children:[s.jsx(xe,{className:"h-4 w-4"}),"Inventory"]}),s.jsxs(hs,{value:"routes",className:"flex items-center gap-2",children:[s.jsx(Nl,{className:"h-4 w-4"}),"Routes"]}),s.jsxs(hs,{value:"feedback",className:"flex items-center gap-2",children:[s.jsx(Ln,{className:"h-4 w-4"}),"Feedback"]}),s.jsxs(hs,{value:"loyalty",className:"flex items-center gap-2",children:[s.jsx(Na,{className:"h-4 w-4"}),"Loyalty"]})]}),s.jsx(Zs,{value:"analytics",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(wi,{className:"h-5 w-5 text-blue-500"}),"Advanced Analytics Dashboard"]})}),s.jsx(z,{children:s.jsx(O1,{})})]})}),s.jsx(Zs,{value:"inventory",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(xe,{className:"h-5 w-5 text-green-500"}),"Smart Inventory Management"]})}),s.jsx(z,{children:s.jsx(I1,{})})]})}),s.jsx(Zs,{value:"routes",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Nl,{className:"h-5 w-5 text-purple-500"}),"Route Optimization"]})}),s.jsx(z,{children:s.jsx(A1,{})})]})}),s.jsx(Zs,{value:"feedback",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Ln,{className:"h-5 w-5 text-orange-500"}),"Customer Feedback Management"]})}),s.jsx(z,{children:s.jsx(E1,{})})]})}),s.jsx(Zs,{value:"loyalty",children:s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Na,{className:"h-5 w-5 text-pink-500"}),"Loyalty Program Management"]})}),s.jsx(z,{children:s.jsx(L1,{})})]})})]})})]});var vo="Switch",[D1]=Yr(vo),[R1,$1]=D1(vo),ag=v.forwardRef((i,e)=>{const{__scopeSwitch:t,name:r,checked:a,defaultChecked:l,required:c,disabled:u,value:h="on",onCheckedChange:f,form:p,...g}=i,[y,_]=v.useState(null),P=kt(e,N=>_(N)),b=v.useRef(!1),j=y?p||!!y.closest("form"):!0,[S,k]=_i({prop:a,defaultProp:l??!1,onChange:f,caller:vo});return s.jsxs(R1,{scope:t,checked:S,disabled:u,children:[s.jsx(Me.button,{type:"button",role:"switch","aria-checked":S,"aria-required":c,"data-state":dg(S),"data-disabled":u?"":void 0,disabled:u,value:h,...g,ref:P,onClick:Te(i.onClick,N=>{k(T=>!T),j&&(b.current=N.isPropagationStopped(),b.current||N.stopPropagation())})}),j&&s.jsx(cg,{control:y,bubbles:!b.current,name:r,value:h,checked:S,required:c,disabled:u,form:p,style:{transform:"translateX(-100%)"}})]})});ag.displayName=vo;var og="SwitchThumb",lg=v.forwardRef((i,e)=>{const{__scopeSwitch:t,...r}=i,a=$1(og,t);return s.jsx(Me.span,{"data-state":dg(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:e})});lg.displayName=og;var U1="SwitchBubbleInput",cg=v.forwardRef(({__scopeSwitch:i,control:e,checked:t,bubbles:r=!0,...a},l)=>{const c=v.useRef(null),u=kt(c,l),h=wp(t),f=Mx(e);return v.useEffect(()=>{const p=c.current;if(!p)return;const g=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(g,"checked").set;if(h!==t&&_){const P=new Event("click",{bubbles:r});_.call(p,t),p.dispatchEvent(P)}},[h,t,r]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...a,tabIndex:-1,ref:u,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});cg.displayName=U1;function dg(i){return i?"checked":"unchecked"}var ug=ag,F1=lg;const Hc=v.forwardRef(({className:i,...e},t)=>s.jsx(ug,{className:se("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",i),...e,ref:t,children:s.jsx(F1,{className:se("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Hc.displayName=ug.displayName;const z1=()=>{const{toast:i}=Et(),[e,t]=v.useState([]),[r,a]=v.useState([]),[l,c]=v.useState(null),[u,h]=v.useState(!1);v.useEffect(()=>{f(),p()},[]);const f=()=>{const b=localStorage.getItem("carouselItems");if(b)t(JSON.parse(b));else{const j=[{id:1,productId:1,productName:"Fresh Tomatoes",title:"Fresh Tomatoes",description:"Farm fresh red tomatoes",imageUrl:"/api/placeholder/800/400",price:40,isActive:!0,order:1}];t(j),localStorage.setItem("carouselItems",JSON.stringify(j))}},p=()=>{a([{id:1,name:"Fresh Tomatoes",price:40,imageUrl:"/api/placeholder/300/200"},{id:2,name:"Basmati Rice",price:120,imageUrl:"/api/placeholder/300/200"},{id:3,name:"Organic Milk",price:60,imageUrl:"/api/placeholder/300/200"}])},g=b=>{localStorage.setItem("carouselItems",JSON.stringify(b)),t(b)},y=b=>{if(l){const j=e.map(S=>S.id===l.id?{...b,id:l.id}:S);g(j),i({title:"Carousel item updated successfully"})}else{const j={...b,id:Date.now()};g([...e,j]),i({title:"Carousel item added successfully"})}c(null),h(!1)},_=b=>{const j=e.filter(S=>S.id!==b);g(j),i({title:"Carousel item deleted"})},P=b=>{const j=e.map(S=>S.id===b?{...S,isActive:!S.isActive}:S);g(j)};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Carousel Management"}),s.jsxs(D,{onClick:()=>h(!0),className:"bg-blue-600",children:[s.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Add Carousel Item"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(b=>s.jsxs(U,{className:"overflow-hidden",children:[s.jsxs("div",{className:"relative h-48 bg-gradient-to-r from-blue-500 to-purple-600",children:[b.imageUrl&&s.jsx("img",{src:b.imageUrl,alt:b.title,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-black/40"}),s.jsx("div",{className:"absolute top-2 right-2 flex gap-2",children:s.jsx(X,{variant:b.isActive?"default":"secondary",children:b.isActive?"Active":"Inactive"})}),s.jsxs("div",{className:"absolute bottom-4 left-4 text-white",children:[s.jsx("h3",{className:"text-xl font-bold",children:b.title}),s.jsx("p",{className:"text-sm opacity-90",children:b.description}),s.jsxs("p",{className:"text-2xl font-bold text-yellow-300",children:["",b.price]})]})]}),s.jsxs(z,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("span",{className:"text-sm text-gray-600",children:["Order: ",b.order]}),s.jsx(Hc,{checked:b.isActive,onCheckedChange:()=>P(b.id)})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(D,{variant:"outline",size:"sm",onClick:()=>{c(b),h(!0)},children:s.jsx(Lv,{className:"w-4 h-4"})}),s.jsx(D,{variant:"destructive",size:"sm",onClick:()=>_(b.id),children:s.jsx(Pa,{className:"w-4 h-4"})})]})]})]},b.id))}),u&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs(U,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex justify-between items-center",children:[l?"Edit Carousel Item":"Add Carousel Item",s.jsx(D,{variant:"ghost",onClick:()=>{h(!1),c(null)},children:s.jsx(ps,{className:"w-4 h-4"})})]})}),s.jsx(z,{children:s.jsx(B1,{item:l,products:r,onSave:y,onCancel:()=>{h(!1),c(null)}})})]})})]})},B1=({item:i,products:e,onSave:t,onCancel:r})=>{const[a,l]=v.useState({productId:(i==null?void 0:i.productId)||0,productName:(i==null?void 0:i.productName)||"",title:(i==null?void 0:i.title)||"",description:(i==null?void 0:i.description)||"",imageUrl:(i==null?void 0:i.imageUrl)||"",price:(i==null?void 0:i.price)||0,isActive:(i==null?void 0:i.isActive)??!0,order:(i==null?void 0:i.order)||1}),c=h=>{const f=e.find(p=>p.id===parseInt(h));f&&l({...a,productId:f.id,productName:f.name,title:f.name,price:f.price,imageUrl:f.imageUrl})},u=h=>{h.preventDefault(),t(a)};return s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Ze,{children:"Select Product"}),s.jsxs(Bc,{value:a.productId.toString(),onValueChange:c,children:[s.jsx(go,{children:s.jsx(qc,{placeholder:"Choose a product"})}),s.jsx(xo,{children:e.map(h=>s.jsxs(vt,{value:h.id.toString(),children:[h.name," - ",h.price]},h.id))})]})]}),s.jsxs("div",{children:[s.jsx(Ze,{children:"Title"}),s.jsx(nt,{value:a.title,onChange:h=>l({...a,title:h.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(Ze,{children:"Description"}),s.jsx(io,{value:a.description,onChange:h=>l({...a,description:h.target.value}),rows:3})]}),s.jsxs("div",{children:[s.jsx(Ze,{children:"Image URL"}),s.jsx(nt,{value:a.imageUrl,onChange:h=>l({...a,imageUrl:h.target.value}),placeholder:"https://example.com/image.jpg"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Ze,{children:"Price"}),s.jsx(nt,{type:"number",value:a.price,onChange:h=>l({...a,price:parseFloat(h.target.value)}),required:!0})]}),s.jsxs("div",{children:[s.jsx(Ze,{children:"Display Order"}),s.jsx(nt,{type:"number",value:a.order,onChange:h=>l({...a,order:parseInt(h.target.value)}),min:"1",required:!0})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Hc,{checked:a.isActive,onCheckedChange:h=>l({...a,isActive:h})}),s.jsx(Ze,{children:"Active"})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsxs(D,{type:"submit",className:"bg-blue-600",children:[s.jsx(Av,{className:"w-4 h-4 mr-2"}),"Save"]}),s.jsx(D,{type:"button",variant:"outline",onClick:r,children:"Cancel"})]})]})},q1=()=>{const i=Ks(),e=t=>i.pathname===t;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[s.jsx("header",{className:"bg-gradient-to-r from-blue-600 to-orange-600 text-white shadow-lg safe-area-top",children:s.jsx("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0",children:[s.jsx(_e,{to:"/",className:"text-white hover:text-white/80 transition-colors flex-shrink-0",children:s.jsx(Di,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),s.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[s.jsx(it,{className:"h-4 w-4 sm:h-5 sm:h-5 md:h-6 md:w-6 flex-shrink-0"}),s.jsx("h1",{className:"text-base sm:text-lg md:text-2xl font-bold truncate",children:"Delivery Portal"})]})]}),s.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[s.jsx(Ma,{userType:"delivery"}),s.jsxs("nav",{className:"flex items-center space-x-2",children:[s.jsx(_e,{to:"/delivery",children:s.jsxs(D,{variant:e("/delivery")?"secondary":"ghost",className:e("/delivery")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(Qd,{className:"w-4 h-4 mr-2"}),"My Tasks"]})}),s.jsx(_e,{to:"/delivery/notifications",children:s.jsxs(D,{variant:e("/delivery/notifications")?"secondary":"ghost",className:e("/delivery/notifications")?"bg-white/20 text-white hover:bg-white/30":"text-white hover:bg-white/10",size:"sm",children:[s.jsx(Ut,{className:"w-4 h-4 mr-2"}),"New Orders"]})})]}),s.jsx($n,{})]}),s.jsxs("div",{className:"flex md:hidden items-center space-x-2",children:[s.jsx(Ma,{userType:"delivery"}),s.jsxs(yc,{children:[s.jsx(bc,{asChild:!0,children:s.jsx(D,{variant:"ghost",size:"sm",className:"text-white hover:bg-white/20",children:s.jsx(lc,{className:"w-5 h-5"})})}),s.jsx(Ya,{side:"right",className:"w-64",children:s.jsxs("div",{className:"flex flex-col space-y-4 mt-6",children:[s.jsx(_e,{to:"/delivery",className:"w-full",children:s.jsxs(D,{variant:e("/delivery")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(Qd,{className:"w-4 h-4 mr-3"}),"My Tasks"]})}),s.jsx(_e,{to:"/delivery/notifications",className:"w-full",children:s.jsxs(D,{variant:e("/delivery/notifications")?"default":"ghost",className:"w-full justify-start",size:"lg",children:[s.jsx(Ut,{className:"w-4 h-4 mr-3"}),"New Orders"]})}),s.jsx("div",{className:"pt-4 border-t",children:s.jsx($n,{})})]})})]})]})]})})}),s.jsx("main",{children:s.jsx(vc,{})})]})};class Ps{static async getAvailableDeliveries(){try{const e=await this.getCurrentLocation(),t=wt.getAllOrders();console.log(" DeliveryDataService - Total orders:",t.length),console.log(" DeliveryDataService - Orders:",t.map(l=>({id:l.orderId,status:l.status})));const r=t.filter(l=>l.status==="out_for_delivery"&&!l.deliveryAgent);console.log(" Available for delivery:",r.length,"orders");const a=r.map(l=>{var c,u;return{id:`TASK_${l.orderId}`,orderId:l.orderId,order_id:l.orderId,customer_name:l.customerAddress.name,customer_address:l.customerAddress.address,customer_phone:l.customerAddress.phone,customerAddress:l.customerAddress,items:l.items,total:l.total,orderValue:l.total,total_amount:l.total,estimatedEarning:Math.round(l.total*.15),status:"available",timestamp:l.timestamp,distance:this.calculateDistance(e.lat,e.lng,((c=l.customerAddress.coordinates)==null?void 0:c.lat)||21.3099,((u=l.customerAddress.coordinates)==null?void 0:u.lng)||75.1178),agentLocation:e,debugInfo:{totalOrders:t.length,outForDeliveryOrders:r.length,agentGPS:e,lastUpdate:new Date().toLocaleTimeString(),allOrderStatuses:t.map(h=>({id:h.orderId,status:h.status}))}}});return console.log(" Delivery tasks created:",a.length),a}catch(e){return console.error("DeliveryDataService error:",e),[]}}static async getCurrentLocation(){return new Promise(e=>{if(navigator.geolocation)navigator.geolocation.getCurrentPosition(t=>{const r={lat:t.coords.latitude,lng:t.coords.longitude};localStorage.setItem("agentLocation",JSON.stringify(r)),e(r)},()=>{const t={lat:21.3486,lng:74.8811};localStorage.setItem("agentLocation",JSON.stringify(t)),e(t)});else{const t={lat:21.3486,lng:74.8811};localStorage.setItem("agentLocation",JSON.stringify(t)),e(t)}})}static getDeliveryMetrics(e){const t=e.filter(a=>["accepted","in_progress"].includes(a.status)).length,r=e.filter(a=>a.status==="completed"&&new Date(a.timestamp).toDateString()===new Date().toDateString()).reduce((a,l)=>a+(l.estimatedEarning||0),0);return{activeTasks:t,availableOrders:e.length,todaysEarnings:r,completionRate:95}}static calculateDistance(e,t,r,a){const c=(r-e)*Math.PI/180,u=(a-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2);return 6371*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))}static clearCache(){this.cache.clear(),this.lastUpdate=0}}ze(Ps,"cache",new Map),ze(Ps,"lastUpdate",0),ze(Ps,"CACHE_DURATION",3e4);const H1=()=>{const i={todayDeliveries:12,onTimeRate:94,avgRating:4.8,totalEarnings:850,weeklyTarget:50,completedThisWeek:38},e=i.completedThisWeek/i.weeklyTarget*100;return s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(U,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-100 text-sm",children:"Today"}),s.jsx("p",{className:"text-2xl font-bold",children:i.todayDeliveries}),s.jsx("p",{className:"text-xs text-blue-200",children:"Deliveries"})]}),s.jsx(Mv,{className:"h-8 w-8 text-blue-200"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-green-100 text-sm",children:"On-Time"}),s.jsxs("p",{className:"text-2xl font-bold",children:[i.onTimeRate,"%"]}),s.jsx("p",{className:"text-xs text-green-200",children:"Rate"})]}),s.jsx(dt,{className:"h-8 w-8 text-green-200"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-yellow-500 to-yellow-600 text-white",children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-yellow-100 text-sm",children:"Rating"}),s.jsx("p",{className:"text-2xl font-bold",children:i.avgRating}),s.jsx("p",{className:"text-xs text-yellow-200",children:"Average"})]}),s.jsx(pr,{className:"h-8 w-8 text-yellow-200"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-purple-100 text-sm",children:"Earnings"}),s.jsxs("p",{className:"text-2xl font-bold",children:["",i.totalEarnings]}),s.jsx("p",{className:"text-xs text-purple-200",children:"Today"})]}),s.jsx(Xt,{className:"h-8 w-8 text-purple-200"})]})})}),s.jsxs(U,{className:"col-span-2 lg:col-span-4",children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(am,{className:"h-5 w-5 text-yellow-500"}),"Weekly Progress"]})}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Deliveries Completed"}),s.jsxs(X,{variant:"outline",children:[i.completedThisWeek,"/",i.weeklyTarget]})]}),s.jsx(Hn,{value:e,className:"h-3"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[i.weeklyTarget-i.completedThisWeek," more deliveries to reach weekly target"]})]})})]})]})},Lr=class Lr{constructor(){ze(this,"subscribers",new Map);ze(this,"locationUpdateInterval",null)}static getInstance(){return Lr.instance||(Lr.instance=new Lr),Lr.instance}calculateDistance(e,t,r,a){const c=(r-e)*Math.PI/180,u=(a-t)*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2);return 6371*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))}setAgentLocation(e,t,r){const a=this.getDeliveryAgents(),l=a.findIndex(c=>c.id===e);l>=0?a[l]={...a[l],currentLat:t,currentLng:r,isActive:!0,lastUpdate:new Date().toISOString()}:a.push({id:e,name:`Agent ${e}`,phone:`+91 ${Math.floor(Math.random()*9e9)+1e9}`,currentLat:t,currentLng:r,isActive:!0,lastUpdate:new Date().toISOString()}),localStorage.setItem("deliveryAgents",JSON.stringify(a)),this.notifySubscribers("agentLocationUpdate",{agentId:e,lat:t,lng:r})}getDeliveryAgents(){return JSON.parse(localStorage.getItem("deliveryAgents")||"[]")}findNearbyOrders(e){const r=this.getDeliveryAgents().find(c=>c.id===e);if(!r)return[];const a=JSON.parse(localStorage.getItem("allOrders")||"[]"),l=[];return a.forEach(c=>{var u,h;if(c.status==="out_for_delivery"&&c.customerAddress){const f=((u=c.customerAddress.coordinates)==null?void 0:u.lat)||21.3099,p=((h=c.customerAddress.coordinates)==null?void 0:h.lng)||75.1178,g=this.calculateDistance(r.currentLat,r.currentLng,f,p);l.push({orderId:c.orderId,customerLat:f,customerLng:p,customerAddress:c.customerAddress.address,customerName:c.customerAddress.name,customerPhone:c.customerAddress.phone,total:c.total,distance:g,status:c.status})}}),l}acceptOrder(e,t){console.log(` Agent ${e} accepting order ${t}`);const a=this.getDeliveryAgents().find(u=>u.id===e);if(!a)return console.error("Agent not found:",e),!1;let l=JSON.parse(localStorage.getItem("allOrders")||"[]"),c=l.findIndex(u=>u.orderId===t);if(c<0){const u={orderId:t,status:"accepted",customerAddress:{name:"Mock Customer",address:"123 Test Street, Shirpur",phone:"9876543210",coordinates:{lat:21.3099,lng:75.1178}},total:250,items:[{name:"Test Product",quantity:1,price:250}],timestamp:new Date().toISOString()};l.push(u),c=l.length-1}return l[c].status="accepted",l[c].deliveryAgent={id:e,name:a.name,phone:a.phone,location:{lat:a.currentLat,lng:a.currentLng,timestamp:new Date().toISOString()}},localStorage.setItem("allOrders",JSON.stringify(l)),localStorage.setItem("currentOrder",JSON.stringify(l[c])),console.log(" Order accepted successfully:",l[c]),this.notifySubscribers("orderAccepted",{orderId:t,agentId:e}),this.startLiveTracking(t,e),window.dispatchEvent(new CustomEvent("deliveryNotificationCreated",{detail:{type:"success",message:`Order ${t} accepted! GPS tracking started.`,orderId:t}})),!0}startLiveTracking(e,t){this.locationUpdateInterval&&clearInterval(this.locationUpdateInterval),this.locationUpdateInterval=setInterval(()=>{this.updateAgentLocationForOrder(e,t)},3e3)}updateAgentLocationForOrder(e,t){var l,c,u,h;const r=JSON.parse(localStorage.getItem("allOrders")||"[]"),a=r.findIndex(f=>f.orderId===e);if(a>=0&&r[a].status==="accepted"){const p=this.getDeliveryAgents().find(g=>g.id===t);if(p){const g=((c=(l=r[a].customerAddress)==null?void 0:l.coordinates)==null?void 0:c.lat)||21.3099,y=((h=(u=r[a].customerAddress)==null?void 0:u.coordinates)==null?void 0:h.lng)||75.1178,_=this.calculateDistance(p.currentLat,p.currentLng,g,y);if(_<.1){console.log(" Agent reached customer location!");return}const P=.02,b=p.currentLat+(g-p.currentLat)*P,j=p.currentLng+(y-p.currentLng)*P;this.setAgentLocation(t,b,j),r[a].deliveryAgent.location={lat:b,lng:j,timestamp:new Date().toISOString(),distanceToCustomer:_},localStorage.setItem("allOrders",JSON.stringify(r));const S=JSON.parse(localStorage.getItem("currentOrder")||"{}");S.orderId===e&&(S.deliveryAgent.location=r[a].deliveryAgent.location,localStorage.setItem("currentOrder",JSON.stringify(S))),console.log(` Agent moving: ${_.toFixed(2)}km to customer`),this.notifySubscribers("liveLocationUpdate",{orderId:e,agentId:t,lat:b,lng:j,distance:_})}}}markAsDelivered(e){const t=JSON.parse(localStorage.getItem("allOrders")||"[]"),r=t.findIndex(a=>a.orderId===e);if(r>=0){t[r].status="delivered",localStorage.setItem("allOrders",JSON.stringify(t));const a=JSON.parse(localStorage.getItem("currentOrder")||"{}");a.orderId===e&&(a.status="delivered",localStorage.setItem("currentOrder",JSON.stringify(a))),this.locationUpdateInterval&&(clearInterval(this.locationUpdateInterval),this.locationUpdateInterval=null),this.notifySubscribers("orderDelivered",{orderId:e})}}subscribe(e,t){this.subscribers.has(e)||this.subscribers.set(e,[]),this.subscribers.get(e).push(t)}unsubscribe(e,t){const r=this.subscribers.get(e);if(r){const a=r.indexOf(t);a>-1&&r.splice(a,1)}}notifySubscribers(e,t){const r=this.subscribers.get(e);r&&r.forEach(a=>a(t))}};ze(Lr,"instance");let sc=Lr;const Gt=sc.getInstance(),W1=()=>{var _,P,b,j;const i=Is(),[e,t]=v.useState([]),[r,a]=v.useState([]),[l,c]=v.useState([]),[u,h]=v.useState(!0),[f]=v.useState("agent-001"),[p,g]=v.useState({activeTasks:0,availableOrders:0,todaysEarnings:0,completionRate:95});v.useEffect(()=>{let S=!0;(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(O=>{if(S){const E={lat:O.coords.latitude,lng:O.coords.longitude};console.log(" Real GPS Location:",E),Gt.setAgentLocation(f,E.lat,E.lng),localStorage.setItem("agentRealLocation",JSON.stringify({...E,timestamp:new Date().toISOString()}))}},O=>{console.error("GPS Error:",O),S&&Gt.setAgentLocation(f,21.3486,74.8811)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}):(console.warn("Geolocation not supported"),Gt.setAgentLocation(f,21.3486,74.8811))})();const N=async()=>{if(S)try{const O=JSON.parse(localStorage.getItem("deliveryTasks")||"[]");O.length>0&&(t(O),g(Ps.getDeliveryMetrics(O)),h(!1));const E=await Ps.getAvailableDeliveries();S&&(t(E),g(Ps.getDeliveryMetrics(E)),localStorage.setItem("deliveryTasks",JSON.stringify(E)));const I=Gt.findNearbyOrders(f);S&&a(I)}catch(O){console.error("Failed to load delivery data:",O)}finally{S&&h(!1)}};N();const T=()=>{S&&(console.log(" Order status changed, refreshing delivery data"),N())};return window.addEventListener("deliveryNotificationCreated",T),window.addEventListener("orderAccepted",T),window.addEventListener("ordersUpdated",T),Gt.subscribe("orderAccepted",T),()=>{S=!1,window.removeEventListener("deliveryNotificationCreated",T),window.removeEventListener("orderAccepted",T),window.removeEventListener("ordersUpdated",T),Gt.unsubscribe("orderAccepted",T)}},[f]);const y=async S=>{try{if(console.log(` Accepting delivery for order: ${S}`),Gt.acceptOrder(f,S)){console.log(" Order accepted successfully");const N=await Ps.getAvailableDeliveries();t(N),g(Ps.getDeliveryMetrics(N));const T=Gt.findNearbyOrders(f);a(T);const E=JSON.parse(localStorage.getItem("allOrders")||"[]").filter(B=>{var W;return B.status==="accepted"&&((W=B.deliveryAgent)==null?void 0:W.id)===f});c(E);const q=JSON.parse(localStorage.getItem("allOrders")||"[]").filter(B=>{var W;return B.status==="accepted"&&((W=B.deliveryAgent)==null?void 0:W.id)===f});c(q),i("/delivery/tracking")}else console.error(" Failed to accept order"),alert(" Failed to accept order. Please try again.")}catch(k){console.error("Error accepting delivery:",k),alert(" Error accepting delivery. Please try again.")}};return u?s.jsx(Ec,{type:"delivery",message:"Loading delivery tasks..."}):s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-orange-600 text-white p-4 sm:p-6 shadow-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(it,{className:"h-8 w-8"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"My Delivery Tasks"}),s.jsx("p",{className:"text-blue-100 mt-1",children:"Manage your deliveries and track earnings"})]})]}),s.jsx(D,{variant:"outline",className:"bg-white/20 text-white border-white/30 hover:bg-white/30",onClick:async()=>{console.log(" Refreshing delivery data...");const S=await Ps.getAvailableDeliveries();t(S),g(Ps.getDeliveryMetrics(S));const k=Gt.findNearbyOrders(f);a(k)},children:" Refresh"})]})}),s.jsxs("div",{className:"p-3 md:p-6 space-y-4 md:space-y-6",children:[s.jsx(Ac,{}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"Performance Dashboard"}),s.jsx(H1,{})]}),s.jsxs(U,{className:"mb-6",children:[s.jsx(ne,{children:s.jsx(ie,{children:"Quick Stats"})}),s.jsx(z,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Avg Delivery Time"}),s.jsx("span",{className:"font-semibold",children:"28 min"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Customer Rating"}),s.jsx("span",{className:"font-semibold",children:"4.8 "})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Weekly Earnings"}),s.jsx("span",{className:"font-semibold text-green-600",children:"4,250"})]})]})})]}),s.jsxs(U,{className:"mb-6 border-l-4 border-l-blue-500",children:[s.jsx(ne,{className:"pb-3",children:s.jsxs(ie,{className:"text-lg flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),"System Status - Live Data"]})}),s.jsx(z,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[s.jsx("p",{className:"font-semibold text-blue-800",children:"Agent GPS"}),s.jsx("p",{className:"text-blue-600",children:(()=>{var k;const S=JSON.parse(localStorage.getItem("agentRealLocation")||"null");return S?` ${S.lat.toFixed(4)}, ${S.lng.toFixed(4)}`:(k=e[0])!=null&&k.agentLocation?`${e[0].agentLocation.lat.toFixed(4)}, ${e[0].agentLocation.lng.toFixed(4)}`:"Getting location..."})()}),s.jsx("p",{className:"text-xs text-blue-500 mt-1",children:((P=(_=e[0])==null?void 0:_.debugInfo)==null?void 0:P.lastUpdate)||"No updates"})]}),s.jsxs("div",{className:"bg-green-50 p-3 rounded",children:[s.jsx("p",{className:"font-semibold text-green-800",children:"Orders Available"}),s.jsx("p",{className:"text-green-600 text-xl font-bold",children:e.length}),s.jsx("p",{className:"text-xs text-green-500 mt-1",children:"Out for delivery status"})]}),s.jsxs("div",{className:"bg-orange-50 p-3 rounded",children:[s.jsx("p",{className:"font-semibold text-orange-800",children:"Total Orders"}),s.jsx("p",{className:"text-orange-600 text-xl font-bold",children:((j=(b=e[0])==null?void 0:b.debugInfo)==null?void 0:j.totalOrders)||0}),s.jsx("p",{className:"text-xs text-orange-500 mt-1",children:"All statuses combined"})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2 md:gap-4",children:[s.jsx(U,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:s.jsx(z,{className:"p-3 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-100 text-xs md:text-sm font-medium",children:"Active Tasks"}),s.jsx("p",{className:"text-xl md:text-3xl font-bold mt-1",children:p.activeTasks})]}),s.jsx(xe,{className:"h-6 w-6 md:h-8 md:w-8 text-blue-200"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:s.jsx(z,{className:"p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Today's Earnings"}),s.jsxs("p",{className:"text-2xl sm:text-3xl font-bold mt-1",children:["",p.todaysEarnings]})]}),s.jsx(Wr,{className:"h-8 w-8 text-green-200"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:s.jsx(z,{className:"p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"Completion Rate"}),s.jsxs("p",{className:"text-2xl sm:text-3xl font-bold mt-1",children:[p.completionRate,"%"]})]}),s.jsx(pr,{className:"h-8 w-8 text-purple-200"})]})})}),s.jsx(U,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300",children:s.jsx(z,{className:"p-4 sm:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Performance"}),s.jsx("p",{className:"text-2xl sm:text-3xl font-bold mt-1",children:""})]}),s.jsx(Xt,{className:"h-8 w-8 text-orange-200"})]})})})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"My Pending Deliveries"}),s.jsx(X,{variant:"secondary",className:"bg-orange-100 text-orange-700",children:l.length})]}),l.length===0?s.jsx(U,{className:"border-2 border-dashed border-gray-200",children:s.jsxs(z,{className:"p-8 text-center",children:[s.jsx(xe,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No pending deliveries"}),s.jsx("p",{className:"text-gray-500",children:"Accepted orders will appear here"})]})}):s.jsx("div",{className:"grid gap-4",children:l.map(S=>s.jsx(U,{className:"hover:shadow-lg transition-all duration-300 border-0 shadow-md bg-orange-50 border-l-4 border-l-orange-500",children:s.jsxs(z,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Order #",S.orderId]}),s.jsx(X,{className:"bg-orange-500 text-white mt-1",children:"Accepted - Ready to Deliver"})]}),s.jsx("div",{className:"text-right",children:s.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["",S.total.toFixed(0)]})})]}),s.jsxs("div",{className:"bg-white p-3 rounded-lg mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Fe,{className:"w-4 h-4 text-red-500"}),s.jsx("span",{className:"font-semibold text-gray-700",children:"Customer Details"})]}),s.jsx("p",{className:"text-sm font-medium text-gray-800",children:S.customerAddress.name}),s.jsx("p",{className:"text-sm text-gray-600",children:S.customerAddress.address}),s.jsx("p",{className:"text-sm text-gray-600",children:S.customerAddress.phone})]}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(xe,{className:"w-4 h-4 text-blue-500"}),s.jsx("span",{className:"font-semibold text-blue-700",children:"Order Items"})]}),S.items.slice(0,2).map((k,N)=>s.jsxs("p",{className:"text-sm text-blue-600",children:[k.quantity,"x ",k.product.name," - ",k.product.price]},N)),S.items.length>2&&s.jsxs("p",{className:"text-xs text-blue-500",children:["+",S.items.length-2," more items"]})]}),s.jsxs(D,{className:"w-full bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 shadow-md",onClick:()=>{localStorage.setItem("currentOrder",JSON.stringify(S)),i("/delivery/tracking")},children:[s.jsx(Ut,{className:"w-4 h-4 mr-2"}),"Start Route for Delivery"]})]})},S.orderId))})]}),s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Available Orders (Within 10km)"}),s.jsx(X,{variant:"secondary",className:"bg-green-100 text-green-700",children:r.length})]}),r.length===0?s.jsx(U,{className:"border-2 border-dashed border-gray-200",children:s.jsxs(z,{className:"p-8 text-center",children:[s.jsx(Fe,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No nearby orders"}),s.jsx("p",{className:"text-gray-500",children:"Orders within 10km will appear here"})]})}):s.jsx("div",{className:"grid gap-4",children:r.map(S=>s.jsx(U,{className:"hover:shadow-lg transition-all duration-300 border-0 shadow-md bg-green-50 border-l-4 border-l-green-500",children:s.jsxs(z,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Order #",S.orderId]}),s.jsx(X,{className:"bg-green-500 text-white mt-1",children:"Nearby Order"})]}),s.jsx("div",{className:"text-right",children:s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",S.total.toFixed(0)]})})]}),s.jsxs("div",{className:"bg-white p-3 rounded-lg mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Fe,{className:"w-4 h-4 text-red-500"}),s.jsx("span",{className:"font-semibold text-gray-700",children:"Customer Details"})]}),s.jsx("p",{className:"text-sm font-medium text-gray-800",children:S.customerName}),s.jsx("p",{className:"text-sm text-gray-600",children:S.customerAddress}),s.jsx("p",{className:"text-sm text-gray-600",children:S.customerPhone})]}),s.jsxs(D,{className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 shadow-md",onClick:()=>y(S.orderId),children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"Accept Delivery"]})]})},S.orderId))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"All Available Tasks"}),s.jsx(X,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:e.length})]}),e.length===0?s.jsx(U,{className:"border-2 border-dashed border-gray-200",children:s.jsxs(z,{className:"p-8 text-center",children:[s.jsx(xe,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No tasks available"}),s.jsx("p",{className:"text-gray-500",children:"New delivery tasks will appear here when available"})]})}):s.jsx("div",{className:"grid gap-4",children:e.map(S=>{var k,N,T;return s.jsx(U,{className:"hover:shadow-lg transition-all duration-300 border-0 shadow-md bg-white/80 backdrop-blur-sm border-l-4 border-l-blue-500",children:s.jsxs(z,{className:"p-4 sm:p-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4 mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Order #",S.order_id||S.orderId]}),s.jsx(X,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white border-0",children:"Ready for Pickup"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Fe,{className:"w-4 h-4 text-red-500"}),s.jsx("span",{className:"font-semibold text-gray-700",children:"Customer Details"})]}),s.jsx("p",{className:"text-sm font-medium text-gray-800",children:S.customer_name||((k=S.customerAddress)==null?void 0:k.name)}),s.jsx("p",{className:"text-sm text-gray-600",children:S.customer_address||((N=S.customerAddress)==null?void 0:N.address)}),s.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:[" ",S.customer_phone]})]}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Ut,{className:"w-4 h-4 text-blue-500"}),s.jsx("span",{className:"font-semibold text-blue-700",children:"Distance & Location"})]}),s.jsxs("p",{className:"text-sm text-blue-600",children:["Distance: ",(T=S.distance)==null?void 0:T.toFixed(2)," km"]}),s.jsxs("p",{className:"text-sm text-blue-600",children:["ETA: ~",Math.round((S.distance||0)*3)," minutes"]}),s.jsx("p",{className:"text-xs text-blue-500 mt-1",children:"From your GPS location"})]}),S.items&&s.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(xe,{className:"w-4 h-4 text-orange-500"}),s.jsxs("span",{className:"font-semibold text-orange-700",children:["Items (",S.items.length,")"]})]}),S.items.slice(0,2).map((O,E)=>s.jsxs("p",{className:"text-sm text-orange-600",children:[O.quantity,"x ",O.product.name]},E)),S.items.length>2&&s.jsxs("p",{className:"text-xs text-orange-500",children:["+",S.items.length-2," more items"]})]})]})]}),s.jsxs("div",{className:"text-right bg-green-50 p-4 rounded-lg",children:[s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",S.total.toFixed(0)]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Order Value"}),s.jsxs("div",{className:"mt-2 pt-2 border-t border-green-200",children:[s.jsxs("p",{className:"text-lg font-bold text-green-700",children:["",S.estimatedEarning]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Your Earning (15%)"})]}),s.jsxs("div",{className:"mt-2 pt-2 border-t border-green-200",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Status: Out for Delivery"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Admin Approved"})]})]})]}),s.jsx("div",{className:"flex gap-3",children:s.jsxs(D,{className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 shadow-md",onClick:()=>y(S.orderId),children:[s.jsx(xe,{className:"w-4 h-4 mr-2"}),"Accept & Start GPS Tracking"]})})]})},S.id)})})]})]})]})},V1=({orderId:i,agentId:e})=>{const{toast:t}=Et(),[r,a]=v.useState(!1),[l,c]=v.useState(null),[u,h]=v.useState(null);v.useEffect(()=>{const _=JSON.parse(localStorage.getItem("customerOrders")||"[]").find(b=>b.orderId===i);return h(_),localStorage.getItem(`tracking_${i}`)==="active"&&(a(!0),Mr.startAgentTracking(i,e)),()=>{r&&Mr.stopTracking()}},[i,e]);const f=()=>{Mr.startAgentTracking(i,e),a(!0),localStorage.setItem(`tracking_${i}`,"active"),t({title:"Live Tracking Started",description:"Your location is now being shared with the customer"})},p=()=>{Mr.stopTracking(),a(!1),localStorage.removeItem(`tracking_${i}`),t({title:"Tracking Stopped",description:"Location sharing has been disabled"})},g=()=>{const y=JSON.parse(localStorage.getItem("customerOrders")||"[]"),_=y.findIndex(P=>P.orderId===i);_>=0&&(y[_].status="delivered",y[_].deliveredAt=new Date().toISOString(),localStorage.setItem("customerOrders",JSON.stringify(y))),p(),t({title:"Order Delivered!",description:"Order has been marked as delivered successfully"})};return u?s.jsxs("div",{className:"space-y-4",children:[s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center justify-between",children:[s.jsxs("span",{children:["Order #",i]}),s.jsx(X,{className:r?"bg-green-500":"bg-gray-500",children:r?" Live Tracking":" Offline"})]})}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:u.customerName}),s.jsx("p",{className:"text-sm text-gray-600",children:u.customerPhone})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:"Delivery Address:"}),s.jsx("p",{className:"text-sm text-gray-600",children:u.deliveryAddress})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Total Amount:"}),s.jsxs("span",{className:"font-bold",children:["",u.total]})]})]})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center space-x-2",children:[s.jsx(Ut,{className:"w-5 h-5"}),s.jsx("span",{children:"Live Tracking"})]})}),s.jsx(z,{children:s.jsx("div",{className:"space-y-4",children:r?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-green-700 font-medium",children:"Sharing location with customer"})]}),s.jsx(D,{onClick:p,variant:"outline",className:"w-full",children:"Stop Tracking"})]}):s.jsxs(D,{onClick:f,className:"w-full bg-green-500 hover:bg-green-600",children:[s.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Start Live Tracking"]})})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Quick Actions"})}),s.jsx(z,{children:s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(D,{variant:"outline",className:"flex-1",children:[s.jsx(Gs,{className:"w-4 h-4 mr-2"}),"Call Customer"]}),s.jsxs(D,{onClick:g,className:"flex-1 bg-green-500 hover:bg-green-600",children:[s.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Mark Delivered"]})]})})]}),r&&s.jsx(U,{children:s.jsx(z,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-sm",children:"Location updates every 10 seconds"})]}),s.jsx(dt,{className:"w-4 h-4 text-gray-500"})]})})})]}):s.jsx(U,{children:s.jsx(z,{className:"p-6 text-center",children:s.jsx("p",{children:"Loading order details..."})})})},Z1=()=>{var j,S;const{taskId:i}=zm(),e=Is(),{toast:t}=Et(),[r,a]=v.useState(""),[l,c]=v.useState(!1),[u,h]=v.useState(!1),[f,p]=v.useState(null),[g,y]=v.useState(null),_=ja.find(k=>k.id===i);if(v.useEffect(()=>()=>{g!==null&&navigator.geolocation.clearWatch(g)},[g]),!_)return s.jsx("div",{className:"container mx-auto px-4 py-8",children:"Task not found"});const P=()=>{g!==null&&(navigator.geolocation.clearWatch(g),y(null)),h(!1),p(null),t({title:"Delivery stopped",description:"Location tracking has been disabled."})},b=async()=>{c(!0);try{await wt.completeDelivery(_.order_id,r)?(P(),t({title:"Delivery Completed!",description:"Order has been successfully delivered. Customer notified automatically."}),pt.sendOrderStatusNotification(_.order_id,"delivered","delivery"),setTimeout(()=>{e("/delivery")},1500)):t({title:"Invalid OTP",description:"Please enter the correct 6-digit OTP from the customer.",variant:"destructive"})}catch(k){console.error("Delivery completion error:",k),t({title:"Error",description:"Failed to complete delivery. Please try again.",variant:"destructive"})}finally{c(!1)}};return s.jsx("div",{className:"container mx-auto px-4 py-4 md:py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-4 md:space-y-6",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4 md:mb-6 gap-3",children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Delivery Task"}),s.jsx(D,{variant:"outline",onClick:()=>e("/delivery"),size:"sm",children:"Back to Tasks"})]}),s.jsxs(U,{children:[s.jsx(ne,{className:"p-4 md:p-6",children:s.jsxs(ie,{className:"flex items-center text-base md:text-lg",children:[s.jsx(Fe,{className:"w-4 h-4 md:w-5 md:h-5 mr-2"}),"Order #",_.order_id]})}),s.jsx(z,{className:"p-4 md:p-6 pt-0 space-y-3 md:space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2 text-sm md:text-base",children:"Customer Details"}),s.jsxs("div",{className:"space-y-1 text-xs md:text-sm",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Name:"})," ",_.customer_name]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Phone:"}),s.jsx("a",{href:`tel:${_.customer_phone}`,className:"text-blue-600 hover:underline ml-1",children:_.customer_phone||"N/A"})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Address:"})," ",_.customer_address]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2 text-sm md:text-base",children:"Order Details"}),s.jsxs("div",{className:"space-y-1 text-xs md:text-sm",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Total:"})," ",((j=_.total_amount)==null?void 0:j.toFixed(2))||"0.00"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Items:"})," ",((S=_.items)==null?void 0:S.length)||0," items"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Payment:"}),s.jsx("span",{className:"ml-1 px-2 py-1 rounded text-xs bg-green-100 text-green-800",children:"PAID"})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Status:"}),s.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${_.status==="accepted"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:_.status.toUpperCase()})]})]})]})]})})]}),s.jsx(V1,{orderId:_.order_id,agentId:"agent_001"}),s.jsxs(U,{children:[s.jsx(ne,{className:"p-4 md:p-6",children:s.jsx(ie,{className:"text-base md:text-lg",children:"Delivery Verification"})}),s.jsxs(z,{className:"p-4 md:p-6 pt-0 space-y-3 md:space-y-4",children:[s.jsxs("div",{children:[s.jsx(Ze,{htmlFor:"otp",className:"text-sm",children:"Enter 6-digit OTP from customer"}),s.jsx(nt,{id:"otp",type:"text",placeholder:"Enter OTP",value:r,onChange:k=>a(k.target.value),maxLength:6,className:"text-center text-base md:text-lg font-mono"})]}),s.jsx(D,{onClick:b,disabled:r.length!==6||l,className:"w-full bg-green-500 hover:bg-green-600 text-sm md:text-base",size:"sm",children:l?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-3 h-3 md:w-4 md:h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Verifying..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Qt,{className:"w-3 h-3 md:w-4 md:h-4 mr-2"}),"Complete Delivery"]})}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[s.jsx("p",{className:"text-xs md:text-sm text-blue-800 text-center font-medium",children:" Ask the customer for their 6-digit OTP to confirm delivery"}),s.jsx("p",{className:"text-xs text-blue-600 text-center mt-1",children:"The OTP was sent to them via WhatsApp and SMS when the order was placed"})]})]})]})]})})},G1=()=>{const[i,e]=v.useState([]),[t,r]=v.useState(!0),[a,l]=v.useState(""),{toast:c}=Et();v.useEffect(()=>{let p=!0;const g=()=>{if(p)try{const P=JSON.parse(localStorage.getItem("deliveryNotifications")||"[]").filter(j=>j.status==="pending"),b=JSON.stringify(P);b!==a&&(e(P),l(b)),r(!1)}catch(_){console.error("Failed to load notifications:",_),r(!1)}};g();const y=()=>{p&&(console.log(" New delivery notification received"),g())};return window.addEventListener("deliveryNotificationCreated",y),window.addEventListener("deliveryNotificationsUpdated",y),()=>{p=!1,window.removeEventListener("deliveryNotificationCreated",y),window.removeEventListener("deliveryNotificationsUpdated",y)}},[a]);const u=async p=>{const g=ms.generateDeliveryAgent();await wt.acceptOrder(p.orderId,g)?(c({title:"Order Accepted!",description:`Order ${p.orderId} has been assigned to you.`}),pt.sendOrderStatusNotification(p.orderId,"out_for_delivery","delivery"),e(_=>_.filter(P=>P.id!==p.id))):c({title:"Error",description:"Failed to accept order. Please try again.",variant:"destructive"})},h=async p=>{const g=ms.generateDeliveryAgent();await wt.rejectOrder(p.orderId,g,"Not available")&&(c({title:"Order Rejected",description:"Order will be offered to other delivery partners."}),e(_=>_.filter(P=>P.id!==p.id)))},f=(p,g,y,_)=>{const b=(y-p)*Math.PI/180,j=(_-g)*Math.PI/180,S=Math.sin(b/2)*Math.sin(b/2)+Math.cos(p*Math.PI/180)*Math.cos(y*Math.PI/180)*Math.sin(j/2)*Math.sin(j/2);return 6371*(2*Math.atan2(Math.sqrt(S),Math.sqrt(1-S)))};return s.jsxs("div",{className:"container mx-auto px-4 py-4 md:py-8",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-4 md:mb-6",children:[s.jsx(Br,{className:"w-6 h-6 md:w-8 md:h-8 text-primary"}),s.jsx("h1",{className:"text-xl md:text-3xl font-bold",children:"New Delivery Requests"}),i.length>0&&s.jsx(X,{className:"bg-red-500 text-white text-xs",children:i.length})]}),t?s.jsx(U,{children:s.jsxs(z,{className:"p-6 md:p-8 text-center",children:[s.jsx("div",{className:"loading-spinner mx-auto mb-4"}),s.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-2",children:"Loading Notifications"}),s.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"Checking for new delivery requests..."})]})}):i.length===0?s.jsx(U,{children:s.jsxs(z,{className:"p-6 md:p-8 text-center",children:[s.jsx(Br,{className:"w-12 h-12 md:w-16 md:h-16 text-muted-foreground mx-auto mb-3 md:mb-4"}),s.jsx("h3",{className:"text-lg md:text-xl font-semibold mb-2",children:"No New Orders"}),s.jsx("p",{className:"text-sm md:text-base text-muted-foreground",children:"You're all caught up! New delivery requests will appear here with real-time notifications."}),s.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:s.jsx("p",{className:"text-xs md:text-sm text-green-700",children:" Orders within 10km radius will be automatically sent to you"})})]})}):s.jsxs("div",{className:"space-y-3 md:space-y-4",children:[s.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200 mb-4",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[" ",s.jsx("strong",{children:"Real-time notifications enabled"})," - You'll be notified instantly when new orders are available in your area."]})}),i.map(p=>{const g=f(20.7516,74.2297,p.customerLocation.lat,p.customerLocation.lng);return s.jsxs(U,{className:"border-l-4 border-l-primary animate-pulse-border",children:[s.jsx(ne,{className:"p-4 md:p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(ie,{className:"flex items-center space-x-2 text-base md:text-lg",children:[s.jsx(Br,{className:"w-4 h-4 md:w-5 md:h-5 text-red-500 animate-bounce"}),s.jsxs("span",{children:["New Order #",p.orderId]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs(X,{className:"bg-green-500 text-white text-xs md:text-sm",children:["",p.orderValue.toFixed(2)]}),s.jsx(X,{className:"bg-red-500 text-white text-xs animate-pulse",children:"URGENT"})]})]})}),s.jsxs(z,{className:"p-4 md:p-6 pt-0 space-y-3 md:space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Fe,{className:"w-3 h-3 md:w-4 md:h-4 text-green-600"}),s.jsxs("span",{className:"text-xs md:text-sm font-medium text-green-600",children:[g.toFixed(1)," km away"]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(dt,{className:"w-3 h-3 md:w-4 md:h-4 text-blue-600"}),s.jsxs("span",{className:"text-xs md:text-sm text-blue-600",children:["~",Math.round(g*3)," min"]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(xe,{className:"w-3 h-3 md:w-4 md:h-4 text-orange-600"}),s.jsxs("span",{className:"text-xs md:text-sm text-orange-600",children:[p.items.length," items"]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2 text-sm md:text-base",children:"Delivery Address:"}),s.jsxs("p",{className:"text-xs md:text-sm text-muted-foreground leading-relaxed",children:[p.customerAddress.name,s.jsx("br",{}),p.customerAddress.address,s.jsx("br",{}),"Phone: ",p.customerAddress.phone]})]}),s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-2 text-sm md:text-base",children:["Items (",p.items.length,"):"]}),s.jsxs("div",{className:"space-y-1",children:[p.items.slice(0,3).map((y,_)=>s.jsxs("p",{className:"text-xs md:text-sm text-muted-foreground",children:[y.quantity,"x ",y.product.name," - ",(y.product.price*y.quantity).toFixed(2)]},_)),p.items.length>3&&s.jsxs("p",{className:"text-xs md:text-sm text-muted-foreground",children:["+",p.items.length-3," more items"]})]})]}),s.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:[s.jsx("p",{className:"text-xs md:text-sm text-yellow-800 font-medium mb-2",children:" Quick Response Required - Customer is waiting!"}),s.jsxs("div",{className:"flex flex-col space-y-2 md:flex-row md:space-y-0 md:space-x-3",children:[s.jsxs(D,{onClick:()=>u(p),className:"flex-1 bg-green-500 hover:bg-green-600 text-sm font-semibold",size:"sm",children:[s.jsx(Qt,{className:"w-3 h-3 md:w-4 md:h-4 mr-2"}),"Accept & Start Delivery"]}),s.jsxs(D,{onClick:()=>h(p),variant:"outline",className:"flex-1 text-red-600 border-red-600 hover:bg-red-50 text-sm",size:"sm",children:[s.jsx(ps,{className:"w-3 h-3 md:w-4 md:h-4 mr-2"}),"Not Available"]})]})]})]})]},p.id)})]})]})},J1=()=>{var b,j,S,k;const[i,e]=v.useState(null),[t,r]=v.useState({lat:21.3486,lng:74.8811}),[a,l]=v.useState({lat:21.3099,lng:75.1178}),[c,u]=v.useState("Getting location..."),[h,f]=v.useState([]),[p,g]=v.useState(!1),y=(N,T,O,E)=>{const q=(O-N)*Math.PI/180,B=(E-T)*Math.PI/180,W=Math.sin(q/2)*Math.sin(q/2)+Math.cos(N*Math.PI/180)*Math.cos(O*Math.PI/180)*Math.sin(B/2)*Math.sin(B/2);return 6371*(2*Math.atan2(Math.sqrt(W),Math.sqrt(1-W)))},_=async(N,T)=>{try{if(!(await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${N}+${T}&key=YOUR_API_KEY&language=en&pretty=1`)).ok){const E=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${N}&lon=${T}&zoom=18&addressdetails=1`);if(E.ok){const q=(await E.json()).display_name||`${N.toFixed(4)}, ${T.toFixed(4)}`;u(` ${q.split(",").slice(0,3).join(", ")}`)}else u(` ${N.toFixed(4)}, ${T.toFixed(4)}`)}}catch(O){console.error("Reverse geocoding failed:",O),u(` ${N.toFixed(4)}, ${T.toFixed(4)}`)}};v.useEffect(()=>{var I,q;const N=JSON.parse(localStorage.getItem("currentOrder")||"{}");N.orderId&&(e(N),(I=N.customerAddress)!=null&&I.coordinates&&l({lat:N.customerAddress.coordinates.lat,lng:N.customerAddress.coordinates.lng}),(q=N.deliveryAgent)!=null&&q.location&&r({lat:N.deliveryAgent.location.lat,lng:N.deliveryAgent.location.lng}));const T=B=>{r({lat:B.lat,lng:B.lng}),f(W=>[...W,[B.lat,B.lng]])};Gt.subscribe("liveLocationUpdate",T);const E=(()=>{if(navigator.geolocation){navigator.geolocation.getCurrentPosition(W=>{const J={lat:W.coords.latitude,lng:W.coords.longitude};r(J),f(V=>[...V,[J.lat,J.lng]]),_(J.lat,J.lng)},W=>{console.error("GPS Error:",W),u("GPS not available")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4});const B=navigator.geolocation.watchPosition(W=>{const J={lat:W.coords.latitude,lng:W.coords.longitude};r(J),f(V=>[...V,[J.lat,J.lng]]),_(J.lat,J.lng)},W=>{console.error("GPS Watch Error:",W)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:3e4});return()=>navigator.geolocation.clearWatch(B)}else u("GPS not supported")})();return()=>{Gt.unsubscribe("liveLocationUpdate",T),E&&E()}},[p]);const P=()=>{i!=null&&i.orderId&&(Gt.markAsDelivered(i.orderId),g(!0),alert(" Order marked as delivered!"))};return i!=null&&i.orderId?s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-green-600 text-white p-4 shadow-lg",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ut,{className:"h-8 w-8"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"GPS Tracking"}),s.jsxs("p",{className:"text-blue-100",children:["Order #",i.orderId]})]})]}),s.jsx(X,{className:`${p?"bg-green-500":"bg-orange-500"} text-white`,children:p?"Delivered":"In Transit"})]})}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs(U,{children:[s.jsx(ne,{children:s.jsxs(ie,{className:"flex items-center gap-2",children:[s.jsx(Fe,{className:"h-5 w-5 text-red-500"}),"Customer Details"]})}),s.jsx(z,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"font-semibold",children:(b=i.customerAddress)==null?void 0:b.name}),s.jsx("p",{className:"text-gray-600",children:(j=i.customerAddress)==null?void 0:j.address}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Gs,{className:"h-4 w-4 text-blue-500"}),s.jsx("span",{className:"text-blue-600",children:(S=i.customerAddress)==null?void 0:S.phone})]}),s.jsxs("p",{className:"text-lg font-bold text-green-600",children:["",i.total]})]})})]}),s.jsxs(U,{children:[s.jsx(ne,{children:s.jsx(ie,{children:"Live GPS Tracking"})}),s.jsx(z,{children:s.jsxs("div",{className:"bg-gray-100 rounded-lg p-6 text-center",children:[s.jsx(Iv,{className:"h-16 w-16 mx-auto text-blue-500 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"GPS Tracking Active"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[s.jsxs("div",{className:"bg-blue-50 p-3 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{className:"text-sm font-semibold",children:"Your Location"})]}),s.jsx("p",{className:"text-xs text-gray-600",children:c})]}),s.jsxs("div",{className:"bg-red-50 p-3 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),s.jsx("span",{className:"text-sm font-semibold",children:"Customer"})]}),s.jsxs("p",{className:"text-xs text-gray-600",children:[" ",((k=i==null?void 0:i.customerAddress)==null?void 0:k.address)||"Customer Location"]})]})]}),s.jsxs("div",{className:"mt-4 p-3 bg-green-50 rounded",children:[s.jsxs("p",{className:"text-sm text-green-700",children:[" Distance: ",y(t.lat,t.lng,a.lat,a.lng).toFixed(2)," km"]}),s.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["ETA: ~",Math.round(y(t.lat,t.lng,a.lat,a.lng)*3)," minutes"]})]}),s.jsxs(D,{className:"mt-4 w-full bg-blue-500 hover:bg-blue-600",onClick:()=>window.open(`https://www.google.com/maps/dir/${t.lat},${t.lng}/${a.lat},${a.lng}`,"_blank"),children:[s.jsx(Ut,{className:"w-4 h-4 mr-2"}),"Open in Google Maps"]})]})})]}),!p&&s.jsxs(D,{onClick:P,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white py-3",size:"lg",children:[s.jsx(Qt,{className:"w-5 h-5 mr-2"}),"Mark as Delivered"]}),p&&s.jsx(U,{className:"border-green-200 bg-green-50",children:s.jsxs(z,{className:"p-6 text-center",children:[s.jsx(Qt,{className:"h-16 w-16 mx-auto text-green-500 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Order Delivered!"}),s.jsx("p",{className:"text-green-600",children:"Thank you for completing this delivery"})]})})]})]}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx(U,{className:"w-96",children:s.jsxs(z,{className:"p-8 text-center",children:[s.jsx(xe,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No Active Delivery"}),s.jsx("p",{className:"text-gray-500",children:"Accept an order to start GPS tracking"})]})})})},K1=()=>{const i=Ks();return v.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",i.pathname)},[i.pathname]),s.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),s.jsx("p",{className:"mb-4 text-xl text-gray-600",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 underline hover:text-blue-700",children:"Return to Home"})]})})},Y1=new G0({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}}),Q1=()=>(v.useEffect(()=>{Zm()},[]),s.jsx(K0,{client:Y1,children:s.jsx(_0,{children:s.jsxs(Sy,{children:[s.jsx(jy,{}),s.jsx(r0,{}),s.jsx(Kb,{children:s.jsxs(qb,{children:[s.jsx(Ge,{path:"/",element:s.jsx(ju,{})}),s.jsx(Ge,{path:"/home",element:s.jsx(a_,{})}),s.jsx(Ge,{path:"/login",element:s.jsx(ju,{})}),s.jsxs(Ge,{path:"/customer",element:s.jsx(il,{allowedRoles:["customer"],children:s.jsx(rN,{})}),children:[s.jsx(Ge,{index:!0,element:s.jsx(_N,{})}),s.jsx(Ge,{path:"cart",element:s.jsx(AN,{})}),s.jsx(Ge,{path:"orders",element:s.jsx(EN,{})}),s.jsx(Ge,{path:"order-details/:orderId",element:s.jsx(LN,{})}),s.jsx(Ge,{path:"track",element:s.jsx(KN,{})})]}),s.jsxs(Ge,{path:"/admin",element:s.jsx(il,{allowedRoles:["admin"],children:s.jsx(MS,{})}),children:[s.jsx(Ge,{index:!0,element:s.jsx(_1,{})}),s.jsx(Ge,{path:"products",element:s.jsx(w1,{})}),s.jsx(Ge,{path:"orders",element:s.jsx(S1,{})}),s.jsx(Ge,{path:"tracking",element:s.jsx(C1,{})}),s.jsx(Ge,{path:"live-tracking",element:s.jsx(T1,{})}),s.jsx(Ge,{path:"carousel",element:s.jsx(z1,{})}),s.jsx(Ge,{path:"features",element:s.jsx(M1,{})})]}),s.jsxs(Ge,{path:"/delivery",element:s.jsx(il,{allowedRoles:["delivery"],children:s.jsx(q1,{})}),children:[s.jsx(Ge,{index:!0,element:s.jsx(W1,{})}),s.jsx(Ge,{path:"notifications",element:s.jsx(G1,{})}),s.jsx(Ge,{path:"task/:taskId",element:s.jsx(Z1,{})}),s.jsx(Ge,{path:"tracking",element:s.jsx(J1,{})})]}),s.jsx(Ge,{path:"*",element:s.jsx(K1,{})})]})})]})})}));Ah(document.getElementById("root")).render(s.jsx(Q1,{}));
